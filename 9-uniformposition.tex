
\input{header.tex}


\chapter{Uniform position and its applications}\label{uniform position}

In this chapter, we will introduce an elementary but surprisingly useful tool for studying curves (and higher-dimensional varieties as well!). We'll see how to apply it in several contexts: to prove the strong form of Clifford's theorem, the strong form of Martens' theorem, and the Castelnuovo bound on the genus of a curve in projective space.

The basic Uniform Position lemma deals with the \emph{monodromy group} of the points of a general hyperplane section of a curve $C \subset \PP^r$. We'll define this precisely below, but the basic idea is straightforward if one is willing to adopt the classical topology (an equivalent definition is described in Cheerful Fact~\ref{Galois equals monodromy} below). To set it up, suppose $C \subset \PP^r$ is an irreducible curve, and $H_0 \subset \PP^r$ a hyperplane transverse to $C$; say the intersection $C \cap H_0 = \{p_1,\dots,p_d\}$. As we vary $H_0$ continuously along a real arc $\{H_t\}$, staying within the open subset $U \subset {\PP^r}^*$ of hyperplanes transverse to $C$, we can ``follow" each of the points $p_i(t)$ of intersection of $C$ with the hyperplane $H_t$.

Now imagine that the hyperplanes $H_t$ come back to the original $H_0$ at some time; that is, we have a continuous family $\{H_t\}_{0 \leq t \leq 1}$ with $H_1 = H_0$. Again, we can follow each of the points $p_i$ as $t$ varies, arriving at an arc $\{p_i(t) \in C \cap H_t\}_{0 \leq t \leq 1}$. Since $H_1 = H_0$, the end point $p_i(1)$ will be one of the original points $p_j \in C \cap H_0$ we started with, but it need not be the point $p_i$ we started with! In this way, we get a permutation of the set $C \cap H_0$; the group of all permutations arrived at in this way will be called the \emph{monodromy group} of the points $C \cap H_0$. 

This may seem a rather esoteric construction, but as we said it is surprisingly useful. We'll start by giving a precise definition of the mondromy group in a more general setting, then prove the \emph{uniform position lemma} for the points of a general hyperplane section of a curve; the rest of the chapter will be a series of applications of this lemma.

\section{Uniform position} \label{uniformSection}

\subsection{The monodromy group of a generically finite morphism}

Let $f : Y \to X$ be a dominant map between varieties of the same dimension over $\CC$, and suppose that $X$ is irreducible. There is then an open subset $U \subset X$ such that $U$ and 
its preimage $V = f^{-1}(U)$ are smooth, and the restriction of $f$ to $V$ is a covering space in the classical topology. Let $d$ be the number of sheets. This is the degree of the extension $K(Y)/K(X)$.

A basic construction from homotopy theory  associates a \emph{monodromy group} to any finite topological covering map $f : V \to U$, defined as follows: Choose a base point $p_0 \in U$, and suppose $\Gamma := f^{-1}(p_0)  = \{q_1,\dots,q_d\}$. If $\gamma$ is any loop in $U$ with base point $p_0$, for any $i = 1, \dots, d$ there is a unique lifting of $\gamma$ to an arc $\tilde \gamma_i$ in $V$ with initial point $\tilde \gamma_i(0) = q_i$ and end point $\tilde \gamma_i(1) = q_j$ for some $j \in \{1,2,\dots,d\}$. Since we could traverse the loop in the opposite direction, the index $j$ determines $i$, and the map $i\mapsto j$ is a permutation of $\{1,2,\dots,d\}$. 
Since the set $\Gamma$ is discreet, the permutation depends only on the class of $\gamma$ in $\pi_1(U,p_0)$ so we have defined a homomorphism to the symmetric group:
$$
\pi_1(U,p_0)  \to {\rm Perm}(\Gamma) \cong S_d.
$$
The image $M$ of this map is called the \emph{monodromy group} of the map $f$. It depends on the labeling of the points of $\Gamma$, but is well-defined  up to conjugation. Moreover, in our setting it is independent of the choice of open set $U$: if $U' \subset U$ is a Zariski open subset, the map $\pi_1(U', p_0) \to \pi_1(U,p_0)$ is surjective,  so the image of $\pi_1(U', p_0)$ in $S_d$ is the same.

\begin{fact}\label{Galois equals monodromy}
The theory of finite coverings of algebraic varieties is not only analogous to Galois theory, it \emph{is} Galois theory: In the situation described above, if we assume that $Y$ is irreducible, then the pullback map $f^*$ expresses the function field $K(Y)$ as a finite algebraic extension of $K(X)$. The degree of this extension is the degree of the map $f$. The monodromy group of $f$  is the Galois group of the Galois normalization of $K(Y)$ over $K(X)$ (see \cite{Harris1979}). Indeed, in early treatments of Galois theory, such as Jordan's book \emph{Trait\'e des Substitutions} (\cite{}), function fields played as large a role as number fields!
\end{fact}

Since we assumed that $X$ is irreducible, the space $U$ is (path) connected, and it follows that the monodromy group is transitive if and only if the space $V$ is (path) connected. But $V$ is a smooth
variety, so this is the case if and only if $V$ is irreducible.

We will next compute the monodromy group of the  universal hyperplane section of a curve, constructed as follows:
Let $C \subset \PP^r$ be an irreducible, nondegenerate curve of degree $d$, and let $X = {\PP^r}^*$ be the space of hyperplanes in $\PP^r$. We define the \emph{universal hyperplane section of $C$} to be the projection  $f: Y\to {\PP^r}^*$ of the incidence variety
$$
Y = \{ (H, p) \in {\PP^r}^* \times C \mid p \in H \}.
$$
The fibers of $f$ are the hyperplane
sections of $C$, so it is a dominant finite map. If we let $U\subset {\PP^r}^*$ be the open subset of hyperplanes
meeting $C$ transversely, then the restriction of $f$ to the preimage $V$ of $U$ is a covering space
whose fibers each consist of $d$ distinct points. The preimage in $Y$ of a point $p\in C$ is the set of hyperplanes containing
$p$, a copy of $\PP^{r-1}$, and thus $Y$ is irreducible. Thus the monodromy group of $f$ is transitive. But much more is true:

\begin{theorem}[Uniform Position Theorem]\label{uniform position lemma}
The monodromy group of the universal hyperplane section of an irreducible curve $C \subset \PP^r$ is the full symmetric group $S_d$.
\end{theorem}

Theorem~\ref{uniform position lemma} fails over fields of finite characteristic; see \cite{Rathmann} and \cite{Kadets} for what is known. 

Informally, theorem~\ref{uniform position lemma} says that two subsets of the same cardinality in the general hyperplane section of $C$
are indistinguishable from the point of view of any discrete invariant that is semicontinuous in the Zariski topology. To make this more precise, and to deduce some immediate consequences, it will be useful to start with a definition:

%The following is a good example of how the theorem is applied:
%
%To carry this out in the case of the monodromy group $M$ of the universal hyperplane section of an irreducible, nondegenerate curve $C \subset \PP^r$, then, we need to establish sufficient conditions for $M$ to be doubly transitive, and for $M$ to contain a transposition; we'll start with the first of these. It will be helpful to introduce one construction first:

\begin{definition}
Let $\phi : Y \to X$ be a finite morphism. By the \emph{restricted fiber power} $\tilde Y^n/X$ we will mean the complement of all diagonals in the ordinary fiber power; that is,
$$
\tilde Y^n/X := \{ (x, y_1,\dots, y_n) \in X \times Y^n \mid \phi(y_i) = x \text{ and } y_i \neq y_j \; \forall i \neq j \}
$$
\end{definition}

%Since the symmetric group $S_d$ is generated by transpositions, we may prove that a subgroup $M\subset S_d$ is equal to $S_d$ by showing that $M$ is doubly transitive and contains a transposition (of course it will then follow that $M$ is $k$-fold transitive for any $k\leq d$.) We can translate these properties into geometry as follows:

In these terms, we have 

\begin{lemma}\label{transitivity lemma}
Let $f : Y \to X$ be a generically finite cover of degree $d$, with  monodromy group $M \subset S_d$.
$M$ is $n$ times transitive if and only if the restricted fiber power $\tilde Y^n/X$ is irreducible.
\end{lemma}

\begin{proof}
If we restrict ourselves to open subsets $U \subset X$ and $V = f^{-1}(U) \subset Y$ such that $U$ and $V$ are smooth and the restriction $f|_V : V \to U$ is a covering space map in the classical topology, then the restricted fiber powers are unions of connected component of the usual fiber power $Y^n/X$. The condition that the monodromy if $n$-times transitive is equivalent to the condition that the restricted fiber power $\tilde Y^n/X$ is connected; since the fiber powers are all smooth, this is equivalent to $\tilde Y^n/X$ being irreducible.
\end{proof}

Applying this to the universal hyperplane section of a curve $C \subset \PP^r$, a consequence of the Uniform Position Theorem is an irreducibility result:

\begin{corollary}\label{hyperplane section monodromy} If $C\subset \PP^r$ is a smooth curve of degree $d$, then 
for $k\leq \deg C$, the restricted fibered powers $\tilde Y^n/X$  of the universal hyperplane section 
of $C$ are irreducible.
\end{corollary}

As a consequence, we have the

\begin{corollary}[numerical uniform position lemma]\label{numerical uniform position lemma}
Let $C\subset \PP^r$ be an irreducible curve, and let $\Gamma = H\cap C$ be a general hyperplane section. Any two subsets of $\Gamma$ with the same cardinality impose the same number of conditions on forms of any degree; that is, any two subsets of the same cardinality have the same Hilbert function.
\end{corollary}

\begin{proof} Let $U = {\PP^r}^* \setminus C^*$ be the open subset of hyperplanes transverse to $C$, and let $Y\to U$ be the universal hyperplane section.
%Thus
%\begin{align*}
% Y^{k*} :=&Y\times_U Y\times_U \cdots Y\times_U \setminus \Delta  =\\
%                                                 & \{ (H, \Gamma) \in {\PP^r}^* \times C^k \mid \Gamma \subset H, \hbox{ and $\Gamma$ consists of $k$ distinct points.}\}\\
%                                                 &\to U
%\end{align*}
Corollary~\ref{hyperplane section monodromy} says that the restricted fiber powers $\tilde V^n/U$ are irreducible.

Now, for each $m$ the number of conditions that $\Gamma$ imposes on forms of degree $m$ is lower semicontinuous, so it achieves its maximum on a Zariski open subset of $\tilde V^n/U$. Since $\tilde V^n/U$ is irreducible, the complement $Z$ of this open set has dimension strictly less than $\dim \tilde V^n/U = \dim U$. Thus a general hyperplane $H \in {\PP^r}^*$ will lie outside the image of $Z$, meaning that the number of conditions imposed by all the $k$-element subsets $\Gamma \subset C \cap H$ will have this maximal value.
\end{proof}


As a special case of Corollary~\ref{numerical uniform position lemma}, we can consider just the number of conditions imposed by subsets of $C \cap H$ on linear forms. Here, since $C \subset \PP^r$ is irreducible and nondegenerate, the points of a general hyperplane section $\Gamma = H \cap C$ of $C$ span the hyperplane $H \cong \PP^{r-1}$, so some subset of $r$ points of $\Gamma$ span $H$; from Corollary~\ref{numerical uniform position lemma}, then, we deduce that \emph{any} $r$ points of $\Gamma$ do. This is the classical


\begin{lemma}[Linear General Position]\label{general position lemma}
If $C \subset \PP^r$ is an irreducible, nondegenerate curve and $\Gamma = C \cap H$ a general hyperplane section of $C$, then the points of $\Gamma$ are in linearly general position in $H \cong \PP^{r-1}$; that is, no $r$ points of $\Gamma$ lie in a hyperplane $\PP^{r-2} \subset H$.
\end{lemma}


Thus, for example, if $C \subset \PP^3$ is a space curve, the general position lemma says that no three points of a general plane section $\Gamma = H \cap C$ of $C$ are colinear. Even this case is surprisingly tricky to prove (and is false in characteristic $p$); Exercise~\ref{weak general position} sketches a proof.
See \cite[Lemma 1.1]{Rathmann} for a fairly direct proof, valid for smooth curves in every characteristic, except for the plane conic in characteristic 2.  

Remarkably, even this special case of a special case of the uniform position theorem already suffices for the proof of the Castelnuovo bound on the genus of a curve $C \subset \PP^r$, which we'll derive in Section~\ref{}.

\subsection{Proof of the uniform position theorem}

To set up, let $C \subset \PP^r$ be an irreducible, nondegenerate curve of degree $d$ and $f : Y \subset {\PP^r}^* \times C \to  X = {\PP^r}^*$ its universal hyperplane section; let $U \subset {\PP^r}^*$ be the open subset of hyperplanes transverse to $C$ and $V = f^{-1}(U)$; let $M \subset S_d$ be the monodromy group of $V$ over $U$.
To
 show that  $M$ is the full symmetric group, it suffices to establish two facts: that $M$ is twice transitive; and that $M$ contains a transposition. Given these two facts, it will follow that $M$ contains all transpositions, and hence that $M = S_d$.

To carry this out, then, we need to establish sufficient conditions for $M$ to be doubly transitive, and for $M$ to contain a transposition; we'll start with the first of these. 

To prove that $M$ is doubly transitive, we can give a concrete description of the restricted fiber power $\tilde V^2/U$: let
$$
\Sigma := \left\{ (H, p, q) \in {\PP^r}^* \times C \times C \mid p, q \in H \text{ and } p \neq q \right\}.
$$
Projection on the second and third factor expresses $\Sigma$ as a $\PP^{r-2}$-bundle over the complement $C \times C \setminus \Delta$ of the diagonal in $C \times C$. Thus $\Sigma$ is irreducible, and it follows that the restricted fiber square $\tilde V^2/U$, which is a Zariski open subset of $\Sigma$, is as well. Note that this part of the argument does not rely on any assumption about the characteristic.

As for the existence of a transposition in the monodromy group of the universal hyperplane section, we have the following lemma:

\begin{lemma}\label{transposition lemma}
Let $f : Y \to X$ be a generically finite cover of degree $d$ over an irreducible variety $X$, with  monodromy group $M \subset S_d$.  
If,  for some smooth point $p \in X$ the fiber $f^{-1}(p)\subset V$ consists of $d-2$ reduced points $p_1,\dots, p_{d-2}$ and one point $q$ of multiplicity 2, where $q$ is also a smooth point of $Y$, then $M$ contains a transposition.
\end{lemma}

\begin{proof} To begin with, let $U \subset X$ be a Zariski open subset of the smooth locus in $X$, as in the definition of the monodromy group, so that  $V := f^{-1}(U)$ is also smooth and the restriction $f|_V : V \to U$ expresses $V$ as a $d$-sheeted covering space of $U$, with $U,V$ smooth and $p\in X$

Now, let $A \subset X$ be a small neighborhood of $p$ in the classical topology. The preimage $f^{-1}(A)$ will have $d-1$ connected components, one containing each of the points $p_1,\dots,p_{d-2}$ and $q$; let
 $B \subset f^{-1}(A) \subset Y$ be the connected component of $f^{-1}(A)$ containing the point $q$.

Let $p' \in A \cap U$. Two of the $d$ points of $f^{-1}(p')$ will lie in the component $B$ of $f^{-1}(A)$ containing $q$; call these $q'$ and $q''$. Since $B \cap V$ is connected (it's the complement of a proper subvariety in the neighborhood $B$ of the smooth point $q \in Y$), we can draw a real arc $\gamma : [0,1] \to B \cap V$ joining $q'$ to $q''$; by construction, the permutation of $f^{-1}(p')$ associated to the loop $f \circ \gamma$ will exchange $q'$ and $q''$ and fix each of the remaining $d-2$ points of $f^{-1}(p')$.
\end{proof}

Here is a generalization of the uniform position theorem for varieties of higher dimension:

\begin{exercise}
Let $X \subset \PP^r$ be an irreducible variety of dimension $k$, and let $\Phi \subset \GG(r-k, r) \times X$ the universal $(r-k)$-plane section; that is,
$$
\Phi := \{ (\Lambda, p) \in \GG(r-k,r) \times X \mid p \in \Lambda \}.
$$
Show that the monodromy of the projection $\Phi \to \GG(r-k,r)$ is the full symmetric group.
\end{exercise}

As a consequence of this, we can deduce the Bertini irreducibility theorem:

\begin{exercise}
Let $X \subset \PP^r$ be an irreducible variety of dimension $k \geq 2$. Show that a general hyperplane section of $X$ is irreducible.
\end{exercise}

\begin{exercise}
Let $C \subset \PP^r$ be a union of irreducible curves $C_i$ of degrees $d_i$. Prove that the monodromy group of the points of a general hyperplane section of $C$ is the product $\prod S_{d_i}$.
\end{exercise}

Hint: We need to know that the dual hypersurfaces $C_i^* \subset {\PP^r}^*$ are all distinct; given this, we can exhibit loops that induce a given permutation of the points of $H \cap C_i$ while fixing the points of $H \cap C_j$ for $j \neq i$.

Here is an exercise sketching an ``elementary" proof of the general position lemma (Lemma~\ref{general position lemma}) for $r=3$:

\begin{exercise}\label{weak general position}
Let $C \subset \PP^3$ be an irreducible, nondegenerate space curve. Assuming characteristic 0,
\begin{enumerate}
\item Show that if $p, q \in C$ are general, then the tangent lines $\TT_pC$ and $\TT_qC \subset \PP^3$ do not intersect.
\item Using this, show that for general $p, q \in C$ the line $\overline{p,q}$ is not a trisecant; that is, it does not intersect $C$ a third time.
\item Using the irreducibility of $C \times C$, show that $C$ can have at most a 1-parameter family of trisecant lines.
\item Deduce that a general plane $H \subset \PP^3$ does not contain three colinear points of $C$.
\end{enumerate}
\end{exercise}



%For every $k\leq \deg C$ we consider the fiber product over $U$ minus the main diagonal $\Delta$
%\begin{align*}
% Y^{k*} :=&Y\times_U Y\times_U \cdots Y\times_U \setminus \Delta  =\\
%                                                 & \{ (H, p_1,\dots, p_k) \in {\PP^r}^* \times C^k \mid p_1,\dots, p_k \in H, p_i \neq p_j \hbox{ for all } i,j \}.
%\end{align*}

%\begin{proof}[Proof of the Uniform Position Theorem]
%We show first that the monodromy group $M$ is twice transitive, and then that it contains a transposition. It follows that $M$ contains all the transpositions so that  $M = S_d$.
%Restricting to an open subset of $C$, we may assume that $C$ is smooth.
%
%For the double transitivity, we introduce a related cover: set
%$$
%\Phi = \{ (H, p, q) \in {\PP^r}^* \times C \times C \mid p + q \subset H \}
%$$
%where $p+q$ is the divisor $p+q$ on $C$, viewed as a subscheme of $C$. The projection $\pi_{2,3} : \Phi \to C \times C$ is a $\PP^{r-2}$-bundle, and so irreducible; applying Lemma~\ref{transitivity lemma}, we deduce that $M$ is twice transitive.
%
%To prove that $M$ contains a transposition, we will use the characteristic 0 hypothesis. It follows from Bertini's theorem and Lemma~\ref{tangent not bitangent} that a general hyperplane $H$ containing
%the tangent line at a general point $p\in C$ meets $C$ with multiplicity exactly 2 at $p$ and meets $C$ transversely elsewhere. 
%Thus the fiber of $\Phi$ over the point $H \in {\PP^r}^*$ consists of the point $p$ with multiplicity 2, and $d-2$ reduced points; applying Lemma~\ref{transposition lemma}, we deduce that $M$ contains a transposition.
%\end{proof}

\section{Applications I: the strong form of Clifford's theorem}

Another consequence of the uniform position lemma is a result about sums of linear series.
Recall that if $D$ is a divisor on a curve $C$ we write $r(D) = \dim |D| = h^0(\cO_C(D))-1$.

\begin{corollary}\label{Clifford equality plus}
If $D,E$ are effective divisors on a curve $C$ then
$$
r(D+E) \geq r(D)+r(E).
$$
If the genus of $C$ is $>0$ and $D+E$ is birationally very ample, then the inequality is strict.
\end{corollary}.

Note that on $\PP^1$ any effective divisor $D$ has $r(D) = \deg D$, so the inequality above is
always an equality for $C = \PP^1$.

\begin{proof}
 The inequality follows in general because the sums of divisors in $|D|$ and divisors in $|E|$ already move in 
 a family of dimension $r(D)+r(E)$; the key point is the strict inequality in case $D+E$ is birationally very ample.
 
In the case where $D+E$ is birationally very ample then, restricting to an open set,
we may identify $C$ with its image under the complete linear series $|D+E|$, and we see that a general hyperplane section $H\cap C$ contains a divisor equivalent to $D$. Since the monodromy of the universal hyperplane section
is the symmetric group, this implies that \emph{every} subset of $\deg D$ elements in $H\cap C$ is
equivalent to $D$. But if $p\in D$ and $q\notin D$, then $D-p+q \equiv D$, whence $q\equiv p$. Thus
$r(p)\geq 1$, so $C\cong \PP^1.$
\end{proof}

A special case of Corollary~\ref{Clifford equality plus} completes the ``equality'' case of Clifford's Theorem:

\begin{corollary}\label{Clifford equality}
If $D$ is an effective divisor on a curve of genus $g\geq 2$ and $r(D) = d/2$, then either $D= 0$ or 
$D=K$ or $C$ is hyperelliptic and $D$ is a multiple of the $g^1_2$.
\end{corollary}

\begin{proof}
  By the argument given in Theorem~\ref{Clifford}, if $r(D) = d/2$, but $D\neq 0,K$, then
$$
r(D) + r(K-D) = r(K) = g-1;
$$
which implies that every canonical divisor is expressible as a sum of a divisor in $|D|$ and a divisor in $|K-D|$.
By Corollary~\ref{Clifford equality plus}, $K$ is not very ample; so $C$ is hyperelliptic. Moreover the
divisors equivalent to $D$ are sums of the fibers of the map given by $|K|$.
\end{proof}

\section{Applications II: the strong form of Martens' theorem}

Another consequence of the uniform position lemma is that it allows us to give a proof of the strong form of Martens' theorem bounding the dimension of the variety $W^r_d(C)$ parametrizing divisor classes of degree $d$ on a curve $C$ with $r(D) \geq r$.
To start, recall the statement of Martens' theorem from Chapter~\ref{new Jacobians chapter}

\begin{theorem}[Martens' theorem]\label{full Martens}
If $C$ is any smooth projective curve of genus $g$, then for any $d$ and $g$ we have
$$
\dim W^r_d(C) \leq d-2r;
$$
moreover, if we have equality for any $r > 0$ and $d < 2g-2$ the curve $C$ must be hyperelliptic.
\end{theorem}

Note that the inequality $\dim W^r_d(C) \leq d-2r$ is equivalent to the inequality $\dim C^r_d \; \leq \; d-r$, which is what we actually showed in Chapter~\ref{new Jacobians chapter}. This in turn followed by combining the geometric form of Riemann-Roch with an elementary bound on the dimension of the variety of secant planes to a curve in projective space:

\begin{lemma}[elementary secant plane lemma]
Let $C \subset \PP^n$ be a smooth, irreducible and nondegenerate curve. If we denote by $\Sigma \subset C_d$ the locus of effective divisors $D$ of degree $d$ on $C$ with $\dim \overline D \leq d-r-1$, then for any $d \leq n$ and $r > 0$,
$$
\dim \Sigma \leq d-r.
$$
\end{lemma}

The uniform position lemma allows us to do exactly one better: using it we can, without difficulty, prove the

\begin{lemma}[strong secant plane lemma]\label{Strong secant plane lemma}
Let $C \subset \PP^n$ be a smooth, irreducible and nondegenerate curve. If we denote by $\Sigma \subset C_d$ the locus of effective divisors $D$ of degree $d$ on $C$ with $\dim \overline D \leq d-r-1$, then for any $d \leq n$ and $r > 0$,
$$
\dim \Sigma \leq d-r-1.
$$
\end{lemma}

\begin{proof}
We set up an incidence correspondence: 
$$
\Gamma := \left\{ (D, H) \in \Sigma \times {\PP^n}^* \mid \overline D \subset H \right\}.
$$
The curve being nondegenerate, the projection map $\Gamma \to  {\PP^n}^*$ is finite. But the fibers of $\Gamma$ over $\Sigma$ have dimension at least $n-d+r$; if we had $\dim \Sigma \geq d-r$, it would follow that $\dim \Gamma \geq n$, and hence that the projection map $\Gamma \to  {\PP^n}^*$ is dominant---contradicting the general position lemma~\ref{general position lemma}.
\end{proof}

Now, if a curve $C$ is non-hyperelliptic, we can apply the strong secant plane lemma to the canonical curve to conclude that $\dim W^r_d(C) \leq d-2r-1$; it follows that if we have $\dim W^r_d(C) = d-2r$ the curve $C$ in question must be hyperelliptic.

There are extensions of Martens' theorem to the case $\dim W^r_d(C) = d-2r-1$ (Mumford) and $d-2r-2$ (Keem).

\section{The $g+2$ theorem}\label{g+2 section}

Now that we have the strong form of Martens' theorem, we can prove an analogue of Theorem~\ref{g+3 theorem} for general linear series of degree $g+2$.

\begin{theorem}
Let $C$ be any smooth projective curve of genus $g$, and let $D$ be a general divisor of degree $g+2$ on $C$. 
\begin{enumerate}
\item If $C$ is non-hyperelliptic, the map $\phi_D : C \to \PP^2$ is birational onto its image $C_0$, and $C_0$ is a plane curve of degree $g+2$ with exactly $\binom{g}{2}$ nodes and no other singularities; and
\item If $C$ is hyperelliptic, the map $\phi_D : C \to \PP^2$ is birational onto its image $C_0$, and $C_0$ is a plane curve of degree $g+2$ with one ordinary $g$-fold point and no other singularities.
\end{enumerate}
\end{theorem}

\begin{proof}
Let's start by proving that $\phi_D$ is birational onto its image, which is true whether or not $C$ is hyperelliptic. We do this much as in the proof of Theorem~\ref{g+3 theorem}. Since $D$ is general, we know that $h^0(D) = 3$. To say that $\phi_D(p) = \phi_D(q)$ for some pair of points $p, q \in C$, accordingly, means exactly that $h^0(D-p-q) = 2$. This in turn means that $D-p-q = K-E$ for some effective divisor $E$ of degree $g-2$; in other words, to say that $\phi_D(p) = \phi_D(q)$ for some pair of points $p, q \in C$ means that $\mu(D)$ is in the image of the map
$$
\nu : C_2 \times C_{g-2} \to \Pic_{g+2}(C)
$$
sending $(p+q, E)$ to $K_C - E + p + q$. Now, $\nu$ is a map between projective varieties of the same dimension, so we might expect that it is surjective, and indeed the genus formula tells us that it must be: $\phi_D$ cannot be an embedding. But by the same token, the locus in $\Pic_{g+2}(C)$ over which the fibers of $\nu$ are positive-dimensional must be a proper subvariety; thus for general $D$ we conclude that \emph{there are only finitely many pairs $p, q \in C$ such that $\phi_D(p) = \phi_D(q)$}; in other words, $\phi_D$ is birational onto its image.

Let's now suppose that $C$ is non-hyperelliptic and $D$ is a general divisor of degree $g+2$ on $C$. To prove the theorem in this case, we have to show  three things: that the image $C_0 = \phi_D(C)$ does not have cusps; that it does not have triple points, and that it does not have tacnodes. (The fact that $|D|$ is base point free  will follow from the first of these arguments, as noted below.) We'll take these assertions in turn:

\begin{enumerate}


\item Cusps: to say that a point $p \in C$ maps to a cusp of $C_0$ (that is, the differential $d\phi_D$ is zero at $p$) amounts to saying that $h^0(D-2p) \geq 2$; that is, $D-2p$ is a $g^1_g$. But by Riemann-Roch, $W^1_g = K_C - W_{g-2}$; so to say $\phi_D$ has a cusp means that
$$
\mu(D) \in 2W_1 + K_C - W_{g-2},
$$
and since the locus on the right has dimension at most $g-1$, a general point of $J(C)$ will not lie in it. Note that this subsumes the fact that $|D|$ has no base points.

\item Triple points: to say that $C_0$ has a triple point means that for some divisor $E = p+q+r$ of degree 3, $h^0(D-E) \geq 1$; thus we must have 
$$
\mu(D) \in W_3 + W^1_{g-1}
$$
Now, to argue that this is not the case, we need to know that $\dim W^1_{g-1} \leq g-4$. Here we have to invoke Marten's theorem, which says that $\dim W^1_{g-1} \leq g-4$ if $C$ is non-hyperelliptic; given this, we conclude that $C_0$ has no triple points.

\item Tacnodes:  To say that a pair of points $p, q \in C$ map to a tacnode of $C_0$ means two things: that $h^0(D-p-q) \geq 2$; and that $h^0(D-2p-2q) \geq 1$. If this is the case, set $E = D - 2p - 2q$;  the condition $h^0(D-2p-2q) \geq 1$ is simply that $E$ is an effective divisor, and by the geometric Riemann-Roch the condition $h^0(D-p-q) \geq 2$ says that in terms of the canonical embedding of $C$, the secant line $\overline{p,q}$ meets the $g-3$-plane $\overline E$ spanned by $E$. Now, not every secant line to $C$ can meet a linear subspace $\Lambda \cong \PP^{g-3}$ of dimension $g-3$---the projection $\pi_\Lambda : C \to \PP^1$ would be constant---so we see that $\mu(D)$ would have to lie on the image of a proper subvariety of $C_{g-2} \times C_2$ under the map 
$$
(E, p+q) \mapsto E+2p+2q.
$$
By a dimension count it follows that $D$ cannot be a general divisor of degree $g+2$.

\end{enumerate}

Thus, in the non-hyperelliptic case, the image curve $C_0 = \phi_D(C)$ has only nodes as singularities; the fact that there are exactly $\binom{g}{2}$ of them follows from the genus formula.


This concludes the proof in the non-hyperelliptic case. The hyperelliptic case is very different, as you might expect from the statement. To analyze this case, suppose that $C$ is hyperelliptic; let $|E|$ be the (unique) $g^1_2$ on $C$. Now, if  $D$ is any divisor of degree $g+2$, the divisor $D - E$ will have degree $g$, and so be effective; thus we can write
$$
D = E + p_1 + \dots + p_g
$$
for some $g$-tuple of points $p_i$. If the divisor $D$ is general, the points $p_i$ will be general as well, and in particular distinct.

Now, the fact that
$$
h^0(D - p_1 - \dots - p_g) = h^0(E) = 2 = h^0(D) - 1
$$
says that $\phi_D$ maps all the points $p_i$ to the same point! The image curve $C_0$ thus has a point of multiplicity at least $g$, with at least $g$ branches; by the genus formula, we see that this is an ordinary $g$-fold point of $C_0$ and that $C_0$ can have no other singularities.

\end{proof}

Here is another way to see the hyperelliptic case: 

\begin{exercise}
Let $C$ be a hyperelliptic curve of genus $g$ and $D$ a general divisor of degree $g+1$ on $C$; let $|E|$ be the $g^1_2$ on $C$.
Consider the map $\phi : C \to \PP^1 \times \PP^1$ given as the product of the maps $\phi_D : C \to \PP^1$ and $\phi_E : C \to \PP^1$ given by the pencils $|D|$ and $|E|$.
\begin{enumerate}
\item Show that $\phi$ embeds the curve $C$ as a curve of bidegree $(g+1,2)$ on $\PP^1 \times \PP^1$.
\item Now embed $\PP^1 \times \PP^1$ into $\PP^3$ as a quadric surface $Q$; pick a general point $p \in C \subset Q$ and project $C$ from the point $p$. Show that the image curve $C_0$ is a plane curve of degree $g+2$ with one ordinary $g$-fold point.
\end{enumerate}
\end{exercise}


\section{Castelnuovo's theorem}

Clifford's theorem gives a complete and sharp answer to the question, ``what linear series can exist on a curve of genus $g$?
But maybe that wasn't the question we meant to ask! After all, we're interested in describing curves in projective space as images of abstract curves $C$ under maps given by linear systems on $C$. Observing that the linear series that achieve equality in Clifford's theorem give maps to $\PP^r$ that are 2 to 1 onto a rational curve, we might hope that we would have a different---and more meaningful---answer if we  restrict our attention to linear series $\cD = (\cL,V)$ for which the associated map $\phi_\cD$ is at least  birational. 

A classical result of Castelnuovo gives a sharp bound, which is in some sense explained by Castelnuovo's classification of the curves that achieve it. For positive integers $d$ and $r$, we write
$$
 d = M(r-1) + 1 + \epsilon \quad \text{ with } \quad 0 \leq \epsilon \leq r-2
$$
and set
$$
\pi(d,r) = \frac{M(M-1)}{2}(r-1) + M\epsilon.
$$

\begin{theorem}[Castelnuovo's bound]\label{Castelnuovo's bound}
If $C \subset \PP^r$ is a reduced, irreducible, nondegenerate curve of degree $d$ and arithmetic genus $p_a$, then
$$
p_a \leq \pi(d,r).
$$
\end{theorem}

In our proof we will use characteristic 0, but in fact the result holds in all characteristics.

We will say that a curve achieving the bound is a \emph{Castelnuovo curve}. We will see in Chapter~\ref{} that the bound is sharp: for every $r$ and $d \geq r$, there exist curves with genus exactly $\pi(d,r)$. 

\begin{example}
For plane curves, $r=2, \ \epsilon = 0, \ M = d-1$ so we recover the necessary $p = \pi(d,2) =  {d-1\choose 2}$. Thus every reduced irreducible
plane curve is a Castelnuovo curve.
\end{example}

\begin{example}For a more typical situation, consider the case $r=3$. We have
$$
p_a \leq \pi(d,3) = \lfloor d^2/4 \rfloor-d+1\, .
$$
It is easy to check that curves on a smooth quadric surface of classes
$(d/2, d/2)$ or $((d-1)/2, (d+1)/2)$
achieve this bound, and a variant of this works for singular quadrics as well. The classification  explained in Chapter~\ref{ScrollsChapter}
shows that these are the only Castelnuovo curves in $\PP^3$.
\end{example}

\begin{fact}
A famous theorem of Gruson and Peskine~\ref{Gruson-Peskine} (see \ref{Hartshorne-report} for an exposition and also the cases of characteristic $>0$ and small fields) completes the picture of the possibilities for the degree $d$ and  genus $g$  of a smooth curve in $\PP^3$. First, if the curve does not lie on a plane or a quadric, then
$$
g\leq \pi_1(d,3) := \frac{d^2-3d}{6} +1
$$
so there are  sometimes gaps in the possible genera for a given degree: for example  $\pi_1(9,3) = 10<\pi(9,3) =12$ but there is
no curve of degree 9 and genus 11: an irreducible curve of class $(a,b)$ on a smooth quadric has arithmetic genus $11 = (a-1)(b-1)$
if and only if $\{a,b\} = \{2,12\}$, so such a curve must have degree 14, and a similar computation holds for a curve on a quadratic cone.

On the other hand, there are smooth curves in $\PP^3$ of every genus and degree realizing $g\leq \pi_1(d)$; and these can be realized as curves
on cubic or quartic surfaces.

The case of $\PP^n$ for $n\geq 3$ remains open. 
\end{fact}
To prove Theorem~\ref{Castelnuovo's bound}, we will give lower bounds for the dimensions of the linear series  cut on a curve $C$ by hypersurfaces of degree $m$. For large values of $m$ the line bundle $\cO_C(m)$ is non-special and $H^1(\sI_{C/\PP^r}(m) = 0$, so a lower bound on the dimension of its space of sections translates, via the Riemann-Roch theorem, into an upper bound on the genus $g$ and this is the Castelnuovo bound.

For the proof, the following definition will be convenient:

\begin{definition}
If $\sV = (V,cL)$ is a linear system on a variety and $\Gamma$ is a subscheme then the number of conditions
imposed by $\Gamma$ on $\sV$ is the dimension of the image of $V$ in $H^0(\sL\mid_\Gamma) = H^0(\sL \otimes \sO_\Gamma)$; or, numerically,
$$
\dim(V) - \dim \left(V \cap H^0(\cL\otimes \cI_{\Gamma/X}) \right).
$$\end{definition}

Thus, for example, if $\Gamma \subset \PP^r$, then the number of conditions imposed by $\Gamma$ on $H^0(\cO_{\PP^r}(m))$ is the value $h_\Gamma(m)$ of the Hilbert function of $\Gamma$ at $m$.
Note that the number of conditions imposed by $\Gamma$ on a linear system $V$ is necessarily less than or equal to the degree $d$ of $\Gamma$; if it is equal we say that $\Gamma$ \emph{imposes independent conditions on $V$}.

\begin{proof}[Proof of Theorem~\ref{Castelnuovo's bound}]
Suppose that $C \subset \PP^r$ is an irreducible, nondegenerate curve, and let $\Gamma = C \cap H$ be a general hyperplane section of $C$. Let $V_m \subset H^0(\cO_C(m))$ be the linear series cut on $C$ by hypersurfaces of degree $m$ in $\PP^r$, that is, the image of the restriction map
$$
H^0(\cO_{\PP^r}(m)) \to H^0(\cO_C(m)).
$$
Since the ideal sheaf of the hyperplane section is $\cI_{\Gamma/C} = \sO_C(-1)$ we have:
\begin{align*}
h^0(\cO_C(m)) - h^0(\cO_C(m-1)) & \geq \text{\# of conditions imposed by $\Gamma$ on $H^0(\cO_C(m))$} \\
&\geq \text{\# of conditions imposed by $\Gamma$ on $V_m$} \\
&\geq \text{\# of conditions imposed by $\Gamma$ on $H^0(\cO_{\PP^r}(m))$} \\
&\geq h_\Gamma(m).
\end{align*}
Summing these relations, we see that the dimension $h^0(\cO_C(m))$ is bounded below by
$$
h^0(\cO_C(m)) \geq \sum_{k=0}^m h_\Gamma(k).
$$

Thus, in order to bound the genus $C$ from above, we have to bound the Hilbert function of its hyperplane section $\Gamma$  from below; and for this, we need to know something about the geometry of $\Gamma$. In fact, all we need to know is Lemma~\ref{general position lemma}, which says that the points of $\Gamma$ are in linear general position! The key fact is the

\begin{proposition}\label{min hilb}
If $\Gamma \subset \PP^n$ is a collection of $d$ points in linearly general position that span $\PP^n$, then 
$$
h_\Gamma(m) \geq \min\{d, mn+1\}
$$
\end{proposition}

\begin{proof}
Suppose first that $d \geq mn+1$, and let $p_1,\dots,p_{mn+1} \in \Gamma$ be any subset of $mn+1$ points. It suffices to show that $\Gamma' = \{p_1,\dots,p_{mn+1}\}$ imposes independent conditions of $H^0(\cO_{\PP^n}(m))$, that is, for any $p_i \in \Gamma'$ there is a hypersurface $X \subset \PP^n$ of degree $m$ containing all the points $p_1,\dots, \hat{p_i},\dots,p_{mn+1}$ but not containing $p_i$.

To construct such an $X$, group the $mn$ points of $\Gamma' \setminus \{p_i\}$ into $m$ subsets $\Gamma_k$ of cardinality $n$; each set $\Gamma_k$ will span a hyperplane $H_k \subset \PP^n$, and we can take $X = H_1 \cup \dots \cup H_m$. 

In the case where $d<mn+1$, we add $mn+1-d$ general points; each one imposes exactly one
additional condition on hypersurfaces of degree $m$.
\end{proof}

This may seem like a crude argument, but the bound derived is sharp, as shown by the example in Exercise~\ref{linear bound is sharp}.

To complete the proof of Theorem~\ref{Castelnuovo's bound} all that remains is to add up the lower bounds in the proposition. To this end, let $C \subset \PP^r$ be as above an irreducible, nondegenerate curve of degree $d$, and set $M = \lfloor{\frac{d-1}{r-1}}\rfloor$, so that we can write
$$
d = M(r-1) + 1 + \epsilon \quad \text{ with } \quad 0 \leq \epsilon \leq r-2.
$$
We have 
\begin{align*}
h^0(\cO_C(M)) &\geq \sum_{k=0}^M h^0(\cO_C(k)) - h^0(\cO_C(k-1)) \\
&\geq  \sum_{k=0}^M k(r-1)+1 \\
&= \frac{M(M+1)}{2}(r-1) + M + 1
\end{align*}
and similarly
$$
h^0(\cO_C(M+m)) \geq \frac{M(M+1)}{2}(r-1) + M + 1 + md.
$$
For sufficiently large $m$, the line bundle $\cO_C(M+m)$ will be nonspecial, so by the Riemann-Roch Theorem,
\begin{align*}
g &= (M+m)d - h^0(\cO_C(M+m)) + 1 \\
&\leq (M+m)d - \bigl(  \frac{M(M+1)}{2}(r-1) + M + 1 + md \bigr) \\
& = M\bigl( M(r-1) + 1 + \epsilon \bigr) - \bigl(  \frac{M(M+1)}{2}(r-1) + M + 1 \bigr) \\
&= \frac{M(M-1)}{2}(r-1) + M\epsilon.
\end{align*}
 \end{proof}

From the proof we see that if  $C\subset \PP^r$ who degree and genus achieve equality, then all the inequalities in the proof
must be equalities; in particular, the map $H^0(\sO_{\PP^r}(d)) \to H^0(\sO_C(d))$ is surjective for every $d$ so the curve is
projectively normal.

\begin{exercise}\label{linear bound is sharp}
Let $D \subset \PP^n$ be a rational normal curve. If $\Gamma \subset D$ is any collection of $d$ points on $D$ (or for that matter any subscheme of $D$ of degree $d$) then the Hilbert function of $\Gamma$ is
$$
h_\Gamma(m) = \min\{d, mn+1\}
$$
\end{exercise} 

Castelnuovo in fact proved a converse to this observation:

\begin{fact}
If $d \geq 2n+3$, then any collection of $d$ points in $\PP^n$ in linearly general position with Hilbert function $h_\Gamma(2) = \min\{d, 2n+1\}$ must lie on a rational normal curve (and then $h_\Gamma(m) = \min\{d, mn+1\}$ for all $m$.) See~\cite{****} for a proof.
\fix{reference for Castelnuovo's $2n+3$}
\end{fact}

This was a key ingredient in Castelnuovo's theorem characterizing curves of maximal genus; we'll see how it's applied in Chapter~\ref{} (scrolls, if we include it). For a proof, see for example~\cite{ACGH} or~\cite{Montreal}

\begin{exercise}
Show that with $C$ and $M$ as above, the line bundle $\cO_C(M)$ is nonspecial. (We will see in Section~\ref{} that this is sharp; that is, there exist curves $C \subset \PP^r$ with $\cO_C(M-1)$ special).
\end{exercise}

\begin{exercise}\label{extremal m-ics}
\fix{move to uniform}
Establish the analog of Proposition~\ref{rnc on most quadrics} for hypersurfaces of any degree $m$, that is to say no irreducible, nondegenerate curve in $\PP^r$ lies on more hypersurfaces of degree $m$ than the rational normal curve.
To do this, let $C\subset \PP^d$ be any irreducible nondegenerate curve. Let $\Gamma$ be a general hyperplane section
of $C$, and use the exact sequences
$$
0 \to \cI_{C/\PP^d}(l-1) \to \cI_{C/\PP^d}(l) \to \cI_{\Gamma/\PP^{d-1}}(l) \to 0.
$$ 
with $2 \leq l \leq m$ to show that
$$
h^0(\cI_{C/\PP^d}(m)) \leq  \binom{d+m}{m} - (md+1)
$$
with equality only if $C$ is a rational normal curve.
\end{exercise}


\input footer.tex