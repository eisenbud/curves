\input{header}

\def\adj{{\rm adj}}
\chapter{Plane Curves}
\label{PlaneCurvesChapter}


For a long time, plane curves were the only algebraic curves that were studied. Originally these were curves in the affine plane over the real numbers, but by the second half of the 19th century the complex projective plane was well understood, and curves in $\PP^2 = \PP^2_\CC$, corresponding to irreducible forms in 3 variables, were recognized as the natural objects of study---see the historical appendix to this book for more details.

The work of Bernhard Riemann dramatically changed the focus of the theory to branched coverings of   the ``Riemann Sphere'' ($\PP^1_\CC$). The Riemann-Roch theorem, in particular, gave information about the existence of meromorphic functions on such coverings, well beyond what could be done in the earlier theory. However, Riemann's work, depending as it did on the then-obscure ``Dirichlet principle'', was not universally accepted. In the 1860s Alfred Clebsch and, after the death of Clebsch  in 1872, Alexander Brill and Max Noether (Emmy Noether's father), undertook the ambitious program of redoing the Riemann-Roch theorem entirely in terms of plane curves. They went beyond Riemann in certain directions, too: the Brill-Noether Theorem treated in our Chapter~\ref{Brill-Noether} was formulated by Brill and Noether, and ``proved'' by them through an unsupported general position assumption. 


A central difficulty in the Brill-Noether attempt on the Riemann-Roch theorem was that,
although any smooth curve can be embedded in $\PP^r$ for any $r \geq 3$, most curves cannot be embedded in the plane. 
However, as is shown in Section~\ref{good projections}, we can embed $C$ as a curve $ C \subset \PP^r$ in a higher-dimensional projective space and find a projection $\PP^r \to \PP^2$ that carries $C$ birationally onto its image $C_0$, called a plane model of $C$. The curve $C_0$ typically has singularities, and $C$ is the normalization of $C_0$. Brill and Noether wanted to prove the Riemann-Roch theorem for $C$ by formulating and proving a related theorem for $C_0$. In particular, they tried to characterize linear equivalence of divisors on $C$ in terms of certain ``clusters'' of points---we would say 0-dimensional subschemes---of $C_0$. 

To carry out this program, a key step was to show that if $D\subset C_0$ is contained in the intersection
$D'$ of $C_0$ and some other plane curve $C_0'$, then the difference 
$E := D'-D$ can be defined with properties such as that $D'-E = D$; Brill and Noether seem simply to have assumed that this is so. A bit later Frances Sowerby Macaulay proved that this is in fact possible  and also understood that it would not generally be possible if $D'$ were the intersection of three or more curves.\footnote{In modern terms, the intersection of two curves is Gorenstein; the intersection of 3 is generally not}

Macaulay exploited this theory of residuation  to prove what he called the ``Generalized Riemann-Roch Theorem'' (now widely known as the ``Cayley Bacharach Theorem'', after some precursors). This early work of Macaulay led directly to his definitions of  ``perfection'' (a homogeneous ideal
$I  \subset S:= k[x_0, \dots, x_n]$ is perfect if $S/I$ is Cohen-Macaulay) and ``super-perfection'' (the case when $S/I$ is
Gorenstein). For all this, see~\cite{Eisenbud-Gray}.

In this chapter we will take the point of view of Clebsch, Brill and Noether, and explain how to understand 
the differential forms and, given a (possibly ineffective) divisor $D$ on $C$, how to find all the 
effective divisors on $C$ that are linearly equivalent to $D$, in terms of a plane model---that is, 
in terms of a possibly singular plane curve $C_{0}$ and the normalization map $\nu: C\to C_{0}$.
More precisely, we will give algorithms for the following tasks:
 
\begin{enumerate}
\item Given the equation $F(X,Y,Z)$ of a degree $d$ plane curve $C_0$, with normalization $C$,
and a certain subscheme $C_{0}\subset C$ supported on the singular locus of $C_{0}$,
construct a basis for $H^0(K_C)$ from curves of degree $d-3$ with base locus in $\adj(C_{0}$; and

\item  Given effective Cartier divisors $D_{0}$ and $D_{\infty}$, we will  find all effective divisors $E$ on $C$ with $E \sim D$, or, equivalently, a basis for $H^0(\cO_C(D))$, expressed in terms of curves of high degree with  base locus $D_{\infty}+\adj(C_{0})$. In particular, we will test whether a divisor $D$ linearly equivalent to any effective divisor, and we will see how to test when two given divisors $D$ and $E$ are linearly equivalent. 
\end{enumerate}

The subscheme $\adj(C_{0})$ is easy to compute in simple cases.

To motivate the constructions we will proceed in three stages: first when $C = C_0$ is a smooth plane curve (Section~ \ref{linear series on smooth plane curves}); next when $C_{0}$ is \emph{nodal}---that is, when
its singularities are only ordinary nodes (Section~~\ref{nodal curves section}); and finally for arbitrary reduced, irreducible plane curves (Section~\ref{arbitrary plane curves}). A curve $C$ may be given to us as (the normalization of) a plane curve with singularities other than nodes, and while Proposition~\ref{nodal projection} assures us in principal that we can also realize $C$ as the normalization of a nodal plane curve, it is often easier to work with the given plane model. 

\section{Smooth plane curves}

\subsection{Differentials on a smooth plane curve}\label{canonical series on smooth plane curves}

Let $C \subset \PP^2$  be a smooth plane curve, given as the zero locus of a homogeneous polynomial $F(X,Y,Z)$ of degree $d$. By the adjunction formula (Proposition~\ref{adjunction}) the canonical  divisors on $C$
are the intersections of $C$ with curves of degree $d-3$. In the spirit of Brill and Noether we
will make this explicit by constructing all
 the regular differential forms on $C$ in terms of forms of degree $d-3$:


For this purpose we introduce coordinates $x = X/Z$ and $y = Y/Z$ on the affine open subset $U \cong \AA^2$ given by $Z \neq 0$, and let $f(x,y) = F(x, y,1)$ be the inhomogeneous form of $F$, so that $C^\circ = C \cap U$ is given as the zero locus $V(f) \subset  \AA^2$. 

Since an automorphism of $\PP^2$ can carry any  any poin in $\PP^{2}$ to any other point, we may assume
that 
 The point $[0,1,0]$ (that is, the point at infinity in the vertical direction) does not lie on $C$ so that the
 projection  $\pi: C \to \PP^1$ from $(0,1,0)$, which is given by $[X,Y,Z] \mapsto [X,Z]$ (or, in affine coordinates, $(x,y) \mapsto x$)  has degree $d$. Let $D$ be the intersection of $C$ with the line $Z=0$ at infinity.

Consider the
regular 1-form $dx$ on $\AA^2$, which we may regard as the pull-back of the form $dx$ on
 $\AA^{1}$.
Since the form $dx$ on $\PP^{1}$ has a double pole at infinity the form $dx|_{C}$ has polar
locus $2D$.
 
How do we get rid of the poles of $dx$? The extension to $\PP^2$ of a polynomial $h(x,y)$ of degree $d$ on
$\AA^2$ has a pole of order $d$ along the line $L$ at infinity. Thus if $h$ has degree at least 2 then $dx/h$ will have no poles at infinity. However, $h(x,y)$ will vanish at points of $C \cap U$, and this may create new poles of $dx/h$. Of course if $h$ vanishes only at  points of $C \cap U$ where $dx$ has a zero, the zeroes of $h$ may cancel the zeroes of $dx$ rather than creating new poles.
 
 To avoid producing new poles in this way we may take
 $$
 h(x,y) = f_{y} := \frac{\partial f}{\partial y}(x,y).
 $$
Note that $df$ vanishes identically when restricted to $C^\circ$, so
 $$
 0 \equiv df|_{C} = f_{x}dx|_{C} + f_{y}dy|_{C} .
 $$
 We claim that 
 $$
\varphi_0 = \frac{dx}{f_{y}}
$$
is everywhere regular and nowhere 0 in $C^\circ$. 

Clearly $\varphi_0$ is regular at points $p$ where
where $f_{y}(p) \neq 0$. At such a point, if $dx|C$ were 0, then since $C$ is smooth we would have $dy|_{C} \neq 0$, contradicting the equation above. Thus $\varphi_{0}$ is both regular and nonzero at such points. On the other hand, if $f_{y}(p) = 0$, then since $C$ is smooth $f_{x}(p) \neq 0$, so $dx|_{C}$ and $f_{y}$ vanish to the same
order, whence, again, $\varphi_0 = dx|_{C}/f_{y}$ is regular and nonzero, proving the claim.

Put differently, if $L$ is the line at infinity, so that $U = \PP^{2}\setminus L \cong \AA^{2}$,
then the cotangent bundle on $U$ is 
$\Omega_{U}=\sO_{U}dx \oplus \sO_{U}dy,$
so 
the cotangent bundle on $C^{\circ}$
 is the cokernel of the map from the normal sheaf $\sO_{C}(-d)|_{U}$ to the restriction of 
$\Omega_{U}$ to $C^{\circ}$. This map sends the local generator $f$ of the normal sheaf to
$f_{x}dx+f_{y}dy \in \Omega_{U}$, and because $f_{x}$ and $f_{y}$ have no common zeros, the generator $d_{y} \in \Omega_{C^{\circ}}$ is a multiple of $dx/f_{y}$.
Thus the free $\sO_{C^{\circ}}$-module $\omega_{C}|_{C^{0}}$ is generated by $dx/f_{y}$.

Since $f_{y}$ has degree $d-1$, the rational function $1/f_{y}$ vanishes to order $d-1$ on the line
at infinity, and thus in particular on the divisor $D$. Thus $\varphi_0$ vanishes to order $d-3$ on $D$; in other words, as divisors,
$$
(\varphi_0) = (d-3)D.
$$
In particular, if $d \geq 3$ then $\varphi_0$ is a globally regular differential on $C$. The divisor of
zeros of this differential has degree $d(d-3)$. If $g$ is the genus of $C$, then we must
have $2g-2 = d(d-3)$, whence 
$$
g = \frac{d(d-3)}{2} + 1 = \binom{d-1}{2}.
$$
We can produce a vector space of $\binom{d-1}{2}$ regular differentials by multiplying $\varphi_0$ by 
polynomials $e(x,y)$ 
  of degree $d-3$, since this will not introduce any poles. This proves:

\begin{theorem}
The space of regular differentials on a smooth plane curve $C$
with affine equation $f=0$ is 
$$
\{ \frac{e(x,y)}{f_{y}} \mid \hbox{ e(x,y) is a polynomial degree $\leq d-3$}\}.\qed
 $$
\end{theorem}
%We have thus found a vector space of regular differentials, of dimension $\binom{d-1}{2}$. But at the same time, the degree of a differential like $\varphi_0$ is
%$$
%\deg((\varphi_0)) = (d-3)\deg(D) = d(d-3),
%$$
%so that the genus of $g(C)$ satisfies
%$2g(C)-2 = d(d-3)$, whence
%$$
%\frac{d(d-3)}{2} + 1 = \binom{d-1}{2}.
%$$
%In other words, we have found all the global regular differentials on $C$! We have
%$$
%H^0(K_C) = \left\{ \frac{e(x,y)dx}{f_y} \mid \deg e \leq d-3\right\};
%$$
%or, equivalently, the space of regular differentials on $C$ has basis $\{\varphi_{i,j} \}_{i+j \leq d-3}$, where
%$$
%\varphi_{i,j} =  \frac{x^iy^jdx}{f_y}
%$$
%
%We could have achieved the same result by using the adjunction formula (see Section~\ref{Adjunction Formula}: we have
%$$
%K_C = (K_{\PP^2} \otimes \cO_{\PP^2}(d))|_C = \cO_C(d-3),
%$$
%and from the exact sequence
%$$
%0 \to \cO_{\PP^2}((d-3)-d) \rTo^f \cO_{\PP^2}(d-3) \to \cO_C(d-3)=K_C \to 0
%$$
%and the vanishing of $H^1(\cO_{\PP^2}(-3))$, we see that the map on global sections
%$$
%H^0(\cO_{\PP^2}(d-3)) \to H^0(K_C)
%$$
%is surjective. 
%

\subsection{Linear series on a smooth plane curves}\label{linear series on smooth plane curves}

Any divisor on a smooth plane curve $C$ may be expressed as the difference of
two effective divisors, $D= D_0-D_\infty$. We would like to find all the \emph{effective} divisors linearly equivalent to $D$, that is, of the form
$D + (H/G)$, where $G, H$ are forms of the same degree $m$. We begin by choosing
an integer $m$, large enough so there is a form $G$ of degree $m$ that vanishes on $D_0$ plus some divisor $A$ (but not on all of $C$). 

\begin{theorem}\label{equiv on smooth plane curve}
The effective divisors equivalent to $D$, if any, are precisely those of the form $(C'\cap C) -(D_\infty+A)$ where $C'$
is a curve of degree $m$ containing $D_\infty+A$, but not containing $C$.
\end{theorem}

In particular, if homogeneous polynomial $H$ of degree $m$ vanishes on  $A + D_\infty$ but not on $C$, then $D$ is not linearly equivalent to any effective divisor. The existence of such an $H$ is thus independent of the choices of $m$ and $G$, as we shall see in the proof.

\begin{example}
Suppose that $C$ has degree 3 and thus genus 1. If we choose as origin on the curve $C$ a point $o$, then to add two points $p$ and $q \in C$ means to find the (unique) effective divisor of degree 1 linearly equivalent to $p + q - o$. In this situation, Theorem~\ref{equiv on smooth plane curve} applies with $m=1$: there is a line $L$ 
containing $p+q$ defined by a linear form $G$. If $r \in C$ be the remaining point of intersection of $L$ with $C$ we can choose a linear form $H$ vanishing on $o+r$, and the line it defines meets $C$
in one additional point $s$. This is the classical construction of the group law.
\pict{illustrate this}
\end{example}

\begin{proof}[Proof of Theorem~\ref{equiv on smooth plane curve}]
First, suppose that we can find a curve $C'$ of degree $m$ as in the Theorem. If the equation of $C'$ is $H=0$,
then  setting $D' = (C'\cap C) -(D_\infty+A)$ we have
$$
D' = D + (H/G) = D_0- D_\infty - (D_0+A)+(D_\infty+A+D')
$$
so $D'$ is linearly equivalent to $D$. 
\pict {illustrate the configuration of all the divisors}

We claim that we find in this way all effective divisors $D' \sim D$. 
To see this, suppose $D'$ is any effective divisor with $D' \sim D$, so that
$$
\cO_C(A+D_\infty+D') = \cO_C(A+D_\infty+D)  = \cO_C(m),
$$
that is, $A+D_\infty+D$ is linearly equivalent on $C$ to the divisor (H) defined by the vanishing of some form $H$ of degree $m$. 
This means that
$A+D_\infty+D  = (H') +(P/Q)$ for some forms $P,Q$ of equal degree, with $Q$ not vanishing identically on $C$. 
Since $A+D_\infty+D$ is effective,
the zeros of $Q$ on $C$ must be contained in the zeros of $H'P$ on $C$; in other words,
the restriction to $C$ of $H'P/Q$ is a section of $\sO_C(m)$.
Since $C\subset \PP^2$ is arithmetically Cohen-Macaulay (see Proposition~\ref{ACM basics}), this implies that
$H'P/Q$ is the restriction of a form $H$ of degree $m$ on $\PP^2$.
\end{proof}

We have made important use of the completeness of the linear series cut out on $C$ by curves of each degree $m$---the arithmetically
Cohen-Macaulay property. 

In the work of Brill and Noether the existence of the form $H$ in the proof above came about
in a different, though closely related way: Since the form  $F$ defining $C$ is irreducible, 
$Q,F$ is a regular sequence, and thus the ideal $(Q,F)$ is \emph{unmixed}; that is, it has no embedded primary component.
Since $H'P$ vanishes on the common zeros of $Q$ and $F$, it follows from
primary decomposition that $H'P$ is in the ideal generated by$Q$ and $F$; that is,
$H'P = HQ +LF$ for some
forms $L,H$, where $\deg H = \deg HP - \deg Q$. Thus $H = (H'P- LG)/Q$ is a form
of degree $m$ defining $A+D_\infty+D$.

The argument given in the last paragraph can be stated more generally thus:  if curves $F(X,Y,Z)=0$ and $Q(X,Y,Z)=0$ 
meet only in a finite set of points $\Gamma$ in $\PP^{2}$, and $E(X,Y,Z) = 0$ is a curve containing the intersection in an appropriate sense,
then $E = QH +LF$ for some forms $H$ and $L$, and this statement applies to arbitrarily singular curves. Recognizing its importance for the argument above and the generalizations to come, Max Noether in~\cite{} dubbed it the \emph{Fundamental Theorem}, 
noting that it had often been used by geometers but not proven. After successive attempts and 
criticisms involving many mathematicians, he and Brill gave a complete proof, essentially using
regular sequences as above, in~\cite{****}. For more of this story see the account in~\cite{Eisenbud-Gray}.



\section{Nodal plane curves}\label{nodal curves section}

Smooth curves that can be embedded in $\PP^{2}$ are very special, but every smooth curve 
is the normalization of a plane curve with only ordinary nodes as singularities---see Section~\ref{nodal curves}.  The methods above can also be applied, with one change, to such \emph{nodal curves}.

Let $\nu: C\to C_{0}\subset \PP^{2}$ be the normalization morphism from a smooth curve,
and let $B\subset C_{0}$ be a subscheme.
It will be convenient to speak of \emph{the linear series cut out on $C$} by curves of degree $m$
containing $B$: this is
the linear series  $\sV$ of divisors in $C$ that are residual to $\nu^{-1}(B)$ in the pullbacks 
of the intersections of $C_{0}$ with curves of degree $m$.


\subsection{Differentials on a nodal plane curve}\label{canonical series on nodal plane curves}

Let $C_{0} \subset \PP^2$  be a nodal curve of degree $d$ with $\delta$ nodes. By the adjunction
formula (Proposition~\ref{adjunction}) and Proposition~\ref{pa and delta}, and the first example that follows it, 
the genus $g$ of the normalization $C$ of $C_{0}$ is
the arithmetic genus $p_{a}(C_{0}) = \binom{d-1}{2}$ of $C_{0}$ minus $\delta$, that is,
$$
g = \binom{d-1}{2} -\delta.
$$
We will make this explicit by exhibiting a vector space of $g$ regular differential forms on $C$.

We may choose homogeneous coordinates  $[X,Y,Z]$ on $\PP^2$ so that the curve $C_0$ intersects the line $L = V(Z)$ in a divisor $D$ consisting only of smooth points of $C_{0}$  other than $[0,1,0]$. In particular,  all the nodes of $C_0$ will lie in the affine plane $U = \PP^2 \setminus L$.
In addition, we can assume for simplicity that  neither branch of $C_0$ at a node has vertical tangent. (These conditions are satisfied by a general choice of coordinates.) Let the nodes of $C_0$ be $q_1,\dots,q_\delta$, with $r_i, s_i \in C$ lying over $q_i$; we'll denote by $\Delta$ the divisor $\sum r_i + \sum s_i$ on $C$.

Let $F(X,Y,Z)$ be the homogeneous polynomial of degree $d$ defining the curve $C_0$, and let $f(x,y) = F(x,y,1)$ be the defining equation of the affine part $C_{0}^{\circ}:= C_0 \cap U$ of $C_0$. Let $\nu: C\to C_0$ be the normalization map. We start by considering the rational differential 
$\nu^*(dx)$ on 
$C^{\circ}:= \nu^{-1}(C_{0}^{\circ})$. 

In the smooth case, $C_{0}=C$, we saw that this differential was regular and nonzero on $C^{\circ}$; this followed from the fact that 
that $f_{x}$ and $f_{y}$ had no common zeroes on $C_0$. But now $f_{x}$ and $f_{y}$ have common zeroes: they both vanish to order 1 at the points $q_{i}$ and thus $\nu^*(f_{x})$ and $\nu^*(f_{y})$ have simple zeroes at the points $r_i$ and $s_i$. 

As before, the differential $\nu^*dx$ has a double poles at the divisor $D$ on $C_{0}$ lying over the point at infinity in $\PP^{1}$
and we see that for a polynomial $e(x,y)$ of degree $\leq d-3$, the differential
$$
\nu^*( \frac{e(x,y)dx}{f_{y}})
$$
is regular except for simple poles at the points $r_i$ and $s_i$.

We can get rid of these poles by requiring that $e$ vanishes at the points $q_i$. We say in this case that $e$ (and the curve defined by $e$) \emph{satisfies the conditions of adjunction}. 

\begin{theorem}\label{canonical from adjoint 1}
If $C_{0}$ is a nodal plane curve of degree $d$ with normalization $\nu: C\to C_{0}$
then the  regular differentials on  $C$, in suitable affine coordinates as $f(x,y) = 0$ 
 are precisely those of the form
 $$
\nu^{*}\biggl( \frac{e(x,y)}dx{f_{y}}\biggr)
$$
where 
$e(x,y)$ ranges over the polynomials of degree $\leq d-3$
vanishing at the nodes of $C_{0}.$

Thus if $\adj(C_{0})\subset C_{0}$ denotes the union
of the reduced points at the nodes of $C$, then  the linear series cut out on $C$ by 
forms of degree $d-3$ containing $\adj(C_{0})$ is $|\omega_{C}|$.
\end{theorem}

\begin{proof}
The dimension of the space of polynomials $e(x,y)$ of degree at most $d-3$ is $\binom{d-1}{2}$,
and vanishing at $\delta$ nodes imposses at most $\delta$ linear conditions on $e$. The linear map sending
$e\mapsto \nu^{*}(edx/f_{y})$ is injective, and the target has dimension 
$\binom{d-1}{2}-\delta$, so this must be an isomorphism.
\end{proof}
We ill sketch a more conceptual proof of this theorem in Section~\ref{arbitrary plane curves}.

In particular, Theorem~\ref{canonical from adjoint 1}
shows that the linear series cut out on $C$ by 
forms of degree $d-3$ containing $\adj(C_{0})$ is complete. We will soon see that
 the linear series cut out on $C$ by 
forms of degree $m$ containing $\adj(C_{0})$ is complete for every $m$.


This gives another proof of Lemma~\ref{adjoint independent}.

\begin{corollary}
If $C$ is a nodal plane curve of degree $d$, then the nodes of $C_{0}$ impose independent
conditions on forms of degree $d-3$.
\end{corollary}
\begin{proof}
 Otherwise the space of differential forms on the normalization of $C_{0}$ would be too large.
\end{proof}

%
%In any event, we see that
%$$
% \left\{ \nu^* \frac{e(x,y)dx}{f_y} \mid \deg e \leq d-3 \text{ and } e(q_i) = 0 \; \forall i \right\} \subset H^0(K_C).
%$$
%In the smooth case we were able to compare dimensions to conclude that this inclusion was an equality. We can do the same thing here. We have seen that the  rational 1-form $\varphi = \nu^*(\frac{dx}{f_y})$ has zeroes of order $d-3$ at the points $p_1,\dots,p_d$ and simple poles at the points $r_i$ and $s_i$ and is otherwise regular and nonzero. In other words, if we set $H = p_1+\dots + p_d$, the divisor
%$$
%(\varphi) = (d-3)H - \Delta.
%$$
%In particular, we see that
%$$
%\deg((\varphi)) = d(d-3) - 2\delta
%$$
%and correspondingly
%$$
%g(C) = \binom{d-1}{2} - \delta.
%$$
%
%
%On the other hand, the space of polynomials $e$ of degree $\leq d-3$ vanishing at the points $q_i$ has dimension at least $ \binom{d-1}{2} - \delta$; we conclude that
%$$
%H^0(K_C) =  \left\{ \nu^* \frac{e(x,y)dx}{f_y} \mid \deg e \leq d-3 \text{ and } e(q_i) = 0 \; \forall i \right\}.
%$$

\pict{Curve $C_{0}$ of genus 4 represented as a quintic with 2 nodes, showing a canonical divisor
representeed as the intersection of $C_{0}$
with a conic through 2 nodes}

\subsection{Linear series on a nodal plane curve}\label{linear series on nodal plane curves}

Given a divisor $D = D_{0}-D_{\infty}$ on $C$, we will compute the complete linear series $|D|$, using a birational map $\nu$ from 
$C$ to the nodal curve $C_0$. Let $\Delta$ be the preimage in $C$ of the set of nodes of $C_{0}$.

Choose an integer $m$ and a polynomial $G$ whose pullback to $C$
  vanishes on the divisor $D_0+\Delta$ 
 but not identically on $C$. (If $D_0$ contains some positive multiple of a point $p$ of $\Delta$ this means that $G$ defines
 a curve sufficiently tangent to the corresponding branch of $C_0$.) This can always be achieved for
 sufficiently large $m$. We can then write the zero locus of $G$ pulled back to $C$ as
$$
(\nu^*G) = D_0 + \Delta + A,
$$
as before. 

\pict{illustration of a case where $D_0$ contains one point of $\Delta$.}

Next, we look for forms $H$ of the same degree $m$, vanishing at $A+D_\infty$ and at all the nodes $q_i$,  but not on all of $C_0$. If there are no such polynomials $H$ then, as we shall show,
there are no effective divisors equivalent to $D$. Supposing that $H$ is such a form, let $D'$ be the divisor 
$$
D' = (\nu^*H) -( D_0 + \Delta),
$$
that is, $D'$ is residual to $( D_0 + \Delta)$ in $(\nu^*H)$. 

Since $\nu^*(G/H)$ is a rational function on $C$ we have
$$
D_\infty +\Delta + A+ D' = (\nu^*H) \sim (\nu^*G) = D_0 + \Delta + A,
$$
and thus $D'$ is an effective divisor linearly equivalent to $D = D_{0}-D_{\infty}$ on $C$.

To complete the argument we must show that we get \emph{all} divisors $D'$ in this way.
In this case the curve $C$ can be desingularized by blowing up the plane once at each node,
and we can give a proof based on the resulting surface $S$. The same technique would work for any curve with only
ordinary multiple points, in which case the total transform of $C_{0}$ on $S$ has normal crossings. For plane curves with arbitrary singularities we will give a different sort of proof in Section~\ref{arbitrary plane curves}.

\begin{proposition}\label{adjoint completeness1}
If $C_{0}$ is a reduced irreducible plane curve all of whose singularities are ordinary nodes, then for each
integer $m$,
the linear series cut out on the normalization $C$ of $C_{0}$ by forms of degree $m$ containing the nodes
is complete.
\end{proposition}

\begin{proof}
To prove Proposition~\ref{adjoint completeness1}, we work on the blow-up $\pi : S \to \PP^2$ of $\PP^2$ at the points $q_i$. The proper transform of $C_0 \subset \PP^2$ in $S$ is the normalization of $C_0$, which we will again call $C$.

Let $H$ be the class on $S$ of the pullback of a line in $\PP^2$  and let $E$ be the sum of the exceptional divisors. We write $h= H\cap C$ and $e = E\cap C= \sum (p_i+q_i)$ for the corresponding divisors on $C$. 
Because $C$ has double points at each $q_{i}$ we have
$
C \sim dH - 2E 
$
and   by
Theorem~\ref{divisor classes on blowup} we have $K_S \sim -3H + E$.

The proper transform of a degree $m$ curve $A\subset \PP^2$  passing through the points $q_i$
is $\pi^*A - E$; this gives an isomorphism
$$
H^0(\cI_{\{q_1,\dots,q_\delta\}/\PP^2}(m)) \cong H^0(\cO_S(mH-E)).
$$
In these terms we can describe the linear series cut on $C$ by plane curves of degree $m$ passing through the nodes of $C_0$ as the image of the map
$$
H^0(\cO_S(mH-E)) \to H^0(\cO_C(mH-E)),
$$
and we must show that this map is surjective.

From the long exact cohomology sequence associated to the exact sequence of sheaves
$$
0 \to \cO_S((m-d)H + E)  \to \cO_S(mH-E) \to \cO_C(mH-E) \to 0,
$$
 we see that it will suffice to prove that $H^1(\cO_S(mH - C + E)) = H^1(\cO_S((m-d)H + E)) = 0$. 
 
By Serre duality on $S$ gives
%we have  $H^1(\cL) \cong H^1(K_S\otimes \cL^{-1})^*$. In this instance it 
%tells us that
$$
H^1(\cO_S((m-d)H + E)) \cong H^1(\cO_S((d-m-3)H))^*.
$$
The line bundle $\cO_S((d-m-3)H)$ is 
 the pullback to $S$ of the bundle $\cO_{\PP^2}(d-m-3)$, which has vanishing $H^1$. Lemma~\ref{H1 on pullback} completes the proof.
\end{proof}

\begin{lemma}\label{H1 on pullback}
Let $X$ be a smooth projective surface, and $\pi : Y \to X$ a blow-up. If $\cL$ is any line bundle on $X$, then
$$
H^1(Y, \pi^*\cL) = H^1(X, \cL).
$$
\end{lemma}
\begin{proof}
For any invertible sheaf $\sL$ on $\PP^{2}$ the natural map $\pi_{*}\pi^{*}(\sL) \to \sL$ is an isomorphism
away from the codimension 2 set of nodes, and is thus an isomorphism. The Leray spectral sequence (Theorem~\ref{Leray}) gives an exact sequence
$$
0\to H^{1}(\pi_{*}(\sL)) \to H^{1}(\sL) \to  H^{0}(R^{1}(\pi_{*}(\sL))\to 0
$$

Take $\sL = \pi^{*}(\sO_{\PP^{2}}(1))$. The restrictions of $\sL$ to the fibers of $\pi$ have vanishing $H^{1}$,
so
$H^{0}(R^{1}(\pi_{*}(\sL)) = 0$.
Also, the restriction of $\pi^{*}\sO_{\PP^{2}}(1)$ to any fiber of $\pi$ is trivial,
so $\pi_{*}\pi^{*}\sO_{\PP^{2}}(1)$ is an invertible sheaf, and the natural map
$\pi_{*}\pi^{*}\sO_{\PP^{2}}(1) \to \sO_{\PP^{2}}(1)$ is an isomorphism away from the codimension
2 set of nodes of $C_{0}$. Thus these two sheaves are isomorphic, and
$$
H^{1}(\pi_{*}\pi^{*}\sO_{\PP^{2}}(1) ) = H^{1}(\sO_{\PP^{2}}(1)) = 0,
$$
completing the proof.
\end{proof}



\begin{proposition}\label{effect of blowup on genus}
 Let $C$ be a curve on a smooth surface $S$, let $\nu : S' \to S$ be the blowup of $S$ at $p$. If $C'$ is the strict transform of $C$, then
 $$
 p_a(C') = p_a(C) -{m\choose 2},
 $$
 where $m$ is the multiplicity of $p\in C$.
\end{proposition}
\begin{proof}
This follows from comparing the adjunction formulas on $S$ and $S'$. To start, we have
$$
p_a(C) = \frac{C^2 + K_S\cdot C}{2} + 1.
$$
On $S'$ let $E$ be the divisor class of the exceptional divisor. As we've seen,
$$
K_{S'} = \nu^*K_S + E,
$$
while the class of $C'$ is given by
$$
C' \sim \nu^*C - mE.
$$
It follows that
$$
(C')^2 = C^2 + m^2E^2 = C^2 - m^2 \quad \text{and} \quad K_{S'}\cdot C' = K_S\cdot C + m.
$$
Thus, applying adjunction on $S'$, we find
$$
p_a(C') = \frac{{C'}^2 + K_{S'}\cdot C'}{2} + 1 = \frac{C^2 + K_S\cdot C - m(m-1)}{2} + 1 = p_a(C) -{m\choose 2}
$$
as stated.
\end{proof}

\section{Arbitrary plane curves} \label{arbitrary plane curves}

Suppose again that $C_0 \subset \PP^2$ is reduced and irreducible, but with arbitrary singularities, and again let $\nu : C \to C_0$ be its normalization. 
It is possible to carry out an analysis of linear series on the normalization of an arbitrary plane curve in a manner  analogous to what we did in the preceding section for nodal curves, replacing the the set of nodes by the scheme $\adj(C_{0})\subset C_{0}$ called the \emph{adjoint scheme}, which is defined in this case by conductor ideal $\ff_{C/C_0}$, defined in Section~\ref{pa and pg} 
as the annihilator in $\sO_{C}$ of $\nu_{*}(\sO_{C})/\sO_{C_{0}})$.

%\begin{theorem}
%If $C_{0}$ is a reduced, irreducible curve in $\PP^{2}$ and $\sV$ is a complete linear series
%on the normalization $\nu: C\to C_{0}$ then for all sufficiently large integers $m$ there is an effective Cartier divisor $D_{m}$  of $C_{0}$ 
%such that $\sV$ is the linear series cut out on $C$ by curves of degree $m$ containing $D_{m}+\adj(C)$.
%\end{theorem}

\subsection{The conductor ideal and linear series on the normalization}

The following result, known classically as \emph{completeness of the adjoint series}, is the general
statement about plane curves that we need:

\begin{theorem}\label{conductor completeness}
Suppose that $C_0 \subset \PP^2$ is a reduced irreducible plane curve and that $\nu : C \to C_0$ is its normalization $C$. Let 
$
\ff_{C/C_{0}}
$
be the conductor ideal on $C_{0}$ and let $\Delta\subset C$ be the Cartier divisor
defined by $\nu^{-1}(\ff_{C/C_{0}})$. Denote the pullback to $C$ of the divisor of a line
in $\PP^{2}$ by $H$.

For every integer $m\geq 0$ the series cut out on $C$ by forms of degree $m$
on $\PP^{2}$ that are contained in $\ff_{C/C_{0}}$ is the complete series
$|mH-\Delta|.$
\end{theorem}

\begin{proof}
If $R\subset R'$ is an inclusion of commutative rings, then the set
$\ff_{R'/R} := \ann_{R}(R'/R)\subset R$, which is defined as an ideal of $R$, is also an ideal of $R'$; this follows
because if $f\in \ff_{R'/R} $ and $r, r'\in R'$, so that $fr \in R$, then $(r'f)r = f(r'r) \in R$ as well. 

If $R_{0}$ is a domain and $R$ is a subring of the quotient field $Q(R)$ of $R$, then
 $\ff_{R/R_{0}} \cong \Hom_{R_{0}}(R, R_{0})$. To see this, note that $R_{0}$ and $R$ become
 equal after tensoring with $Q(R_{0})$ and thus 
 $Hom_{R_{0}}(R,R_{0}) \subset Hom_{Q}(Q,Q) = Q$ 
 may be identified
 with the set of elements $\{\alpha\in Q\mid \alpha R \subset R_{0}\}$. If $\alpha$ is in this set, then
  $\alpha\cdot 1 = \alpha \in R_{0}$, as required.
  
Returning to the case of the curve $C_{0}$, it follows that the global sections of $mH -\Delta$ on $C$
are, on each affine open set $U$, represented by the ring elements that  are restrictions to $U$
of forms of degree $m$ contained in 
the ideal $\ff_{C/C_{0}}$.Thus
the global sections of the sheaf $\widetilde{\ff_{C/C_{0}}(m)}$ cut out the complete linear series $|mH-\Delta|$
on $C$.

Write $S =\CC[x_{0}, x_{1}, x_{2}]$ for the homogeneous coordinate ring of $\PP^{2}$.
It remains to prove that the homogeneous ideal $\ff_{C/C_{0}}$ maps
surjectively to $H^{0}_{*}(\widetilde{\ff_{C/C_{0}}}$, and this amounts to the
statement that the depth of $\ff_{C/C_{0}}$ as an $S$-module is (at least) 2.
%There is a natural  map
%$$
%\ff_{C/C_{0}} \to \sHom_{\sO_{C_{0}}(\nu_{*}\sO_{C}, \sO_{C_{0}}},
%$$ and the argument
%above shows that this map is an isomorphism on each affine open set, proving that as sheaves
%$$
%\ff_{C/C_{0}} \cong \sHom_{\sO_{C_{0}}}(\nu_{*}\sO_{C}, \sO_{C_{0}}.
%$$
Set $R_{0} = H^{0}_{*}(\nu_{*} (\sO_{C_{0}})$ and $R = H^{0}_{*}(\nu_{*} (\sO_{C})$.
We see from the general considerations above that
$$
\ff_{C/C_{0}} = Hom_{R_{0}}(R, R_{0}).
$$ 
A nonzerodivisor on a module $M$
is automatically a nonzerodivisor on $Hom(P, M)$ for any $P$ since $(a\phi)(p) = a(phi(p))$ by definition. 
Since $R_{0} = S/(F)$, it is a module of depth 2, and we may choose a regular sequence
$a,b$ of elements in $R_{0}$. From the short exact sequence
$$
0\rTo R_{0}\rTo^{x} R_{0}\rTo R_{0}/(a) \rTo 0
$$
we get a left exact sequence
$$
0\rTo Hom_{R_{0}}(R,R_{0})\rTo^{a} Hom_{R_{0}}(R,R_{0})\rTo Hom_{R_{0}}(R,R_{0}/(a)).
$$
Thus 
$$
Hom_{R_{0}}(R,R_{0})/aHom_{R_{0}}(R,R_{0}) \subset Hom_{R_{0}}(R,R_{0}/(a))
$$
and since $b$ is a nonzerodivisor on $Hom_{R_{0}}(R,R_{0}/(a))$, it is a nonzerodivisor
on $Hom_{R_{0}}(R,R_{0})/aHom_{R_{0}}(R,R_{0})$ as well.
\end{proof}

Since we saw directly that the adjoint ideal was equal to the conductor ideal in the case of
a nodal curve, this result gives another, less ad hoc proof, that the  liinear series $mH-\Delta$
of on the normalization of a nodal curve
are exactly those constructed in Proposition~\ref{adjoint completeness1}

\subsection{Differentials}

Let $C^\circ_0$ to be the intersection of $C_0$ with the open set $z \neq 0$, that is, with $\AA^2\subset \PP^2$, and assume that
all the singular points of $C_0$ are contained in $C^\circ_0$.

The function on $C^\circ_0$ defined by $x$  
is a \emph{finite} map to $\AA^1$, and thus the field of rational functions $\kappa(C) = \kappa(C^\circ_0)$ is a finite
separable extension of $\CC(x)$. By~\cite[Section 16.5]{Eisenbud1995} that the module of differentials 
$\omega_{\kappa(C)/\CC}$ is generated over $\kappa(C^\circ_0)$ by $dx$; that is, every rational
differential form on $C$ can be expressed as a rational function
times $dx$. 
 
\begin{theorem}
The complete canonical series on $C$ is cut out by differentials of the form
$$
e(x,y) \frac{dx}{f_{y}}
$$
where $e(x,y)$ is a polynomial of degree $\leq d-3$ contained in the 
conductor ideal $\ff_{C^{\circ}/C_{0}^{\circ}}$
\end{theorem}

\begin{proof}
We focus for now on one singular point $q \in C_0$, with points $r_1,\dots,r_k \in C$ lying over $q$, and we wish to describe the conditions on a rational function $e(x,y)$ for  $e\varphi_0$ on $C$ to be regular
at the points $r_{i}$, where
$$
\varphi_0 = \nu^* \frac{dx}{f_{y}},
$$
and $f$ is the defining equation of $C_0$ in $\AA^2$. As in the case of a smooth curve $C$, the differential
form $\varphi_0$ has a zero of order $d-3$ at each of the points of $C$ lying over the intersection of $C_0$ with the line  $L = \PP^2\setminus \AA^2$
at infinity. Thus we must must choose $e$ to be a function with poles on $C_0$ of order $\leq d-3$ on $L\cap C_0$ and no poles in $C^\circ$. Any such function is represented (modulo $(f)$) by 
\fix{Joe had simply asserted that e is a polynomial. This is true but needs a proof, as below}
a rational function $e$ in $x,y$ of degree $\leq d-3$, since otherwise $edx$ would have poles at infinity. In addition, $\varphi_0$ has poles at the points $r_i$,
so $e$ must satisfy some ``conditions of adjunction'' at each singular point.


To show that the conditions of adjunction are satisfied exactly by polynomials (not rational functions)
of degree $d-3$ that are contained in the conductor ideal
$\ann_{\sO_{C_{0}^{\circ}}(\sO{C^{circ}}/\sO_{C^{circ}_{0}})}$,
we wish to write the conditions of adjunction as a similar annihilator. We have
$\omega_{C} = \sHom(\sO_{C}, \sO_{\PP^{1}}$, as explained in Chapter~\ref{LinkageChapter}.
Now consider the $\sO_{C_{0}}$-module
$$
M := \frac{ \sHom_{C_{0}^{\circ}}(\sO_{C_{0}}}{\sO_{\PP^{1}})}{\sHom(\sO_{C}, \sO_{\PP^{1}})})
$$
Since the conductor is the annihilator of the quotient 
$$
\frac{\sO_{C}}{\sO_{C_{0}}}
$$
it also annihilates $M$.  We will prove in Theorem~\ref{adjoint equals conductor} that for any singular
curve $C_{0}$ and finite map to $\PP^{1}$, with normalization $C\to C_{0}$, the annihilator of $M$
as defined above is equal the conductor.

To prove Theorem~\ref{general differentials}, it suffices to identify 
$\sHom_{C_{0}^{\circ}}(\sO_{C_{0}}, \sO_{\PP^{1}})$
with $\sO_{C_{0}}(dx/f_{y})$ in a way compatible with the computation above.
\end{proof}

%Let $m_i$ be the order of the pole of $\varphi_0$ at $r_i$. We can define the \emph{adjoint ideal} of $C_0$ at $q$ to be the fractional ideal
%$$
%\mathfrak A_{q} = \left\{ e \hbox{ a rational function on $\PP^{2}$ defined on $C_{0}$}\mid \ord_{r_i}(\nu^*e) \geq m_i \; \forall i \right\}.
%$$
%
%In other words, $\mathfrak A_q$ is the ideal of rational functions $e$ such that $\nu^* \frac{gdx}{f_y}$ is regular at all the points $r_i$. We define the \emph{adjoint ideal $\mathfrak A_{C/C_0}$ of $C_0$} to be the intersection of $A_q$ over all singular points  $q \in C_0$, 
%and the adjoint scheme $\adj(C_{0})$ is the scheme defined by $\mathfrak A_{C/C_0}$. We define
%the \emph{adjoint series of degree $m$} to be the linear series $H^0(\mathfrak A_{C/C_0}(m))$. 
%Thus the linear series of regular differential forms on  $C$ is the series cut on $C$ by the forms
%$$
%e(x,y) \varphi_0,
%$$
%with $e$ a rational function of degree $\leq d-3$ in the adjoint ideal $\fA_{C/C_0}$.
%
%We now use a result, That we will prove as Theorem~\ref{general adjoints}:
%\begin{theorem}
%If $C_0$ is a reduced irreducible plane curve, then the adjoint ideal $\fA_{C/C_0}$ is equal to the conductor ideal $\ff_{C/C_0}(m))$,
%and consequently the linear series on $C$ cut out by forms of degree $m$ vanishing on the adjoint scheme is complete for
%every $m$.
%%
%\end{theorem}
%
%The examples in Section~\ref{pa and pg} are
%really computations of the conductor in some simple cases. Here are some further computations of the conductor:


\begin{example}[nodes and cusps]
We have already seen that in case $q$ is a node of $C_0$, there are two points of $C$ lying over it, and the multiplicities of $\varphi_0$ at these two points are $m_1=m_2=1$; the adjoint ideal is thus 
 the maximal ideal $\cI_q$ at $q$. In the case of a cusp, analytically isomorphic to the zero locus of $y^2-x^3$, there is only one point $r$ of $C$ lying over the cusp point $q$. The cusp can be parameterized, locally analytically,
 by $x = t^{2}, y = t^{3})$ and it follows that the differential 
 $$
 \varphi_0 = \frac{dx}{f_{y}} =  \frac{2tdt}{2t^{3}} =  \frac{dt}{t^{2}}
 $$ 
 has a pole of of order 2. since the pullback to $C$ of any polynomial $g$ vanishing at the cusp $q$ will vanish to order at least two at $r$, the adjoint ideal is the maximal ideal at $q$. This is also obvious when
 $\fA_{C/C_{0}}$ is expressed as the
 conductor ideal, which is the annihilator of $\CC[t]/\CC[t^{2}, t^{3}]$.
\end{example}

\begin{example}[ordinary $n$-fold points]
In the case of an ordinary $n$-fold point of a plane curve---$n$ smooth branches pairwise transverse to one another---there are $n$ points
$r_i$ of $C$ lying over $q$. The polynomial $f_y$ vanishes to order $n-1$ at $q$, so $dx/f_y$ has a pole of order $n-1$ at
each $r_i$. It follows that for $e(x,y)dx/f_y$ to be regular, $e$ must vanish to order $n-1$ at each $r_i$. 

We can see that the conductor ideal is the full $(n-1)$-rst power of $(x,y)$ by computing a presentation of the nornalization. Assuming
that the singularity has the form $R:= \CC[x,y]/\prod_{i=1}^n(x-a_iy)$ for some distinct constants $a_i$, the normalization
is generated by $n$ elements $e_i$ and the normalization map, as a map of $R$-modules, is
$$
\psi := \nu^*: R \to R' := \prod_{i=1}^n\CC[x,y]/(x-a_iy)e_i.
$$

Since $\psi(1) = \sum e_i$, the module $R'/R$ is generated by $e_1,\dots, e_{n-1}$. We can write some of the relations of $R'/R$ as
in the form $(x-a_i)e_j = (x-a_j)e_i$
 \end{example}

\begin{example}[tacnodes]
Next, consider the case of a \emph{tacnode}; that is, a plane-curve singularity with two smooth branches simply tangent to one another, analytically isomorphic to the zero locus of $y^2-x^4$, parameterized locally analytically with two branches $x = t, y =  t^{2}$ and $x=t, y = -t^{2}$.
\pict{the tacnode}
At the two points of $C$ lying over $q$, we have
  $$
 \varphi_0 =  \frac{dt}{ 2t} \hbox{ and } \frac{-dt}{ 2t}
 $$ 
whch has a simple poles at each. 
The adjoint ideal is thus the ideal of functions vanishing at $q$ and having derivative 0 in the direction of the common tangent line to the branches.
\end{example}

\begin{example}[ordinary triple points]
In the case of an ordinary triple point of a plane curve---three smooth branches pairwise transverse to one another---there are three points of $C$ lying over $q$, and we have $m_1=m_2=m_3= 2$; the adjoint ideal is correspondingly 
 the square of the maximal ideal at $q$. 
 %\fix{let's add some justiification}
\end{example}

\begin{example} (spatial triple points) Spatial triple points provide a useful contrast to the last example. A spatial triple point is a singularity consisting of three smooth branches, with linearly independent tangent lines, meeting in a point $p$ so that its Zariski tangent space is 3-dimensional; the simplest example is the origin as a point on the union of the three coordinate axes in $\AA^3$.
In this case, in contrast to case of the planar triple point, the condition that $f(r)=f(s)=f(t)$ is both necessary and sufficient for $f$ to descend, and thus  $\delta_p=2$. However $\ff_{C/C_{0}} = \gm_{p}$ has colength 1; any function vanishing at the singular point is descend from a function on the spatial triple point!
\fix{need to add the computation $\ff_{C/C_{0}} = \gm_{p}$.} 

\end{example}
%In the next chapter we shall define the canonical (or dualizing) sheaf of a singular curve $C_0$ in 
%general and show in Theorem~\ref{general adjoint} that if $\nu: C\to C_0$ is the normalization of a reduced, connected
%projective curve $C$, then $\nu_*(\omega_C)$ is contained in $\omega_{C_0}$. We can
%then define the \emph{adjoint ideal} of $C_0$ to be 
%$$
%\fA_{C/C_0} :=\ann_{\sO_{C_0}}\frac{\omega_{C_0}}{\nu_* \omega_C}.
%$$
%\footnote{The notation $\mathfrak f$ for the conductor comes from the german term \emph{F\"uhrer} (leader); it is the ideal that "leads" elements of $\nu_* \sO_C$ into elements of $\sO_{C_0}$.}
%We will show that $C_0$ this is equal to the \emph{conductor ideal}
%$$
%\mathfrak f_{C/C_0}: = \ann_{\sO_{C_0}}\frac{\nu_* \sO_C}{\sO_{C_0}}	
%$$
%Furthermore, if $C_0$ is a plane curve, then 
%$$
%\delta(C_0) = \length \frac{\nu_* \sO_C}{\sO_{C_0}} = \length \frac {\sO_{C_0}}{\mathfrak f_{C/C_0}}.
%$$
%
%%For an node the value of the $\delta$-invariant is 1, and in general it may be regarded as the ``number of nodes equivalent to the singularities of $C_0$'' as
%%explained in Chapter~\ref{RiemannRochChapter}.  
%%
%%In the previous chapter we used the adjoint ideal as a condition on a polynomial
%%$e$ to multiply differential forms on $C$ for $e\phi$ to belong to $\omega_C$ is always sufficient, but may be necessary only
%%when $\omega_{C_0}$ is cyclic---which is equivalent to the statement that $C_0$ is locally
%%Gorenstein. This condition is always satisfied for singularities of curves in the plane.
%%See Example~\ref{nongorenstein} for a singularity that is not locally planar, and behaves differently.
%%
%%
%%In the Theorem~\ref{general adjoint} we shall prove that the adjoint ideal can be computed
%%as the \emph{conductor} ideal, the annihilator in $\sO_{C_0}$ of the quotient
%%$\nu_*\sO_C/\sO_{C_0}$.
%%
%%\subsection{The ``deficiency" of a curve}
%
%Arthur Cayley observed the importance for a nodal plane curve of degree $n$ of the number
%that we would now call the arithmetic genus. In \cite{Cayley2} He wrote:
%\begin{quotation}
% Before going further, it will be convenient to to introduce the term ``Deficiency," viz., a curve of the order $n$ with
% $\frac{1}{2}(n-1)(n-2)-D$ dps [double points] is said to have a deficiency $=D$: the foregoing theorem is that for curves with a deficiency $=0$, the coordinates are expressible rationally in terms of a parameter $\theta$.
%  \end{quotation}
% 
%Riemann-Roch theorem and the modern definitions of the genus of a curve, algebraic geometers had
%defined an invariant called the \emph{deficiency} that is equal to the genus When Clebsch, Brill and Noether tried to 
%compute what amounts to the geometric genus of a plane curve, this was the idea they used, and we can shed some light
%on the meaning of the adjoint ideal by examining the old definition.
%
%The starting point may have been the observation that, while any $2n$ points on a plane conic curve $C$ form the intersection of $C$ with a  curve of degree $n$, the analogous statement---that any $3n$ points on a smooth plane cubic comprise the intersection of $C$ with a plane curve of degree $n$---is not true. This is a reflection of the fact that there are fewer rational functions on the cubic than on the conic: if $D = p_1+\dots + p_d$ is a $d$-tuple of points on a conic curve $C$, we have
%$$
%h^0(\cO_C(D)) = d+1,
%$$ 
%and so there is a rational function with poles just along $D$ and vanishing at any given $d$-tuple of points; by contrast, a plane cubic $C$ has genus 1, and so by Riemann-Roch for such a divisor we have
%$$
%h^0(\cO_C(D)) = d.
%$$
%This lack of rational functions was viewed as a defect of the curve, and called its \emph{deficiency} (and typically denoted $p$, rather than $g$). .
%
%In general, suppose that $C$ is a smooth plane curve $C \subset \PP^2$ of degree $n$, and that $D = p_1+\dots + p_d$ is a divisor of degree $d$. To find the complete linear system $|D|$ by the method of Section~\ref{smooth plane curves} we start by choosing a plane curve $B$ of degree $m$ containing $D$ but not containing $C$; again for simplicity of notation we'll assume $m \geq n$. The intersection $B \cap C$ will then consist of $D$ plus another divisor $E$ on $C$, of degree $mn-d$; and what we saw is that the complete linear series $|D|$ will be cut on $C$ by plane curves of degree $m$ containing $E$, modulo those containing $C$.
%
%We can easily estimate the size of this linear series: If the $(mn-d)$ points of $E$ impose independent conditions on curves of degree $m$, which will be the case when $d$ is large compared with $n$, the space of curves of degree $m$ containing $E$ will have dimension
%$$
%h^0(\cI_{E/\PP^2}(m)) = \binom{m+2}{2} - (mn-d).
%$$ 
%On the other hand, the subspace of curves of degree $m$ containing all of $C$ has dimension
%$$
%h^0(\cO_{\PP^2}(m-n)) = \binom{m-n+2}{2}
%$$
%so the dimension of $H^0(\cO_C(D))$ is
%$$
%h^0(\cO_C(D)) \geq \binom{m+2}{2} - (mn-d) -  \binom{m-n+2}{2} = d + 1 - \binom{n-1}{2}.
%$$
%By the Riemann-Roch theorem, the inequality will be an equality if $d> 2g-2 = 2\binom{n-1}{2}-2 = n^2-3n$.  That is, a smooth plane curve of degree $n$ has deficiency $\binom{n-1}{2}$.
%
%Now suppose the curve $C$ maps birationally to a curve $C_0$ which has a node at a point $p$; let $D$ again be a divisor of degree $d$, whose support we assume does not contain $p$. If we take our curve $B$ of degree $m$ to contain $D$ and also pass through the point $p$, then the residual intersection $E$ to $D+\nu^{-1}(p)$ on $C$ will consist of $mn-d-2$ points rather than $mn-d$. To construct the complete linear system $|D|$, we take curves of degree $m$ passing through this residual divisor $E$ and passing through $p$.
%
%Here we have a sort of ``two-for-one" deal: the curves of degree $m$ that cut out the linear series $|D|$ have to satisfy the one additional condition of passing through the node $p$; but the number of points of $E$ that these curves have to contain has been reduced by 2. The expected dimension of the linear series associated to $DS$ is thus
%$$
%h^0(\cO_C(D)) = \binom{m+2}{2} - (mn-d-2) -  \binom{m-n+2}{2} = d  - \binom{n-1}{2}.
%$$
%so the deficiency of the curve is $\binom{n-1}{2}-1$, or one less. More generally, if $C$ has $\delta$ nodes, we can get this two-for-one deal $\delta$ times, resulting in a deficiency of $\binom{n-1}{2} - \delta$, giving us an early version of the formula for the  geometric genus of a plane curves with nodes.
%
%What if $C$ has an ordinary triple point $p$? In this case, we can get a ``three-for-one" deal by requiring the curve $B$ of degree $m$ to pass through $p$. In this case the residual divisor $E$ will have degree 3 less; again, the curves of degree $m$ that cut out the linear series $|D|$ only have to satisfy the one additional condition of passing through $p$, so the apparent deficiency will be 2 less than for a smooth plane curve of degree $n$.
%
%But we can do even better! If we require our initial curve of degree $m$ to be double at $p$, that reduces the degree of the residual divisor $E$  by 6. Of course, now the curves $B$ of degree $m$ containing $E$ that cut our the linear system $|D|$  will have to be double at $p$ as well, but this is only 3 linear conditions, the vanishing at $p$ along with the vanishing of the first derivatives. In effect, we have gotten a ``six-for-three" deal, suggesting (correctly, as we know) that the presence of a triple point should reduce the deficiency by 3. 
%
%In general---for singularities beyond nodes or triple points---the adjoint ideal can be characterized as the largest ideal that gives the best ``deal" in this sense. 
%

\section{Exercises}


In Exercise~\ref{gonality of smooth plane curve}, we saw how to use the description of the canonical series on a smooth plane curve to determine its gonality. Now that we have an analogous description of the canonical series on (the normalization of) a nodal plane curve, we can deduce a similar statement about the gonality of such a curve. Here are the first two cases: 

\begin{exercise}
Let $C_0$ be a plane curve of degree $d\geq 4$ with one node and no other singularities, and let $C$ be its normalization. Show that $C$ admits a unique map $C \to \PP^1$ of degree $d-2$, but does not admit a map $C \to \PP^1$ of degree $d-3$ or less.
\end{exercise}

\begin{exercise}\label{general case of divisors on nodal curves}
Suppose that $C$ is a smooth curve and $\nu: C \to C_0$ is a map to a plane curve with
only nodes as singularities and let $D = D_0-D_\infty$ be a divisor on $C$. Modify the 
technique of Section~ref{linear series on nodal plane curves} to compute the complete
linear series $|D|$ without assuming that $D$ is disjoint from the preimages of the singular
points. 
Hint: Be careful to subtract the right multiples of the points that are preimages of the singular
points.
\end{exercise}

\begin{exercise}
Let $C_0$ be a plane curve of degree $d\geq 5$ with two nodes and no other singularities, and let $C$ be its normalization. Show that $C$ admits two maps $C \to \PP^1$ of degree $d-2$, but does not admit a map $C \to \PP^1$ of degree $d-3$ or less.
\end{exercise}

\begin{exercise}
Generalizing some of the examples above, show that if a nodal plane curve of degree $d$ has $\delta\leq d+3$ nodes,
then its gonality is $d-2$, and moreover every $g^1_d$ on the curve is given by projection from one of the nodes.
You should make use of the following result from~\cite[p. 302]{MR1376653}:
\begin{proposition}
 A set of $n \leq 2d+ 2$ distinct
points fails to impose independent conditions on curves of degree
$d$ if and only if either $d + 2$ of the points  are collinear or $n = 2d + 2$ and all the points lie
on a conic.
\end{proposition} 
Hint: a $g^1_{d-2}$ is a set of points that, together with the nodes, impose dependent conditions on forms of degree $d-3$.
\end{exercise}

\begin{exercise}
Find the adjoint ideals of the following plane curve singularities:
\begin{enumerate}
\item a \emph{triple tacnode}: three smooth branches, pairwise simply tangent
\item a triple point with an infinitely near double point: three smooth branches, two of which are simply tangent, with the third transverse to both
\item a unibranch triple point, such as the zero locus of $y^3-x^4$
\end{enumerate}
\end{exercise}

Here is a  general description in case the individual branches of $C_0$ at $p$ are each smooth:

\begin{exercise}
Let $\nu : C \to C_0$ be the normalization of a plane curve $C_0$ and $p \in C_0$ a singular point. Denote the branches of $C_0$ at $p$ by $B_1,\dots,B_k$, and let $r_i$ be the point in $B_i$ lying over $p$. If the individual branches $B_i$ of $C_0$ at $p$ are each smooth, and we set
$$
m_i = \sum_{j \neq i} \mult_p(B_i \cdot B_j)
$$
then the adjoint ideal of $C_0$ at $p$ is the ideal of functions $g$ such that $\ord_{r_i}(\nu^*g) \geq m_i$.
(Hint: The computation can be done locally analytically. Let $R = \widehat{\sO_{C_0, p}}$ be the completion of the local ring
of $C_0$ at $r_i$. The integral closure is then the product of rings $R_i = \widehat{\sO_{B_i}} \cong k[[t_i]]$,
with $R_i = R/P_i$ as $P_j$ runs over the minimal primes of $R$. The multiplicity
$m_i$ is the colength of the ideal $\sum_{j\neq i}P_j \subset R$.
)
\end{exercise}

%\begin{exercise}
%Continuing the example of a plane curve with a triple point $p$, show that requiring our curve of degree $m$ to be triple at $p$ gives us a ``nine-for-six" deal---the same net effect as when we required our curve of degree $m$ to be double. (In general, an ideal contained in the adjoint ideal will work as well; the adjoint ideal is characterized as the largest ideal that works.)
%\end{exercise}

%\begin{exercise}
%Now let $C \subset \PP^2$ be a plane curve with a tacnode at $p$. Show that by taking our curve of degree $m$ to pass through $p$ and be tangent to the branches of $C$ at $p$ we get a four-for-two deal; and that this is the best we can do, so that the effect of a tacnode is to drop the deficiency by 2.
%\end{exercise}

%\fix{Joe will add a sequence of exercises on "infinitely near points"; culminate (?) with the theorem that $\delta$ can be computed in general as a sum of multiplicities of iterated blowups.}


\input{footer}