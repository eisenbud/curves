\input{header}

\def\adj{{\rm adj}}
\chapter{Plane Curves}
\label{PlaneCurvesChapter}


For a long time, plane curves were the only algebraic curves that were studied. Originally these were curves in the affine plane over the real numbers, but by the second half of the 19th century the complex projective plane was well understood, and curves in $\PP^2 = \PP^2_\CC$, corresponding to irreducible forms in 3 variables, were recognized as the natural objects of study---see the historical appendix to this book for more details.

The work of Bernhard Riemann dramatically changed the focus of the theory to branched coverings of   the ``Riemann Sphere'' ($\PP^1_\CC$). The Riemann-Roch theorem, in particular, gave information about the existence of meromorphic functions on such coverings, well beyond what could be done in the earlier theory. However, Riemann's work, depending as it did on the then-obscure ``Dirichlet principle'', was not universally accepted. In the 1860s Alfred Clebsch and, after the death of Clebsch  in 1872, Alexander Brill and Max Noether (Emmy Noether's father), undertook the ambitious program of redoing the Riemann-Roch theorem entirely in terms of plane curves. They went beyond Riemann in certain directions, too: the Brill-Noether Theorem treated in our Chapter~\ref{Brill-Noether} was formulated by Brill and Noether, and ``proved'' by them through an unsupported general position assumption. 


A central difficulty in the Brill-Noether attempt on the Riemann-Roch theorem was that,
although any smooth curve can be embedded in $\PP^r$ for any $r \geq 3$, most curves cannot be embedded in the plane. 
However, as we saw in Section~\ref{good projections}, we can embed $C$ as a curve $ C \subset \PP^r$ in a higher-dimensional projective space and find a projection $\PP^r \to \PP^2$ that carries $C$ birationally onto its image $C_0$, called a plane model of $C$. The curve $C_0$ typically has singularities, and $C$ is the normalization of $C_0$. Brill and Noether wanted to prove the Riemann-Roch theorem for $C$ by formulating and proving a related theorem for $C_0$. In particular, they tried to characterize linear equivalence of divisors on $C$ in terms of certain ``clusters'' of points---we would say 0-dimensional subschemes---of $C_0$. 

To carry out this program, a key result is that if $D\subset C_0$ is contained in the intersection
$D'$ of $C_0$ and some other plane curve $C_0'$, then the difference 
$E := D'-D$ can be defined with properties such as that $D'-E = D$; Brill and Noether seem simply to have assumed that this is so. A bit later Frances Sowerby Macaulay proved that this is in fact possible  and also understood that it would not generally be possible if $D'$ were the intersection of three or more curves. 

Macaulay exploited this theory of residuation  to prove what he called the ``Generalized Riemann-Roch Theorem'' (now erroneously called the ``Cayley Bacharach Theorem''). This early work of Macaulay led directly to his definitions of  ``perfection'' (a homogeneous ideal
$I  \subset S:= k[x_0, \dots, x_n]$ is perfect if $S/I$ is Cohen-Macaulay) and ``super-perfection'' (the case when $S/I$ is
Gorenstein). For all this, see~\cite{Eisenbud-Gray}.

In this chapter we will take the point of view of Clebsch, Brill and Noether, and explain how to understand 
the differential forms and, given a (possibly ineffective) divisor $D$ on $C$, how to find all the 
effective divisors on $C$ that are linearly equivalent to $D$, in terms of a plane model---that is, 
in terms of a possibly singular plane curve $C_{0}$ and the normalization map $\nu: C\to C_{0}$.
More precisely, we will give algorithms for the following tasks:
 
\begin{enumerate}
\item Given the equation $F(X,Y,Z)$ of a degree $d$ plane curve $C_0$, with normalization $C$, we will find a basis for $H^0(K_C)$ constructed from curves of degree $d-3$ with base locus in a certain subscheme $\adj(C_{0})$; and
\item  Given, in addition, a (not necessarily effective) divisor $D$ on $C$, we will describe the complete linear system $|D|$; that is, we will find all effective divisors $E$ on $C$ with $E \sim D$, or, equivalently, a basis for $H^0(\cO_C(D))$ expressed in terms of curves of some degree $m$ with specified base locus including $\adj(C_{0})$.
\end{enumerate}

Along the way we will see how to test when two given divisors $D$ and $E$ on $C$ are linearly equivalent; and whether a divisor $D$ linearly equivalent to any effective divisor.

To motivate the constructions we will proceed in three stages: first when $C = C_0$ is a smooth plane curve (Section~ \ref{linear series on smooth plane curves}); next for nodal curves (Section~~\ref{nodal plane curves}), which in principle  covers all smooth curves $C$; and finally for arbitrary reduced, irreducible plane curves (Section~\ref{arbitrary plane curves}): many times a curve $C$ is given to us as (the normalization of) a plane curve with singularities other than nodes, and while Proposition~\ref{nodal projection} assures us in principal that we can also realize $C$ as the normalization of a nodal plane curve, it is often easier to work with the given plane model. 

\section{Smooth plane curves}

\subsection{Differentials on a smooth plane curve}\label{canonical series on smooth plane curves}

Let $C \subset \PP^2$  be a smooth plane curve, given as the zero locus of a homogeneous polynomial $F(X,Y,Z)$ of degree $d$. We'll introduce coordinates $x = X/Z$ and $y = Y/Z$ on the affine open subset $U \cong \AA^2$ given by $Z \neq 0$, and let $f(x,y) = F(x, y,1)$ be the inhomogeneous form of $F$, so that $C^\circ = C \cap U$ is given as the zero locus $V(f) \subset  \AA^2$. 

Since an automorphism of $\PP^2$ can carry any line in the plane to the line at infinity, and any point on that line to the point $(0,1,0)$, we may assume:
\begin{enumerate}
\item The point $[0,1,0]$ (that is, the point at infinity in the vertical direction) does not lie on $C$; equivalently,  the projection $C \to \PP^1$ from $(0,1,0)$, which is given by $[X,Y,Z] \mapsto [X,Z]$ (or, in affine coordinates, $(x,y) \mapsto x$)  has degree $d$; and
\item The line $L$ at infinity given by $Z = 0$ intersects $C$ transversely in $d$ distinct points $p_1, \dots, p_d$; We write $H = p_1+ \dots +p_d$ for the corresponding divisor, the ``hyperplane section at infinity''.
\end{enumerate}
 
By the adjunction formula (Theorem ****) the divisors of differential forms on $C$, that is, the canonical divisors,
are the intersections of $C$ with curves of degree $d-3$. In the spirit of Brill and Noether we begin by
constructing the regular differential forms themselfves in terms of forms of degree $d-3$:

We start by writing down a single rational 1-form on $C$: 
 take a regular 1-form on $\AA^2$, such as $dx$, and restrict/pull back to $C$. 

Though $dx$ is regular on $C^\circ$, writing
$$
dx = d\frac{X}{Z} = \frac{X dZ+ Z dX}{Z^2}
$$
 shows that $dx$ has double poles at the points $p_1,\dots,p_d$ of the divisor $D := C \cap L$. (One can
 also see this by thinking of $dx$ as pulled back to $C$ from the differential form on $\PP^{1}$, which
 has a double pole at $\infty$.
 
How do we get rid of the poles of $dx$? The extension to $\PP^2$ of a polynomial $h(x,y)$ of degree $d$ on
$\AA^2$ has a pole of order $d$ along the line $L$ at infinity. Thus if $h$ has degree at least 2 then $dx/h$ will have no poles at infinity. However, $h(x,y)$ will vanish at points of $C \cap U$, and this may create new poles of $dx/h$. Of course if $h$ vanishes only at  points of $C \cap U$ where $dx$ has a zero, the zeroes of $h$ may cancel the zeroes of $dx$ rather than creating new poles.
 
 To avoid producing new poles in this way we may take
 $$
 h(x,y) = \frac{\partial f}{\partial y}(x,y).
 $$
To simplify the notation, we will set  $f_{y}:= \frac{\partial f}{\partial y}(x,y)$ and similarly for
$f_{x}$. Note that  when restricted to $C^\circ$, $df$ must vanish identically, that is,
 $$
 0 \equiv df = f_{x}dx + f_{y}dy 
 $$
Because $C$ is smooth, the functions $f_{x}$ and $f_{y}$ have no common zeroes on $C^\circ$. Moreover, the differentials $dx$ and $dy$ have no common zeros on $C^\circ$. It follows that at for all $p \in C^\circ$ we  have
$$
\ord_p(dx) = \ord_pf_{y}, 
$$ 
and thus the quotient 
$$
\varphi_0 = \frac{dx}{f_{y}}
$$
is everywhere regular and nowhere 0 in $C^\circ$.

The differential $dx$ has poles of order $2$ at the points $p_i$. The polynomial $f_{y}$, having degree $d-1$, has poles of order $d-1$. Thus $\varphi_0$ has zeroes of order $d-3$ at the points $p_i$; in other words, as divisors,
$$
(\varphi_0) = (d-3)D.
$$
In particular, if $d \geq 3$ then $\varphi_0$ is a global regular differential on $C$. The divisor of
zeros of this differential has degree $d(d-3)$. If $g$ is the genus of $C$, then we must
have $2g-2 = d(d-3)$, whence 
$$
g = \frac{d(d-3)}{2} + 1.
$$
Moreover, we can  multiply $\varphi_0$ by any polynomial $e(x,y)$ 
  of degree $d-3$ or less without introducing poles, so that 
$$
e\varphi_0 = \frac{e(x,y)dx}{\partial f/\partial y}
$$ 
is likewise a global regular differential, for $g$  any polynomial of degree $\leq d-3$. The dimension 
of the space of forms of degree $d-3$ on $\PP^{2}$ is 
$$
\binom{d-1}{2} =  \frac{d(d-3)}{2} + 1.
$$
This proves:

\begin{theorem}
The space of regular differentials on a smooth plane curve $C$
with affine equation $f=0$ has basis $\{\varphi_{i,j} \}_{i+j \leq d-3}$, where
$$
\varphi_{i,j} =  \frac{x^iy^jdx}{f_{y}}.\qed
$$
\end{theorem}
%We have thus found a vector space of regular differentials, of dimension $\binom{d-1}{2}$. But at the same time, the degree of a differential like $\varphi_0$ is
%$$
%\deg((\varphi_0)) = (d-3)\deg(D) = d(d-3),
%$$
%so that the genus of $g(C)$ satisfies
%$2g(C)-2 = d(d-3)$, whence
%$$
%\frac{d(d-3)}{2} + 1 = \binom{d-1}{2}.
%$$
%In other words, we have found all the global regular differentials on $C$! We have
%$$
%H^0(K_C) = \left\{ \frac{e(x,y)dx}{\partial f/\partial y} \mid \deg e \leq d-3\right\};
%$$
%or, equivalently, the space of regular differentials on $C$ has basis $\{\varphi_{i,j} \}_{i+j \leq d-3}$, where
%$$
%\varphi_{i,j} =  \frac{x^iy^jdx}{\partial f/\partial y}
%$$
%
%We could have achieved the same result by using the adjunction formula (see Section~\ref{Adjunction Formula}: we have
%$$
%K_C = (K_{\PP^2} \otimes \cO_{\PP^2}(d))|_C = \cO_C(d-3),
%$$
%and from the exact sequence
%$$
%0 \to \cO_{\PP^2}((d-3)-d) \rTo^f \cO_{\PP^2}(d-3) \to \cO_C(d-3)=K_C \to 0
%$$
%and the vanishing of $H^1(\cO_{\PP^2}(-3))$, we see that the map on global sections
%$$
%H^0(\cO_{\PP^2}(d-3)) \to H^0(K_C)
%$$
%is surjective. 
%

\subsection{Linear series on a smooth plane curves}\label{linear series on smooth plane curves}

Suppose that $D$ is any divisor on a smooth plane curve $C$, expressed as the difference of
two effective divisors, $D= D_0-D_\infty$. We would like to find all the \emph{effective} divisors linearly equivalent to $D$, that is, of the form
$D + (H/G)$, where $G, H$ are forms of the same degree $m$. Choose $m$ large enough so that
we may choose
 a form $G$ of degree $m$ that vanishes on $D_0$ plus some divisor $A$ (but not on all of $C$). 
 
 
\begin{theorem}\label{equiv on smooth plane curve}
The effective divisors equivalent to $D$, if any, are precisely those of the form $C'\cap C -(D_\infty+A)$ where $C'$
is a curve of degree $m$ containing $D_\infty+A$, but not containing $C$.
\end{theorem}

In particular,  if there is no curve $C'$ of degree $m$ vanishing on  $A + D_\infty + D$ but not vanishing identically on $C$, then $D$ is not linearly equivalent to any effective divisor. In particular, the existence of such a curve $C'$ is independent of the choices of $m$ and $G$, as we shall see in the proof.

\begin{example}
Suppose that $C$ has degree 3 and thus genus 1. If we choose as origin on the curve $C$ a point $o$, then to add two points $p$ and $q \in C$ means to find the (unique) effective divisor of degree 1 linearly equivalent to $p + q - o$. In this situation, we can carry out the process described above with $m=1$: draw the line $L$ through the points $p$ and $q$, and let $r \in C$ be the remaining point of intersection of $L$ with $C$; then draw the line $M$ though the points $r$ and $o$, and let $s \in C$ be the remaining point of intersection of $L$ with $C$. This is the classical construction of the group law.
\pict{illustrate this}
\end{example}

\begin{proof}[Proof of Theorem~\ref{equiv on smooth plane curve}]
First, suppose that we can find a curve $C'$ of degree $m$ as in the Theorem. If the equation of $C'$ is $H=0$,
then  setting $D' = C'\cap C - -(D_\infty+A)$ we have
$$
D' = D + (H/G) = D_0- D_\infty - (D_0+A)+(D_\infty+A+D')
$$
so $D'$ is linearly equivalent to $D$. 
\pict {illustrate the configuration of all the divisors}

We claim that we find in this way all effective divisors $D' \sim D$. (This is a special case of the Completeness of the Adjoint series, Proposition~\ref{adjoint completeness}). In particular, this will show that if there is no polynomial $H$ as above, then there are no effective divisors equivalent to $D$. In particular, this shows
that whether or not we can find a curve $C'$ fulfilling the conditions of the Theorem is independent of $m\gg 0$.

Indeed, suppose $D'$ is any effective divisor with $D' \sim D$, so that
$$
\cO_C(A+D_\infty+D') = \cO_C(A+D_\infty+D)  = \cO_C(m),
$$
that is, $A+D_\infty+D$ is linearly equivalent on $C$ to the divisor (H) defined by the vanishing of some form $H$ of degree $m$. 
This means that
$A+D_\infty+D  = (H') +(P/Q)$ for some forms $P,Q$ of equal degree, with $Q$ not vanishing identically on $C$. 
Since $A+D_\infty+D$ is effective,
the zeros of $Q$ on $C$ must be contained in the zeros of $H'P$ on $C$; in other words,
the restriction to $C$ of $H'P/Q$ is a section of $\sO_C(m)$.
Since $C\subset \PP^2$ is arithmetically Cohen-Macaulay (see Proposition~\ref{ACM basics}), this implies that
$H'P/Q$ is the restriction of a form $H$ of degree $m$ on $\PP^2$.

We can also prove the existence of $H$ directly: Since $F$ is irreducible, 
$Q,F$ is a regular sequence, and thus the ideal $(Q,F)$ is \emph{unmixed}; that is, it has no embedded primary component.
Since $H'P$ vanishes on the zeros of $Q$ on $C$ we see that $H'P = QH+LF$ for some
forms $L,H$, where $\deg H = \deg HP - \deg Q$. Thus $H = (H'P- LG)/Q$ is a form
of degree $m$ defining $A+D_\infty+D$.
\end{proof}

The argument given in the last paragraph can be stated more generally thus:  if curves $F(X,Y,Z)=0$ and $Q(X,Y,Z)=0$ 
meet only in a set of  points $\Gamma$ in $\PP^{2}$, and $E(X,Y,Z) = 0$ is a curve containing
$\Gamma$, then $E = QH +LF$ for some forms $H$ and $L$. Recognizing the importance of this
statement for the argument above, Max Noether in~\cite{} dubbed it the \emph{Fundamental Theorem}, 
noting that it had often been used by geometers but not proven. After successive attempts and 
criticisms involving many mathematicians, he and Brill gave a complete proof, essentially using
regular sequences as above, in~\cite{}. For more of this story see the account in~\cite{Eisenbud-Gray}.

\section{Nodal plane curves}


Smooth curves that can be embedded in $\PP^{2}$ are very special, but every smooth curve 
is the normalization of a plane curve with only ordinary nodes as singularities---see Section~\ref{nodal curves}.  We now want to explain methods like those above for such \emph{nodal curves}.

\subsection{Differentials on a nodal plane curve}\label{canonical series on nodal plane curves}


As before, we may choose homogeneous coordinates  $[X,Y,Z]$ on $\PP^2$ so that the curve $C_0$ intersects the line $L = V(Z)$ at infinity transversely at points $p_1,\dots,p_d$ other than $[0,1,0]$. In particular,  all the nodes of $C_0$ will lie in the affine plane $U = \PP^2 \setminus L$.
In addition, we can assume that  neither branch of $C_0$ at a node has vertical tangent. (These conditions serve only to keep the notation reasonably simple, and are satisfied by a general choice of coordinates.) Let the nodes of $C_0$ be $q_1,\dots,q_\delta$, with $r_i, s_i \in C$ lying over $q_i$; we'll denote by $\Delta$ the divisor $\sum r_i + \sum s_i$ on $C$.

Let $F(X,Y,Z)$ be the homogeneous polynomial of degree $d$ defining the curve $C_0$, and let $f(x,y) = F(x,y,1)$ be the defining equation of the affine part $C_0 \cap U$ of $C_0$. Let $\nu: C\to C_0$ be the normalization map. We start by considering the rational differential $\nu^*(dx)$ on $C$. In the smooth case, we saw that this differential was regular and nonzero in the finite plane, but had poles of order 2 at the points of $C \cap L$; this followed from the equation
$$
 df = \frac{\partial f}{\partial x}dx + \frac{\partial f}{\partial y}dy \equiv 0.
 $$
and the fact that $\frac{\partial f}{\partial x}$ and $\frac{\partial f}{\partial y}$ have no common zeroes on $C_0$. But now $\frac{\partial f}{\partial x}$ and $\frac{\partial f}{\partial y}$ \emph{do} have common zeroes; specifically, the pullbacks $\nu^*(\frac{\partial f}{\partial x})$ and $\nu^*(\frac{\partial f}{\partial y})$ have simple zeroes at the points $r_i$ and $s_i$. We conclude, accordingly, that the differential $\nu^*dx$ has double poles at the points $p_i$, 
and, proceeding as before, we see that for a polynomial $e(x,y)$ of degree $\leq d-3$, the differential
$$
\nu^*( \frac{e(x,y)dx}{\partial f/\partial y})
$$
will be regular except for simple poles at the points $r_i$ and $s_i$.

We can get rid of these poles by requiring that $e$ vanishes at the points $q_i$. We say in this case that $e$ (and the curve defined by $e$) \emph{satisfies the conditions of adjunction}. (In Section~\ref{adjoint ideal}, we'll describe the  conditions of adjunction associated to an arbitrary singularity.) In any event, we see that
$$
 \left\{ \nu^* \frac{e(x,y)dx}{\partial f/\partial y} \mid \deg e \leq d-3 \text{ and } e(q_i) = 0 \; \forall i \right\} \subset H^0(K_C).
$$
In the smooth case we were able to compare dimensions to conclude that this inclusion was an equality. We can do the same thing here. We have seen that the  rational 1-form $\varphi = \nu^*(\frac{dx}{\partial f/\partial y})$ has zeroes of order $d-3$ at the points $p_1,\dots,p_d$ and simple poles at the points $r_i$ and $s_i$ and is otherwise regular and nonzero. In other words, if we set $H = p_1+\dots + p_d$, the divisor
$$
(\varphi) = (d-3)H - \Delta.
$$
In particular, we see that
$$
\deg((\varphi)) = d(d-3) - 2\delta
$$
and correspondingly
$$
g(C) = \binom{d-1}{2} - \delta.
$$


On the other hand, the space of polynomials $e$ of degree $\leq d-3$ vanishing at the points $q_i$ has dimension at least $ \binom{d-1}{2} - \delta$; we conclude that
$$
H^0(K_C) =  \left\{ \nu^* \frac{e(x,y)dx}{\partial f/\partial y} \mid \deg e \leq d-3 \text{ and } e(q_i) = 0 \; \forall i \right\}.
$$
This argument would give another proof of Lemma~\ref{adjoint independent}.

\pict{canonical divisor on a curve of genus 4 represented as the intersection of a plane quintic
with a conic through 2 nodes}

\section{Linear series on a nodal plane curve}\label{linear series on nodal plane curves}

Given a divisor $D$ on $C$, we next compute the complete linear series $|D|$, using the birational map $\nu$ from 
$C$ to the nodal curve $C_0$. 

  To start, we find an integer $m$ and a polynomial $G$ whose pullback to $C$
  vanishes on the divisor $D_0+\Delta$ 
 but not identically on $C$; if $D_0$ contains a point  of $\Delta$ this means that $G$ defines
 a curve sufficiently tangent to the corresponding branch of $C_0$, which we can 
 achieve for sufficiently large $m$. We can then write the zero locus of $G$ pulled back to $C$ as
$$
(\nu^*G) = D_0 + \Delta + A,
$$
as before. 

\pict{illustration of a case where $D_0$ contains one point of $\Delta$.}

Next, we find polynomials $H$ of the same degree $m$, vanishing at $A+D_\infty$ and at the points $q_i$  but not on all of $C_0$. Let $D'$ be the divisor cut on $C$ by $H$ residual to $D_0 + \Delta + A$; that is, we write
$$
(\nu^*H) = D_0 + \Delta + A + D'.
$$
Finally, since $\nu^*(G/H)$ is a rational function on $C$, we see that 
$$
D_0 + \Delta + A = (\nu^*H) \sim (\nu^*G) = D_0 + \Delta + A + D',
$$
and we conclude that $D'$ is an effective divisor linearly equivalent to $D$ on $C$.

To prove that we get \emph{all} divisors $D'$ in this way we will work on the surface $S$ obtained by blowing up
$\PP^2$ at the points $q_i$. 

The following result, known classically as \emph{completeness of the adjoint series}, is what we need:

\begin{proposition}\label{adjoint completeness}
If $C_0 \subset \PP^2$ is a nodal plane curve and $\nu : C \to C_0$ its normalization $C$ then for any $m$ the linear series cut on $C$ by plane curves of degree $m$ passing through the nodes is complete.
\end{proposition}

The  meaning of this statement is that we get a complete linear series on $C$ by taking pullbacks of forms of degree $m$ on $\PP^2$
that vanish on the nodes, and then subtracting the divisor $\Delta$ of preimages of the nodes from the pullbacks.

\begin{proof}
To prove Proposition~\ref{adjoint completeness}, it will be helpful to introduce another surface: the blow-up $\pi : S \to \PP^2$ of $\PP^2$ at the points $q_i$. The proper transform on $C_0 \subset \PP^2$ in $S$ is the normalization of $C_0$, which we will again call $C$.

There are two divisor classes on $S$ that will come up in our analysis: the pullback of the class of a line in $\PP^2$, which we'll denote $H$; and the sum of the exceptional divisors, which we'll call $E$. We write $h= H\cap C$ and $e = \sum (p_i+q_i) = E\cap C$ for the corresponding divisors on $C$. In these terms, we have
$$
C \sim dH - 2E \quad \text{and} \quad K_S \sim -3H + E
$$
(the first follows from the fact that $C_0$ has multiplicity 2 at each of the points $q_i$, the second from considering the pullback to $S$ of a rational 2-form on $\PP^2$; see Theorem~\ref{divisor classes on blowup} for more details.)

 If $A$ is a curve in $\PP^2$ of degree $m$ passing through the points $q_i$, we can associate to it the effective divisor $\pi^*A - E$; this gives us an isomorphism
$$
H^0(\cI_{\{q_1,\dots,q_\delta\}/\PP^2}(m)) \cong H^0(\cO_S(mH-E)).
$$
In these terms we can describe the linear series cut on $C$ by plane curves of degree $m$ passing through the nodes of $C_0$ as the image of the map
$$
H^0(\cO_S(mH-E)) \to H^0(\cO_C(mH-E)),
$$
and the proposition amounts to the assertion that this map is surjective.

From the long exact cohomology sequence associated to the exact sequence of sheaves
$$
0 \to \cO_S(mH-E-C) = \cO_S((m-d)H + E)  \to \cO_S(mH-E) \to \cO_C(mH-E) \to 0,
$$
 we see that it will suffice to establish $H^1(\cO_S((m-d)H + E)) = 0$. To do this, we apply Serre duality on $S$, which says that $H^1(\cL) \cong H^1(K_S\otimes \cL^{-1})^*$. In this instance it 
tells us that
$$
H^1(\cO_S((m-d)H + E)) \cong H^1(\cO_S((d-m-3)H))^*.
$$
The line bundle $\cO_S((d-m-3)H)$ is 
 the pullback to $S$ of the bundle $\cO_{\PP^2}(d-m-3)$, which has vanishing $H^1$. The following lemma completes the proof of the proposition:
\begin{lemma}
Let $X$ be a smooth projective surface, and $\pi : Y \to X$ a blow-up. If $\cL$ is any line bundle on $X$, then
$$
H^1(Y, \pi^*\cL) = H^1(X, \cL).
$$
\end{lemma}
The lemma follows by applying the Leray spectral sequence, which relates the cohomology of $\cL$ on $Y$ to the cohomology of the direct image $\pi_*\pi^*\cL$ (Leray is particularly simple in this setting, since all higher direct images are 0), and the observation that $\pi_*\pi^*\cL \cong \cL$.
\end{proof}

\section{Arbitrary plane curves} \label{arbitrary plane curves}

%\begin{proposition}\label{effect of blowup on genus}
% Let $C$ be a curve on a smooth surface $S$, let $\nu : S' \to S$ be the blowup of $S$ at $p$. If $C'$ is the strict transform of $C$, then
% $$
% p_a(C') = p_a(C) -{m\choose 2},
% $$
% where $m$ is the multiplicity of $p\in C$.
%\end{proposition}
%\begin{proof}
%This follows from comparing the adjunction formulas on $S$ and $S'$. To start, we have
%$$
%p_a(C) = \frac{C^2 + K_S\cdot C}{2} + 1.
%$$
%On $S'$ let $E$ be the divisor class of the exceptional divisor. As we've seen,
%$$
%K_{S'} = \nu^*K_S + E,
%$$
%while the class of $C'$ is given by
%$$
%C' \sim \nu^*C - mE.
%$$
%It follows that
%$$
%(C')^2 = C^2 + m^2E^2 = C^2 - m^2 \quad \text{and} \quad K_{S'}\cdot C' = K_S\cdot C + m.
%$$
%Thus, applying adjunction on $S'$, we find
%$$
%p_a(C') = \frac{{C'}^2 + K_{S'}\cdot C'}{2} + 1 = \frac{C^2 + K_S\cdot C - m(m-1)}{2} + 1 = p_a(C) -{m\choose 2}
%$$
%as stated.
%\end{proof}


Very often, smooth projective curves $C$ are given to us as the normalizations of reduced and irreducible plane curves $C_0 \subset \PP^2$ with more complicated singularities than nodes, and we would like to be able to effectively determine the complete linear systems on $C$ in this setting. Of course, we know we can re-embed $C$ birationally in the plane as a plane curve with nodes, but this knowledge is apt to be more of a comfort in theory than in practice.

Happily, it is possible to carry out an analysis of linear series on the normalization of an arbitrary plane curve in a manner exactly analogous to what we did in the preceding section for nodal curves; in this section, we'll describe how this goes. 

The general result
involves the normalization map $\nu: C\to C_{0}$ and a finite subscheme  $\adj(C_{0})\subset C_{0}$ supported on the singular locus of $C_{0}$ called the 
\emph{adjoint} scheme of $C_{0}$, about which we will have more to say later in the Chapter. 

Given a 
subscheme $B\subset C_{0}$ we consider the linear series $\sV_{0}\subset H^{0(}\sO_{C_{0}}(-m))$ of Cartier divisors on $C_{0}$ that are the intersections
of $C_{0}$ with curves of  degree $m$ that contain the subscheme $B$. We define \emph{the linear series cut out on $C$} by curves of degree $m$
containing $B$ to be the linear series  $\sV$ of divisors in $C$ that are residual to $\nu^{-1}(B)$ in the pullbacks 
of divisors in $\sV_{0}$.

\begin{theorem}
If $C_{0}$ is a reduced, irreducible curve in $\PP^{2}$ and $\sV$ is a complete linear series
on the normalization $\nu: C\to C_{0}$ then for all sufficiently large integers $m$ there is an effective Cartier divisor $D_{m}$  of $C_{0}$ 
such that $\sV$ is the linear series cut out on $C$ by curves of degree $m$ containing $D_{m}+\adj(C)$.
\end{theorem}


Suppose again that $C_0 \subset \PP^2$ is reduced and irreducible, but with arbitrary singularities, and again let $\nu : C \to C_0$ be its normalization. Again we want to find the regular differentials on $C$ and the effective divisors on $C$ linearly equivalent to a given $D \in \Div(C)$. We set this up just as did above: we take $C^\circ_0$ to be the intersection of $C_0$ with the open set $z \neq 0$, that is, with $\AA^2\subset \PP^2$, and assume that
all the singular points of $C_0$ are contained in $C^\circ_0$.

To mimic the analysis in the nodal case we need to generalize what we called the ``conditions of adjunction." In the nodal case, these were the conditions that a curve $e(x,y)=0 \subset \AA^2$ pass through the nodes of $C_0$, that is, locally, $e$ was contained in the maximal ideal
at each node. For an arbitrary singular point, the ideal that will play the role of the maximal ideal is called the \emph{adjoint ideal} of the singularity. It is easy to compute in simple cases, and has a nice description in terms of $\nu$ for arbitrary plane curves that will be given in Theorem~\ref{general adjoint}.

We first turn to the canonical series; that is, we wish to find expressions for all the regular differential forms on $C$. In the case of smooth and nodal curves we found we could express every regular differential form
on $C$ as a rational function times the pullback of the differential form written as $dx$ on $\AA^2$. We justified this
by counting---that is, by showing that we could get a $g(C)$-dimensional space of regular differentials in this way. The justification for 
this procedure for a reduced, irreducible curve with arbitrary singularities relies on the fact that $x$, as a function on $C^\circ_0$
is a \emph{finite} map to $\AA^1$, and thus the field of rational functions $\kappa(C) = \kappa(C^\circ_0)$ is a finite
separable extension of $\CC(x)$. By~\cite[Section 16.5]{Eisenbud1995} that the module of differentials 
$\omega_{\kappa(C)/\CC}$ is generated over $\kappa(C^\circ_0)$ by $dx$; that is, every differential can be expressed as a rational function
times $dx$. 

We focus for now on one singular point $q \in C_0$, with points $r_1,\dots,r_k \in C$ lying over $q$, and we wish to describe the conditions for a rational differential $e\varphi_0$ on $C$ to be regular, where
$$
\varphi_0 = \nu^* \frac{dx}{\partial f/\partial y},
$$
and $f$ is the defining equation of $C_0$ in $\AA^2$. As in the case of a smooth curve $C$, the differential
form $\varphi_0$ has a zero of order $d-3$ at each of the points of $C$ lying over the intersection of $C_0$ with the line  $L = \PP^2\setminus \AA^2$
at infinity. Thus we must must choose $e$ to be a function with poles on $C_0$ of order $\leq d-3$ on $L\cap C_0$ and no poles in $C^\circ$. Any such function is represented (modulo $(f)$) by 
a polynomial $e$ in $x,y$ which must have degree $\leq d-3$, since otherwise $edx$ would have poles at infinity. In addition, $\varphi_0$ will have poles at the points $r_i$,
so $e$ must satisfy some ``conditions of adjunction," represented by belonging to an ideal---the adjoint ideal---at each singular point.

Let $m_i$ be the order of the pole of $\varphi_0$ at $r_i$. We can define the \emph{adjoint ideal} of $C_0$ at $q$ to be the ideal
$$
\mathfrak A_{q} = \left\{ e \in \cO_{\PP^2, q} \mid \ord_{r_i}(\nu^*e) \geq m_i \; \forall i \right\}
$$

In other words, $\mathfrak A_q$ is the ideal of functions $e$ such that $\nu^* \frac{gdx}{\partial f/\partial y}$ is regular at all the points $r_i$. We define the \emph{adjoint ideal $\mathfrak A_{C/C_0}$ of $C_0$} to be the intersection of $A_q$ over all singular points  $q \in C_0$; the \emph{adjoint series of degree $m$} is then the linear series $H^0(\mathfrak A_{C/C_0}(m))$. 

We can see, by an extension of the arguments above,  that every global regular 1-form on the curve $C$ is of the form 
$$
e(x,y) \varphi_0,
$$
with $e$ a polynomial of degree $\leq d-3$ in the adjoint ideal $\fA_{C/C_0}$; and more generally, the adjoint series of degree $m$ is complete for every $m$. Thus  we can compute complete linear series as in the nodal case, simply replacing
the divisor $\Delta = \sum q_i$ with the divisor determined by the adjoint ideal. We omit the details, which involve replacing
the surface $S$ with a repeated blowup of the plane on which the strict transform of $C_0$ is the normalization $C$.

In simple cases, the adjoint ideal is not difficult to compute. Here are some examples:


\begin{example}[nodes and cusps]
We have already seen that in case $q$ is a node of $C_0$, there are two points of $C$ lying over it, and the multiplicities of $\varphi_0$ at these two points are $m_1=m_2=1$; the adjoint ideal is thus 
 the maximal ideal $\cI_q$ at $q$. In the case of a cusp, for example the zero locus of $y^2-x^3$, there is only one point $r=r_1$ of $C$ lying over $q$, and the differential $\varphi_0$ has a pole of of order $m_1=2$; since the pullback to $C$ of any polynomial $g$ vanishing at $q$ will vanish to order at least two at $r$, the adjoint ideal is again the maximal ideal at $q$.
\end{example}

\begin{example}[tacnodes]
Next, consider the case of a \emph{tacnode}; that is, a plane-curve singularity with two smooth branches simply tangent to one another, such as the zero locus of $y^2-x^4$. In this case there are again two points of $C$ lying over $q$, and a simple calculation shows that $\varphi_0$ has poles of order $m_1=m_2=2$ at each. The adjoint ideal is thus the ideal of functions vanishing at $q$ and having derivative 0 in the direction of the common tangent line to the branches.
\end{example}

\begin{example}[ordinary triple points]
In the case of an ordinary triple point of a plane curve---three smooth branches pairwise transverse to one another---there are three points of $C$ lying over $q$, and we have $m_1=m_2=m_3= 2$; the adjoint ideal is correspondingly 
 the square of the maximal ideal at $q$. 
\end{example}

For plane curves the adjoint ideal coincides with the 
\emph{conductor ideal} of $C_0$, which is to say the annihilator of the sheaf $\nu_*\cO_C / \cO_{C_0}$. This is a reflection of the fact that plane curve singularities are \emph{Gorenstein}, and will be proven in Theorem~\ref{general adjoint}.


%In the next chapter we shall define the canonical (or dualizing) sheaf of a singular curve $C_0$ in 
%general and show in Theorem~\ref{general adjoint} that if $\nu: C\to C_0$ is the normalization of a reduced, connected
%projective curve $C$, then $\nu_*(\omega_C)$ is contained in $\omega_{C_0}$. We can
%then define the \emph{adjoint ideal} of $C_0$ to be 
%$$
%\fA_{C/C_0} :=\ann_{\sO_{C_0}}\frac{\omega_{C_0}}{\nu_* \omega_C}.
%$$
%\footnote{The notation $\mathfrak f$ for the conductor comes from the german term \emph{F\"uhrer} (leader); it is the ideal that "leads" elements of $\nu_* \sO_C$ into elements of $\sO_{C_0}$.}
%We will show that $C_0$ this is equal to the \emph{conductor ideal}
%$$
%\mathfrak f_{C/C_0}: = \ann_{\sO_{C_0}}\frac{\nu_* \sO_C}{\sO_{C_0}}	
%$$
%Furthermore, if $C_0$ is a plane curve, then 
%$$
%\delta(C_0) = \length \frac{\nu_* \sO_C}{\sO_{C_0}} = \length \frac {\sO_{C_0}}{\mathfrak f_{C/C_0}}.
%$$
%
%%For an node the value of the $\delta$-invariant is 1, and in general it may be regarded as the ``number of nodes equivalent to the singularities of $C_0$'' as
%%explained in Chapter~\ref{RiemannRochChapter}.  
%%
%%In the previous chapter we used the adjoint ideal as a condition on a polynomial
%%$e$ to multiply differential forms on $C$ for $e\phi$ to belong to $\omega_C$ is always sufficient, but may be necessary only
%%when $\omega_{C_0}$ is cyclic---which is equivalent to the statement that $C_0$ is locally
%%Gorenstein. This condition is always satisfied for singularities of curves in the plane.
%%See Example~\ref{nongorenstein} for a singularity that is not locally planar, and behaves differently.
%%
%%
%%In the Theorem~\ref{general adjoint} we shall prove that the adjoint ideal can be computed
%%as the \emph{conductor} ideal, the annihilator in $\sO_{C_0}$ of the quotient
%%$\nu_*\sO_C/\sO_{C_0}$.
%%
%%\subsection{The ``deficiency" of a curve}
%
%Arthur Cayley observed the importance for a nodal plane curve of degree $n$ of the number
%that we would now call the arithmetic genus. In \cite{Cayley2} He wrote:
%\begin{quotation}
% Before going further, it will be convenient to to introduce the term ``Deficiency," viz., a curve of the order $n$ with
% $\frac{1}{2}(n-1)(n-2)-D$ dps [double points] is said to have a deficiency $=D$: the foregoing theorem is that for curves with a deficiency $=0$, the coordinates are expressible rationally in terms of a parameter $\theta$.
%  \end{quotation}
% 
%Riemann-Roch theorem and the modern definitions of the genus of a curve, algebraic geometers had
%defined an invariant called the \emph{deficiency} that is equal to the genus When Clebsch, Brill and Noether tried to 
%compute what amounts to the geometric genus of a plane curve, this was the idea they used, and we can shed some light
%on the meaning of the adjoint ideal by examining the old definition.
%
%The starting point may have been the observation that, while any $2n$ points on a plane conic curve $C$ form the intersection of $C$ with a  curve of degree $n$, the analogous statement---that any $3n$ points on a smooth plane cubic comprise the intersection of $C$ with a plane curve of degree $n$---is not true. This is a reflection of the fact that there are fewer rational functions on the cubic than on the conic: if $D = p_1+\dots + p_d$ is a $d$-tuple of points on a conic curve $C$, we have
%$$
%h^0(\cO_C(D)) = d+1,
%$$ 
%and so there is a rational function with poles just along $D$ and vanishing at any given $d$-tuple of points; by contrast, a plane cubic $C$ has genus 1, and so by Riemann-Roch for such a divisor we have
%$$
%h^0(\cO_C(D)) = d.
%$$
%This lack of rational functions was viewed as a defect of the curve, and called its \emph{deficiency} (and typically denoted $p$, rather than $g$). .
%
%In general, suppose that $C$ is a smooth plane curve $C \subset \PP^2$ of degree $n$, and that $D = p_1+\dots + p_d$ is a divisor of degree $d$. To find the complete linear system $|D|$ by the method of Section~\ref{smooth plane curves} we start by choosing a plane curve $B$ of degree $m$ containing $D$ but not containing $C$; again for simplicity of notation we'll assume $m \geq n$. The intersection $B \cap C$ will then consist of $D$ plus another divisor $E$ on $C$, of degree $mn-d$; and what we saw is that the complete linear series $|D|$ will be cut on $C$ by plane curves of degree $m$ containing $E$, modulo those containing $C$.
%
%We can easily estimate the size of this linear series: If the $(mn-d)$ points of $E$ impose independent conditions on curves of degree $m$, which will be the case when $d$ is large compared with $n$, the space of curves of degree $m$ containing $E$ will have dimension
%$$
%h^0(\cI_{E/\PP^2}(m)) = \binom{m+2}{2} - (mn-d).
%$$ 
%On the other hand, the subspace of curves of degree $m$ containing all of $C$ has dimension
%$$
%h^0(\cO_{\PP^2}(m-n)) = \binom{m-n+2}{2}
%$$
%so the dimension of $H^0(\cO_C(D))$ is
%$$
%h^0(\cO_C(D)) \geq \binom{m+2}{2} - (mn-d) -  \binom{m-n+2}{2} = d + 1 - \binom{n-1}{2}.
%$$
%By the Riemann-Roch theorem, the inequality will be an equality if $d> 2g-2 = 2\binom{n-1}{2}-2 = n^2-3n$.  That is, a smooth plane curve of degree $n$ has deficiency $\binom{n-1}{2}$.
%
%Now suppose the curve $C$ maps birationally to a curve $C_0$ which has a node at a point $p$; let $D$ again be a divisor of degree $d$, whose support we assume does not contain $p$. If we take our curve $B$ of degree $m$ to contain $D$ and also pass through the point $p$, then the residual intersection $E$ to $D+\nu^{-1}(p)$ on $C$ will consist of $mn-d-2$ points rather than $mn-d$. To construct the complete linear system $|D|$, we take curves of degree $m$ passing through this residual divisor $E$ and passing through $p$.
%
%Here we have a sort of ``two-for-one" deal: the curves of degree $m$ that cut out the linear series $|D|$ have to satisfy the one additional condition of passing through the node $p$; but the number of points of $E$ that these curves have to contain has been reduced by 2. The expected dimension of the linear series associated to $DS$ is thus
%$$
%h^0(\cO_C(D)) = \binom{m+2}{2} - (mn-d-2) -  \binom{m-n+2}{2} = d  - \binom{n-1}{2}.
%$$
%so the deficiency of the curve is $\binom{n-1}{2}-1$, or one less. More generally, if $C$ has $\delta$ nodes, we can get this two-for-one deal $\delta$ times, resulting in a deficiency of $\binom{n-1}{2} - \delta$, giving us an early version of the formula for the  geometric genus of a plane curves with nodes.
%
%What if $C$ has an ordinary triple point $p$? In this case, we can get a ``three-for-one" deal by requiring the curve $B$ of degree $m$ to pass through $p$. In this case the residual divisor $E$ will have degree 3 less; again, the curves of degree $m$ that cut out the linear series $|D|$ only have to satisfy the one additional condition of passing through $p$, so the apparent deficiency will be 2 less than for a smooth plane curve of degree $n$.
%
%But we can do even better! If we require our initial curve of degree $m$ to be double at $p$, that reduces the degree of the residual divisor $E$  by 6. Of course, now the curves $B$ of degree $m$ containing $E$ that cut our the linear system $|D|$  will have to be double at $p$ as well, but this is only 3 linear conditions, the vanishing at $p$ along with the vanishing of the first derivatives. In effect, we have gotten a ``six-for-three" deal, suggesting (correctly, as we know) that the presence of a triple point should reduce the deficiency by 3. 
%
%In general---for singularities beyond nodes or triple points---the adjoint ideal can be characterized as the largest ideal that gives the best ``deal" in this sense. 
%

\section{Exercises}

\begin{exercise}\label{gonality of smooth plane curve}
Let $C$ be a smooth plane curve of degree $d$. Show that $C$ admits a one-parameter family of maps $C \to \PP^1$ of degree $d-1$. Using the Riemann-Roch Theorem, show that $C$ does not admit a map $C \to \PP^1$ of degree $d-2$ or less.
\end{exercise}

In Exercise~\ref{gonality of smooth plane curve}, we saw how to use the description of the canonical series on a smooth plane curve to determine its gonality. Now that we have an analogous description of the canonical series on (the normalization of) a nodal plane curve, we can deduce a similar statement about the gonality of such a curve. Here are the first two cases: 

\begin{exercise}
Let $C_0$ be a plane curve of degree $d\geq 4$ with one node and no other singularities, and let $C$ be its normalization. Show that $C$ admits a unique map $C \to \PP^1$ of degree $d-2$, but does not admit a map $C \to \PP^1$ of degree $d-3$ or less.
\end{exercise}
\begin{exercise}\label{general case of divisors on nodal curves}
Suppose that $C$ is a smooth curve and $\nu: C \to C_0$ is a map to a plane curve with
only nodes as singularities and let $D = D_0-D_\infty$ be a divisor on $C$. Modify the 
technique of Section~ref{linear series on nodal plane curves} to compute the complete
linear series $|D|$ without assuming that $D$ is disjoint from the preimages of the singular
points. 
Hint: Be careful to subtract the right multiples of the points that are preimages of the singular
points.
\end{exercise}

\begin{exercise}
Let $C_0$ be a plane curve of degree $d\geq 5$ with two nodes and no other singularities, and let $C$ be its normalization. Show that $C$ admits two maps $C \to \PP^1$ of degree $d-2$, but does not admit a map $C \to \PP^1$ of degree $d-3$ or less.
\end{exercise}

\begin{exercise}
Generalizing some of the examples above, show that if a nodal plane curve of degree $d$ has $\delta\leq d+3$ nodes,
then its gonality is $d-2$, and moreover every $g^1_d$ on the curve is given by projection from one of the nodes.
You should make use of the following result from~\cite[p. 302]{MR1376653}:
\begin{proposition}
 A set of $n \leq 2d+ 2$ distinct
points fails to impose independent conditions on curves of degree
$d$ if and only if either $d + 2$ of the points  are collinear or $n = 2d + 2$ and all the points lie
on a conic.
\end{proposition} 
Hint: a $g^1_{d-2}$ is a set of points that, together with the nodes, impose dependent conditions on forms of degree $d-3$.
\end{exercise}

\begin{exercise}
Find the adjoint ideals of the following plane curve singularities:
\begin{enumerate}
\item a \emph{triple tacnode}: three smooth branches, pairwise simply tangent
\item a triple point with an infinitely near double point: three smooth branches, two of which are simply tangent, with the third transverse to both
\item a unibranch triple point, such as the zero locus of $y^3-x^4$
\end{enumerate}
\end{exercise}

Here is a  general description in case the individual branches of $C_0$ at $p$ are each smooth:

\begin{exercise}
Let $\nu : C \to C_0$ be the normalization of a plane curve $C_0$ and $p \in C_0$ a singular point. Denote the branches of $C_0$ at $p$ by $B_1,\dots,B_k$, and let $r_i$ be the point in $B_i$ lying over $p$. If the individual branches $B_i$ of $C_0$ at $p$ are each smooth, and we set
$$
m_i = \sum_{j \neq i} \mult_p(B_i \cdot B_j)
$$
then the adjoint ideal of $C_0$ at $p$ is the ideal of functions $g$ such that $\ord_{r_i}(\nu^*g) \geq m_i$.
(Hint: The computation can be done locally analytically. Let $R = \widehat{\sO_{C_0, p}}$ be the completion of the local ring
of $C_0$ at $r_i$. The integral closure is then the product of rings $R_i = \widehat{\sO_{B_i}} \cong k[[t_i]]$,
with $R_i = R/P_i$ as $P_j$ runs over the minimal primes of $R$. The multiplicity
$m_i$ is the colength of the ideal $\sum_{j\neq i}P_j \subset R$.
)
\end{exercise}

\begin{exercise}
Continuing the example of a plane curve with a triple point $p$, show that requiring our curve of degree $m$ to be triple at $p$ gives us a ``nine-for-six" deal---the same net effect as when we required our curve of degree $m$ to be double. (In general, an ideal contained in the adjoint ideal will work as well; the adjoint ideal is characterized as the largest ideal that works.)
\end{exercise}

\begin{exercise}
Now let $C \subset \PP^2$ be a plane curve with a tacnode at $p$. Show that by taking our curve of degree $m$ to pass through $p$ and be tangent to the branches of $C$ at $p$ we get a four-for-two deal; and that this is the best we can do, so that the effect of a tacnode is to drop the deficiency by 2.
\end{exercise}

%\fix{Joe will add a sequence of exercises on "infinitely near points"; culminate (?) with the theorem that $\delta$ can be computed in general as a sum of multiplicities of iterated blowups.}


\input{footer}