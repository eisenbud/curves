\input{header.tex}


\chapter{Hyperplane sections of a curve}\label{linear general position chapter}

One way to study a curve in $\PP^n$ is to use properties of its hyperplane sections. In this chapter, we will take up the question: if $C \subset \PP^n$ is a reduced, irreducible and nondegenerate curve, what can we say about the geometry of the points in the  hyperplane section $\Gamma = C \cap H$ of $C$, and what more can we say about a general hyperplane section?

In this chapter we prove and apply a result originally due to Castelnuovo, that every subset of $n$ points in a
general hyperplane section of $C$ spans the hyperplane; that is, any $n$ points of $\Gamma$ are linearly independent. This 
holds for smooth curves in arbitrary characteristic (but see Exercise~\ref{strange curves} for
interesting counterexamples of singular examples in positive characteristic). This is followed by a series of applications,
including the famous theorem of Castelnuovo bounding the genus of a curve in terms of its degree. Later in this
book (Sections~\ref{high degree ACM} and \ref{canonical ACM}) we will apply this result to prove that canonical curves and 
curves ``of high degree'' are arithmetically Cohen-Macaulay.

In the following chapter, we will explain and prove a still stronger general position result, which requires characteristic 0. We give applications to the irreducibility of fiber products, to the Hilbert functions of subsets of the
general hyperplane section, and to sums of linear series.

\section{Arbitrary hyperplane sections}

\begin{proposition}\label{arbitrary hyperplane}
If $X\subset \PP^r$ is a nondegenerate, reduced, irreducible variety, and $h$ is a linear form defining
the hyperplane $H$, then the natural
sequence
$$
0\to \sI_{X/\PP^r} \rTo^h \sI_{X/\PP^r}(1)\to \sI_{(H\cap X)/H}(1)\to 0.
$$
is exact, and the subscheme
$H\cap X$ spans $H$; that is, $H^0(\sI_{(H\cap X)/H}(1)) = 0$.
\end{proposition}

See Exercise~\ref{arbitrary hyperplane examples} for the necessity of the hypotheses
and Exercise~\ref{restriction of ideals} for a generalization. Note that
${H\cap X}$ could have embedded components of dimension $<\dim X -1$, though in the case where $X$ is a curve
this is obviously impossible. 

\begin{proof}
Because $X$ is reduced irreducible and nondegenerate,
$h$ is a nonzerodivisor modulo $\sI_{X/\PP^r}$. Thus, setting $\Gamma = {H\cap X}$ we have
we have 
$$
\begin{aligned}
\sI_{X/\PP^r}(1)/h\sI_{X/\PP^r} &= \sI_{X/\PP^r}(1)/((h)\cap\sI_{X/\PP^r})\\
 &=(\sI_{X/\PP^r}(1)+(h))/(h)\\
 &= \sI_{\Gamma/H}(1).
\end{aligned}
 $$
 From which the exactness assertion follows.
 
 Again because $X$ is reduced and irreducible, $H^0(\sO_X)$ contains only the constant function, so the map $H^0(\sO_{\PP^r}) \to H^0(\sO_X)$ is surjective, 
from which it follows that $H^1(\sI_{X/\PP^r}) = 0.$ From the long exact sequence in cohomology it follows that
 the restriction map $H^0(\sI_{X/\PP^r}(1))\to H^0(\sI_{\Gamma/H}(1))$ is surjective. Since
$X$ is nondegenerate, $H^0(\sI_{X/\PP^r}(1)) = 0$, and the desired result follows.
\end{proof}

\begin{fact}
Given any reduced scheme $X\subset \PP^r$, there are a finite number of subvarieties $\{X_i\subset X\}$ such that
$I_X +(h)$ is the saturated ideal of $X\cap H$ if and only if $H$ intersects each $X_i$ properly. Thus if $H$ is general
then $X\cap H$ has no embedded projective subvarieties (though the irrelevant ideal may be associated). 
This may be regarded as a version of Bertini's theorem. See for example~\cite{WMACE}.
\end{fact}



Note that the sequence of saturated homogeneous ideals corresponding to that of the proposition may not be exact: 
The homogeneous ideal $I_X(1)+(h)$
defines $X\cap H$, but may be properly contained in the saturated ideal of $X\cap H$. See Exercise~\ref{bad restriction} for an example. 


\section{Linear general position}
In this section we will allow our algebraically closed ground field to have arbitrary characteristic. 

An irreducible and reduced curve
$C\subset \PP^n$ over an algebraically closed field $k$, other than a line, is called \emph{strange} if
all the tangent lines at smooth points of $C$ meet in a point $p\in \PP^n$. If this condition seems somewhat, well, strange, that may be because no such curves exist in characteristic 0: if it were the case that all the tangent lines at smooth points of $C$ met in a point, then the projection of $C$ from that point would have derivative 0 everywhere and hence be constant. But strange curves do exist in characteristic $p > 0$, albeit rarely: Pierre Samuel showed that the only \emph{smooth} curve that is strange (in any characteristic) is the conic in characteristic 2; a proof is given in \cite[Theorem IV.3.9]{Hartshorne1977}. Without the smoothness hypothesis, however there are other examples; see Exercise~\ref{strange curves}.

Given this language, we can state our first result. Recall that if $C\subset \PP^n$ is a reduced curve then, by Bertini's theorem, a general hyperplane
section of $C$ consists of smooth points. 

\begin{theorem} \label{basic linear independence}(\cite[Lemma 1.1]{Rathmann})\label{linear general position}
Suppose that $n\geq 3$. If $C\subset \PP^n$ is a nondegenerate irreducible, reduced curve, that is not strange
and $H$ is a general hyperplane, then any $n$ points of $H\cap C$ are
linearly independent.
\end{theorem}

For example, the theorem says that for $C \subset \PP^3$, the general hyperplane section does not contain a line
that meets $C$ 3 or more times---a \emph{multisecant}. Another special configuration which is not present in a general hyperplane section, as it turns out,
is any pair of points $p\neq q$ on $C$ such that the the tangent lines $T_p(C), T_q(C)$ to $C$ at $p$ and $q$ intersect---what was classically
called a \emph{stationary secant}. More formally we define two subsets of the symmetric square $C_2$ of $C$:
$$
\begin{aligned}
 mult(C) &:=\{(p,q) \in C_2 \mid \overline{p,q} \hbox{ meets $C$ in a scheme of length $\geq 3$}\};\\
stat(C) &:= \{(p,q) \in C_2\setminus \Delta \mid  \hbox{the tangent lines to $C$ at $p,q$ have nonempty intersection}\},
\end{aligned}
$$
where $\overline{p,q}$ denotes the secant line through $p,q$ (or the tangent line if $p=q$) and $\Delta\subset C_2$
is the diagonal.
Clearly if $C$ is strange or planar then $stat(C) = C_2$. If $C$ is planar with $\deg C>2$ then $mult(C) = C_2$ as well.
It turns out that these are the only cases:

\begin{proposition}\label{mult and stat}
 If $C\subset \PP^n$ is a reduced, irreducible, curve that is neither planar nor strange, then $mult(C)\subset C_2$
 and $stat(C)\subset C_2\setminus \Delta$ are closed subsets of dimension $\leq 1$.
\end{proposition}

\begin{proof}
To show that $mult(C)$ is closed, consider the projection to the first factor, 
$$
\{((p,q), r) \in C_2\times \PP^n \mid r \in \overline{p,q}\} \to C_2 : ((p,q),r)\mapsto (p,q).
$$
By the semicontinuity of the degree of fiber dimension, the set of points lying in fibers
of length $\geq 3$ is closed, and $mult(C)$ is the image of this set. Because the map is finite, 
$mult(C)$  is closed as well.

Similarly since 
$$
\{((p,q), r) \in (C_2\setminus \Delta)\times \PP^n \mid r \in T_p(C)\cup T_q(C) \}
$$
is closed in $(C_2\setminus \Delta)\times \PP^n$, its image under the projection to the first factor,
which is $stat(C)$, is closed in $C_2\setminus \Delta$

Suppose, contrary to the Proposition, that $\dim stat(C) >1$. Since $stat(C)$ is a closed subset of the irreducible variety $C_2\setminus \Delta$ it
follows that $stat(C) = C_2\setminus \Delta$, so every pair of tangent lines meet. Any three
lines in projective space that meet pairwise must be either coplanar or meet in a point. Thus if $C$ is not strange,
then all the tangents to $C$ lie in a common plane, and $C$ is planar, contradicting our hypothesis
and proving that $\dim stat(C)\leq 1$.

Finally suppose, contrary to the Proposition,  that $\dim mult(C)>1$. As in the previous argument, this
implies that every secant is a multisecant.  We will show in this case that $\dim stat(C) =2$, a contradiction. 

To this end, consider the set  $I \subset   C^3$ consisting of those triples $(p,r,r')$ of distinct points 
such that $\pi_p(r) = \pi_p(r')$ is a smooth point of $\pi_p(C)$,
where $\pi_p$ denotes the projection of $C$ from $p$.

The tangent lines $T_r(C)$ and $T_{r'}(C)$ both project from $p$ to the tangent line $T_{\pi_p(r)}(\pi_C)$,
and thus they lie in the 2-plane spanned by $p$ and this line; it follows that $(r,r') \in stat(C)$.
The projection $I \to C_2: (p,r,r') \mapsto (r,r')$ is finite since the secant line $\overline{r,r'}$ meets $C$ in only finitely many points, 
so $\dim I \leq \dim stat(C)$.

 If the projection from some point $p$ were everywhere ramified,
then all tangents to $C$ would pass through $p$, and $C$ would be strange.
Since also every secant to $C$ is a multisecant it follows that  for every smooth point $p\in C$ there is an open set of points $q\in \pi_p(C)$ such that
the fiber $\pi_p^{-1}(q)$ contains two distinct points of $C$. Thus the projection $I \to C: (p,r,r') \mapsto p$ maps
$I$ onto an open set of $C$, with 1-dimensional fibers, so $2 = \dim I\leq \dim stat(C)$ as claimed. \end{proof}


\begin{proof}[Proof of Theorem~\ref{linear general position}]
First suppose that $n=3$, and consider the incidence correspondence
$$
I := \{ ((p,q), H) \in mult(C) \times \PP^{3*} \mid \overline{p,q}\in H\}.
$$
Since $\dim \overline{p,q} = 1$, the fibers of the projection of $I$ to $mult(C)$ have dimension 1,
so $\dim I = 1+\dim mult(C)  \leq 2$. Consequently the image of  the projection of $I$ to $\PP^{3*}$ has
dimension $\leq 2$, so there is an open set of planes that contain no multisecants, proving the Theorem in this case.

We next do induction on $n\geq 4$.We will show first that the image $C$ of
$C$ under the projection $\pi_p: C\to C'$ from a general point of $C$ is not strange. Since $C\subset \PP^n$ is neither
planar nor strange
Proposition~\ref{mult and stat} shows that we may choose two smooth points
$r,r'\in C\subset \PP^n$ such that $T_r(C)\cap T_{r'}(C) = \emptyset$, and thus 
$T_r(C)$ and $T_{r'}(C)$ together span a 3-plane $L$. Since $C$ is nondegenerate we may
choose a point $p\in C$ outside $L$, and it follows that $\pi_p$ restricted to $L$ is an isomorphism.
Thus $T_{\pi_p(r)}(C') \cap T_{\pi_p({r'})}(C') = \emptyset$, so $C'$ is not strange, 
and since $n\geq 4$ the curve $C'$ is not planar either.

Arguing by contradiction, suppose that the general hyperplane section of $C$ contains a set of $n$ linearly dependent points. Consider the closed subsets  
$$
I_1 \subset I \subset \{(p,H) \in C \times \PP^{n*}\}
$$
where I is defined by the conditions that $p\in H$ and $I_1$ is defined by the condition that, in addition, there exist $p_2,\dots, p_n\in H$
such that $p, p_2, \dots, p_n$ are dependent. Both $I_1$ and $I$ are closed subsets.

By hypothesis, both $I_1$ and $I$ project onto open sets of $\PP^{n*}$, so they have the same dimension.
But $I$ is irreducible: it projects onto an open subset of $C$ with fibers isomorphic to $\PP^{n-1}$. Thus $I_1 = I$,
and  $p$ is part of a dependent set
$\{p, p_2,\dots, p_n\}$ in a general hyperplane containing $p$.

Let $H'$ be a general hyperplane in $\PP^{n-1}$
and let $H = \pi_p^{-1}(H')$, which is a general hyperplane containing $p$. The intersection $H\cap C$
contains $n$ dependent points $\{p, p_2,\dots, p_n\}$, and it follows that $\pi_p(p_2),\dots \pi_p(p_n)$
are dependent points of $H'\cap C'$. This contradicts the induction hypothesis, and proves that
the general hyperplane section of $C$ is in linearly general position.
\end{proof}
 
 
\section{Applications of linear general position}

\subsection{Existence of good projections}\label{projection section}\label{good projections}

We can use Theorem~\ref{basic linear independence} to show that every smooth curve $C$ is birational to a nodal plane curve $C_0 \subset \PP^2$, in many ways.

\begin{proposition}\label{nodal projection}
If $C \subset \PP^n$ is a smooth nondegenerate curve in projective space, let $\Lambda \cong \PP^{k} \subset \PP^n$ be a general $k$-plane, and let
$\pi_\Lambda$ be the projection from $\Lambda$, restricted to $C$. If $n\geq 4$ and $k=n-4$,then
$\pi_\Lambda: C \to \PP^3$ defines an isomorphism of $C$ onto its image, while if $n\geq 3$ then $\pi_\Lambda$ is birational onto its image, which is a curve with only ordinary nodes.
\end{proposition}

\begin{proof} Recall that the secant variety of $C$ consists of the union of the lines $\overline{q,r}$ joining pairs of distinct points $q,r \in C$, plus the tangent lines ${\mathbb T}_q(C)$; altogether, these lines form a family, parametrized by the symmetric square $C^{(2)}$ of $C$. More precisely every subscheme $\lambda$ of
length 2 in $\PP^n$ spans a line $\overline \lambda$. The incidence variety
$$
I:=\{(\lambda, p)\mid \lambda\in C^{(2)} \hbox{ is a divisor of degree 2 on }C,\ p\in \overline \lambda\subset\PP^n\}
$$
projects to $C^{(2)}$ with 1-dimensional fibers isomorphic to $\PP^1$, and thus
is irreducible of dimension 3. Its image in $\PP^n$ under the second projection
is the secant variety of $C$, which is thus irreducible of dimension $\leq 3$.
It follows that a general
$n-4$-plane does not meet the secant variety, and the first statement of the Proposition follows.

If $n>3$ then by first projecting from a general $n-4$-plane inside $\Lambda$ we may reduce to the case $n=3$, and assume that $\Lambda$ is a general point of $\PP^3$. By a variant of the argument above, the union 
of the tangent lines to $C$ is a surface, and thus does not contain $\Lambda$.
It follows that $\pi_\Lambda$ is locally an analytic isomorphism.

To show that the fibers of $\pi_\Lambda$ are subschemes of length at most 2,
we need to show that $\Lambda$ does not lie on any multisecant line. 

By Theorem~\ref{basic linear independence} the family of multisecant lines to $C$ is a proper subscheme of the irreducible two-dimensional family of secant lines, so the union of the trisecant lines is at most 2 dimensional, and we see that the fibers of $\pi_\Lambda$ all have degree $\leq 2$. Furthermore, the general fiber of the projection
from the incidence correspondence $I$ to $\PP^3$ is empty or finite, so only a finite number of secant lines will contain $\Lambda$, and we see that $\pi_\Lambda$ is birational. 

We have shown that the map $\pi_\Lambda$ is an immersion, and at most two-to-one everywhere; thus the image curve $C_0 \subset \PP^2$ will have at most double points, and an analytic neighborhood of each double point will consist of two smooth branches. To complete the proof of Proposition~\ref{nodal projection} we have to show that those two branches have distinct tangent lines; that is, that
if $q, r \in C$ are any two points collinear with $\Lambda$, then the images of the tangent lines ${\mathbb T}_q(C)$ and ${\mathbb T}_r(C)$ in $\PP^2$ are distinct. But if  $\pi_p({\mathbb T}_q(C)) = \pi_p({\mathbb T}_r(C))$ then  ${\mathbb T}_q(C)$ and ${\mathbb T}_r(C)$ lie in a plane, and thus intersect.

Since the family of all secant lines is irreducible of dimension 2,  it will suffice to show that not every secant line to $C$ is a stationary secant or, equivalently, that not every pair of tangent lines to $C$ meet. We saw in Lemma~\ref{incident tangents} that in the contrary case the curve $C$ would be either strange or planar, a contradiction.
\end{proof}


\subsection{The case of equality in Martens' theorem}

Theorem~\ref{basic linear independence}  allows us to analyze the case of equality in Martens' theorem bounding the dimension of the variety $W^r_d(C)$ parametrizing divisor classes of degree $d$ on a curve $C$ with $r(D) \geq r$
(Theorem~\ref{Martens' inequality}.
To start, recall the statement:

\begin{theorem}(Martens)\label{full Martens}
If $C$ is any smooth projective curve of genus $g$, then for any $r>d-g$ we have
$$
\dim W^r_d(C) \leq d-2r.
$$
Equality holds iff either $C$ is hyperelliptic
or $d=r=0$ or $d=2g-2, r=g-1$; in either of the last two cases $W^r_d$ is
a single point.
\end{theorem}

Note that the inequality $\dim W^r_d(C) \leq d-2r$ is equivalent to the inequality $\dim C^r_d \; \leq \; d-r$, which is what we actually showed in Chapter~\ref{new Jacobians chapter}. This in turn followed by combining the geometric form of Riemann-Roch with an elementary bound on the dimension of the variety of secant planes to a curve in projective space.

Theorem~\ref{basic linear independence} allows us to do exactly one better: 

\begin{lemma}(strong secant plane lemma)\label{Strong secant plane lemma}
Let $C \subset \PP^n$ be a smooth, irreducible and nondegenerate curve. If we denote by $\Sigma^r_d \subset C_d$ the locus of effective divisors $D$ of degree $d$ on $C$ with $\dim \overline D \leq d-r-1$, then for any $d \leq n$ and $r > 0$,
$$
\dim \Sigma^r_d \leq d-r-1.
$$
\end{lemma}

\begin{proof}
Consider the incidence correspondence: 
$$
\Gamma := \left\{ (D, H) \in \Sigma^r_d\times {\PP^n}^* \mid \overline D \subset H \right\}.
$$
The curve being nondegenerate, the projection map $\Gamma \to  {\PP^n}^*$ is finite. But the fibers of $\Gamma$ over $\Sigma^r_d$ have dimension at least $n-d+r$; if we had $\dim \Sigma^r_d \geq d-r$, it would follow that $\dim \Gamma \geq n$, and hence that the projection map $\Gamma \to  {\PP^n}^*$ is dominant---contradicting Theorem~\ref{basic linear independence}.
\end{proof}

\begin{proof}[Proof of the case of equality in Martens theorem]
 Now, if a curve $C$ is non-hyperelliptic, we can apply the strong secant plane lemma to the canonical curve. Except for the trivial cases $d=r=0$ and $d=2g-2, r=g-1$,
 we can apply Lemma~\ref{Strong secan plane lemma} to conclude that $\dim W^r_d(C) \leq d-2r-1$; it follows that if we have $\dim W^r_d(C) = d-2r$ the curve $C$ in question must be hyperelliptic.
\end{proof}

Using the case of equality in Martens' Theorem, we can analyze equality in 
Clifford's Theorem:

\begin{corollary}\label{equality in Clifford from Martens}
If $C$ is a smooth curve of genus $g$ and $D$ a divisor on $C$ of degree $\leq 2g-2$,
such that $\deg D = 2r(D)$, then either $D =0$ or $D=K_C$ or $C$ is hyperelliptic.
\end{corollary}

\begin{proof}
If $C$ has a divisor $D$ with $\deg D =2 r(D)$ then by the Riemann-Roch theorem,  $\deg D  = 2(\deg D-g+h^1(D))$, 
so $\deg D = 2g-2h^1(D)$. If also $\deg D\leq 2g-2$, then $h^1(D) \geq 1$
and thus $r(D) >\deg D-g$. Since $W^{r(D)}_{\deg D}$ contains $D$ its dimension
is $\geq 0$, and we have a case of equality in Martens' theorem.
\end{proof}


\subsection{The $g+2$ theorem}\label{g+2 section}

Now that we have the strong form of Martens' theorem, we can prove the analogue of Theorem~\ref{g+3 theorem} for general linear series of degree $g+2$. This was stated in Section~\ref{g+3 section}, but we'll reproduce the statement here.

\begin{theorem}
Let $C$ be any smooth projective curve of genus $g$, and let $D$ be a general divisor of degree $g+2$ on $C$. 
The complete linear series $|D|$ is base-point free of dimension 2, and thus defines a map $\phi_D: C\to \PP^2$
which is birational onto its image $C_0$. Moreover, no two branches of $C_0$ share a tangent line. Furthermore,

\begin{enumerate}
\item If $C$ is nonhyperelliptic, then $C_0$ has only $\binom{g}{2}$ ordinary nodes and no other singularities; and
\item If $C$ is hyperelliptic,  $C_0$ has only one singular point, which is an ordinary $g$-fold point.\end{enumerate}
\end{theorem}

\begin{proof}
\begin{itemize}
\item (Dimension) Since $D$ is general, its points span $\PP^{g-1}$,
so $D$ is nonspecial, whence $h^0(D) = (g+2)-g+1 = 3.$

\item (No base points) If $|D|$ had a base point $p\in C$, then $3=h^0(D) = h^0(D-p) = (g+1)-g+1+h^0(K_C-D+p)$,
so $K_C-D$ is effective of degree $2g-2-(g+1) =g-3$; thus the family of such $D$ depends on only $g-3+1$ parameters,
and $\mu(D)$ would lie in a proper subvariety of $Pic_{g+2}(C).$

\item (Birationality)
 To say that $\phi_D(p) = \phi_D(q)$ for some pair of points $p, q \in C$   means that $h^0(D-p-q) = 2$. By the Riemann-Roch
 theorem, $D-p-q = K-E$ for some effective divisor $E$ of degree $g-2$; Thus $\sO_C(D)$ is in the image of the map
$$
\nu : C_2 \times C_{g-2} \to \Pic_{g+2}(C)
$$
sending $(p+q, E)$ to $K_C - E + p + q$. 

The map $\nu$ is 
the composition of two surjective maps, $C_2 \times C_{g-2} \to C_g$ and $C_g\to Pic_g \to Pic_{g+2}$ by duality. Since the source and target of $\nu$ have the same dimension, the general fiber of $\nu$ is finite. Thus for general $D$ we  there are only finitely many pairs $p, q \in C$ such that $\phi_D(p) = \phi_D(q)$; it follows that $\phi_D$ is birational onto its image.


\item (Tacnodes):  To say that a pair of points $p, q \in C$ map to a point of $C_0$ such that the 
two branches have a common tangent means two things: that $h^0(D-p-q) \geq 2$; and that $h^0(D-2p-2q) \geq 1$. If this is the case, set $E = D - 2p - 2q$.  The condition $h^0(D-2p-2q) \geq 1$ is equivalent to  $E$ being an effective divisor. Considering the canonical map $\phi_K: C\to \PP^{g-1}$ 
the geometric Riemann-Roch Theorem $r(E) = \deg E -1-\dim\overline{\phi_K(E)}$ implies that $\overline {\phi_K(E)}$ has dimension $g-3$. The additional condition $h^0(D-p-q) \geq 2$ says that $\dim\overline{\phi_K(E+p+q)} = g-2$,
so the secant line $\overline{p,q}$ meets the $g-3$-plane $\overline{\phi_K(E)}$. Now, not every secant line to $C$ can meet a given linear subspace $\Lambda \subset \PP^{g-1}$ of dimension $g-3$--- otherwise, the projection $\pi_\Lambda : C \to \PP^1$ would be constant---so we see that $\mu(D)$ would have to lie on the image of a proper subvariety of $C_{g-2} \times C_2$ under the map $(E, p+q) \mapsto \sO(E+2p+2q)$ from $C_g-2 \times C_2$ to $Pic_{g+2}(C)$;
Since the dimension of this subvariety is $<g$ we see that if $C'$ has
a point at which two branches are tangent, then $\sO_C(D)$ lies in a proper subvariety of $\Pic_{g+2}(C)$. Since
the Abel-Jacobi map $C_{g+2} \to Pic_{g+2}(C)$ is surjective,
 $D$ would not be general. 
 

Let's now suppose that $C$ is non-hyperelliptic and $D$ is a general divisor of degree $g+2$ on $C$. To prove the theorem in this case, we have to show  three things: that the image $C_0 = \phi_D(C)$ does not have cusps or triple points.

\item (No cusps) To say that a point $p \in C$ maps to a cusp of $C_0$ (that is, the differential $d\phi_D$ is zero at $p$) amounts to saying that $h^0(D-2p) \geq 2$; that is, $D-2p$ is a $g^1_g$. But by Riemann-Roch, $W^1_g = K_C - W_{g-2}$; so to say $\phi_D$ has a cusp means that
$$
\mu(D) \in 2W_1 + K_C - W_{g-2},
$$
and since the locus on the right has dimension at most $g-1$, a general point of $J(C)$ will not lie in it. Note that this subsumes the fact that $|D|$ has no base points.

\item (no Triple points) To say that $C_0$ has a triple point means that for some divisor $E = p+q+r$ of degree 3, $h^0(D-E) \geq 1$; thus we must have 
$$
\mu(D) \in W_3 + W^1_{g-1}
$$
Now, to argue that this is not the case, we need to know that $\dim W^1_{g-1} \leq g-4$. Here we have to invoke Marten's theorem, which says that $\dim W^1_{g-1} \leq g-4$ if $C$ is non-hyperelliptic; given this, we conclude that $C_0$ has no triple points.


Thus, in the non-hyperelliptic case, the image curve $C_0 = \phi_D(C)$ has only nodes as singularities; the fact that there are exactly $\binom{g}{2}$ of them follows from the genus formula.
\end{itemize}

\noindent This concludes the proof in the non-hyperelliptic case. Now suppose that $C$ is hyperelliptic, and let $|E|$ be the  $g^1_2$ on $C$. If  $D$ is any divisor of degree $g+2$, the divisor $D - E$ will have degree $g$, and so be effective; thus we can write
$$
D \sim E + p_1 + \dots + p_g
$$
for some $g$-tuple of points $p_i$. If the divisor $D$ is general, the points $p_i$ will be general as well, and in particular distinct.

Now, the fact that
$$
h^0(D - p_1 - \dots - p_g) = h^0(E) = 2 = h^0(D) - 1
$$
implies that $\phi_D$ maps all the points $p_i$ to the same point. The image curve $C_0$ thus has a point with at least $g$ branches. Since these branches cannot share a tangent line,
they are smooth and their tangents are distinct; that is, the point is an ordinary multiple point. By the adjunction
formula $p_a(C) = binomial{g+1}{2}$ and since $C$ has genus $g$ the singularity must have $\delta$ invariant
$binom{g+1}{2} -g = \binom{g}{2}$. Such a singularity cannot have multiplicity $>g$, and is thus an ordinary $g$-fold point. Since the $\delta$-invariant of such a point is $\binom{g}{2}$ by Proposition~\ref{effect of blowup on genus}.
\end{proof}





\subsection{Castelnuovo's theorem}

Clifford's theorem gives a complete and sharp answer to the question, ``what linear series can exist on a curve of genus $g$?
But maybe that wasn't the question we meant to ask! After all, we're interested in describing curves in projective space as images of abstract curves $C$ under maps given by linear systems on $C$. Observing that the linear series that achieve equality in Clifford's theorem give maps to $\PP^r$ that are 2 to 1 onto a rational curve, we might hope that we would have a different---and more meaningful---answer if we  restrict our attention to linear series $\cD = (\cL,V)$ for which the associated map $\phi_\cD$ is at least  birational. 

A classical result of Castelnuovo gives a sharp bound on the genus of a curve in terms of its degree. For positive integers $d$ and $r$, let $M := M(d,r) := \lfloor(d-1)/(r-1)\rfloor$, so that
$$
 d -1 = M(r-1) + \epsilon \quad \text{ for some $\epsilon = \epsilon(d,r)$ with }0 \leq \epsilon \leq r-2. 
$$

\begin{theorem}[Castelnuovo's bound]\label{Castelnuovo's bound}
If $C \subset \PP^r$ is a reduced, irreducible, nondegenerate curve of degree $d$ then, with $M$ and $\epsilon$
as above,
$$
p_a(C) \leq \pi(d,r) := \frac{M(M-1)}{2}(r-1) + M\epsilon.
$$
\end{theorem}

To prove this result we will estimate the dimension of $h^0(\sO_C(m))$, and connect this with the 
arithmetic genus using Theorem~\ref{general RR without duality}, the Riemann-Roch theorem for integral curves
in the easy version $h^0(\sO_C(m)) = m\deg \sO_C(1) + \chi(\sO_C)$ for sufficiently large $m$; this version
does not require duality, and (as noted in Chapter~\ref{RR}) its proof requires nothing more than the additivity
of the Euler characteristic. 

We will say that a curve achieving the bound is a \emph{Castelnuovo curve}. We will see in Chapter~\ref{ScrollsChapter} that the bound is sharp: for every $r$ and $d \geq r$, there exist curves with genus exactly $\pi(d,r)$. 

\begin{example}
For plane curves, $r=2, M = d-1, \ \epsilon = 0,$ so we recover the necessary $p = \pi(d,2) =  {d-1\choose 2}$. Thus every reduced irreducible
plane curve is a Castelnuovo curve.
\end{example}

\begin{example}If $r=3$ then
$$
\pi(d,3) = \lfloor d^2/4 \rfloor-d+1 = \lfloor (d-2)^2/4\rfloor\, .
$$
It is easy to check that curves on a smooth quadric surface in each of the classes
$(d/2, d/2)$ or $((d-1)/2, (d+1)/2)$
achieve this bound, and a variant of this works for singular quadrics as well. The classification  explained in Chapter~\ref{ScrollsChapter}
shows that these are the only Castelnuovo curves in $\PP^3$.
\end{example}

\begin{fact}
A famous theorem of Gruson and Peskine~\ref{Gruson-Peskine} (see \ref{Hartshorne-report} for an exposition and also the cases of characteristic $>0$ and small fields) completes the picture of the possibilities for the degree $d$ and  genus $g$  of a smooth curve in $\PP^3$. If the curve does not lie on a plane or a quadric, then the genus satisfies the stronger inequality
$$
g\leq \pi_1(d,3) := \frac{d^2-3d}{6} +1
$$
and smooth curves with all such degree and genus exist; they can all be realized as curves
on cubic or quartic surfaces.

Note that there can be gaps in the possible genera of curves a given degree: for example  $\pi_1(9,3) = 10<\pi(9,3) =12$ but there is
no curve of degree 9 and genus 11. 
The full range of possible degrees and genera for curves in $\PP^n$ remains open for larger $n$. 
\end{fact}

To prove Theorem~\ref{Castelnuovo's bound}, we will give lower bounds for the dimensions of the linear series  cut on an integral projective curve $C$ by hypersurfaces of degree $m$. For large values of $m$ the line bundle $\cO_C(m)$ is non-special and $H^1(\sI_{C/\PP^r}(m)) = 0$. We will then apply the Riemann-Roch theorem to deduce the bound.

For the proof, the following definition will be convenient:

\begin{definition}
If $\sV = (V,\cL)$ is a linear system on a variety $X$ and $\Gamma$ is a subscheme then the \emph{number of conditions
imposed by $\Gamma$ on $\sV$} is the dimension of the image of $V$ in $H^0(\sL\mid_\Gamma) = H^0(\sL \otimes \sO_\Gamma)$; or, numerically,
$$
\dim(V) - \dim \left(V \cap H^0(\cL\otimes \cI_{\Gamma/X}) \right).
$$\end{definition}

Thus, for example, if $\Gamma \subset \PP^r$, then the number of conditions imposed by $\Gamma$ on $H^0(\cO_{\PP^r}(m))$ is the value $h_\Gamma(m)$ of the Hilbert function of $\Gamma$ at $m$.
Note that the number of conditions imposed by $\Gamma$ on a linear system $V$ is necessarily less than or equal to the degree $d$ of $\Gamma$; if it is equal we say that $\Gamma$ \emph{imposes independent conditions on $V$}.

\begin{proof}[Proof of Theorem~\ref{Castelnuovo's bound}]
Suppose that $C \subset \PP^r$ is an irreducible, nondegenerate curve, and let $\Gamma = C \cap H$ be a general hyperplane section of $C$. Let $V_m \subset H^0(\cO_C(m))$ be the linear series cut on $C$ by hypersurfaces of degree $m$ in $\PP^r$, that is, the image of the restriction map
$$
H^0(\cO_{\PP^r}(m)) \to H^0(\cO_C(m)).
$$
Since the ideal sheaf of the hyperplane section is $\cI_{\Gamma/C} = \sO_C(-1)$ we have:
\begin{align*}
h^0(\cO_C(m)) - h^0(\cO_C(m-1)) & = \text{\# of conditions imposed by $\Gamma$ on $H^0(\cO_C(m))$} \\
&\geq \text{\# of conditions imposed by $\Gamma$ on $V_m$} \\
&= \text{\# of conditions imposed by $\Gamma$ on $H^0(\cO_{\PP^r}(m))$} \\
&= h_\Gamma(m).
\end{align*}
Summing these relations, we see that the dimension $h^0(\cO_C(m))$ is bounded below by
$$
h^0(\cO_C(m)) \geq \sum_{k=0}^m h_\Gamma(k).
$$

Thus, in order to bound the genus $C$ from above, we have to bound the Hilbert function of its hyperplane section $\Gamma$  from below; and for this, we need to know something about the geometry of $\Gamma$. In fact, all we need to know is Lemma~\ref{general position lemma}, which says that the points of $\Gamma$ are in linear general position! The key fact is the

\begin{proposition}\label{min hilb}
If $\Gamma \subset \PP^n$ is a collection of $d$ points in linearly general position that span $\PP^n$, then 
$$
h_\Gamma(m) \geq 
\begin{cases}
&mn+1\hbox{ if $m\leq M(d,n+1)$}\\
&d \hbox{ otherwise.}
\end{cases}
$$
\end{proposition}

One way to understand the bound $mn+1$ is to realize that if $\Gamma$ is any finite subscheme of a rational normal curve $C\subset\PP^n$ of degree $n$, 
then $h_\Gamma(m) = \min\{\deg \Gamma, mn+1\}$ for every $m$ (Exercise~\ref{linear bound is sharp}).
  Thus the bound in Proposition~\ref{min hilb} is best possible.
On the other hand, sets of points on a rational normal curve are almost the only sets for which the bound is sharp.


\begin{proof}
Suppose first that $d \geq mn+1$, and let $p_1,\dots,p_{mn+1} \in \Gamma$ be any subset of $mn+1$ points. It suffices to show that $\Gamma' = \{p_1,\dots,p_{mn+1}\}$ imposes independent conditions of $H^0(\cO_{\PP^n}(m))$, that is, for any $p_i \in \Gamma'$ there is a hypersurface $X \subset \PP^n$ of degree $m$ containing all the points $p_1,\dots, \hat{p_i},\dots,p_{mn+1}$ but not containing $p_i$.

To construct such an $X$, group the $mn$ points of $\Gamma' \setminus \{p_i\}$ into $m$ subsets $\Gamma_k$ of cardinality $n$; each set $\Gamma_k$ will span a hyperplane $H_k \subset \PP^n$, and we can take $X = H_1 \cup \dots \cup H_m$. 

In the case where $d<mn+1$, we add $mn+1-d$ general points; each one imposes exactly one
additional condition on hypersurfaces of degree $m$.
\end{proof}

\begin{fact}
If $d \geq 2n+3$, then any collection of $d$ points in $\PP^n$ in linearly general position with Hilbert function $h_\Gamma(2) = 2n+1$ must lie on a rational normal curve. See~\cite[Lemma 3.9]{MR685427} for a proof.
 This is a key ingredient in Castelnuovo's theorem characterizing curves of maximal genus as
those lying in certain divisor classes on rational normal scrolls.
We'll see how it's applied in Chapter~\ref{ScrollsChapter}.
\end{fact}


To complete the proof of Theorem~\ref{Castelnuovo's bound} all that remains is to add up the lower bounds in the proposition. To this end, let $C \subset \PP^r$ be as above an irreducible, nondegenerate curve of degree $d$, and again set 
$M = M(d,r) = \lfloor{\frac{d-1}{r-1}}\rfloor$.
We have 
\begin{align*}
h^0(\cO_C(M)) &\geq \sum_{k=0}^M h^0(\cO_C(k)) - h^0(\cO_C(k-1)) \\
&\geq  \sum_{k=0}^M (k(r-1)+1) \\
&= \frac{M(M+1)}{2}(r-1) + M + 1
\end{align*}
and similarly
$$
h^0(\cO_C(M+m)) \geq \frac{M(M+1)}{2}(r-1) + M  + md.+ 1
$$
For sufficiently large $m$, the line bundle $\cO_C(M+m)$ will be nonspecial, so by the Riemann-Roch Theorem,
\begin{align*}
g &= (M+m)d - h^0(\cO_C(M+m)) + 1 \\
&\leq (M+m)d - \bigl(  \frac{M(M+1)}{2}(r-1) + M + 1 + md \bigr)+1 \\
& = M\bigl( M(r-1) + 1 + \epsilon \bigr) - \bigl(  \frac{M(M+1)}{2}(r-1) + M  \bigr) \\
&= \frac{M(M-1)}{2}(r-1) + M\epsilon.
\end{align*}
 \end{proof}

From the proof we see that if  $C\subset \PP^r$ is a curve whose degree and genus achieve equality, then all the inequalities in the proof
must be equalities; in particular, the map $H^0(\sO_{\PP^r}(d)) \to H^0(\sO_C(d))$ is surjective for every $d$ so, as we'll explain
in Chapter~\ref{linkage}, the curve is arithmetically Cohen-Macaulay.


\section{Exercises}

\begin{exercise}\label{arbitrary hyperplane examples}
Let $C_1$ be the union of two skew lines in $\PP^3$, and let $C_2$ be the double line on a smooth quadric in $\PP^3$.
Show that there are hyperplane sections of $C_1$ and of $C_2$ that violate the conclusion of Proposition~\ref{arbitrary hyperplane}.
\end{exercise}

\begin{exercise}\label{restriction of ideals}
Suppose that $X\subset \PP^r$ is a subscheme and  $Z$ is the subscheme of $\PP^r$ defined by a hypersurface $F\in H^0(\sO_{\PP^r}(m)$. If the restriction of $F$ is a nonzerodivisor in $\sO_X(m)$  then there are short exact sequences
$\sI_X(d-m) \rTo^F \sI_X(m) \rTo \sI_{X\cap Z}(m) \to 0$.
\end{exercise}

\begin{exercise}\label{bad restriction}
Let $C\subset \PP^3$ be the smooth rational quartic (or any smooth curve embedded by an incomplete linear series), and let $h$ be a linear form defining the hyperplane $H$.Show that
the the irrelevant ideal is associated to the 
homogeneous ideal $I_C+(h)$, and thus $I_C(1)/hI_c$ is not the saturated homogeneous ideal of the finite
set $C\cap H$. 
\end{exercise}

\begin{exercise}
Let $C\subset \PP^n$ be a smooth curve. If we re-embed $C$ by a Veronese map of sufficiently high degree---that is, we let $\nu_m : \PP^n \to \PP^N$ be the $m$th Veronese map, and let $\widetilde C = \nu_m(C)$ be image of $C$. Prove:

\begin{proposition}[Proposition~\ref{nodal projection} in characteristic $p$]\label{positive characteristic nodes}
The projection of $\widetilde C$ from a general $\PP^{N-3}$ is a nodal plane curve.
\end{proposition}

Hint: show that the items of~\ref{needed for nodes}  are true in this situation.
\end{exercise}

\begin{exercise}
\fix{the language of linear series on a smooth curve cut out by series on the singular model is introduced in genus 6 chapter. Could move this there; or define the terms in ch 1 or 3 and move this to ch 3}
\fix{This exercise seems to have been connected to some piece of the text. Reconnect it!}
Let $C_0$ be a plane quartic curve with two nodes $q_1, q_2$; let $\nu : C \to C_0$ be its normalization, and let $o \in C$ be any point not lying over a node of $C_0$.
By the genus formula, $C$ has genus 1. Using the construction above, describe the group law on $C$ with $o$ as origin.
\end{exercise}

\begin{exercise}\label{strange curves} \cite{Rathmann}. Let $k$ be an algebraically closed field of characteristic $p>0$, and let $q=p^e$ for some $e\geq 1$. Let $C\subset \PP^n$
be the closure of the image $C_0$ of the morphism
$$
\AA^1 \ni t \mapsto (t, t^q, t^{q^2}, \dots , t^{q^{n}}) \in \AA^n
$$
where $\AA^n\subset \PP^n$ is the open set $x_0=1$. 
\begin{enumerate}
\item Show that $C$ is a complete intersection, defined by the equations
$$
x_0^{q-1}x_2 - x_1^q, x_0^{q-1}x_3 - x_2^q,\dots, 
x_0^{q-1}x_n - x_{n-1}^q.
$$
\item Show that $C$ is singular unless $q = n = 2$.
\item Show every secant line to $C_0$ contains $q$ points of $C_0$; more generally, if
$a_1, \dots, a_r$ are linearly independent points of $C_0$, show that the linear span of
$a_1, \dots, a_r$ contains $q^{(r-1)}$ points of $C_0$.  Compare this with the configuration of
points in affine $n$-space over a field of $q$ elements.
\end{enumerate}
\end{exercise}

\begin{exercise}
Here is another approach to the $g+2$ theorem in the hyperelliptic case: 
Let $C$ be a hyperelliptic curve of genus $g$ and $D$ a general divisor of degree $g+1$ on $C$; let $|E|$ be the $g^1_2$ on $C$.
Consider the map $\phi : C \to \PP^1 \times \PP^1$ given as the product of the maps $\phi_D : C \to \PP^1$ and $\phi_E : C \to \PP^1$ given by the pencils $|D|$ and $|E|$.
\begin{enumerate}
\item Show that $\phi$ embeds the curve $C$ as a curve of bidegree $(g+1,2)$ on $\PP^1 \times \PP^1$.
\item Now embed $\PP^1 \times \PP^1$ into $\PP^3$ as a quadric surface $Q$; pick a general point $p \in C \subset Q$ and project $C$ from the point $p$. Show that the image curve $C_0$ is a plane curve of degree $g+2$ with one ordinary $g$-fold point.
\end{enumerate}
\end{exercise}

\begin{exercise}
Show that with $C$ and $M$ as in Castelnuovo's theorem, the line bundle $\cO_C(M)$ is nonspecial. (We will see in Section~\ref{} that this is sharp; that is, there exist curves $C \subset \PP^r$ with $\cO_C(M-1)$ special).
\end{exercise}

\begin{exercise}\label{extremal m-ics}
Establish the analog of Proposition~\ref{rnc on most quadrics} for hypersurfaces of any degree $m$, that is to say no irreducible, nondegenerate curve in $\PP^r$ lies on more hypersurfaces of degree $m$ than the rational normal curve.
To do this, let $C\subset \PP^d$ be any irreducible nondegenerate curve. Let $\Gamma$ be a general hyperplane section
of $C$, and use the exact sequences
$$
0 \to \cI_{C/\PP^d}(l-1) \to \cI_{C/\PP^d}(l) \to \cI_{\Gamma/\PP^{d-1}}(l) \to 0.
$$ 
with $2 \leq l \leq m$ to show that
$$
h^0(\cI_{C/\PP^d}(m)) \leq  \binom{d+m}{m} - (md+1)
$$
with equality only if $C$ is a rational normal curve.
\end{exercise}

\begin{exercise}\label{linear bound is sharp}
Let $D \subset \PP^n$ be a rational normal curve. If $\Gamma \subset D$ is any collection of $d$ points on $D$ (or for that matter any subscheme of $D$ of degree $d$) then the Hilbert function of $\Gamma$ is
$$
h_\Gamma(m) = \min\{d, mn+1\}
$$
\end{exercise} 

\begin{exercise}
Let $C \subset \PP^r$ be an irreducible, nondegenerate curve of degree $d$, and set $M = \lfloor{\frac{d-1}{r-1}}\rfloor$ as in the proof of Castelnuovo's theorem.
Show that the line bundle $\cO_C(M)$ is nonspecial. (We will see in Section~\ref{} that this is sharp; that is, there exist curves $C \subset \PP^r$ with $\cO_C(M-1)$ special).
\end{exercise}

\input footer.tex