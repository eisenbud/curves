\input{header}

\chapter{Curves in $\PP^3$: Linkage}
\label{LiaisonChapter}\label{linkageChapter}\label{LinkageChapter}


\section{Introduction} 
The ideal of each curve $C$ in the plane is generated by one equation. It is arithmetically Cohen-Macaulay 
which means that 
$$
H^1_*(\sI_C) := \oplus_{m\in \ZZ}H^1(\sI_C(m) = 0.
$$
 and its degree determines its (arithmetic) genus. In $\PP^3$ the simplest ideals of curves are
complete intersections, generated by two equations; again these are arithmetically Cohen-Macaulay, and again the genus is determined by the degrees of the equations.
 Next simplest, perhaps
is a curve $C$ that is \emph{directly linked} to a complete intersection, which means roughly that its union $X = C\cup D$
with a complete intersection
curve $D$ is again a complete intersection. We will see that such a curve $C$ is arithmetically Cohen-Macaulay,
and its genus is determined by the degrees of the equations of $X$ and $D$.

Allowing sequences of direct links we define an equivalence relation called  \emph{linkage} or \emph{liaison}, 
and curves in the Linkage Class of a Complete Intersection are often said to be ``licci''. 
A famous theorem of Hartshorne and Rao shows that the linkage class of a curve $C\subset \PP^3$
is defined by the finite dimensional graded module $H^1_*(\sI_C)$,
and the correspondence is quite constructive: from a finite-dimensional graded module one can
actually construct curves.

Aside from providing a striking classification result, linkage is quite useful in analyzing Hilbert schemes. We will exploit this systematically in cases of low degree and genera in Chapters~\ref{HilberSchemes1} and \ref{HilbertSchemes2}, and we begin
this chapter with what is perhaps the simplest example, computing the dimension of the component of
the Hilbert scheme $\cH ilb_{3m+1}(\PP^3)$ consisting of twisted cubics (see Proposition~\ref{hilb of twisted cubics} for another proof.)

Let $C\subset \PP^3$ be a twisted cubic. As we saw already in Chapter~\ref{linear series chapter} the ideal of $C$
is minimally generated by the three $2\times 2$ minors of the matrix
$$
\begin{pmatrix}
 x_0&x_1&x_2\\
 x_1&x_2&x_3
\end{pmatrix}\,.
$$
The minor $Q_{1,2}$ involving the first two columns and the minor $Q_{2,3}$ involving the last two columns clearly
both vanish on the line $L: x_1 = x_2 = 0$, which meets the twisted cubic in the two points corresponding to the
vanishing of the linear forms in the first row and in the second row, respectively -- that is, it is a secant line to $C$. 
A general linear combination $Q$ of these two minors defines a smooth quadric, which is thus isomorphic to $\PP^1\times \PP^1$. The curve $C$ necessarily lies in the divisor class $(1,2)$ (or, symmetrically, $(2,1)$), and the line in class $(1,0)$, summing to the 
complete intersection $(2,2)$ of Q with (say) $Q_{1,2}$
 
 This suggests that we set up an incidence correspondence between twisted cubics and their secant lines. Let $\PP^9$ denote the projective space of quadrics in $\PP^3$, and consider
$$
\Phi = \{ (C, L, Q, Q') \in \cH^\circ \times \GG(1,3) \times \PP^9 \times \PP^9 \; \mid \; Q \cap Q' = C \cup L \}.
$$

We'll analyze $\Phi$ by considering the projection maps to $\cH^\circ$ and $\GG(1,3)$; that is, by looking at the diagram

\begin{diagram}[small]
& &  \Phi & & \\
& \ldTo^{\pi_1} & & \rdTo^{\pi_2} & \\
\cH^\circ & & & & \GG(1,3)
\end{diagram}

Consider first the projection map $\pi_2 : \Phi \to \GG(1,3)$ on the second factor. By what we just said, the fiber over any point $L \in \GG(1,3)$ is an open subset of $\PP^6 \times \PP^6$, where $\PP^6$ is the space of quadrics containing $L$; it follows that $\Phi$ is irreducible of dimension $4 + 2\times 6 = 16$. Going down the other side, we see that the map $\pi_1 : \Phi \to \cH^\circ$ is surjective, with fiber over every curve $C$ an open subsets of $\PP^2 \times \PP^2$, where $\PP^{2}$ is the projective space of quadrics containing $C$; we conclude that $\cH^\circ$ is irreducible of dimension 12, in accord with our previous
computation of the space of twisted cubics as $PGL(4,\CC)/\PGL(2,C)$.


\section{Linkage of smooth curves in $\PP^3$}\label{SLinkage}\label{linkage section}

If the union of two smooth curves in $\PP^3$ is a complete intersection of surfaces, then the degrees and genera
of the curves are related. The relation is true much more generally, as we shall see in the next section, but the special
case is already useful and attractive:

\begin{theorem}\label{liaison genus formula-first version} Let $C, {C_2}\subset \PP^3$ smooth irreducible curves of  of degrees $c,d$ whose union is the complete intersections of two surfaces $S,T$, with $S$ smooth. If the degrees of $S,T$ are $s,t$ respectively, then
$$
\begin{aligned}
&\deg C+\deg C_2 = st\\
&g(C) - g({C_2}) = \frac{s+t-4}{2}(\deg C-\deg {C_2}).
\end{aligned}
 $$
\end{theorem}
In words, the difference between the genera of $C$ and ${C_2}$ is proportional to the difference in their degrees, with constant of proportionality $(s+t-4)/2$. Note that in the case of the complete intersection of two quadrics, the multiplier $(s+t-4)/2 = 0$, and indeed the line and the twisted cubic have the same genus.

\begin{proof}
B\'ezout's Theorem implies that the degree of $S\cap T = C_1\cup C_2$ is $st$, whence the first formula.

By the adjunction formula in $\PP^3$ the canonical divisor of $S$ has class $K_S = (s-4)H$. Thus, from the 
adjunction formula on the surface $S$ we get
$$
g(C_i) = \frac{C_i^2+C_i\cdot K_S}{2}+1 = \frac{C_i^2+(s-4) \deg C_i}{2}+1
$$
and thus, subtracting,
$$
g(C_1)-g(C_2) = \frac{C_1^2-C_2^2+(s-4) (\deg C_1-\deg C_2)} {2}.
$$
Because $C_1+C_2$ is in the class $tH$ on $S$ we have
$$
C_1^2-C_2^2 = (C_1-C_2)(C_1+C_2) = t(\deg C_1-\deg C_2)
$$
and substituting this into the previous formula we get the second formula of the theorem.
\end{proof}

\begin{remark}
Linkage is closely related to linear equivalence; here is a special case:
Suppose that $S$ is a smooth surface in $\PP^3$, and $C\subset S$ is a curve. If $T$ is a sufficiently general surface of degree $t$
containing $C$ then the curve $C'$ that is the link of $C$ with respect to $S,T$ lies in the class $tH-C$. If we link again with
respect to an other surface $T'$ of degree $t'$ we thus arrive at $C'' = C+(t-t')H$. Thus if $t=t'$ we get a curve in the same 
linear equivalence class as $C$. Moreover, since every rational function on $S$ is the restriction to $S$ of the ratio of two forms of the same degree on $\PP^3$,
the set of curves on $S$ that can be obtained from $C$ by two linkages with surfaces $T, T'$ of the same degree is exactly the 
linear series $|C|$ on $S$.
\end{remark}

\section{Linkage of purely 1-dimensional schemes in $\PP^3$}
To say that the union of distinct smooth irreducible curves $C, C'$ without common components is a complete intersection $X$ means that 
the ideal $I_X$ of the complete intersection is the intersection $I_C\cap I_{C'}$. Since this ideal contains $I_CI_{C'}$, the ideal quotient
$I_X:I_C:= \{F \mid FI_C\subset I_X$
contains $I_{C'}$. On the other hand, if $F \notin I_{C'}$ and we choose $G\in I_C\setminus I_{C'}$, then $FG\notin I_{C'}$, so in fact
$I_X:I_C = I_{C'}$. It turns out that this relationship is the key to the formulas connecting the degrees and genera of $C,C'$, which hold 
for arbitrary purely 1-dimensional subschemes of $\PP^3$, as we shall see in Theorem~\ref{direct linkage}. This suggests the definition
of direct linkage for such subschemes:

\begin{definition}
Let $C,C'$ be purely 1-dimensional subschemes of $\PP^3$. We say that $C'$ is \emph{directly linked} to $C$ if there is a complete
intersection $X$ containing $C,C'$ and $I_X:I_C = I_{C'}$. We say that $C'$ is \emph{linked} to $C$ if they are connected by a chain of such
direct linkages, and we say that $C'$ is \emph{evenly linked} to $C$ if the chain involves an even number of steps.
\end{definition}

As in the smooth case treated above, direct linkage is a symmetric relationship:
\begin{proposition}
Let $C_1\subset \PP^3$ be a purely 1-dimensional subscheme with saturated homogeneous ideal $I_1$ and suppose that $C_1$ is contained in a complete intersection of
hypersurfaces $S\cap T$. The ideal $I_2 = I_{S\cap T}:I_1$ is a saturated ideal, defining a purely 1-dimensional subscheme and 
$I_1 = I_{S\cap T}: I_2$ as well.
\end{proposition}
 
\begin{proof}
Since $S\cap T$ is a complete intersection, the ideal $I_{S\cap T}$ is unmixed of codimension 2, and it follows
that $I_2 = I_{S\cap T}:I_1$ is unmixed of codimension 2 as well (and thus, in particular, saturated).
Tnus it suffices to prove that $I_1 = I_{S\cap T}: I_2$ after localizing at a codimension 2 prime $P$
that contains $I_{S\cap T}$. 

Write $R$ for the localization at $P$ of the homogeneous coordinate ring of $S\cap T$. 
Because $I_{S\cap T}$ is a complete intersection, the ring $R$ is
 is zero-dimensional and Gorenstein.
By \cite[***]{Eisenbud1995}, every finitely generated $R$-module is reflexive. Since 
$$
I_{C_2}R= \ann_{R}(I_{C_1}R \cong Hom_R(R/I_{C_1}R, R)
$$
the proposition follows.
\end{proof}

Iterating direct links we thus define the equivalence relation of \emph{linkage} among purely 1-dimensional subschemes
of $\PP^3$.

\section{Degree and genus of linked curves}

The degrees and (arithmetic) genera 
of directly linked schemes are related exactly as in the simple case above:

\begin{theorem}\label{direct linkage}\label{linked genus formula}
If $C,{C'}\subset \PP^3$ are purely 1-dimensional schemes that are directly linked by surfaces $S,T$ of degrees $s,t$  then 
$$
\begin{aligned}
&\deg C+\deg C_2 = st\\
&g(C) - g({C_2}) = \frac{s+t-4}{2}(\deg C-\deg {C_2}).
\end{aligned}
 $$
\end{theorem}

Since we have left the realm of smooth curves and surfaces, we will need a more sophisticated duality theory, and we
postpone the proof to explain the necessary ideas.

\section{Dualizing modules}\label{duality}

To go further, we will use some facts about the dualizing modules:

Recall that in Chapter~\ref{RR} we claimed that the canonical sheaf of a smooth curve---the sheaf of differential forms---was ``the most important invertible sheaf'' after the structure sheaf. In the general setting of Cohen-Macaulay schemes, the analogue of the canonical sheaf is called the dualizing sheaf.
The general definition of the dualizing sheaf is not very illuminating; what is useful is how it is constructed and is cohomological properties relating to duality.
However, having a definition may be comforting. 

\begin{definition}
Let $X$ be a projective scheme over of pure dimension $d$. The \emph{dualizing sheaf} for $X$ is a coherent sheaf $\omega_X$ 
with a map $\eta: H^d(\omega_X) \to \CC$ such that for every coherent sheaf  $\sF$ the compositive map
$$
H^d(\sF) \times \Hom(\sF, \omega_X) \to H^d(\omega_X) \rTo^\eta \CC
$$
is a perfect pairing. 
\end{definition}

One can construct the dualizing sheaf on a scheme
$X$ by comparing it with any scheme $Y$ whose dualizing sheaf is known, in the following sense:
\begin{fact} \label{construction of dualizing sheaf}
\begin{theorem}\label{omega}\label{general adjunction}
Suppose that $f: X\to Y$ is a finite morphism between projective schemes $X,Y$ of pure dimensions $d,e$. If $Y$ has a dualizing sheaf $\omega_Y$,
then $\omega := \sExt_Y^{e-d}(f_*\sO_X,  \omega_Y)$, regarded as a sheaf on $X$ is a dualizing sheaf for $X$ in a way compatible with the residue maps.
Moreover, if $Y$ is smooth, then $X$ is Cohen-Macaulay if and only if $ \sExt_Y^{e-d}(f_*\sO_X,  \omega_Y)= 0$ for all $m\neq e-d$.\qed
\end{theorem}
\end{fact}

As the name suggests, any two canonical sheaves are isomorphic in a way compatible with the
residue maps. If $X$ is smooth then the top degree differential forms $\omega_X :=\wedge^d(\Omega_X)$,
together with the classical residue (see for example~\cite[p. 648, 708]{Griffiths-Harris1978}), is a dualizing sheaf, as implied by Serre duality. 

See Exercises \ref{codimension0} and \ref{codimension1} for a comparison of this general result with some
familiar cases, and see for example \cite{AltmanKleiman} for a thorough exposition.

Several similarities to the smooth case are consequences:

\begin{proposition}\label{similarities}
If $C$ is a purely 1-dimensional projective scheme over $\CC$, then:
\begin{enumerate}

\item $\sHom_C(\omega_C, \omega_C) = \sO_C$, and  thus if $C$ is integral then the generic rank of $\omega_C$ is 1.

\item For any invertible sheaf $\sL$, 
$h^0(\omega_C) = h^1(\sO_C)$ and
$h^1(\omega_C)= h^0(\sO_C).$
and thus
$$
\chi(\omega_C\otimes_C\sL)= -\chi(\sL^{-1}).
$$

\item $\deg \omega_C = 2p_a(C) -2.$

\end{enumerate}
\end{proposition}

\begin{proof}
\noindent{\bf 1:} We claim that the natural map $\sO_C \to \sHom_C(\omega_C, \omega_C)$ is an isomorphism. Choose a Noether
normalization of $C$, that is, a finite map $C\to \PP^1$.
By Theorem~\ref{general adjunction} $\omega_C \cong \sO_C^\vee := \sHom_{\PP^1}(\sO_C,\sO_{\PP^1}(-2)).$
Now
$$
\begin{aligned}
\sHom_{C}(\sO_C^\vee,\sO_C^\vee ) &=\sHom_{C}(\sO_C^\vee, \sHom_{\PP^1}(\sO_C^\vee,\sO_{\PP^1}(-2)))\\
&= \sHom_{\PP^1}(\sO_C^\vee, \sO_{\PP^1}(-2)))\\
&= (\sO_C^\vee)^\vee.
\end{aligned}
$$

Since $C$ is unmixed it is locally Cohen-Macaulay so, by the Auslander-Buchsbaum formula, 
$\sO_C$ is locally free as an $\sO_{\PP^1}$-module.
Thus the natural map $\sO_C \to (\sO_C^\vee)^\vee$ is an isomorphism, proving first equality in the Proposition.
This implies in particular that if $C$ is integral then $\omega_C$ is generically isomorphic to $\sO_C$.

\noindent{\bf 2:} The duality property of $\omega_C$ shows that, if $\sL$ is an invertible sheaf, then
$$
\begin{aligned}
h^1(\omega_C \otimes_C \sL) &= h^0(\Hom_C(\omega_C\otimes_C \sL, \omega_C))\\
&= h^0(\Hom_C(\sL, \sHom(\omega_C,\omega_C))\\
&=h^0 (\sHom(\sL, \sO_C)\\
&= h^0(\sL^{-1}).
\end{aligned}
$$
Also
$$
\begin{aligned}
h^0(\omega_C\otimes_C\sL) &= h^0 \bigl(Hom_C(\sO_C, \omega_C\otimes_C\sL)\bigr)\\
&=h^0 \bigl(Hom_C(\sO_C\otimes_C\sL^{-1}, \omega_C)\bigr)\\
&=H^1 (\sL^{-1}). 
\end{aligned}
$$

\noindent{\bf 3:} By definition, $p_a(C) = 1-\chi(\sO_C)$, and 
 $\deg \omega_C = \chi(\omega_C) - \chi(\sO_C),$
 so by what we have proven above
 $\deg \omega_C = -2\chi(\sO_C) = 2p_a(C)-2.$
 \end{proof}

Using the dualizing property of $\omega_C$ we can reformulate Theorem~\ref{general RR without duality} as
\begin{theorem}\label{general RR with duality}
If $C$ is an integral curve and $\sF$ is a coherent sheaf on $C$, then
$$
h^0(\sF) = \deg(\sF) + \rank(\sF)(1-p_a(C)) + h^0(\Hom_C(\sF, \omega_C)).
$$
\end{theorem}

\begin{fact}
If $X$ is Cohen-Macaulay, then more generally
$$
H^a(\sF) \times \Ext^{d-a}(\sF, \omega_X) \to H^d(\omega_X) \rTo^\eta \CC
$$
is a perfect pairing for all $a$. (In the non-Cohen-Macaulay case a similar result is true if we replace $\omega_X$ by a dualizing complex
and work in the derived category.) 
\end{fact}


\subsection{Proof of Theorem~\ref{direct linkage}}

\begin{proof}
 Let $X$ be the complete intersection of surfaces of degrees $s,t$ containing $C$, and let $S_X = S/(F,G)$ be its homogeneous coordinate ring, where
$S = \CC[x_0,\dots,x_3]$ is the homogeneous coordinate ring of $\PP^3$.
From the free resolution
$$
0\rTo S(-s-t) \rTo^{
\begin{pmatrix}
 G \\ -F
\end{pmatrix}}
 S(-s)\oplus S(-t) \rTo^{
\begin{pmatrix}
 F & G
\end{pmatrix}}
 S \rTo S/(F,G) \rTo 0
$$
 and Theorem~\ref{omega} we see that
 $$
\omega_X =  \sExt^2_C(\sO_X, \omega_{\PP^3}) =\sExt^2(\sO_X, \sO_{\PP^3}(-4)) = \sO_X(s+b-4).
 $$
Note that for any ideals $J\subset I$ in a ring $A$ we have $Hom_A(A/I, A/J) \cong (J:I)/J$, where the isomorphism
sends a homomorphism $\phi$ to the element $\phi(1)$. Again from Theorem~\ref{omega} we have 
$$
\omega_C = \Hom_X(\sO_C, \omega_X) = \Hom_X(\sO_C, \sO_X)(s+t-4) = \frac{\sI_X:\sI_C}{\sI_X}(s+t-4),
$$
where we have identified $\sO_C$ with its pushforward under the inclusion map $C\to X$. 

Since $C$ is purely 1-dimensional it is Cohen-Macaulay, so
$\chi(\omega_C(m)) = -\chi(\sO_C(-m))$. It follows that the degree of $\omega_C$, which is the leading coefficient of the Hilbert polynomial of $\omega_C$, is 
equal to $\deg C$, and 
$$
st = \deg \sO_X =\deg \sO_{C'}+\deg \omega_C = \deg \sO_{C'}+\deg \sO_C
$$
as required by the formula for the sum of the degrees.

From Theorem~\ref{omega} we see that $\chi(\sO_X) = st(4-s-t)/2$. Since $\sO_{C'} = \sO_{\PP^3}/(\sI_X : \sI_C)$ and
$(\sI_X : \sI_C)/(\sI_X) = \omega_C(4-s-t)$ we have
$$
\begin{aligned}
-\frac{(s+t-4)}{2} (\deg C +& \deg C') \\&= -\frac{(s+t-4)}{2}st \\
&= \chi(\sO_X) \\&=  \chi(\sO_{C'})+\chi(\omega_C(4-s-t)) \\&= \chi(\sO_{C'})-\chi(\sO_C(s+t-4)) \\&= \chi(\sO_{C'})-(s+t-4)\deg C-\chi(\sO_C)
\\&= (1-p_a(\sO_{C'})) - (1-p_a(\sO_C) -(s+t-4)\deg C,
\end{aligned}
$$
whence 
$$
p_a(\sO_C) -p_a(\sO_{C'} = \frac{(s+t-4)}{2} (\deg C - \deg C'). 
$$
 \end{proof}

Linkage behaves in a simple way with respect to deficiency modules:

\begin{theorem}\label{HR}
If $C,C'$ are purely 1-dimensional subschemes of $\PP^3$ that are directly linked by a complete intersection of degrees $s,t$ then
$$
D(C') = Hom_\CC(D(C), \CC) (-s-t+4).
$$ 
as graded modules over the homogeneous coordinate ring of $\PP^3$.
\end{theorem}

\begin{proof}
Suppose that the homogeneous ideal of $C$ is generated by forms of degree $a_i, i=1,\dots,s$. Since $C$ is locally Cohen-Macaulay,
the local rings $\sO_{C,p}$ have projective dimension 2 as modules over $\sO_{\PP^3, p}$, and $\sI_{C,p}$ has projective dimension 1.
Thus we have an exact sequence
$$
0\to \sE \to \oplus_i\sO_{\PP^3}(-a_i) \to \sI_C \to 0.
$$
Since the first and second cohomology groups of the twists of $\sO_{\PP^3}$ vanish, we deduce an isomorphism
$$
D(C) := \oplus_{m\in \ZZ} H^1(\sI_C(m)) \cong \oplus_{m\in \ZZ} H^2(\sE(m)).
$$

Let $X$ be the complete intersection of two hypersurfaces, of degrees $s,t$, containing $C$. From the inclusion we deduce a
map of resolutions
$$
\begin{diagram}[small]
0&\rTo& \sE &\rTo& \oplus_i\sO_{\PP^3}(-a_i)                                         &\rTo&\sO_{\PP^3}&\rTo &\sO_C &\rTo& 0\\
&&\uTo&&\uTo&&\uTo&&\uTo\\
0&\rTo& \sO_{\PP^3}(-s-t) &\rTo& \sO_{\PP^3}(-s)\oplus \sO_{\PP^3}(-t) &\rTo& \sO_{\PP^3}&\rTo& \sO_X &\rTo& 0\\
\end{diagram}
$$
We dualize this diagram, form the mapping cone, and twist by $-s-t$. Note that $\Hom_{\PP^3}(\sO_C, \sO_{\PP^3}) = 0$. 
Also, since the vertical map $\sO_{\PP^3}\to \sO_{\PP^3}$ on the right
is an isomorphism we may cancel these terms. Noting that $\omega_C = \Ext^2(\sO_C, \sO_{\PP^3}(-4))$ we get the diagram with 
exact rows:
$$
\begin{diagram}[small]
 0&\lTo&\omega_C(-s-t+4)&\lTo&\sE^*(-s-t) &\lTo&  \oplus_i\sO_{\PP^3}(a_i-s-t)&\lTo&  0\\
 &&\dTo^\phi&&\dTo&&\dTo\\
 0&\lTo&\sO_X&\lTo&\sO_{\PP^3} &\lTo& \sO_{\PP^3}(-t)\oplus \sO_{\PP^3}(-s) &\lTo&0\\
 &&\dTo\\
 &&\sO_{C'}\\
 &&\dTo\\
 && 0
\end{diagram}.
$$
Here the column on the left is an exact sequence because $(\sI_X:\sI_C)/\sI_X \cong \omega_C(-s-t+4)$, as explained above.
We can now write a resolution of $\sI_{C'}$ by taking the mapping cone:
$$
\begin{diagram}
0\leftarrow \sI_{C'} \leftarrow \sO_{\PP^3}(-t)\oplus \sO_{\PP^3}(-s) \oplus \sE^*(-s-t) \leftarrow \oplus_i\sO_{\PP^3}(a_i-s-t)\leftarrow  0
\end{diagram}
$$
From this we see that 
$$
H^1(\sI_{C'}(m) \cong H^1(\sE^*(-s-t+m) \cong Hom_\CC( H^2(\sE(s+t-m-4)), \CC)
$$
where the last equality is from Serre duality on $\PP^3$. Summing over $m$ we see that
$D(C') \cong Hom(D(C)(s+t-4), \CC)$,
and since Serre duality is functorial, the isomorphism holds not only as graded vector spaces, but as graded $S$-modules. 

To prove that the relation of direct linkage is symmetric, we can repeat this argument starting from the locally free
resolution of $C'$, above, using the same forms of degree $s,t$ and we see that  direct link of $C'$ is $C$.
\end{proof}

Sometimes the following consequence is a useful way to compute the deficiency module:

\begin{corollary}[Corollary of the proof of Theorem~\ref{HR}]\label{deficiency as dual of Ext}
If $C$ is a purely 1-dimensional subscheme of $\PP^3$ with homogeneous ideal $I = I_C$ then 
$$
D(C) \cong Hom_\CC (Ext^3(S/I, S), \CC)(-4), \CC)
$$
as graded modules over the homogeneous coordinate ring $S$ of $\PP^3$.
\end{corollary}

This is a special case of the local duality isomorphism between local cohomology and the dual of Ext; see for example \cite[Theorem A.1.9]{MR2103875}.
\begin{proof}
We may choose a surjection  $\psi:  \oplus_iS(-a_i)\rTo I$, and choose the map
$\phi: \oplus_i\sO_{\PP^3}(-a_i)\rTo\sI_C$
in the proof of Theorem~\ref{HR}
to be the corresponding map of sheaves, so that
$\sE$ is the sheafification of the graded module $E = \ker \psi$.

Since $I$ is a saturated ideal,
 the depth of $S/I$ is at least 1, so $\pd\ S/I\leq 3$, and $I$ has a free resolution of the form
$$
0\rTo G \rTo F \rTo \oplus_iS(-a_i)  \rTo S\rTo S/I \rTo 0.
$$
where $G\to F$ is a free presentation of $E$. and there is an exact sequence
$$
0 \to E^* \to F^* \to G^* \to Ext^3_S(S/I, S) \to 0.
$$
Since $\sO_C$ is Cohen-Macaulay the sheafification of $Ext^3_S(S/I, S)$ is 0; that is,
$Ext^3_S(S/I, S)$ has finite length, and writing $\widetilde{(\phantom{-})}$ for the sheafification functor,
we have a short exact sequence of sheaves 
$$
0\to \sE^* \to \widetilde{F^*} \to \widetilde{G^*}\to 0.
$$
From this we see that 
$$
Ext^3_S(S/I,S) = H^1_*(\sE^*) = Hom_\CC( H^2_*(\sE(-4)),\CC) = H^1_*(\sI)(-4),
$$
proving the assertion.
\end{proof}


\section{The linkage equivalence relation}
As an immediate consequence of Theorem~\ref{HR} we have:
\begin{corollary}(Hartshorne)
 If two curves $C,C'$ are linked by an even length chain of direct linkages, then 
 $D(C)$ and $D(C')$ are isomorphic up to a shift in grading.
\end{corollary}

As we mentioned at the beginning of this Chapter, the converse is also true: the Hartshorne-Rao modules, up to shift in grading, provide a complete invariant of
linkage. Even more precise results are known (and the characteristic 0 hypothesis is largely unnecessary); here is a sample:

\begin{fact}
\begin{theorem}
Let $S = \CC[x_0, \dots, x_3]$ be the homogeneous coordinate ring of $\PP^3$, and let $M$ be a graded $S$-module of finite length.
\begin{enumerate}
\item There is a smooth curve $C$ with $D(C) = M(m)$ for some integer $m$.
\item There is a minimum value of $m$ such that $M(m) = D(C_0)$ for some purely one-dimensional scheme $C_0$.
\item Every curve that is evenly linked to $C_0$ is obtained from $C_0$ by deformation and a process called
\end{enumerate}
\end{theorem}

Moreover, each Liaison class has a relatively simple structure, known as the \emph{Lazarsfeld-Rao property}.
We say that $C'$ is obtained from $C$ by an \emph{ascending double link} if $I_{C'} = fI_C+(g)$ for some regular sequence
contained in $I_C$---see Exercise~\ref{Basic double links}. 

\begin{theorem}\cite{MR1087803}\label{LR property}
Let $M = D(C_0)$ the the Hartshorne Rao invariant of a purely 1-dimensional subscheme of $\PP^3$, and suppose that
$M$ is minimal in the sense that no $M(m)$ is the invariant of a purely 1-dimensional scheme. 
\begin{enumerate}
 \item Every curve $C$ in $\PP^3$ with $D(C) = M$ is a deformation of $C_0$ through curves with invariant $M$.
 \item Every curve in the even linkage class of $C_0$ is the result of a series of ascending double links followed by a deformation.
\end{enumerate}
\end{theorem}

In \cite{MR714753} it is shown that general curves of reasonably large degree in $\PP^3$ and many others have the property in the hypothesis
of  Theorem~\ref{LR property}.
\end{fact}


\section{Exercises}

\begin{exercise}
 Verify that the genus formula in Theorem~\ref{direct linkage} agrees with the usual calculation of degrees and genera for divisors on a quadric of
 classes $(a,b)$ and $(d-a, d-b)$.
\end{exercise}

\begin{exercise}
 Let $C$ be an integral projective curve, and let $\sE$ be a locally free sheaf of rank $r$ on $C$. Show that
 $\deg(\sE) = \deg(\wedge^r(\sE))$.
 
 Hint: First show that any locally free sheaf on $C$ is an iterated extension of invertible sheaves.
\end{exercise}

\begin{exercise}
Let $C$ be the disjoint union of 3 skew lines. 
\begin{enumerate}
 \item prove that $C$ lies on a unique quadric, and that $H^2(\sI_C) = 0$
 \item compute the Hartshorne-Rao module $D(C)$.
 \item show that if $\Gamma$ is the union of 3 points in $\PP^3$ then
 $H^1\sI(\Gamma) = 0$ iff the three points are colinear.
 \item Using the exact sequence in cohomology coming from the short exact sequence
$$
0\to \sI_C \rTo^{\ell} \sI_C(1) \to \sI_\Gamma(1) \to 0
$$
where $\ell$ is a linear form, show that the map of vector spaces
$$
H^1(\sI_C) \rTo^{\ell} H^1\sI_C(1))
$$
has rank<2 if and only if $\ell$ vanishes on 3 collinear points on the three lines (including the case when $\ell$ vanishes identically on one of the lines).
Conclude that if a different union $C'$ of 3 skew lines is linked to $C$, then $C'$ lies on the same quadric as $C$.
\end{enumerate}
See~\cite{Migliore} for more examples of this type.
\end{exercise}

\begin{exercise}
 Compute the Hilbert function of the Hartshorne-Rao module of a curve of type $(a,b)$ on a smooth quadric surface.
 Hint: The ideal sheaf of the curve on the quadric $Q$ is an extension of the ideal sheaf of the quadric in $\PP^3$
 with the ideal sheaf of the curve on the quadric, which is 
 $$
 \sO_Q(-a,-b) = \pi_1^*(\sO_{\PP^1}(-a)) \otimes pi_2^*(\sO_{\PP^1}(-b)),
 $$
 where $\pi_1, \pi_2$ are the projections to $\PP^1$. Use the K\"unneth formula
 $$
 H^1(\sO_Q(p,q)) = H^1(\sO_{\PP^1}(p)) \otimes H^0(\sO_{\PP^1}(q)) \oplus
  H^0(\sO_{\PP^1}(p)) \otimes H^1(\sO_{\PP^1}(q))
 $$
  to compute the necessary cohomology.
\end{exercise}

\begin{exercise} (Liaison addition)\label{Liaison addition}
(From the unpublished Brandeis thesis of Phillip Schwartau):
Suppose that $I, J$ are saturated ideals defining purely 1-dimensional subschemes of $\PP^3$
and that $f,g$ is a regular sequence with $f\in I$ and $g\in J$.
Prove that $g I \cap fJ = (fg)$, and conclude that if $I,J$ are purely codimension 2 ideals
 defining purely 1-dimensional schemes $C,C'$ in $\PP^3$
 then  $(gI+fJ)$ is a saturated ideal defining a purely 1-dimensional
scheme $C''$ with $D(C'') = D(C)(-\deg g) \oplus D(C')(-deg f)$.

Hint: Use the exact sequence 
$$
0\to (fg) \to gI \oplus fJ \to gI+fJ \to 0
$$
and the corresponding exact sequence of quotients by these ideals.
\end{exercise}


\begin{exercise}(Basic double links)\label{Basic double links}
The special case of the construction in Exercise~\ref{Liaison addition} in which $C'$ is trivial is already interesting. 

\begin{enumerate}
 \item Show that if $I$ is a purely codimension 2 ideal
 defining a purely 1-dimensional scheme $C$ in $\PP^3$
 and $(f, g)$ is a regular sequence with $g\in I$, then
 then  $fI+(g)$ defines a scheme $C'$ with $D(C') = D(C)(-\deg f)$.

 \item Show directly that, with notation as above, $C'$ is directly linked to $C$
 in two steps. \fix{add hint} Since the degrees of the generators of $D(C')$ are more positive, this
 is sometimes called an \emph{ascending double link}. Geometrically it amounts to taking the
 union of $C$ with some  components that are complete intersections.
 \end{enumerate}

\end{exercise}

The next two exercises illustrate Theorem~\ref{general adjunction}:

\begin{exercise}\label{codimension0}
Show that if $C\to D$ is a map of smooth curves with ramification index $e$ at $p\in C$, and $t$ is a local
analytic parameter at $p$, then 
locally analytically at $p$ the sheaf $\sHom_C(\sO_C, \omega_D)$ is $\sO_C(e)$.
\end{exercise}

\begin{exercise}\label{codimension1}
 Show that if $C\subset S$ is a cartier divisor on a surface $S$ with canonical sheaf $\omega_S$, 
 then $\sExt^1(\sO_C, \omega_S) \cong \sO_C\otimes \sO_S(C)$, and thus $K_C = (K_S+C)\cap C$.
\end{exercise}

\input{footer}

