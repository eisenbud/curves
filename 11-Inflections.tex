\input{header}

\chapter{Inflections and Brill Noether}
\label{InflectionsChapter}

In this concluding chapter, we want to introduce one more aspect of the geometry of linear series on curves, the \emph{inflectionary points} of a linear system,and use it to give a proof of at least half of the classical Brill-Noether theorem.

Inflectionary points in general are a direct generalization of the notion of flex point of a smooth plane curve to curves in higher-dimensional space. Just as a point $p \in C$ on a smooth plane curve $C \subset \PP^2$ is called a \emph{flex point} if there is a line $L \subset \PP^2$ having contact of order 3 or more with $C$ at $p$, a point on a smooth, nondegenerate curve $C \subset \PP^r$ will be called an inflectionary point if there is a hyperplane $H \subset \PP^r$ having contact of order $r+1$ or more with $C$ at $p$. This notion can be extended to arbitrary linear series on smooth curves (as opposed to very ample ones); we'll see below that every linear series has finitely many inflectionary points, and how to count them.


\section{Inflection points,  Pl\"ucker formulas and Weierstrass points}

\subsection{Definitions}

To start with the definition: let $C$ be a smooth projective curve of genus $g$, and $\cD = (\cL,V)$ a $g^r_d$ on $C$; that is, let $\cL \in \Pic^d(C)$ be a line bundle of degree $d$ on $C$ and $V \subset H^0(\cL)$ an $(r+1)$-dimensional vector space of sections.

For any point $p \in C$, we can find a basis $\sigma_0, \dots, \sigma_r$ of $V$ consisting of sections vanishing to different orders at $p$ (just start with any basis and if two elements vanish to the same order, replace one with a linear combination of the two vanishing to strictly higher order; since the order $\ord_p(\sigma)$ of any section at $p$ is bounded above by $d$, this process must terminate). The set
$$
\{ \ord_p(\sigma) \mid \sigma \neq 0 \in V \}
$$
thus has cardinality $r+1$, and we can write it as
$$
\{ \ord_p(\sigma) \mid \sigma \neq 0 \in V \} = \{a_0,\dots,a_r\} \; \text{ with } \; a_0 < a_1 < \dots < a_r;
$$
the sequence $a_i = a_i(\cD,p)$ is called the \emph{vanishing sequence} of $\cD$ at $p$.  Finally, since $a_i \geq i$, we can set $\alpha_i = \alpha_i(\cD,p) = a_i - i$; the sequence $0 \leq \alpha_0 \leq \alpha_1 \leq \dots \leq \alpha_r$ is called the \emph{ramification sequence} of $\cD$ at $p$, and we say that $p$ is an \emph{inflectionary point} of the linear series $\cD$ if $(\alpha_0,\dots,\alpha_r) \neq (0,\dots,0)$. (Note that if $\cD$ is very ample, so that it may be viewed at the linear series cut on $C$ by hyperplanes for some embedding $C \subset \PP^r$, then this coincides with the notion above: $p$ is an inflectionary point if there is a hyperplane $H \subset \PP^r$ having contact of order $r+1$ or more with $C$ at $p$.)

Finally, we define the \emph{weight} of an inflectionary point to be the sum
$$
w(\cD, p) = \sum_{i=0}^r \alpha_i(\cD, p).
$$

\subsection{The Pl\"ucker formula}

There are two essential facts about the inflectionary points of a linear series $\cD = (\cL,V)$ on a smooth curve $C$.

The first is simply that \emph{not every point of $C$ is an inflectionary point}. This may seem obvious---try to imagine a plane curve in which every point is a flex!---but in fact it's false in characteristic $p$: there exist what are called ``strange curves," smooth curves in $\PP^r$ such that every point is inflectionary. Luckily, we are in characteristic 0 here, so we don't have to worry about this phenomenon.

The second is the total number of inflectionary points, properly counted, is determined by $d, g$ and $r$. Here ``properly counted" means that we count an inflectionary point $p \in C$ $w$ times, where $w = w(\cD,p)$ is the weight of $p$; the actual formula, called the \emph{Pl\"ucker formula}, is
$$
\sum_{p \in C} w(\cD, p) \; = \; (r+1)d + r(r+1)(g-1).
$$
Proofs of these two statements can be found in a variety of sources; see for example~\cite{} (3264?). 

It should be emphasized that the Pl\"ucker formula, while extremely useful (as we'll see in the remainder of this chapter), leaves many questions unanswered: we don't know, for example, what combinations of inflectionary points are possible, or what the behavior of the inflectionary points on a suitably general curve may be.

\subsection{Weierstrass points}

As with any extrinsic invariant of a curve in projective space, we can derive an intrinsic invariant of an abstract curve by applying the notion of inflectionary point to the canonical linear series. 

We define a \emph{Weierstrass point} of a curve $C$ to be an inflectionary point of the canonical linear series $|K_C|$. This amounts to saying a point $p$ is a Weierstrass point if there exists a canonical differential on $C$ vanishing to order $g$ or more at $p$; by Riemann-Roch, this is tantamount to the condition that $h^0(\cO_C(gp)) \geq 2$, or in other words to saying that there exists a rational function on $C$, regular away from $p$ and having a pole of order $g$ or less at $p$.

We can similarly characterize all the inflectionary indices of the canonical series at a point. We see from Riemann-Roch that for any $k \geq 0$, there exists a rational function on $C$ with a pole of order exactly $k$ at $p$---that is,
$$
h^0(\cO_C(kp)) > h^0(\cO_C((k-1)p))\text{---}
$$
if and only if 
$$
h^0(K_C(-kp)) = h^0(K_C((-k+1)p)); 
$$
that is, if and only if there does \emph{not} exist a regular differential on $C$ with a zero of order exactly $k-1$ at $p$. To give the classical terminology, we see from the above that there will exist exactly $g$ values of $k$ such that there does \emph{not} exist a rational function on $C$ with a pole of order exactly $k$ at $p$; these are called the \emph{gap values} of the point $p \in C$, and they comprise exactly the vanishing sequence of the canonical series $|K_C|$ at $p$. Moreover, it is clear that the complement in $\NN$ of the gap values---that is, the set of $k$ such that there does exist a rational function on $C$ with a pole of order exactly $k$ at $p$---for a semigroup, called the \emph{Weierstrass semigroup} of $p \in C$. Finally, the \emph{weight} $w_p$ of a Weierstrass point $p \in C$  is defined to be the weight $w(|K_C|,p)$ of $p$ as an inflectionary point of the canonical series.

From the general theory of ramification above, we see that a general point $p$ on any curve $C$ has gap sequence $(1,2,\dots,g)$, and correspondingly the semigroup $W_p = (0, g+1, g+2, \dots)$. A Weierstrass point is called \emph{normal} if it has weight 1; this is tantamount to saying that the gap sequence is $(1,2,\dots,g-1,g+1)$, or semigroup $(0, g, g+2, g+3, \dots)$. (The full Brill-Noether theorem tells us that a general curve $C$ has only normal Weierstrass points.) Finally, the Pl\"ucker formula tells us  the total weight of the Weierstrass points on a given curve $C$:
$$
\sum_{p \in C} w_p \; = \; g^3-g.
$$

There is still much we don't know about Weierstrass points in general. Most notably, we don't know what semigroups of finite index in $\NN$ occur as Weierstrass semigroups; an example of Buchweitz shows that not all semigroups occur, but there are also positive results, such as the statement ([EH]) that every semigroup of weight $w \leq g/2$ occurs, and its refinement and strengthening by Pflueger (\cite{**}).

\section{Finiteness of the automorphism group}

As an application of just a rudimentary knowledge of Weierstrass points, we will deduce a fundamental fact: that the automorphism group of a curve of genus $g\geq 2$ is finite. The idea behind the argument is simple: because the Weierstrass points of a curve $C$ are intrinsically defined, \emph{any automorphism of $C$ must carry Weierstrass points to Weierstrass points}. Since there are only finitely many Weierstrass points, then, it will suffice to show that the subgroup of $Aut(C)$ of automorphisms of $C$ that fix all the Weierstrass points individually is finite. In fact, the following two lemmas establish a strong version of this:

\begin{lemma}
Let $C$ be a smooth projective curve of genus $g \geq 2$, and $f: C \to C$ an automorphism of $C$.
\begin{enumerate}
\item If $f$ has $2g+3$ distinct fixed points, then $f$ is the identity; and
\item If $f$ has $2g+2$ distinct fixed points, then either $f$ is the identity or $C$ is hyperelliptic and $f$ is the hyperelliptic involution.
\end{enumerate}
\end{lemma}

\begin{proof}
There are two possible arguments here, one invoking the classical topology and applying the Lefschetz fixed point formula and the other more algebrao-geometric.

For the first, we recall the definition of the \emph{Lefschetz number} of a map $f : M \to M$ of a compact oriented real $n$-manifold $M$. This is the alternating sum of the traces of the action of $f$ on $H^i(X,\CC)$:
$$
L(f) := \sum_{i=0}^n {\rm Trace}\left(f^* : H^i(X,\CC) \to H^i(X,\CC)\right).
$$
The Lefschetz fixed point formula then says that if $f$ has isolated fixed points, the number of those points, properly counted, is equal to $L(f)$.

In the situation of a smooth projective curve over $\CC$, any automorphism other than the identity has isolated fixed points, and since the map is orientation-preserving each fixed point contributes positively to the total; thus the number of distinct fixed points is at most $L(f)$.

Now suppose $f: C \to C$ is any automorphism. Of necessity, $f$ acts as the identity on $H^0(C, \CC)$ and $H^2(C, \CC)$, so if we want to bound $L(f)$ we just have to say something about the action of $f$ on $H^1(C,\CC)$. To do this, note that the action of $f$ on $H^1(C,\CC)$ respects the \emph{Hodge decomposition}
$$
H^1(C,\CC)  = H^0(K_C) \oplus H^1(\cO_C).
$$  
Moreover, the action of $f$ on $H^0(K_C)$ preserves the definite Hermitian inner product
$$
H(\eta, \phi) = \int_C \eta \wedge \overline \phi,
$$
and it follows that \emph{the eigenvalues of the action of $f$ on $H^0(K_C)$ are all complex numbers of absolute value 1}, and likewise for the action on $H^1(\cO_C)$. The absolute value of the trace of $f^*: H^1(C,\CC) \to H^1(C,\CC)$ is at most 2g, and hence
$$
L(f) \leq 2 + 2g,
$$
proving the stated inequality in general.

Finally, if we have equality then $f$ must act as $-1$ on $H^1(C,\CC)$, and it follows (again from Lefschetz) that $f^2$ is the identity; applying Riemann-Hurwitz to the map from $C$ to the quotient $B = C/\langle f \rangle$ we may deduce that $B = \PP^1$, so $C$ is hyperelliptic and $f$ the hyperelliptic involution.
\end{proof}

An alternative, more algebraic argument for the lemma may be given using the intersection pairing on the surface $S = C \times C$ and applying the index theorem for surfaces. To carry this out, let $\Delta$ and $\Gamma \subset S$ be the diagonal and the graph of $f$ respectively, and let $\Phi_1$ and $\Phi_2 \subset S$ be fibers of the two projection maps; let $\delta, \gamma, \varphi_1$ and $\varphi_2 \in N(S)$ be the classes of these curves in the Neron-Severi group of $S$. We are trying to estimate the intersection number $b = \delta \cdot \gamma$.

We know all the other pairwise intersection number of these classes: the ones involving $\varphi_1$ or $\varphi_2$ are obvious; we have
$$
\delta^2 = 2 - 2g
$$
and since the automorphism $id_C \times f : C\times C \to C \times C$ carries $\Delta$ to $\Gamma$, we see that $\gamma^2 = 2-2g$ as well.

We can now apply the index theorem for surfaces to deduce our inequality. To keep things relatively simple, let's introduce two new classes: set
$$
\delta' = \delta - \varphi_1 - \varphi_2 \quad \text{and} \quad \gamma' = \gamma - \varphi_1 - \varphi_2,
$$
so that $\delta'$ and $\gamma'$ are orthogonal to the class $\varphi_1 + \varphi_2$. Since $\varphi_1 + \varphi_2$ has positive self-intersection, the index theorem tells us that the intersection pairing must be negative definite on the span $\langle \delta',\gamma' \rangle \subset N(S)$. In particular, the determinant of the intersection matrix


\begin{center}
\begin{tabular}{c|c|c}
& $\delta'$ &  $\gamma'$  \\
\hline
$\delta'$ & $-2g$ & $b-2$ \\
\hline
$\gamma'$ & $b-2$ & $-2g$ 
\end{tabular}
\end{center}
(where again $b = \gamma \cdot \delta$) must be positive, from which our inequality follows.

Having established an upper bound on the number of fixed points an automorphism $f$ of $C$ (other than the identity) may have, it remains to find a lower bound on the number of distinct Weierstrass points; this is the content of the next lemma.


\begin{lemma}
If $C$ is a smooth projective curve of genus $g \geq 2$, then $C$ has at least $2g+2$ distinct Weierstrass points; and if it has exactly $2g+2$ Weierstrass points it is hyperelliptic.
\end{lemma}

\begin{proof}
Let $p \in C$ be any point, and $w_1=w_1(p),\dots,w_g = w_g(p)$ the ramification sequence of the canonical series $|K_C|$ at $p$. By definition, 
$$
h^0(K_C(-(w_i+i)p)) = g - i.
$$
Applying Clifford's theorem we have
$$
g-i \leq \frac{2g - 2 - w_i - i}{2} + 1;
$$
solving, we see that
$$
w_i \leq i
$$
and hence
$$
w_p \leq \binom{g}{2}
$$
where $w_p$ is the total weight of $p$ as a Weierstrass point. Since the total weight of the Weierstrass points on $C$ is $g^3-g$ by Pl\"ucker, we see that the number of distinct Weierstrass points must be at least
$$
\frac{g^3-g}{\binom{g}{2}} = 2g+2.
$$
Finally, by the strong form of Clifford, equality here implies that the curve is hyperelliptic.
\end{proof}




\section{Proof of (half of) the Brill-Noether theorem}

In its most basic form, the Brill-Noether theorem asserts for any $d, g$ and $r$ that
\begin{enumerate}
\item if $\rho(g,r,d) := g - (r+1)(g-d+r) \geq 0$, then every curve $C$ of genus $g$ possesses as $g^r_d$; and
\item if $\rho < 0$ then a general curve of genus $g$ does not possess a $g^r_d$.
\end{enumerate}

The first part, often called the ``existence half" of Brill-Noether, was originally proved by Kempf (\cite{}) and Kleiman-Laksov (\cite{}); both proofs relied on an application of the Thom-Porteous formula to a particular map of vector bundles on the Jacobian of $C$. An account of this argument may also be found in Appendix A of \cite{}. 

We will now apply the notion of inflectionary points, and the Pl\"ucker formula in particular, to deduce the second half of the statement above---the "nonexistence half." We will then go back and deduce some of the other parts of the full Brill-Noether statement from the same set-up.

The basic approach here is to consider a family of curves $\cC \to B$, where
\begin{enumerate}
\item $B$ is a smooth curve, with distinguished point $0 \in B$;
\item the total space $\cC$ is smooth;
\item for all $b \neq 0 \in B$, the fiber $C_b$ is a smooth, projective curve of genus $g$;  and
\item the fiber $C_0$ over $0$ is a rational curve with $g$ ordinary cusps.
\end{enumerate}

We will establish the

\begin{theorem}
If $\cC \to B$ is a family of curves as above, then for general $b \in B$ the fiber $C_b$ does not possess a $g^r_d$ with $\rho < 0$.
\end{theorem}




\begin{enumerate}
 
\item Reference to the appendix of 3264 for the existence half
\item generic $g^2_*$ is birational; $g^3_*$ is very ample (on a general curve)
\end{enumerate}
\input{footer}