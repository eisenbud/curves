\input{header.tex}

\chapter{Linear series and morphisms to projective space}\label{linear series}

We start by laying
out four major definitions:
divisors, linear series, invertible sheaves, and maps to projective space. 
These ideas are used
throughout
this
book. In the last section 
we explore some special cases, culminating with
the condition for an invertible sheaf to provide an embedding of a curve in projective space.

We prove only some of our assertions; a reader who wants to see
all the proofs should keep
handy
a copy of \cite{Hartshorne1977} or the equivalent. 
A
more experienced reader,
could instead skip ahead to Chapter 3.

As an analytic space, a complex projective smooth curve is a compact
Riemann surface,
\index{Riemann surface}%
a compact
1-dimensional complex
manifold. In this sense its local structure is trivial,
but its
global structure
can be hard to visualize. 
\index{Riemann, Georg}%
\index{Clebsch, Alfred}%
Any two Riemann surfaces with the same genus%
\footnote{The notion of genus was introduced by Riemann in his great paper~\citeyear{Riemann}, though he never used the term. Instead,
he defined the \emph{connectivity} 
(Zusammenhang\index{Zusammenhang}%
) 
of a Riemann surface $X$
to be the number 
of disjoint 
closed curves 
(one-dimensional real submanifolds) that can be drawn on $X$ such that 
the complement of their union
is connected. The term genus 
(Geschlecht\index{Geschlecht}%
)
was first used by
\def\marginpar#1{}%
Clebsch.
Both uses 
were 
subtly different
from their modern counterparts: whereas 
we speak of genus as a property of a given surface, Riemann and Clebsch 
used this idea as a way of partitioning the family of all Riemann
surfaces into groups.
For a discussion, see
\cite{MR4175877}.
\par
}

are $C^\infty$ isomorphic,
but except for genus 0, where the sphere has a unique complex structure,
there are continuous families of 
nonisomorphic 
global structures.  The differences among Riemann surfaces or
algebraic curves is revealed in 
the
geometry of their maps to projective spaces. Throughout this book we
will study curves in this way. 
It turns out that in characteristic 0 the algebraic and complex analytic theories are equivalent. 

If $U$ is a Zariski open set of a projective variety, then a \emph{regular} function on $U$
is a rational function whose denominator does not vanish on $U$.
Because the only global regular functions on a projective variety are the  constant functions, 
interesting maps must be described and studied using
a different approach, and a large part of this chapter is devoted to the necessary machinery for doing this. The idea is simple: a point in projective space is the intersection of the hyperplanes containing it, so a map $\phi: C\to \PP^r$ from a curve to projective space can be described set-theoretically
by the set of preimages of these hyperplanes. 
In other words, a point $p\in C$ is sent to the point
that is the intersection of those hyperplanes whose preimages contain $p$.
 
\begin{figure}[b]
\centerline {\includegraphics[height=2in]{"main/Fig01-1"}}
 \caption{Divisors of the linear system corresponding to the map
   $\phi$ from $C$ 
\marginparhere{replaced ``$:C\to$'' by words to avoid bad break}
to $\PP^2$ are preimages of the hyperplanes\emdash
   in this case the dashed lines\emdash in the plane.
 The image of $p$ is determined by the intersection of the two lines.
}
\end{figure}


Some hyperplanes in $\PP^{r}$ will be tangent to the image $\phi(C)$ at a point $\phi(p)$, and in that case the point $p$ should be counted with higher multiplicity in the preimage of that hyperplane; in
this way we arrive at a notion of divisor as a sum of points with multiplicities.

\section{Divisors}

On a smooth projective curve $C$, we define a \emph{divisor} to be a
finite formal sum of points of $C$ with integer coefficients, which we
can write compactly as $\sum_{p\in C} m_p\cdot p$ with all but
finitely many $m_p=0$.  The coefficient $m_p$ is called the
\emph{multiplicity} of the point $p$ in the divisor $D$; if all
coefficients $m_p$ are nonnegative we say that $D$ is
\emph{effective}. Thus the group of divisors $\Div C$ is the free
abelian group whose generators
\index{divisor!on curve}%
\index{multiplicity!of divisor}%
\index{divisor!effective}\index{effective!divisor}%
are the points of $C$.


The \emph{degree} of  $D = \sum_{p\in C} m_p\cdot p$ is by definition
\index{degree!of a divisor}%
the sum $\sum m_p$ of its coefficients. Because the curve is smooth
each local ring is a discrete valuation ring, so two elements of 
$\sO_{C,p}$ with the same order of vanishing at $p$ generate the same ideal in the local ring. Thus an effective divisor 
can be identified with a finite subscheme of $C$, and vice versa. If $D = \sum m_p\cdot p$ and $E = \sum n_p\cdot p$ are any two divisors, we write $E \geq D$ to mean $n_p \geq m_p$ for all $p \in C$.


\section{Divisors and rational functions}

Let $C$ be a smooth projective curve, $U \subset C$ an open subset and
$f \in \cO_C(U)$ a regular function, not identically zero. At every
point $p \in U$, we define the \emph{order} of $f$ at $p$, denoted
\index{order!of a function}%
\index{notation!$\ord_p(f)$}%
$\ord_p(f)$j,
to be the highest power of the maximal ideal $m_p \subset
\cO_p$ containing $f$, and we define the divisor $(f)$ associated to
\index{divisor!associated to a function}%
the function $f$ by 
$$
(f) := \sum_{p \in U} \ord_p(f) \cdot p.
$$

More generally, if $h$ is any rational function on $C$, given locally as a quotient $f/g$ of regular functions $f$ and $g$, we define the divisor of $h$ to be
$$
(h) := (f) - (g);
$$
\index{notation!$\div(C)$}%
this is independent of the choice of $f$ and $g$. The divisor of a
\index{divisor!principal}\index{principal!divisor}%
rational function $h$ is called a \emph{principal divisor}; principal
divisors form a subgroup $\Div_0(C)$ of the group $\Div(C)$ of all
divisors. We say that two divisors $D$ and $E$ on $C$ are
\emph{linearly equivalent} if their difference $D-E$ is a principal
divisor. The group $\Div(C)@/` `\Div_0(C)$ of linear equivalence classes \marginpar{the quote marks should not appear}
\index{Picard group}%
of divisors is called the \emph{Picard group} of $C$, denoted
\index{notation!$\pic C$}%
$\pic C$.

Linear equivalence
\index{linear!equivalence}\index{equivalence!linear}%
is important in the description of a map $C\to \PP^{r}$ by divisors
because in $\PP^{r}$ any two hyperplanes, defined by the vanishing of linear forms  $\ell_{1}=0$ and $\ell_{2}=0$, differ by the globally defined rational
function $\ell_{1}/\ell_{2}$. The preimages of these hyperplanes
differ by the 
pullback of this rational function,
and are thus linearly equivalent divisors.

\subsection*{Generalizations}

We can generalize the notion of a divisor on a smooth curve in two respects.

First, we can extend the notion to higher-dimensional smooth varieties
$X$, defining a divisor to be a finite formal linear combination of
irreducible subvarieties of codimension 1 in $X$. In this setting,
most of the notions introduced above have natural analogues; for
\index{divisor!effective}\index{effective!divisor}%
example, a divisor is called \emph{effective} if all the irreducible
varieties in its expression as a sum appear with nonnegative
coefficients. We can similarly define the divisor of a rational
function on $X$, and the notion of linear equivalence of divisors.
(One notion that does not have an obvious analog is the degree of a divisor.)

We can also extend the notion to possibly singular varieties $X$,
though this requires more care. We can mimic the definition above,
defining a divisor to be a finite formal linear combination of
irreducible subvarieties of codimension 1 in $X$; this is called a
\index{divisor!Weil}\index{Weil!divisor}%
\emph{Weil divisor} on $X$. But for most purposes we have to introduce
a slightly different notion of divisor, called a \emph{Cartier
  divisor}. We first define an \emph{effective Cartier divisor} to be
\index{divisor!Cartier}\index{Cartier!divisor}%
a subscheme locally defined on some open covering $U_{i}$ by the
vanishing of one nonzerodivisor in $\sO_{X}(U_{i})$; and a
\emph{Cartier divisor} to be a difference of effective Cartier divisors.

A simple example will serve to illustrate this. Suppose $C \subset
\AA^2$ is a plane curve with a node at a point $p = (0,0) \in C$. The
point $p$ itself (that is, the reduced subscheme) is \emph{not} a
Cartier divisor, since its ideal $(x,y)$ is not generated by a single
element. Likewise, the
\emph{fat point}\marginpar{too much space before the emdash here}
\index{fat point}%
\emdash that is, the subscheme $\Gamma = V(x^2, xy, y^2) \subset C$
\emdash is not Cartier. But a subscheme of degree 2 supported at $p$
$$
\Gamma_{\alpha, \beta} := V(\alpha x + \beta y, x^2, xy, y^2) \subset C
$$ 
\emdash 
is in general Cartier, 
\since
it is defined locally by the equation $\alpha x + \beta y = 0$. 
For distinct lines $L$ the schemes $\Gamma_{L}$ are also distinct,
since $\Gamma_{L}\subset L$. The two exceptions, when $\Gamma_{L}$ is
not Cartier, occur when the line $L$ is tangent to either branch of
$C$ at the node. 
In these cases the scheme $\Gamma_{\alpha, \beta}$ is not a Cartier
divisor on $C$: the intersection $L \cap C$ has multiplicity 3 at $p$,
and is not equal to $\Gamma_{\alpha, \beta}$. 
For all these assertions see
Exercise~\ref{Cartier examples} 
at the end of the chapter; 
the reader
not already familiar with the notion of Cartier divisor is
encouraged to carry out the verifications. 

Here is another way to characterize Cartier divisors on a scheme $X$: for each open affine set $U\subset X$ we define $K_X(U)$ to be the field of fractions of $\sO_X(U)$, and write $K_X$ for the
\index{notation!$K_X$}%
\index{notation!$\sO_X^*$}%
\index{notation!$K_X^*$}%
associated sheaf. We write $\sO_X^*$ and $K_X^*$ for the sheaves of groups of units in $\sO_X(U)$ and $K_X(U)$.
A Cartier divisor on $X$ is then by definition a global section of $K_X^*/\cO_X^*$. 
Moreover, if $X$ is a 
\emph{normal} scheme
(so that its local rings at
\index{normal!scheme}\index{scheme!normal}%
the generic points of codimension-1 subvarieties are discrete
valuation rings) then Cartier divisors are the same as locally
principal Weil divisors. See~\cite[Section II.6]{Hartshorne1977} for
more information. 

In this book, we  
deal
for the most part with smooth curves;
even when singular curves $C$ arise, they will be viewed as images of
smooth curves $\tilde C$
\redden{\emdash} 
their normalizations
\redden{\emdash} 
and their geometry
analyzed in terms of that of $\tilde C$. Thus for the most part we will
be dealing with divisors in the simplest setting of smooth curves. But
there will be occasions when we want to extend our analysis to
singular curves 
or to 
higher-dimensional varieties, and in those
cases the notion of Cartier divisor is called for. 

\subsection*{Divisors of functions}

Returning to the case of smooth curves, we have:

\begin{theorem}\label{degree defn}
Let $C$ be a smooth projective curve. If $f\in K(C)$, 
the degree of the divisor $(f)$ is $0$. 
Thus any two linearly equivalent divisors on $C$ have the
same degree.
\end{theorem}

\begin{proof}
 The result is evident on $\PP^1$, where a rational 
function is the ratio of two forms of the same degree. In general, a rational function $\phi$ on a smooth curve $C$ defines a map $\pi : C \to \PP^1$, such that
$$
(\phi) = \pi^{-1}(0) - \pi^{-1}(\infty).
$$
If $C\to D$ is any map of smooth projective curves, then restricting to an affine open subset $D'$ of $D$ and its primage
$C'\subset C$
the map is represented by a homomorphism of rings $\sO_D(D') \to \sO_C(C')$ in such a way that $\sO_C(C')$ becomes a finitely generated
module over $\sO_D(D')$, which is torsion-free because $C$ is reduced and irreducible. Since $D$ is smooth,
$\sO_D(D')$ is a Dedekind domain, so $\sO_C(C')$ is free of constant rank equal to the degree of the extension of the corresponding
 fields of rational functions $\kappa(D)\subset \kappa(C)$. This implies that the degree of the fibers is constant.
 
 Returning to the case of the map $C\to \PP^1$ defined by a rational function, we see that $\pi^{-1}(0)$ and $ \pi^{-1}(\infty)$
 have the same degree, so $(\phi)$ has degree 0 as required.
\end{proof}

In particular, we see that if $C\to \PP^{r}$ is a morphism then
the pullbacks of different hyperplanes
have the same degree, and we define this to be the 
\emph{degree of the morphism}.
\index{degree!of morphism}\index{morphism!degree of}%

It follows from Theorem~\ref{degree defn} that we can write $\pic C$ as a disjoint union
$$
\pic C = \tsty\bigsqcup\limits_{d \in \ZZ} \pic_d C,
$$
where $\pic_d C$ is the set of linear equivalence classes of divisors of degree $d$.

\subsection*{Invertible sheaves}%\label{Invertible sheaves}

To deal with families of linearly equivalent divisors we will use the language of invertible sheaves. 
\index{invertible sheaf}\index{sheaf!invertible}%

Recall first that a \emph{coherent sheaf} $\sL$ on $X$ may be defined by
\index{coherent!sheaf}\index{sheaf!coherent}%
specifying
\begin{itemize}
 \item an open affine cover $\{U_{i}\}$ of $X$; 
 \item for each $i$, a finitely generated $\sO_{X}(U_{i})$-module $L_{i}$;
 \item for each $i,j$, an isomorphism $\sigma_{i,j}: L_{i}@|@_{U_{i}\cap U_{j}} \to L_{j}@|@_{U_{i}\cap U_{j}}$
 satisfying the compatibility conditions $\sigma_{j,k}\sigma_{i,j} = \sigma_{i,k}$. 
 \end{itemize}

A 
\emph{global section}
\index{global section!of coherent sheaf}\index{section!global}%
of $\sL$ is a family of elements $t_{i}\in L_{i}$ such that 
$\sigma_{i,j} t_{i} = t_{j}$. Such a section may be realized as the image of the constant function 1 under
a homomorphism of sheaves $\sO_{X} \to \sL$. 

A coherent sheaf $\cL$ is said to be 
\emph{locally free}
\index{locally free!coherent sheaf}%
if the modules $L_i$ are all free; when $X$ is irreducible, the ranks
of the free modules $L_{i}$ are all the same, and this is called the
\emph{rank}
\index{rank!of coherent sheaf}%
of $\cL$.
An 
\emph{invertible sheaf}
\index{invertible sheaf}\index{sheaf!invertible}%
is a locally free coherent sheaf of rank 1;  that is, $L@|@_U \cong \sO_U$,
for every open set in some covering of $X$. 

Invertible sheaves form a group: the tensor product
$\sL_1\otimes_{\sO_X}\sL_2$ of two invertible sheaves is  again an invertible sheaf.
The
inverse of an invertible sheaf $\sL$ is  the dual invertible sheaf $\sHom_{\sO_X}(\cL,\sO_X)$
(Proof: Evaluation of functions defines a natural map $\sF \otimes  \sHom_{\sO_X}(\cF,\sO_X)$,
and when $\sF = \sL$ is locally free of rank 1 this is locally an isomorphism.) 
Invertible sheaves can be defined from divisors on a smooth scheme (or more generally from Cartier divisors on any scheme). In case $C$ is a smooth projective curve, this is concrete: if $D = \sum m_p \cdot p$, then we define the sections of $\cO_C(D)$ on any open set $U$ by
$$
\cO_C(D)(U) := \{ \text{rational functions } f \mid \ord_p(f) + m_p \geq 0 \text{ for all } p \in U \}.
$$
Thus, at a point $p$ with $m_p > 0$, we are allowing $f$ to have a pole of order at most $m_p$; if $m_p \leq 0$ then $f$ must be regular at $p$, with a zero of order at least~$-m_p$.

More generally, we can associate an invertible sheaf to any 
Cartier divisor
\index{divisor!Cartier}\index{Cartier!divisor}%
on a scheme $X$.
First, if
 $D\subset X$ is an effective Cartier divisor (and thus locally defined by the vanishing of a nonzerodivisor) then
$D$ corresponds to a subscheme of $X$ whose ideal sheaf $\sI_{D/X}$
is invertible. We define $\cO_X(-D)$ to be the ideal sheaf $\sI_{D/X}$, and define $\sO_{X}(D)$ to be 
its inverse. The dual of the inclusion of
$\cO_X(-D) \subset \cO_X$ is a homomorphism $\sigma := \cO_X \to
\cO_X(D)$, 
which
we regard as a global section $\sigma \in H^0(\cO_X(D))$, the image of $1\in H^0(\sO_X)$. It
vanishes precisely along $D$. 

For a general (Cartier) divisor $D = E - F$, we define
$$
\cO_X(D) := \cO_X(E) \otimes \cO_X(F)^{-1}.
$$

If $D$ and $E$ are linearly equivalent divisors on $C$ \emdash that is, 
\redden{if}
there is a rational function $f$ on $C$ with $(f) = D - E$ \emdash
then multiplication by $f$ defines an isomorphism 
$\cO_C(E) \to \cO_C(D)$. 
Thus the isomorphism class of the invertible sheaf $\cO_C(D)$
corresponds to the linear equivalence class of $D$. We will see 
in Corollary~\ref{invertible sheaves and divisors} 
that every invertible sheaf on a projective scheme has this form.

If $\sigma\in H^0(\sL)$ is a global section of an invertible sheaf on
\index{global section!value at a point}%
$X$ and $p\in X$ is a point, then the 
\emph{value $\sigma(p)$ of $\sigma$ at $p$}
is the image  of $\sigma$ under the natural map
$H^0(\sL)$ to the fiber $\kappa(p) \otimes \sL_{p} \cong \CC$. 
Since the isomorphism is not canonical, $\sigma$ does not define a function on $X$ at $p$; but since any two isomorphisms
differ by a unit in $\sO_{X,p}$, the vanishing locus of $\sigma$,
denoted $(\sigma)_0$, is a well-defined subscheme of $X$.%
\index{vanishing!of global section at a point}%
\footnote{
When we  say that 
\def\marginpar{\marginparhere[200pt]}%
$\sigma$ vanishes at $p$,
or $\sigma(p) = 0$, we mean that the 
image of $\sigma$ in the stalk $\sL_p = \sL \otimes_{\sO_{X}}\!\sO_{X,p}$ is in
the maximal ideal $\gm_{X,p}$ of $\sO_{X,p}$ times $\sL_p$,
and \emph{not} that $\sigma$ is zero
as an element of the stalk $\sL_p$ itself. Similarly, we say that $\sigma$ vanishes to order $m$ at $p$ if $\sigma(p)$ lies in $\gm_{X,p}^m\sL_p$. }
%
 Moreover, if $X$ is reduced and irreducible, 
the ratio $\sigma/\tau$ of two global sections
 of the same invertible sheaf is a well-defined rational function
$\sigma(p)/\tau(p)$ at all the points where the denominator $\tau(p)$ is not 0, so the divisor class of 
$(\sigma)_0$ is independent of the choice of $\sigma \in H^0(\sL)$.

The tensor product of (rational) sections $\sigma$ of $\sL$ and $\sigma'$
of $\sL'$ is a rational section of $\sL \otimes \sL'$ 
whose divisor is
the sum of the divisors of $\sigma$ and 
$\sigma'$. Thus the group of divisor classes $\pic X$ is naturally isomorphic to the group of invertible
sheaves under $\otimes$, and we will identify the two.

\subsection*{Invertible sheaves and line bundles}

If $\sL$ is an invertible sheaf on a variety $X$ and $p\in X$ is a point, the 
\index{stalk!at a point}%
\index{notation!$\sL_p$}%
\index{notation!$\gm_{X,p}$}%
\emph{stalk} $\sL_p$
of $\sL$ is isomorphic to the local
ring $\sO_{X,p}$. We write 
$\gm_{X,p}$
for the maximal ideal of $\sO_{X,p}$. By definition the 
\emph{fiber} 
\index{fiber!of invertible sheaf}%
of $\sL$ is 
$$
\kappa(p) \otimes \sL =\sL_p/\gm_{X,p}\sL_p\cong \CC
,
$$
where 
\index{notation!$\kappa(p) := \sO_{X,p}/\gm_{X,p}$}%
$\kappa(p) := \sO_{X,p}/\gm_{X,p}$
is the residue field of $X$ at $p$.
It is not hard to prove that the collection of these fibers forms a line bundle on $X$; that is,
\index{line bundle}\index{bundle!line}%
a morphism of schemes $L \to X$ whose fibers have the structure of 1-dimensional vector spaces
such that $L@|@_{U_{i}} \cong U_{i}\times \CC^{1}$ for some open covering $\{U_{i}\}$ of $X$.

Given a line bundle $L$ on $X$, 
we can recover an invertible sheaf $\sL$ associated to $L$ by defining
$\sL(U)$ to be the set of sections of $L$ defined over $U$. These two processes are inverse to one another, and allow
us to think of invertible sheaves and line bundles interchangeably.

Though we 
generally
use the invertible sheaf terminology, there are at least two points
in which the line bundle approach is more natural. First,  the
vanishing of a section of an invertible sheaf at a point $p$ is
genuinely the vanishing of the
section of the line bundle as a function. Second, and more serious, given a morphism $f: Y\to X$ of schemes, the 
\index{pullback!of an invertible sheaf}%
\index{pullback!of a line bundle}%
pullback $f^*(\sL)$ of an invertible sheaf $\sL$ on $X$ is defined as
the tensor product of $\sO_Y$ with a sort of naive pullback, whereas
the pullback of a line bundle is a straightforward set-theoretic
operation.

\begin{example} [Invertible sheaves on $\PP^{r}$]\label{linear series on Pr} Since $\CC[x_0,\dots,x_r]$ is a 
unique factorization domain, the ideal of any codimension 1 subvariety of $\PP^r$ is generated by one
nonzero element, which is thus a nonzerodivisor \emdash it is a hypersurface.  As we explained above,
any two hypersurfaces of degree $d$ differ by the divisor of a rational function, so
the group of divisor classes on $\PP^r$ is $\ZZ$.
In other words,
the class of a divisor is defined by its degree.
Thus if $D = V(F)\subset \PP^{r}$ is a hypersurface defined by the vanishing of a  form 
$F$ of degree $d$,
it is natural to use the name 
$\sO_{\PP^r}(d)$
\index{notation!$\sO_{\PP^r}(d)$}%
  for $\sO_{\PP^r}(D)$.

If $D$ is an effective divisor other than 0, then $H^{0}(\sO_{\PP^{r}}(-D)) = 0$, since there are
no globally defined functions vanishing on $D$ except 0.
 
To compute $H^0(\cO_{\PP^1} (d))$ directly, let $D = z_1 +z_2
+\cdots+z_d$ be a divisor of degree 
$d$ 
and suppose that the coordinates are chosen so that none of the $z_i$ are at infinity. The sections of $\cO_{\PP^1} (D)$ are the rational functions with poles in $\PP^1$ only at 
the $z_i$. Identifying $\PP^1\setminus \{\infty\} = \AA^1$ with $\CC$ these can each be written as
$$
\frac{g(z)}{(z-z_1)(z-z_2)\cdots(z-z_d)}
,
$$
where $g$ is a polynomial. The condition that the point at infinity is
not a pole is the condition $\deg g \leq d$. With this condition,
these rational functions form a vector space of dimension $d+1$.

More generally, because every
rational function on $\PP^{r}$ has degree 0, and any two global sections differ by a rational
function, 
every global section of $\sO_{\PP^{r}}(d)$ vanishes on a divisor of degree $d$. Thus
we may identify $H^{0}(\sO_{\PP^{r}}(d))$ with the $\tbinom{r+d}{r}$-dimensional vector space of forms of degree $d$ on $\PP^{r}$.

Putting this together for future reference we have:
\index{invertible sheaf!characterization}\index{sheaf!invertible}%

\begin{proposition}
Every invertible sheaf $\sL$ on $\PP^r$ has the form $\sL \cong\sO_{\PP^r}(m)$ 
\,for a unique $m = \deg \sL \in \ZZ$; and we have
 $$
 H^0(\sO_{\PP^r}(m)) = 
\let\marginpar\marginparhere    
\CC[x_0,\dots, x_r]_m
,
 $$
 the space of forms of degree $m$ in $r+1$ variables.
\end{proposition}
\end{example}

\section{Linear series and maps to projective space}

We will use invertible sheaves to  describe maps of a given variety $X$ to projective space. For this we add the notion of linear series (sometimes called linear system). 
\index{linear!series}\index{series!linear}%
\index{linear!system}\index{system!linear}%

\begin{definition}
 A \emph{linear series} on a scheme $X$ is a pair $\sV  = (\sL, V)$ where $\sL$ is an invertible sheaf  on $X$ and
 $V$ is a nonzero vector space of global sections of $\sL$. We defa 
\emph{dimension}
\index{dimension!of linear series}%
of the linear series to be  
 $$
 \dim \sV := \dim_\CC V -1.
 $$
  \end{definition}
  
To every global section $\sigma$ of an invertible sheaf $\cL$ on a variety $X$  we can associate an effective divisor $(\sigma) = (\sigma)_0$ defined by the vanishing of $\sigma$. If $\tau$ is a scalar multiple of $\sigma$, it has the same divisor; and if 
 $H^0(\sO_X) = \CC$ (for example if $X$ is reduced, connected, and
 projective) then the converse is true: two sections of $\cL$ with the same divisor differ by multiplication by a scalar.  
 
 We sometimes write
 $|\sL|$ for the complete linear series $(\sL, H^0(\cL))$. If 
$\sL = \sO(D)$
\index{notation!$\vert \sL\vert , \vert D\vert $}%
 we often write this as $|D|$.

Thus a linear series $\sV = (\cL, V)$ gives rise to a family of
effective divisors on $X$, all in the same linear equivalence class,
parametrized by the projective space $\PP V^*$ 
of nonzero $\sigma \in V$ mod scalars.
This is indeed the way 
we think of a linear series: as a family of divisors parametrized by a
projective space.
The definition of the dimension
of a linear series 
reflects this: 
it's not the dimension of $V$ as a vector
space, but the dimension of the corresponding projective space. 
Similarly, we speak
 of ``the divisors of
a linear series $\sV$'' or as divisors ``moving'' in a linear series.

The intersection of the vanishing loci of all the sections in $V$ is

\index{base locus}%
called the \emph{base locus} of $\sV$. It is in general a subscheme of
$C$. The points in its support are called \emph{base points} of $\sV$.
If the vector space $V = H^0(\cL)$, the linear system is said to be
\index{linear system!complete}\index{complete!linear system}%
\emph{complete}; 
from the viewpoint
of the \emph{family of divisors},
\index{family of divisors}%
this is the same as saying the linear system includes every
effective divisor in the linear equivalence class. 
 
Suppose that $C$ is a smooth projective curve. Since the divisors in a linear series are linearly equivalent, they all have the same 
degree, called the degree of the linear series. If $\sV$ is a linear
series of degree $d$ and dimension $r$ we say that \emph{$\sV$ is a}
\blue{$g^r_d$}.
\index{notation!$g^r_d$}%
This classical  language means that $\sV$ 
\marginpar{$\sV$ it $\to \sV$\\[2pt]dropped quotes around ``moving'': once is enough} 
represents a group of $d$
points moving within a linear equivalence class with $r$ degrees
of freedom.%
\footnote{
This ``$g$'' is unrelated to the genus; 
it's short for \emph{gruppi di punti}, Italian for ``divisors."}

The next result is fundamental:

\begin{theorem}\label{morphisms and linear series}
For any scheme $X$ there is a natural bijection between the set of
nondegenerate morphisms $\phi : X \to \PP^r$ modulo $\PGL_{r+1}$ and
\marginpar{dropped two commas, ok?}
base-point free linear series of dimension $r$ on $X$ up to isomorphism. 
\end{theorem}

Here \emph{nondegenerate} means the image of the morphism $\phi$ is
\marginpar{made PGL upright for consistency}
not contained in any hyperplane. The phrase ``modulo $\PGL_{r+1}$'' is
needed because the notation $\PP^r$ supposes a choice of projective
coordinates, and 
$\PGL_{r+1}$ is the group of linear coordinate transformations (actually all automorphisms, by Exercise~\ref{aut Pr}).
To get a correspondence without the dependence on a basis we could think of morphisms to $\PP V$, the set of 1-quotients of $V$.

Suppose that $(\sL, V)$ is a linear series on a smooth projective curve $C$ that does have a base locus $D_0$. We can then subtract $D_0$ from all the divisors of the linear series, replacing $\sL$ by $\sL(-D_0)$ and dividing each section in $V$
by the section $\sigma$ of $\cO_C(D_0)$ vanishing on $D_0$.
\redden{This yields}
a new, base-point free linear series of the same dimension 
\redden{but lower degree.}

\redden{We prove} 
Theorem~\ref{morphisms and linear series} 
by describing the correspondence in both directions:

\subsubsection*{From morphism to linear series}
Let 
\marginpar{shortened subsection titles and deleted number}
$f : X \to \PP^r$ be any nondegenerate morphism. The associated linear series $\sV = (\cL, V)$ on $X$ has $\cL = f^*\cO_{\PP^r}(1)$, the pullback of the invertible sheaf $\cO_{\PP^r}(1)$, and 
$$
V = f^*H^0(\cO_{\PP^r}(1)) \subset H^0(\cL).
$$
In geometric terms, if we think of a linear series as a family of
effective divisors, this is the linear series on $X$ consisting of
preimages of hyperplanes in $\PP^r$. 
\marginpar{dropped ``The condition of''}
Nondegeneracy assures us that the preimage of 
a hyperplane in $\PP^r$ is indeed a divisor on $X$.

\subsubsection*{From linear series to morphism}
%\label{morphism from series}

Suppose  that $X$ is any scheme, and $\sV = (\cL, V)$ is a base-point
free linear series of dimension $r$ on $X$; we want to describe a
corresponding morphism $f : X \to \PP^r$. Choose a basis $\sigma_0,
\dots, \sigma_r$ for $V$. If we let $D_i = (\sigma_i) \subset X$ be
the divisor of zeroes of $\sigma_i$ and 
\redden{set}
$U_i := X \setminus D_i$, 
the ratio $\sigma_j@/\sigma_i$ is a regular function on $U_i$, and
we can define a map $f_i : U_i \to \PP^r$ by
$$
f_i : p \; \mapsto \; \Big(\frac{\sigma_0}{\sigma_i}(p), \dots, \frac{\sigma_r}{\sigma_i}(p)\Big), 
$$
where the component $\sigma_i@/\sigma_i = 1$ ensures that not all the components are 0, so that the image point is well-defined.
The maps $f_i$ and $f_j$ agree on the overlap $U_i \cap U_j$, and by the hypothesis that $\sV$ is base-point free the $U_i$ cover $X$;
so together they define a regular map $f$ from $X$ to $\PP^r$. 

We can describe this map set-theoretically without having to choose a basis: since $\sV$ is assumed base-point free, for any point $p \in X$ the subspace $H_p := \{ \sigma \in V \mid \sigma(p) = 0 \}$ is a hyperplane in $V$; thus we get a map $f : X \to \PP V$.

\begin{example}\label{Veronese definition}
The morphism 
\vspace*{-2pt}%
from $\PP^r$ defined by the complete linear series 
\marginpar{supplied missing right paren}
$(\cO_{\PP^r}(d), H^0(\cO_{\PP^r}(d)))$ has target
%$\PP^{\smash{\vcenter{\hbox{$\scalebox{0.8}{$\tbinom{r+d}{r}$}}@-1$}}}$,
$\PP^{\sssty{r+d\choose r}-\ssty 1}$, 
and takes a point $(a_0,\dots a_r)$ to the point whose coordinates are all the monomials of
degree $d$ in $x_0,\dots x_r$. It is called the \emph{$d$-th Veronese morphism} from $\PP^r$. For example, on $\PP^1$ this has the form
\index{Veronese!morphism}\index{morphism!Veronese}%
\index{Veronese!surface}%
$$
(x_0,x_1) \mapsto (x_0^d,\ x_0^{d-1}x_1,\ \dots,x_1^d).
$$
The image of $\PP^1$ under this morphism is called 
\index{curve!rational normal of degree $d$}%
\index{conic!plane}\index{plane!conic}%
\index{cubic!twisted}{twisted!cubic}%
\index{rational normal curve}%
the 
\blue{\emph{rational normal curve}} 
of degree $d$; in the case $d=2$ is the
\emph{plane conic}, and in the case $d=3$ it is called the 
\blue{\emph{twisted cubic}.}
Veronese himself studied the image of $\PP^2$
by the Veronese morphism of degree 2 now simply called the 
\blue{\emph{Veronese surface}.}
\end{example}

\section{The geometry of linear series}

\subsection*{An upper bound on $h^0(\sL)$}

We will develop sophisticated ways of estimating the dimensions of linear series. We begin with an elementary bound:

\begin{theorem}\label{characterization of P1}
Let $C$ be a smooth projective curve. If $\cL$ is an invertible sheaf of degree $d\geq 0$ on $C$, then $h^0(\cL)\leq d+1$; and
equality holds if and only if $C \cong \PP^1$.
\end{theorem}

\begin{proof}
Let $p_1,\dots,p_{d+1}$ be 
\marginpar{dropped ``First'', ``any'' (also ``any'' 3 lines below)} 
points of $C$. If $h^0(\cL)$
\redden{exceeded $d+1$},
there would be a nonzero section
$\sigma \in H^0(\cL)$ vanishing at $p_1,\dots,p_{d+1}$; the divisor
$(\sigma)$ would then have degree $\geq d+1$, contradicting the
hypothesis that $\deg \cL = d$.

For the second part, suppose that $h^0(\cL) = d+1$. If
$p_1,\dots,p_{d}$ are points of $C$, there is a nonzero section
$\sigma \in H^0(\cL)$ vanishing at $p_1,\dots,p_{d}$; by degree
considerations, it cannot vanish anywhere else. It follows that any
two divisors of degree $d$ on $C$ are linearly equivalent, hence that
any two points $p,q \in C$ are linearly equivalent. Thus there is a
rational function $f$ on $C$ with exactly one zero and one pole,
giving an isomorphism $C \cong \PP^1$. 
 \end{proof}

From the correspondence between invertible sheaves and maps to projective space, we now get:
\begin{corollary}\label{minimal degree curves}
If $C\subset \PP^d$ is a  nondegenerate curve, 
the degree of $C$ 
\redden{is at least $d$,}
with equality only in the case
that $C$ is a rational normal curve.\qed
\end{corollary}

Rational normal curves arise often in the literature because they have many extremal properties, such as those of Corollaries~\ref{minimal degree curves} and \ref{independence of points on a RNC}. For a related result see Corollary~\ref{uninflected curves}. Since there is only
one invertible sheaf of degree $d$ on $\PP^1$,
any two rational normal curves of degree $d$ differ by a transformation in $\PGL_{d+1}$,
and we will therefore often speak of \emph{the} 
rational normal curve.
\index{rational normal curve}%

\begin{corollary}\label{independence of points on a RNC}
Let $C\subset \PP^d$ be the rational normal curve of degree $d$. If $E$ is an effective divisor on $C$ of degree $e\leq d+1$, then the
\emph{span} of $E$ (that is, the smallest linear space containing the subscheme $E$) has dimension $e-1$.
\end{corollary}

Less formally: any finite set or subscheme of $C$ is as linearly independent as possible.

\begin{proof}
Since $E$  
\marginpar{dropped unused $L$}
imposes at most $e$ conditions on hyperplanes, 
\redden{the span of $E$ has
dimension}
at most $e-1$.

On the other hand, the hyperplanes containing $E$ meet $C$ in a divisor of the form $E+E'$, where
$\deg E' = d-e$. Thus the projection of $C$ from $E$ is a nondegenerate curve of degree $d-e$ in $\PP^{d-(\dim \rmspan E)-1}$,
so from Corollary~\ref{minimal degree curves} we get 
\marginpar{$\ot$ \redden{moved $-1$ out of parentheses; please double check}}
\redden{$d-e \geq d-(\dim \rmspan E)-1$,} 
as required.
\end{proof}

In the case of distinct points on a rational normal curve
it is easy to make a direct argument why they are as independent as possible: Choose coordinates so that none of the points are
at infinity. We can identify the points $\lambda_1,\dots,\lambda_{d+1} \in C \cong \PP^1$ with distinct complex numbers, and the independence (for $\ell = d+1$) is equivalent to the the nonvanishing of the Vandermonde determinant
$$
\begin{vmatrix}
\,1 & \lambda_1 & \lambda_1^2 & \cdots & \!\lambda_1^d \\
\,1 & \lambda_2 & \lambda_2^2 & \cdots & \!\lambda_2^d \\
\,\vdots & & & & \!\vdots \\
\,1 & \lambda_{d+1} & \lambda_{d+1}^2 & \cdots & \lambda_{d+1}^d@ \\
\end{vmatrix}
= \prod_{1 \leq i < j \leq d+1} (\lambda_j - \lambda_i)
$$


\subsection*{Incomplete linear series}

In classical algebraic geometry a linear series of dimension 1 is
called a 
\blue{\emph{pencil},}
\index{pencil!def}%
a linear series of dimension 2 is called a
\emph{net} and, less commonly, a three-dimensional linear series is
called a \emph{web}.  We will use only the first of these
\redden{terms}.

\begin{figure}
\centerline {\includegraphics[height=3in]{"main/Fig01-2"}}
 \caption{Projection of a space curve from a general point $p$ to $\PP^2$.
\marginparhere{Perhaps provide a call to the figure from the text?}
}
\end{figure}

The morphism associated to an incomplete linear series $V \subset
H^0(\cL)$ is the composition of the morphism associated to the
complete linear series $|\cL|$ with a linear projection. In general, if 
\redden{$V,W \subset H^0(\cL)$} 
are nested linear series, 
\redden{$V\subset W$,}
then a 1-dimensional quotient of $W$ restricts to a 1-dimensional quotient of $V$ unless it vanishes on $V$.
Thus we have a partially defined linear morphism $\pi: \PP W  \to \PP V$. 
The 
\blue{\emph{indeterminacy locus}}
\index{indeterminacy locus}%
of the map
consists of the set of 1-quotients vanishing on $V$, that is, 
\marginpar{is, to $\to$ is,}
$\PP(W/V) \subset \PP W$; we will call it the 
\blue{\emph{center of the projection $\pi$.}}
\index{center!of a projection}%
(It is sometimes useful to
think of the dual picture: lines in $W^*$ map to lines in $V^*$ except when they lie in the subspace $(W/V)^* = \Ann V\subset\nobreak W^*$.)
Thus there is a commutative diagram
\marginpar{\vskip10pt the {\tt\string\nohug} option cancels the rotated labels}
\begin{diagram}
& & \PP W^* \\
& \ruTo^{\phi_W} & \dDashto_\pi \\
C & \rTo^{\phi_V} & \PP V^*.
\end{diagram}

If $W$ is base-point free, then $V$ is base-point free if and only if
the center of the projection $\pi$ is disjoint from $\phi_W(C)$. 
\redden{We then}
\marginpar{to improve layout}%
\index{regular!projection}%
say that $\pi$ is 
\blue{\emph{regular}} on $C$.

By way of language, we will say that a curve $C \subset \PP^r$
embedded by a complete linear series $|\sL|$ is 
\blue{\emph{linearly normal};}
\index{linearly normal}%
this is equivalent to saying that the pullback map
$$
H^0(\cO_{\PP^r}(1)) \to H^0(\sL)
$$
is surjective. Since regular projections of a curve correspond to subseries, this is equivalent to saying that $C$ is \emph{not} the regular  projection of a nondegenerate curve $\tilde C \subset \PP^{r+1}$. 

\subsection*{Sums of linear series}
If
$\cD = (\cL,V)$ and $\cE = (\cM, W)$ be two linear series on a curve
$C$. By the
\blue{\emph{sum}} 
\index{sum!of linear series}%
$\cD + \cE$ of $\cD$ and $\cE$
 we will mean the pair 
$$
\cD + \cE = (\cL \otimes \cM, U) 
$$
where $U \subset H^0(\cL \otimes \cM)$ is the subspace generated by
the image of $V \otimes W$, under the multiplication/cup product map
$H^0(\cL) \otimes H^0(\cM) \to H^0(\cL \otimes \cM)$. In other words,
it's the subspace of the complete linear series $|\cL\otimes \cM|$
spanned by divisors of the form $D+E$, with effective divisors $D \in
\cD$ and $E \in \cE$.
 
The sum of two base-point free linear series is clearly base-point free; if the two series correspond to maps
\marginpar{reworked map notation for better layout}
$\phi:C\to \PP^r$ and $\psi:C\to \PP^s$ then the sum corresponds to the composition of the map
$(\phi, \psi): C\to \PP^r\times \PP^s$ with the 
\blue{\emph{Segre embedding}} 
\index{Segre embedding}\index{embedding!Segre}% 
$\sigma : \PP^r\times \PP^s \to \PP^{(r+1)(s+1)-1}$
given in coordinates by
$$
((x_0,\dots, x_r), (y_0, \dots, y_s))\mapsto (x_0y_0, \dots, x_iy_j, \dots, x_ry_s).
\vspace*{-\parskip}
$$

Note that this says nothing about the dimension of $\cD + \cE$, since the composite map $\sigma \circ (\phi, \psi)$ will typically not be nondegenerate. In fact, the best we can do in general is the following proposition.


\begin{proposition}\label{sum of linear series}
 If $\cD$ and $\cE$ are two  linear series that contain effective divisors on a curve $C$, then
$$
\dim(\cD + \cE) \geq \dim \cD + \dim \cE.
\vspace*{-\parskip}
$$
\end{proposition}

\begin{proof}
Saying that
$\dim \cD \geq m$ is equivalent to saying that we can find a divisor
$D \in \cD$ containing any given $m$ points of $C$; since $\cD + \cE$
contains all pairwise sums $D + E$ with $D \in \cD$ and $E \in \cE$,
we can certainly find a divisor $F \in \cD + \cE$ containing any given
$\dim \cD + \dim \cE$ points of $C$. 
\end{proof}

\subsection*{Which linear series define embeddings?}

A linear series $\sV = (\sL, V)$ is called  
\blue{\emph{very ample}}
\index{very ample}%
if it is base-point free and defines an embedding (what Hartshorne
\marginpar{\redden{do you mean H calls all embeddings closed immersions?}}
calls a ``closed immersion''). If $D$ is a Cartier divisor on $X$,
then we say that $D$ is \emph{very ample} if the complete linear
series $|D|$ is very ample, and we say that $D$ is 
\blue{\emph{ample}}
\index{ample}% 
if
$mD$ is very ample for some integer $m>0$.  

Similarly, $\sV$ or $D$ are called 
\blue{\emph{birationally very ample}}
\index{birationally very ample}%
if $\V$ or $D$ are base-point free and define a map that is generically one-to-one or, equivalently,
an embedding when restricted to an open set. This arises frequently when speaking of a map from a smooth
curve $C$ onto a curve $C_{0}$ in the plane, since the latter frequently has singularities.

Given a linear series $\sV = (\sL, V)$ and an effective divisor $D$ on $C$, we  set
$
\sV(-D) = (\sL(-D),V(-D))
$
where
$$
\sL(-D): = \sL \otimes \sO(-D)\hbox{ and } V(-D) := \{ \sigma \in V \mid \sigma(D) = 0 \}.
$$
The difference $\dim \sV - \dim \sV(-D)$ is called the \emph{number of conditions imposed by $D$ on the linear series $\sV$}; we say that $D$ \emph{imposes independent conditions} on $\sV$ if $\dim \sV - \dim \s V(-D) = \deg D$.

Via the correspondence of Theorem~\ref{morphisms and linear series}, statements about the geometry of a morphism $\phi : C \to \PP^r$ can be formulated as statements about the relevant linear series. In the case of complete series, these are statements about the vector space $H^{0}(\sL)$ of global sections of $\sL$. We write $h^{0}(\sL)$ for the vector space dimension of $H^0(\sL)$ (and similarly for other cohomology groups). It is useful to have criteria
in these terms for when a linear series defines an embedding, or even to be base-point free so that it
defines a morphism:

\begin{proposition}\label{very ample}
{\rm\cite[Theorem IV.3.1]{Hartshorne1977}}
Let $\cL$ be an invertible sheaf on a smooth curve $C$. The complete linear series $|\cL|$ is base-point free if and only if
$$
h^0(\cL(-p)) = h^0(\cL) - 1 \quad \forall p \in C;
$$
and $\sL$ is very ample if and only if
$$
h^0(\cL(-p-q)) = h^0(\cL) - 2 \quad \forall p, q \in C.
\vspace*{-\parskip}
$$
\end{proposition} 

\begin{figure}
\centerline {\includegraphics[height=2.8in]{"main/Fig01-3"}}
 \caption{Two distinct points or one double point might impose just
   one condition on the linear series defined by projection from a
   point $a$ (here illustrated by vertical projection).
\marginparhere{again, call it in the text?}
}
\end{figure}

\begin{proof}
First, if $\cL$ is base-point free, then vanishing at a point imposes one linear condition on sections of $\sL$, so 
$h^0(\sL(-D)) \geq h^0(\sL)-\deg D$ for any
effective divisor $D$.

To say that $|\cL|$ is base-point free means that for every point $p\in C$ there is a section of $\sL$ that does not vanish at $p$; thus vanishing
at $p$ is a nontrivial linear condition on $H^0(\sL)$. Conversely, if $h^0(\cL(-p)) = h^0(\cL) - 1$ then $p$ imposes a nontrivial condition, so
some section of $\sL$ does not vanish at $p$.

Since a divisor of degree $d$ cannot impose more than $d$ condtions on a linear series, the statement $h^0(\cL(-p-q)) = h^0(\cL) - 2$ for all $p, q$ implies the condition for base-point freeness; and saying that $\phi_\cL(p) \neq \phi_\cL(q)$ implies that the linear series defines a set-theoretic injection. 

Let $\phi:C \to \PP^r$ be the map defined by $\sL$. To say that $\phi$  is an embedding locally at a point $p$, we need to know that the map of local rings
$$
\phi^*: \sO_{\PP^r,\phi(p)} \to \sO_{C,p} 
$$
is surjective. 

Since $C$ is projective, the map $C\to \phi(C)$ is finite,
so $\phi^*$ makes $\sO_{C,p}$ into a finitely generated $\sO_{\PP^r,\phi(p)}$-module.
By Nakayama's lemma it suffices to show that 
$\sO_{C,p}/\phi^*(\gm_{\PP^r,\phi(p)})$
is generated by the image of $\sO_{\PP^r,\phi(p)}/\gm_{\PP^r,\phi(p)} = \CC.$

 Since the constants  $\CC =\sO_{\PP^r,\phi(p)}/\gm_{\PP^r,\phi(p)}$ pull back to the constants in
$\sO_{C,p}/\gm_{C,p}@$,
surjectivity will follow if 
$$
\frac{\sO_{C,p}}
{\phi^*(\gm_{\PP^r,\phi(p)})  \sO_{C,p}}
$$
is 1-dimensional; that is, if the linear series contains
a section that vanishes to order exactly 1 at $p$, which is equivalent to the condition
that $h^0(\sL(-2p)) \neq h^0(\sL(-p))$.
\marginpar{supplied missing right paren}
\end{proof}

A more geometric version of the last part of the proof would be to say that the condition of the existence of a section
vanishing to order exactly 1 implies that $\phi$ is an injection on the tangent space to $C$ at $p$. This implies that
the map is analytically an isomorphism onto its image, and together with the finiteness of the map, this suffices.

If $\phi:X \to \PP^r$ is a generically finite morphism, then the
\emph{degree} of $\phi$ is the number of points in the preimage of a
general point of $\phi(X)$. It follows that if $D := \sum_{p\in C}
n_pp$ is a divisor on a smooth curve, and the linear series $|D|$ is
base-point free, then the degree of the morphism associated to $|D|$
is $\deg D := \sum_{p\in C} n_p$.
{\meshing\par}

\section*{Exercises}

\begin{exercise}\label{here there be basepoints}
 Show that there is no nonconstant morphism $\PP^r\to \PP^s$ when $s<r$ by showing that any nontrivial linear
 series of dimension $<r$ on $\PP^r$ has a nonempty base locus. Hint: use B\'ezout's theorem.
\end{exercise}

\begin{exercise}
Let 
$$
V = \langle s^{a_0}t^{d-a_0}, \dots, s^{a_r}t^{d-a_r}\rangle \subset \CC[s,t]_d,
$$
and let $\sV = (\sO_{\PP^1}(d), V)$. Determine the conditions for
\redden{each of these properties to hold:}
\begin{enumerate}
 \item $\sV$ is base-point free.
 \item $\sV$ is ample.
 \item $\sV$ is very ample.
 \item $\sV$ is complete.
\end{enumerate}
\end{exercise}

\begin{exercise}
Extend the statement of Proposition~\ref{very ample} to incomplete linear series; that is, prove that the morphism associated to a linear series $(\cL, V)$
on a smooth curve is an embedding iff
$$
\dim\big( V \cap H^0(\cL(-p-q))\big) = \dim V - 2 \quad \forall p, q \in C.
$$
\end{exercise}

\begin{exercise}\label{aut Pr}
Show that an automorphism of $\PP^r$ takes hyperplanes to hyperplanes. Deduce that it is given by the linear series
$\sV = (\sO_{\PP^r}(1), H^0(\sO_{\PP^r}(1)))$, and use this to show that $\Aut \PP^r = \PGL(r+1)$. Hint: for the first part, use B\'ezout's theorem.
\end{exercise}

\begin{exercise}\label{projective automorphism}
Let $C \subset \PP^r$ be any linearly normal curve and $\phi: C \to C$ an automorphism. Show that $\phi$ is induced by an automorphism of $\PP^r$ if and only if $\phi$ carries the invertible sheaf $\cO_{C}(1)$ to itself; that is, $\phi^*(\cO_{C}(1)) \cong \cO_{C}(1)$. In this case we say that the automorphism
is projective. Show that every automorphism of a rational normal curve $C \subset \PP^d$  extends to $\PP^d$. Since the
automorphism group $\PGL_2$ of $\PP^1$ acts transitively on $\PP^1$, we say that
$C$ is \emph{projectively homogeneous}.
\end{exercise}

\begin{exercise}\label{normality of RNC}
 Show that the ring $\CC[s^d,s^{d-1}t,\dots, t^d]$ is normal ($=$ integrally closed) by noting that its integral closure must be
 contained in $\CC[s,t]$ and then showing that if $f$ is any polynomial
 in the integral closure then the homogeneous components of $f$ are also in the integral closure.
\end{exercise}

\begin{exercise}\label{Cartier examples}
Suppose $C = V(y^2 - x^2 - x^3) \subset \AA^2$ (so that $C$ is a plane curve with a node at the point $p = (0,0) \in C$). 
\begin{enumerate}
\item Show that the point $p$ itself (that is, the reduced subscheme) is not a Cartier divisor, since its ideal $(x,y)$ is not generated by a single element. 
\item Show that the fat point, that is, the subscheme $\Gamma = V(x^2,
  xy, y^2)$, is contained in $C$ but is not a Cartier divisor on $C$. 
\item Let $\Gamma_{\alpha, \beta} := V(\alpha x + \beta y, x^2, xy, y^2) \subset C$. Show that if $\beta \neq \pm \alpha$ then $\Gamma_{\alpha, \beta}$ is a Cartier divisor on $C$; and
\item With $\Gamma_{\alpha, \beta}$ as above, show that if $\beta = \pm \alpha$ then $\Gamma_{\alpha, \beta}$ is not a Cartier divisor on $C$.
\end{enumerate}

Hint: for the last two parts, observe that if $\beta \neq \pm \alpha$ then $\Gamma_{\alpha, \beta}$  is locally the intersection of $C$ with the line $L \subset \AA^2$ given by $\alpha x + \beta y = 0$, but when $\beta = \pm \alpha$ 
the intersection $L \cap C$ has multiplicity 3 at $p$, and is not equal to $\Gamma_{\alpha, \beta}$.
\end{exercise}

\input footer.tex
