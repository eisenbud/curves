\input{header.tex}

\chapter{Linear series and morphisms to projective space}\label{linear series}

In the first two sections of this chapter we lay out a number of definitions that we will later use to discuss
maps of curves to projective space; in the last section we derive some consequences that do not involve the
use of cohomology. In the next chapter we introduce that too as well. We will prove only some of our assertions; a reader who wants to see all the proofs should keep a copy of \cite{Hartshorne1977} or the equivalent handy. On the other hand, a more experienced reader
could skip ahead to Chapter 3.

As an analytic space a complex projective smooth curve is a compact. Riemann surface. This is a compact, orientable 2-manifold with a complex structure but it's hard to ``see'' the global complex structure. Any two Riemann surfaces with the same genus are $C^\infty$ isomorphic, but except for genus 0, where the sphere has a unique complex structure,
there are continuous families of non-isomorphic global structures.  The differences among Riemann surfaces or algebraic curves is revealed in  geometry of their maps to projective spaces. Throughout this book we will study curves in this way. The algebraic and
complex analytic theories are equivalent, and in this book we generally take the algebraic path.

\section{Divisors}

Since the only  globally defined regular functions on a projective variety are the constant functions, we must take a different approach to describing the maps we will study, and a large part of this chapter is devoted to describing the necessary machinery for doing this. The idea is simple: a point in projective space is the intersection of the hyperplanes containing it, so a map $\phi: C\to \PP^r$ from a variety to projective space can be described set-theoretically
by the set of preimages of these hyperplanes, $C$: the point $p\in C$ is sent to the point
that is the intersection of those hyperplanes whose preimages contain $p$. 

If we choose homogenous coordinates $x_0,\dots, x_r$ on $\PP^r$ then hyperplanes
are defined by the vanishing of linear forms such as $x_i=0$. A general linear form
$\ell = \sum r_ix_i$ is does not define a function on $\PP^r$, but $\ell/x_i$ is a regular function on the affine space subset where $x_i\neq 0$, and we could also
 specify $\phi$ by specifying its composition with such regular functions. Thus we can refine the the notion of the divisor that is the preimage of $\ell=0$ by including the generic order of vanishing of $\ell/x_i \circ \phi$---this corresponds roughly to the order of tangency
 of the hyperplane $\ell=0$ with the image $\phi(C)$ of $C$---and we take the divisor of a rational
 function to be the difference of the divisors associated to the numerator and denominator.

Thus on a smooth projective curve $C$, we are led to define a \emph{divisor} to be a finite formal sum of points of $C$ with integer coefficients, which we can write compactly as $\sum m_p\cdot p$ with all but finitely many $m_p=0$.  The coefficient $m_p$ is called the \emph{multiplicity} of the point $p$ in the divisor $D$; if all coefficients $m_p$ are nonnegative we say that $D$ is \emph{effective}. The \emph{degree} of  $D = \sum m_p\cdot p$ is by definition the sum $\sum m_p$ of its coefficients. Because the curve is smooth each local ring is a discrete valuation ring, so every effective divisor $D$ is defined locally by the vanishing of one non-zerodivisor; and the difference of two effective divisors $D - E$ that are defined on an open
affine subset $U$ by equations $f$ and $g$ thus corresponds to a rational function
$f/g$.

Write $K(X)$ for the field of rational functions on $X$.
For each open set $U\subset X$ we define $K_X(U)$ to be the field of fractions of $\sO_X(U)$, and write $K_X$ for the
associated sheaf. We write $\sO_X^*$ and $K_X^*$ for the sheaves of groups of units in $\sO_X(U)$ and $K_X(U)$.
A Cartier divisor on $X$ is by definition a global section of $K_X^*/\CC^*$.

There is a natural map $\div$
from the group of Cartier divisors on $C$ to the free group on the points of $C$:
 for any rational function $f$ on an open set $U\subset C$
and any 
point $p\in U$ the local ring $\sO_{C,p}$ is a discrete valuation
ring and we can write $f$ uniquely in the form $f = ut^m$ where $t$ generates
the maximal ideal of $\sO_{C,p}$ and $u$ is a unit in $\sO_{C,p}$. We define
$m:= \ord_p(f)$, and we set
$$
div(f) := \sum_{p\in C}\ord_D(f)[p] 
$$
When
confusion is unlikely we write $(f) $ in place of $div(f)$, and we let
$(f)_0, (f)_\infty$ be the effective divisors that are the sums of the terms in $(f)$ that appear with positive
or  negative coefficients, so that $(f) = (f)_0-(f)_\infty$. 

Two Cartier divisors are said to be \emph{linearly equivalent}
if they differ by the divisor of a globally defined rational function $f \in K(C)$, called a \emph{principal divisor}.
\begin{definition}
The group of divisors modulo linear equivalence is called $\pic(C)$.
\end{definition}
 
Exactly the same definition of Cartier divisors and linear equivalence works for any projective variety $X$; and
the map $\div$ is also defined in the same way when $X$ is nonsingular in codimension 1, yielding
a map from the group of Cartier divisors to the free group on
codimension 1 subvarieties, called the group of Weil divisors. See~\cite{Hartshorne1977} for this and further generalizations. 
 
 
 %
%
%and for a general hyperplane, this will be a non-zerodivisor
%
%%Let $\phi: C\to \PP^{r}$ be a morphism from a smooth curve $C$. If $H\subset \PP^r$ is a hyperplane that does not contain $\phi(C)$, then the preimage of $H$ is a finite set of points on $C$, with multiplicities when $H$ is tangent to $\phi(C)$ or (possibly) when $H$ passes through a singular point of $\phi(C)$. Such a set of points with non-negative integer multiplicities is called an \emph{effective divisor} on $C$; more generally, a \emph{divisor} (sometimes called a \emph{Weil divisor}) on a scheme $X$ is an integral linear combination of codimension 1 subvarieties, and it is called \emph{effective} if the coefficients are all non-negative. The \emph{degree} of a divisor on a smooth curve
%%is the sum of the coefficients. 
%
%The divisors that arise as the pullbacks of general hyperplanes are special: since a hyperplane is defined by just one equation, which is locally given by the vanishing of a function, the pullback of a hyperplane will be locally defined by the vanishing of a single function,
%and for a general hyperplane, this will be a non-zerodivisor; that is, it is an  \emph{effective Cartier divisor}. See \cite[pp. 140-146]{H} for more information; on a smooth curve every divisor is Cartier, so the difference between Weil and Cartier divisors will not be an issue for us.
%The  word ``local'' scattered through the previous paragraph is needed because, if $X$ is a projective variety, then the only algebraic functions $X\to \CC$ are constant functions. Equivalently, the only projective subvarieties of an affine variety are points.

\subsection{Divisors of functions}
Returning to the case of smooth curves, we have:
\begin{theorem}\label{degree defn}
Let $C$ be a smooth projective curve. If $f\in K(C)$, then $deg (f) = 0$. Thus any two linearly equivalent divisors on $C$ have the
same degree.
\end{theorem}

\begin{proof}
 The result is evident on $\PP^1$, where a rational 
function is the ratio of two forms of the same degree. The divisor of a rational function $\phi$ on a smooth curve $C$ may be regarded as the pullback of the divisor of a rational function
on $\PP^1$ under the map given by $\phi$; since any non-constant map of smooth curves is flat, the pullback multiplies the degree of a divisor by the degree 
of the covering. 
\end{proof}

It follows that we can write $\pic(C)$ as a disjoint union
$$
\pic(C) = \bigsqcup_{d \in \ZZ} \pic_d(C),
$$
where $\pic_d(C)$ is the set of linear equivalence classes of divisors of degree $d$.

On $\PP^r$ the divisors of hypersurfaces of degree $d$ $F = 0$ and $G=0$ differ by the principal divisor of the rational function $F/G$,
and thus are linearly equivalent. Thus, if $\phi : C \to \PP^r$ is a morphism, then the preimages
of any two hyperplanes that don't contain the image $\phi(C)$ are linearly equivalent. In particular, they have the same
degree, called the \emph{degree of $\phi$}. If $\phi$ is an inclusion, we call this the \emph{degree of $C\subset \PP^r$.}

\subsection{Invertible sheaves}\label{Invertible sheaves}

As we have explained, a map of a curve to a projective space corresponds to a family of linearly equivalent divisors.
To deal with such families we will use the language of invertible sheaves. 

For simplicity will assume in this section that $X$ is a reduced, irreducible projective
scheme, nonsingular in codimension 1, so that divisors may be thought of as formal linear combinations of
subvarieties of codimension 1 with integer coefficients. 
  An account greater generality may be found in~\cite{Hartshorne1977}.

Recall first that a \emph{coherent sheaf} $\sL$ on $X$ may be defined by
giving 
\begin{itemize}
 \item An open affine cover $\{U_{i}\}$ of $X$; 
 \item For each $i$, a finitely generated $\sO_{X}(U_{i})$-module $L_{i}$;
 \item For each $i,j$, an isomorphism $\sigma_{i,j}: L_{i}\mid_{U_{i}\cap U_{j}} \to L_{j}\mid_{U_{i}\cap U_{j}}$
 satisfying the compatibility conditions $\sigma_{j,k}\sigma_{i,j} = \sigma_{i,k}$. 
 \end{itemize}

A \emph{global section} of $\sL$ is a family of elements $t_{i}\in L_{i}$ such that 
$\sigma_{i,j} t_{i} = t_{j}$. Such a section may be realized as the image of the constant function 1 under
a homomorphism of sheaves $\sO_{X} \to \sL$. 

\fix{The following is stated as a thm in Ch 2---do we need it here?}
If $X$ is projective, then 
by Theorem \cite[Thm III.5.2]{H} the space $H^{0}(\sL)$  of global sections is
a finite-dimensional vector space. If, moreover, $X$ is reduced and irreducible, then $H^{0}(\sO_{X}) = \CC$ because the only globally defined
functions on $X$ are the constant functions.

A coherent sheaf $\cL$ is said to be \emph{locally free} if the modules $L_i$ are all free; when $X$ is irreducible the \emph{rank} of $\cL_i$ is defined to be the rank of the modules $L_i$.
The coherent sheaf $\sL$ is said to be an \emph{invertible sheaf} if it is locally free of rank 1; that is, $L\mid_U \cong \sO_X(U)$,
for every open set in some covering of $X$. The tensor product  $\sL_1\otimes_{\sO_X}\sL_2$ of two invertible sheaves is  again an invertible sheaf, as is the dual invertible sheaf $\sF^{-1} := \hom_{\sO_X}(\cF,\sO_X)$ of an invertible sheaf $\cF$. There is a natural map
$\cF \otimes \sF^{-1} \to \cO_X$ that is an isomorphism, as one checks locally. Thus the set of isomorphism classes of invertible sheaves on $X$ forms a group with law of composition given by tensor product and inverse given by the dual.

A divisor is called \emph{effective} if all the irreducible varieties in its expression as a sum appear with nonnegative coefficients.
If $D\subset X$ is an effective Cartier divisor (and thus locally defined by the vanishing of a non-zerodivisor) then the ideal sheaf $\sI_{D/X}$
is invertible $\cO_X(-D)$ to be $\sI_{D/X}$. To make the group law on the group of divisors correspond to the
tensor product of invertible sheaves, we set $\sO_X(D) =\cO_X(-D)^{-1}$. The dual of the inclusion
$\cO_X(-D) \subset \cO_X$ is a homomorphism $\sigma := \cO_X \to \cO_X(D)$, that we regard as a global section which
vanishes precisely along $D$. 

We extend this idea to to all Cartier divisors, and define $\sO_X(\sum m_iD_i)$ to be the corresponding tensor
product of the sheaves $\cO_X(D_i)$. If $D$ and $E$ are linearly equivalent divisors on $C$---that is, there is a rational function $f$ on $C$ with $(f) = D - E$---then multiplication by $f$ defines an isomorphism $\cO_C(D) \cong \cO_C(E)$; thus the isomorphism class of the invertible sheaf $\cO_C(D)$ corresponds to the linear equivalence class of $D$. By Corollary~\ref{invertible sheaves and divisors} every invertible sheaf on a projective scheme has this form.

For example, if $C$ is a smooth curve, and $D = \sum m_p\cdot p$ s a divisor on $C$ then the sections of the invertible sheaf
$\sO_D(U)$ on an open set $U$ is the space of rational functions $f$ on $U$ such that $\ord_p(f) + m_p \geq 0$ for all $p \in U$. 
In particular, if $D$ is effective, sections of $\cO_C(D)$ are rational functions, regular away from the points $p$ with $m_p > 0$, but which are allowed to have a pole at a point $p$ of order at most $m_p$. 

If $\sigma\in H^0(\sL)$ is a global section of an invertible sheaf on $X$  $p\in X$ is a point and, then the value $\sigma(p)$ of $\sigma$ at $p$ is the image  of $\sigma$ under the natural map $H^0(\sL)$ to the fiber $\kappa(p) \otimes \sL_{p} \cong \CC$.
Since the isomorphism is not canonical, $\sigma$ does not define a function on $X$ at $p$; but since any two isomorphisms
differ by a unit in $\sO_{X,p}$, the vanishing locus, denoted $(\sigma)_0$ of $\sigma$ is a well-defined subscheme of $X$. Moreover, if $X$ is reduced and irreducible, then the ratio $\sigma/\tau$ of two global sections is a well-defined rational function
$\sigma(p)/\tau(p)$ at all the points where the denominator $\tau(p)\neq 0$ is not 0, so the divisor class of 
$(\sigma)_0$ is independent of the choice of $\sigma \in $.

The terminology of ``vanishing'' is slightly confusing: when we  say that $\sigma$ vanishes at $p$ we mean
that $\sigma(p) = 0$. This means that the image of $\sigma$ in the stalk $\sL_p = \sL \otimes_{\sO_{X}} \sO_{X,p}$ is in 
the maximal ideal $\gm_{X,p}$ of $\sO_{X,p}$ times $\sL_p$
not that $\sigma$ is zero
as an element of the stalk $\sL_p$ itself. Similarly, we say that $\sigma$ vanishes to order $m$ at $p$ if $\sigma(p)$ lies in $\gm_{X,p}^m\sL_p$. 

\subsection{Invertible sheaves and line bundles}

If $\sL$ is an invertible sheaf on a variety $X$, and $p\in X$ is a point then the \emph{stalk} $\sL_p$ of $\sL$ is isomorphic to the local
ring $\sO_{X,p}$. We write $\gm_{X,p}$ for the maximal ideal of $\sO_{X,p}$. By definition the \emph{fiber} of $\sL$ is 
$\sL_p/\gm_{X,p}\cong \CC$. It is not hard to prove that the collection of these fibers forms a line bundle on $X$; that is,
a morphism of schemes $L \to X$ whose fibers are given the structure of 1-dimensional vector spaces that becomes
a product $\CC^1 \times U$ over the open sets $U$ of an affine covering of $X$.

Moreover,
given a line bundle $L$ on $X$, we can recover an invertible sheaf $\sL$ associated to $L$ by defining
$\sL(U)$ to be the set of sections of $L$ defined over $U$. These two processes are inverse to one another, and allow
us to think of invertible sheaves and line bundles interchangeably.

Though we will systematically prefer the invertible sheaf terminology, there are at least two points in which the line bundle approach is more natural. First,  the vanishing of a section of an invertible sheaf at a point $p$ is genuinely the vanishing of the 
section of the line bundle as a function. Second, and more serious, given a morphism $f: Y\to X$ of schemes, the 
pullback $f^*(\sL)$ of an invertible sheaf $\sL$ on $X$ is defined as the tensor product of $\sO_Y$ with a sort of naive pullback; whereas the pullback of a line bundle is a straightforward set-theoretic operation.

%\begin{proposition}
% The invertible sheaves on $X$ form a group under $\otimes_{X}$, called the 
%\emph{Picard group of $X$}, denoted $\Pic(X)$. 
%\end{proposition}
%\begin{proof}
% If $\sF, \sG$ are invertible sheaves then so are $\sF\otimes_{\cO_X}\sG$ and  $\Hom_{\cO_X}(\sF, \sG)$, as one sees immediately by
%restricting to the open sets where $\sF$ and $\sG$ are isomorphic to $\sO_{X}$. Moreover the natural isomorphisms
%$$
%\sF(U) \otimes_{X} \Hom(\sF(U), \sO_{X}(U)) \to \sO_{X}(U)\quad s \otimes f \mapsto f(s)
%$$ 
%patch together to define a global isomorphism 
%$$
%\sF \otimes_{\cO_X} \Hom(\sF, \sO_{X}) \to \sO_{X}
%$$
%justifying the definition
%$\sF^{-1} := \Hom(\sF, \sO_{X})$ and thus the name ``invertible sheaf''. 
%\end{proof}
% 
%If $D\subset X$ is an effective divisor, then we define $\sO_{X}(-D)$ to be the ideal sheaf of $D$. If $D$ is locally defined by the vanishing of a (locally defined) nonzerodivisor in $\sO_{X}$, (that is, $D$ is a Cartier divisor), then
%$\sO_{X}(-D)$ is an invertible
%sheaf.
%We write $\sO_{X}(D)$ for the inverse, $\sO_{X}(-D)^{-1}$. The dual of the inclusion
%$\sO_{X}(-D)\subset \sO_{X}$ is a map $\sO_{X} \to \sO_{X}(D)$ sending the global section $1\in \sO_{X}$ to a section
%$\sigma\in \sO_{X}(D)$ that vanishes precisely on $D$.

\begin{example} [Invertible sheaves on $\PP^{r}$]\label{linear series on Pr} Since $\CC[x_0,\dots,x_r]$ is a 
unique factorization domain, every codimension 1 subvariety of $\PP^r$ is defined by a principal ideal. As we explained above,
any two hypersurfaces of degree $d$ differ by the divisor of a rational function, so
the group of divisor classes on $\PP^r$ is $\ZZ$---the class of a divisor is defined by its degree.
Thus If $V(F)\subset \PP^{r}$ is a hypersurface defined by the vanishing of a linear form 
$F$ of degree $d$,
it is natural to use the name $\sO_{\PP^r}(d)$  for $\sO_{\PP^r}(V(F))$.

Note that if $d>0$ then $H^{0}(\sO_{\PP^{r}}(-D)) = 0$, since it may be realized
as the sheaf of locally defined functions vanishing on $D$, and there are no such
globally defined functions except 0.
 
To compute $H^0(\cO_{\PP^1} (d))$ directly, let $D = z_1 +z_2 +\cdots+z_d$ be a divisor of degree d and suppose that the coordinates are chosen so that none of the $z_i$ are at infinity. The sections of $\cO_{\PP^1} (D)$ are the rational functions with poles in $\PP^1$ only at 
the $z_i$. Identifying $\PP^1\setminus \{\infty\} = \AA^1$ with $\CC$ these can each be written
$$
\frac{g(z)}{(z-z_1)(z-z_2)\cdots(z-z_d)}
$$
where $g$ is a polynomial. The condition that the point at infinity is not a pole is the condition $\deg(g) \leq d$. With this condition, these rational functions form a vector space of dimension $d+1$.

More generally, because every
rational function on $\PP^{r}$ has degree 0, and any two global sections differ by a rational
function, it follows that every global section of $\sO_{\PP^{r}}(d)$ vanishes on a divisor of degree $d$. Thus
we may identify $H^{0}(\sO_{\PP^{r}}(d))$ with the ${r+d\choose r}$-dimensional vector space of forms of degree $d$ on $\PP^{r}$.

Putting this together for future reference we have:
\begin{proposition}
 Every invertible sheaf $\sL$ on $\PP^r$ has the form $\L \cong \sO_{\PP^r}(m)$ for a unique $m = \deg \sL \in \ZZ$; and
 $$
 H^0(\sO_{\PP^r}(m) = \CC[x_0,\dots, x_r]_m
 $$
 the space of forms of degree $m$ in $r+1$ variables.
\end{proposition}
\end{example}


\section{Linear series and maps to projective space}

We will use invertible sheaves to  describe maps of a given variety $X$ to projective space. For this we add the notion of linear series (sometimes called linear system). We start with the definition:

\begin{definition}
 A \emph{linear series} on a scheme $X$ is a pair $\sV  = (\sL, V)$ where $\sL$ is an invertible sheaf (defined in Section ~\ref{Invertible sheaves}) on $X$ and
 $V$ is a vector space of global sections of $\sL$. We define the \emph{dimension} of the linear series to be 
 $$
 \dim \sV := \dim V -1.
 $$
 
 Note that to every global section $\sigma$ of an invertible sheaf $\cL$ on a variety $X$  we can associate the divisor $(\sigma) = (\sigma)_0$ defined by the vanishing of $\sigma$. If $\tau$ is a scalar multiple of $\sigma$, it has the same divisor; and if 
 $H^0(\sO_X) = \CC$ (for example if $X$ is reduced, connected, and
 projective) then the converse is true: two sections of $\cL$ with the same divisor differ by multiplication by a scalar.  If the vector space $V = H^0(\cL)$, the linear system is said to be \emph{complete}; in terms of the ``family of divisors" point of view, this is the same as saying the linear system includes every effective divisor in the linear equivalence class. We sometimes write
 $|\sL|$ for the complete linear series $(\sL, H^0(\cL))$. If $\sL = \sO(D)$ we often abbreviate this further to $|D|$.

Thus a linear system $\sV = (\cL, V)$ gives rise to a family of effective divisors on $X$, all in the same linear equivalence class, parametrized by the projective space $\PP V^*$ of nonzero $\sigma \in V$ mod scalars. This is indeed the way most people think of linear series: as families of divisors linearly parametrized by a projective space. This is reflected in the definition of the dimension of a linear series above: it's not the dimension of $V$ as a vector space, but the dimension of the corresponding projective space. It is also reflected in the terminology: we often speak of ``the divisors of a linear series $\sV$." 
 
 If $C$ is a smooth projective curve and $\sV$ a linear system on $C$, then all the divisors of $\sV$ have the same degree; this is called the \emph{degree} of the linear system. One other bit of terminology: i 
If $\sV$ has degree $d$ and dimension $r$ we say that \emph{$\sV$ is a $g^r_d$}---this classical  language means that $\sV$ it represents a group of $d$ points ``moving'' within a linear equivalence class with $r$ degrees of freedom.  The intersection of the vanishing loci of all the sections in $V$ is called the \emph{base locus} of $\sV$. It is in general a subscheme of $C$. The points in its support are called \emph{base points} of $\sV$. 
 \end{definition}

\begin{theorem}\label{morphisms and linear series}
For any scheme $X$ there is a natural bijection between the set of nondegenerate morphisms $\phi : X \to \PP^r$ modulo $PGL_{r+1}$, and base-point free linear series of dimension $r$ on $X$, up to isomorphism.
\end{theorem}

Given an embedding $X\subset \PP^r$ write $\sO_C(1)$ for the restriction of $\sO_{\PP^r}(1)$.

Here ``nondegenerate" means the image of the morphism $\phi$ is not contained in any hyperplane; the dimension of the series
 $\sV  = (\sL, V)$ is $\dim_\CC V -1$; and base-point free means that the scheme $\cap_{\sigma\in V}(\sigma)_0$, called the  \emph{base locus} of $\sV$, is zeothere is no point of $C$ where all the sections in $V$
vanish. The phrase ``modulo $PGL_{r+1}$ because the notation $\PP^r$ supposes a choice of projective coordinates, and
$PGL_{r+1}$ is the group of linear coordinate transformations (actually all automorphisms, by Exercise~\ref{aut Pr}).
To get a correspondence without the dependence on a basis we could think of morphisms to $\PP(V)$, the set of 1-quotients of $V$.

Suppose that $(\sL, V)$ is a linear series on $X$ that does have a base locus. If the base locus $D = (sigma)_0$ is a Cartier divisor---as is always the
case when $X$ is a smooth curve---then we can subtract it, replacing $\sL$ by $\sL(-D)$ and dividing each section in $V$
by $\sigma$ to get a new, base-point free linear series of the same dimension. 

We will prove Theorem~\ref{morphisms and linear series} by describing the correspondence in both directions:

\subsubsection{The linear series coming from a morphism to projective space}\label{series from morphism}

Let $f : X \to \PP^r$ be any nondegenerate morphism. The associated linear series $\sV = (\cL, V)$ on $X$ has $\cL = f^*\cO_{\PP^r}(1)$ the pullback of the invertible sheaf $\cO_{\PP^r}(1)$, and 
$$
V = f^*H^0(\cO_{\PP^r}(1)) \subset H^0(\cL).
$$
In geometric terms, if we think of a linear series as a family of effective divisors, this is the linear series on $X$ consisting of preimages of hyperplanes in $\PP^r$ (the condition of nondegeneracy assures us that the preimage of a hyperplane in $\PP^r$ is indeed a divisor on $X$).

%Conversely, suppose that we are given a morphism $\phi: X\to \PP^{r}$. With notation as in Example~\ref{linear series on Pr} we may choose an open affine cover $W_{i,j}$ of $X$ such that $\phi(W_{i,j})\subset U_{j}$. Composing the regular
%functions
%$x_{0}/x_{j},\dots, x_{r}/x_{j}$ with $\phi$ we get functions $\sigma_{0},\dots,\sigma_{r}$ on $W_{i,j}$.  The function $\sigma_{j}$ is the image under $\phi^*: \sO_{U_j} \to \sO_{W_{i,j}}$ of the function $x_j/x_j = 1$ on $U_{j}$, so $\sigma_j = 1\in \sO_{W_{i,j}}$. 
%
%In particular, the module $\sL\mid_{W_{i,j}}$ generated by the rational functions 
%$$
%\{\sigma_p\mid_{W_{i,j}}\}= 
%\{\phi^*((x_p/x_j)\mid_{U_j})\}
%_{0\leq p\leq r}
%$$
% is a free $\sO_{W_{i,j}}$-module on 1 generator. On the preimage of $U_j\cap U_k$ these sections differ by the common unit $\phi^*(x_k/x_j)$, and thus the collection of these modules defines an invertible sheaf $\sL$ on $X$ together with an
%$r+1$-dimensional space of global sections $\sV := \langle \sigma_0,\dots \sigma_r\rangle$ that forms a base-point free linear series. Note that the subscheme  $\{\sigma_p = 0\} \subset W_{i,j}$  is the scheme-theoretic preimage of the
%the hyperplane $\{x_p = 0\}\subset \PP^r$. This association of a linear series to a morphism is inverse to the construction
%of Section~\ref{morphism from series},  completing the explanation and proof of Theorem~\ref{morphisms and linear series}\qed



\subsubsection{The morphism to projective space coming from a linear series} \label{morphism from series}

Suppose  that $X$ is any scheme, and $\sV = (\cL, V)$ is a base-point free linear series of dimension $r$ on $X$; we want to describe a corresponding morphism $f : X \to \PP^r$. Choose a basis $\sigma_0, \dots, \sigma_r$ for $V$. If we let $D_i = (\sigma_i) \subset X$ be the divisor of zeroes of $\sigma_i$ and $U_i := X \setminus D_i$, then the ratio $\sigma_j/\sigma_i$ is a regular function on $U_i$, and
we can define a map $f_i : U_i \to \PP^r$ by
$$
f_i : p \; \mapsto \; \big[\frac{\sigma_0}{\sigma_i}(p), \dots, \frac{\sigma_r}{\sigma_i}(p)\big], 
$$
where the component $\sigma_i/\sigma_i = 1$ ensures that not all the components are 0, so that the image point is well-defined..
The maps $f_i$ and $f_j$ agree on the overlap $U_i \cap U_j$, and by the hypothesis that $\sV$ is base-point free the $U_i$ cover $X$;
so together they define a regular map $f$ from $X$ to $\PP^r$. 

We can describe this map set-theoretically without having to choose a basis: since $\sV$ is assumed base-point free, for any point $p \in X$ the subspace $H_p := \{ \sigma \in V \mid \sigma(p) = 0 \}$ is a hyperplane in $V$; thus we get a map $f : X \to \PP V^*$.


%
%For any $\CC$-vector space $V$ of dimension $r+1$ with basis $x_{0}, \dots, x_{r}$, we write $\Sym(V) \cong \CC[x_{0},\dots, x_{r}]$ for the symmetric algebra on $V$, and
%$\PP(V)\cong \PP^{r}_{\CC}$ to be the projective space ${\rm Proj}(\Sym(V))$, which is naturally isomorphic to the
%space of lines in $V^{*}$ or, equivalently,  the space of 1-dimensional quotients of $V$. Note that the isomorphism $\PP(V)\cong \PP^{r}_{\CC}$ is well-defined up to the action
%of $\Aut(\PP^r) = PGL(r+1)$.
%
%Given a linear series $\sV:=(\sL, V)$  of dimension $r$ on a scheme $X$
%we define the \emph{base locus} of $\sV$ to be the closed subscheme 
%$$
%B_\sV := \bigcap_{\sigma\in V}\{\sigma = 0\}.
%$$
%Note that we could have restricted the intersection to a basis of $V$, with the same result.
%Let $W:=X\setminus B_\sV$ be the open subscheme where not all sections $\sigma_{i}$ vanish.
%
%For any point $q\in W$ we  may choose an open neighborhood $W'\subset W$ of $q$, and an identification 
%$$
%t: \sL\mid_{W'} \rTo^{\cong} \sO_{W'}
%$$
%and define $\phi_{\sV}: W' \to \PP(V)$ by 
%$$
%W'\ni p \mapsto \bigl(t(\sigma_{0}(p)),\dots, t(\sigma_{r}(p))\bigr) \in \PP(V).
%$$
%This  is a morphism on $W'$. A change of neighborhoods $W'$ or of identifications $t$ would multiply
%each value $t(\sigma_{i}(p))$ by a unit, the same one for each $i$, and thus the construction would define the same morphism. It follows that the morphisms
%defined on different $W'$ agree on overlaps, and thus define a morphism $W \to \PP(V) \cong \PP^r$. This is the reason
%that the dimension of $\sV$ is defined to be $r=\dim V -1$ instead of $\dim V$.
%
%The most useful linear series are those that define morphisms defined on all of $X$. This happens when $B_\sV = \emptyset$,
%that is, for every point $q\in X$, there is a section $\sigma \in V$ such that $\sigma$ does not vanish at $q$. In this case we say that $(\sL, \sV)$ is \emph{base-point free}.

\begin{example}\label{Veronese definition}
The morphism from $\PP^r$ defined by the complete linear series $(\cO_{\PP^r}(d), H^0(\cO_{\PP^r}(d))$ has target
$\PP^{{r+d\choose r}-1}$, and takes a point $x_0,\dots x_r$ to the point whose coordinates are all the monomials of
degree $d$ in $x_0,\dots x_r$. It is called the \emph{$d$-th Veronese morphism} from $\PP^r$. For example on $\PP^1$, this has the form
$$
(x_0,x_1) \mapsto (x_0^d,\ x_0^{d-1}x_1,\ \dots,x_1^d).
$$
The image of $\PP^1$ under this morphism is called the \emph{rational normal curve} of degree $d$; in the case $d=2$ is the
\emph{plane conic}, and in the case $d=3$ it is called the \emph{twisted cubic}. Veronese himself studied the image of $\PP^2$
by the Veronese morphism of degree 2 now simply called \emph{the Veronese surface}.
\end{example}





\section{The geometry of linear series}

\subsection{An upper bound on $h^0(\sL)$}

We will develop sophisticated ways of estimating the dimensions of linear series. We begin with an elementary bound:

\begin{theorem}\label{characterization of P1}
Let $C$ be a smooth projective curve. If $\cL$ is an invertible sheaf of degree $d\geq 0$ on $C$, then $h^0(\cL)\leq d+1$.
Equality holds if and only if
$$
C \cong \PP^1  \text{ and  }  \cL \cong \cO_{\PP^1}(d).
$$
\end{theorem}

\begin{proof}
First, suppose that $d=1$. The linear series $(\cL, H^0(\cL))$ cannot have any base points, since
otherwise after subtracting one, we would get an invertible sheaf of degree $0$ with two independent global sections. This is impossible, since some linear combination of the sections would vanish at any given point, showing that the degree would be
$\geq 1$.

Thus we see that the linear series $(\cL, H^0(\cL))$ defines a morphism $\phi: C\to \PP^1$ of degree 1 whose fibers are the divisors defined by
the vanishing of sections of $\cL$, and which are thus of degree 1. Thus if $p\in C$ is the preimage of $q\in \PP^1$, the induced map of local rings
$\phi^*:\cO_{\PP^1, q} \to \cO_{C, p}$ is a finite, birational map. Since $\cO_{\PP^1, q}$ is integrally closed, this is an isomorphism. Thus 
$\phi$ is an isomorphism, and the statements $\cL \cong \cO_{\PP^1}(d), \hbox{ and  } \h^0(\cL) = d+1$ follow from the classification of invertible sheaves on $\PP^1$. 

If $d>1$, let $p_1,\dots p_{d-1}$ be general points of $C$, and set $\cL':=\cL(-p_1-\cdots-p_{d-1})$, a sheaf of degree 1.
 If $p\in C$ is a point then, since $\cL$ is locally isomorphic to the sheaf of functions on $C$, the global sections vanishing
 at $p$ are a linear subspace of $H^0(\sL)$ of codimension at most 1. Informally we say that vanishing at $p$ imposes at most 1 linear condition on 
the global sections of $\cL$. It follows that  $H^0(\cL') \geq 2$. From the case $d=1$ we see that $C\cong \PP^1$, and the statements
about $\cL$ follow as before.
 \end{proof}

From the correspondence between invertible sheaves and maps to projective space, we now get:
\begin{corollary}\label{minimal degree curves}
If $C\subset \PP^d$ is a  non-degenerate curve, then the degree of $C$ is $\geq d$ with equality only in the case
that $C$ is a rational normal curve.\qed
\end{corollary}

Recall from Example~\ref{Veronese definition} that the image of the $d$-th \emph{Veronese map}  
$$
\phi_d: \PP^1 \to \PP(H^0(\cO_{\PP^1}(d)) \cong \PP^d; \quad (s,t) \mapsto (s^d, s^{d-1}t, \dots, t^d)
$$
corresponding to by the complete linear series $|\cO_{\PP^1}(d)|$ is called the \emph{rational normal curve} of degree $d$. Rational normal curves arise often in the literature because they have many extremal properties, such as those of Corollaries~\ref{minimal degree curves} and \ref{independence of points on a RNC}. For a related result see Corollary~\ref{uninflected curves}. Since there is only
one invertible sheaf of degree $d$ on $\PP^1$ any two rational normal curves of degree $d$ differ by a transformation in $\PGL_{d+1}$,
and we will therefore often speak of ``the rational normal curve''.

\begin{corollary}\label{independence of points on a RNC}
Let $C\subset \PP^d$ be the rational normal curve of degree $d$. If $E$ is an effective divisor on $C$ of degree $e\leq d+1$, then the
span of $E$ (that is the dimension of the smallest linear space containing the subscheme $E$) has dimension $e-1$.
\end{corollary}
Less formally: any finite set or subscheme of $C$ is as linearly independent as possible

\begin{proof}
Let $L$ be the span of $E$. Since $E$  imposes at most $e$ conditions on hyperplanes, it follows that the dimension of the span of $E$ is
at most $e-1$.

On the other hand, the hyperplanes containing $E$ meet $C$ in a divisor of the form $E+E'$, where
$\deg E' = d-e$. Thus the projection of $C$ from $E$ is a non-degenerate curve of degree $d-e$ in $\PP^{d-(\dim {\rm span}(E))-1}$
so from Corollary~\ref{minimal degree curves} we get $d-e \geq d-(\dim {\rm span}(E)-1)$, as required.
\end{proof}

In the case of distinct points on a rational normal curve
it is easy to make a direct argument why they are as independent as possible: In affine coordinates chosen so that none of the points are
at infinity we can identify the points $\lambda_1,\dots,\lambda_{d+1} \in C \cong \PP^1$ with distinct complex numbers, and the independence (for $\ell = d+1$) is equivalent to the the nonvanishing of the Vandermonde determinant
$$
\begin{vmatrix}
1 & \lambda_1 & \lambda_1^2 & \dots & \lambda_1^d \\
1 & \lambda_2 & \lambda_2^2 & \dots & \lambda_2^d \\
\vdots & & & & \vdots \\
1 & \lambda_{d+1} & \lambda_{d+1}^2 & \dots & \lambda_{d+1}^d \\
\end{vmatrix}
= \prod_{1 \leq i < j \leq d+1} (\lambda_j - \lambda_i)
$$


\subsection{Incomplete linear series}

 If $D$ is any divisor on $C$ we write $r(D)$ for the dimension of the complete linear series $|D|$; that is, $r(D) = h^0(\cO_C(D)) - 1$. In classical algebraic geometry a linear series of dimension 1 is called a \emph{pencil}, a linear series of dimension 2 is called a \emph{net} and, less commonly, a three-dimensional linear series is called a \emph{web}.  We will use only the first of these.

The morphism associated to an incomplete linear series $V \subset H^0(\cL)$ is the composition of the morphism associated to the complete linear series $|\cL|$ with a linear projection. In general, if $V \subset W \subset H^0(\cL)$ are a pair of nested linear series, then a 1-dimensional quotient of $W$ restricts to a 1-dimensional quotient of $V$ unless it vanishes on $V$.
Thus we have a partially defined linear morphism $\pi: \PP(W)  \to \PP(V)$. The \emph{indeterminacy locus} of the map
consists of the set of 1-quotients vanishing on $V$, that is, to $\PP(W/V) \subset \PP(W)$; we will call it the 
\emph{center of the projection $\pi$.} (It is sometimes useful to
think of the dual picture: lines in $W^*$ map to lines in $V^*$ except when they lie in the subspace $(W/V)^* = Ann(V)\subset W^*$.)
Thus there is a commutative diagram
\begin{diagram}
& & \PP W^* \\
& \ruTo^{\phi_W} & \dDashto_\pi \\
C & \rTo^{\phi_V} & \PP V^*.
\end{diagram}

If $W$ is base-point free, then $V$ is base-point free if and only if the center of the projection $\pi$ is disjoint from $\phi_W(C)$, and in this case we say that $\pi$ is \emph{regular} on $C$.

By way of language, we will say that a curve $C \subset \PP^r$ embedded by a complete linear series $|\sL|$ is \emph{linearly normal}; this is equivalent to saying that the pullback map
$$
H^0(\cO_{\PP^r}(1)) \to H^0(\sL)
$$
is surjective. Since regular projections of a curve correspond to subseries, this is equivalent to saying that $C$ is \emph{not} the regular  projection of a nondegenerate curve $\tilde C \subset \PP^{r+1}$. 

\subsection{Sums of linear series}
If
$\cD = (\cL,V)$ and $\cE = (\cM, W)$ be two linear series on a curve $C$. By the \emph{sum} $\cD + \cE$ of $\cD$ and $\cE$, we will mean the pair 
$$
\cD + \cE = (\cL \otimes \cM, U) 
$$
where $U \subset H^0(\cL \otimes \cM)$ is the subspace generated by the image of $V \otimes W$, under the multiplication/cup product map $H^0(\cL) \otimes H^0(\cM) \to H^0(\cL \otimes \cM)$---in other words, it's the subspace of the complete linear series $|\cL\otimes \cM|$ spanned by divisors of the form $D+E$, with effective divisors $D \in \cD$ and $E \in \cE$.
 
 
\begin{proposition}\label{sum of linear series}
 If $\cD$ and $\cE$ are two  linear series that contain effective divisors on a curve $C$, then
$$
\dim(\cD + \cE) \geq \dim \cD + \dim \cE.
$$
\end{proposition}
\begin{proof}
Saying $\dim \cD \geq m$ is equivalent to saying that we can find a divisor $D \in \cD$ containing any given $m$ points of $C$; since $\cD + \cE$ contains all pairwise sums $D + E$ with $D \in \cD$ and $E \in \cE$, we can certainly find a divisor $F \in \cD + \cE$ containing any given $\dim \cD + \dim \cE$ points of $C$.
\end{proof}

\subsection{Which linear series define embeddings?}

A linear series $\sV = (\sL, V)$ is called  \emph{very ample}  if it is base-point free and defines an embedding. If $D$ is a Cartier divisor on $X$, then we say that $D$ is \emph{very ample} if the complete linear series $|D|$ is very ample, and we say that $D$ is \emph{ample} if $mD$ is very ample for some integer $m>0$.

Given a linear series $\sV = (\sL, V)$ and an effective divisor $D$ on $C$, we  set
$
\sV(-D) = (\sL(-D),V(-D))
$
where
$$
\sL(-D): = \sL \otimes \sO(-D)\hbox{ and } V(-D) := \{ \sigma \in V \mid \sigma(D) = 0 \}.
$$
The difference $\dim \sV - \dim \sV(-D)$ is called the \emph{number of conditions imposed by $D$ on the linear series $\sV$}; we say that $D$ \emph{imposes independent conditions} on $\sV$ if $\dim \sV - \dim \s V(-D) = \deg(D)$.

Via the correspondence of Theorem~\ref{morphisms and linear series}, the statements about the geometry of a morphism $\phi : C \to \PP^r$ can be formulated as statements about the relevant linear series. In the case of complete series, these are statements about the vector space $H^{0}(\sL)$ of global sections of $\sL$. As is customary, we write $h^{0}(\sL)$ for the dimension of this vector space. It is useful to have criteria
in these terms for when a linear series defines an embedding, or even to be base-point free so that it
defines a morphism:

\begin{proposition}\label{very ample}\cite[Thm. IV.3.1]{H}
Let $\cL$ be an invertible sheaf on a smooth curve $C$. The complete linear series $|\cL|$ is base-point free if and only if
$$
h^0(\cL(-p)) = h^0(\cL) - 1 \quad \forall p \in C;
$$
and $\sL$ is very ample if and only if
$$
h^0(\cL(-p-q)) = h^0(\cL) - 2 \quad \forall p, q \in C.
$$
\end{proposition} 

\begin{proof}
First, since vanishing at a point imposes one linear condition on sections of $\sL$ we have $h^0(\sL(-D)) \geq h^0(\sL)-\deg D$ for any
effective divisor $D$.

To say that $|\cL|$ is base-point free means that for every point $p\in C$ there is a section of $\sL$ that does not vanish at $p$; thus vanishing
at $p$ is a nontrivial linear condition on $H^0(\sL)$. Conversely, if $h^0(\cL(-p)) = h^0(\cL) - 1$ then $p$ imposes a nontrivial condition, so
some section of $\sL$ does not vanish at $p$.

Since a divisor of degree $d$ cannot impose more than $d$ condtions on a linear series, the statement $h^0(\cL(-p-q)) = h^0(\cL) - 2$ for all $p, q$ implies the condition for base-point freeness; and saying that $\phi_\cL(p) \neq \phi_\cL(q)$ implies that the linear series defines a set-theoretic injection. 

%The Zariski tangent space of $C$ at $p$ is the dual of $\gm_{C,p}/\gm_{C,p)^2$, so the condition that there is a section of $\sL$ that vanishes at $p$, but does not vanish
%to order 2, implies that the differential $d\phi_\cL$ is injective at $p$ as well.

Let $\phi:C \to \PP^r$ be the map defined by $\sL$. To say that $\phi$  is an embedding locally at a point $p$, we need to know that the map of local rings
$$
\phi^*: \sO_{\PP^r,\phi(p)} \to \sO_{C,p} 
$$
is surjective. 

Since $C$ is projective, the map $C\to \phi(C)$ is finite,
so $\phi^*$ makes $\sO_{C,p}$ into a finitely generated $\sO_{\PP^r,\phi(p)}$-module.
By Nakayama's lemma it suffices to show that 
$\sO_{C,p}/\phi^*(\gm_{\PP^r,\phi(p)})$
is generated by the image of $\sO_{\PP^r,\phi(p)}/\gm_{\PP^r,\phi(p)} = \CC.$

 Since the constants  $\CC =\sO_{\PP^r,\phi(p)}/\gm_{\PP^r,\phi(p)}$ pull back to the constants in
$\sO_{C,p}/\gm_{C,p}$,
surjectivity will follow if 
$$
\frac{\sO_{C,p}}
{\phi^*(\gm_{\PP^r,\phi(p)})  \sO_{C,p}}
$$
is 1-dimensional; that is, if the linear series contains
a section that vanishes to order exactly 1 at $p$, which is equivalent to the condition
that $h^0(\sL(-2p) \neq h^0(\sL(-p))$.
\end{proof}

A more geometric version of the last part of the proof would be to say that the condition of the existence of a section
vanishing to order exactly 1 implies that $\phi$ is an injection on the tangent space to $C$ at $p$. This implies that
the map is analytically an isomorphism onto its image, and together with the finiteness of the map, this suffices.

\fix{move the following remarks someplace else!}
For another example of the relationship between linear series on curves and morphisms of curves to projective space, consider a smooth curve $C \subset \PP^r$ embedded in projective space, and assume that $C$ is linearly normal. If $\phi : C \to C$ is any automorphism, we can ask whether $\phi$ is induced by an automorphism of $\PP^r$; in other words, does there exist an automorphism $\Phi : \PP^r \to \PP^r$ such that $\Phi(C) = C$ and $\Phi|_C = \phi$? The answer is expressed in Exercise~\ref{projective automorphism}.


If $\phi:X \to \PP^r$ is a generically finite morphism, then the \emph{degree of $\phi$} is the number of points in the preimage of a general point of $\phi(X)$. It follows that if $D := \sum_{p\in C} n_pp$ is a divisor on a smooth curve, and the linear series $|D|$ is base-point free, then the degree of the morphism associated to $|D|$ is $\deg D := \sum_{p\in C} n_p$.

\section{Exercises}

\begin{exercise}\label{here there be basepoints}
 Show that there is no non-constant morphism $\PP^r\to \PP^s$ when $s<r$ by showing that any nontrivial linear
 series of dimension $<r$ has a non-empty base locus.
\end{exercise}

\begin{exercise}
Extend the statement of Proposition~\ref{very ample} to incomplete linear series; that is, prove that the morphism associated to a linear series $(\cL, V)$
on a smooth curve is an embedding iff
$$
\dim\big( V \cap H^0(\cL(-p-q))\big) = \dim V - 2 \quad \forall p, q \in C.
$$
\end{exercise}

\begin{exercise}\label{aut Pr}
An automorphism of $\PP^r$ takes hyperplanes to hyperplanes. Deduce that it is given by the linear series
$\sV = (\sO_{\PP^r}(1), H^0(\sO_{\PP^r}(1)))$, and use this to show that $\Aut \PP^r = PGL(r+1)$. 
\end{exercise}

\begin{exercise}\label{projective automorphism}
In the circumstances above, the automorphism $\phi$ is induced by an automorphism of $\PP^r$ if and only if $\phi$ carries the invertible sheaf $\cO_{C}(1)$ to itself; that is, $\phi^*(\cO_{C}(1)) \cong \cO_{C}(1)$. In this case we say that the automorphism
is projective. Show that every automorphism of a rational normal curve $C \subset \PP^d$  extends to $\PP^d$. Since the
automorphism group $PSL_3$ acts transitively on $\PP^1$, we say that
$C$ is \emph{projectively homogeneous}.


\end{exercise}

\begin{exercise}\label{normality of RNC}
 Show that $\CC[s^d,s^{d-1}t,\dots, t^d]$ is normal (ie, integrally closed) by noting that its integral closure must be
 contained in $\CC[s,t]$ and then showing that if $f$ is any polynomial
 in the integral closure then the homogeneous components of $f$ are also in the integral closure.
\end{exercise}


\input footer.tex
