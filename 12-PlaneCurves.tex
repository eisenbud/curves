\input{header}

\chapter{Plane Curves}
\label{PlaneCurvesChapter}

For a long time, plane curves were the only algebraic curves that were studied. Originally these were curves in the affine plane over the real numbers, but by about 1850 the complex projective plane was well understood, and curves in $\PP^2 = \PP^2_\CC$, corresponding to irreducible forms in 3 variables, were recognized as the natural objects of study. \fix{add something?}

%One of the central topics was duality: given a curve in $\PP^2$, the dual curve is the closure of the set of tangent lines at its smooth points. Starting with smooth curve each bitangent line corresponds to a node of the dual curve, and each flex corresponds to a cusp, so singular curves were included.

The work of Bernard Riemann dramatically changed the focus of the theory to branched coverings of   the ``Riemann Sphere'' ($\PP^1_\CC$). The Riemann-Roch theorem, in particular, gave information about the existence of meromorphic functions on such coverings, well beyond what could be done in the earlier theory. However, Riemann's work, depending as it did on the then-obscure ``Dirichlet principle'', was not universally accepted. In the 1860s Alfred Clebsch and, after Clebsch' death in 1872, Alexander Brill and Max Noether (Emmy Noether's father), undertook the ambitious program of redoing the Riemann-Roch theorem entirely in terms of plane curves. They went beyond Riemann in certain directions, too: the Brill-Noether Theorem treated in our Chapter~\ref{Brill-Noether chapter} was formulated by Brill and Noether, and ``proved'' by them through an unsupported general position assumption. 

A central difficulty in the Brill-Noether attempt on the Riemann-Roch theorem was that,
although any smooth curve can be embedded in $\PP^r$ for any $r \geq 3$, most curves cannot be embedded in the plane. 
However, as we saw in Section~\ref{good projections}, we can embed $C$ as a curve $ C \subset \PP^r$ in a higher-dimensional projective space and find a projection $\PP^r \to \PP^2$ that carries $C$ birationally onto its image $C_0$, called a plane model of $C$. The curve $C_0$ typically has singularities, and $C$ is the normalization of $C_0$. Brill and Noether wanted to prove the Riemann-Roch theorem for $C$ by formulating and proving a related theorem for $C_0$. In particular, they tried to characterize linear equivalence of divisors on $C$ in terms of certain ``clusters'' of points---we would say 0-dimensional subschemes---of $C_0$. 

To carry out this program, a key result is that if $D\subset C_0$ is contained in the intersection
$D'$ of $C_0$ and some other plane curve $C_0'$, then the difference 
$E := D'-D$ can be defined with properties such as that $D'-E = D$; Brill and Noether seem simply to have assumed that this is so. A bit later Frances Sowerby Macaulay proved that this is in fact possible  and also understood that it would not generally be possible if $D'$ were the intersection of three or more curves. 

Macaulay exploited this theory of residuation  to prove what he called the ``Generalized Riemann-Roch Theorem'' (now erroneously called the ``Cayley Bacharach Theorem''.) This early work of Macaulay led directly to his definitions of  ``perfection'' (a homogeneous ideal
$I  \subset S:= k[x_0, \dots, x_n]$ is perfect if $S/I$ is Cohen-Macaulay) and ``super-perfection'' (the case when $S/I$ is
Gorenstein). For all this, see "\cite{Eisenbud-Gray}.

In the first part of this Chapter we will use ideas that go back to Brill and Noether to prove the ``completeness of the adjoint series'', giving us a recipe, using $C_0$, to find all effective divisors on $C$ equivalent on $C$ to a given (possibly) non-effective divisor. In Section~\ref{linear series on smooth plane curves} we treat the simple case of smooth plane curves, and in subsequent sections we treat the case of plane curves with nodes, and then plane curves with arbitrary singularities.

 In the last Section we will study the ``Severi variety'' of nodal plane curves $C_0$ of given geometric genus (the genus of the normalization, $C$.)
 
\section{Using plane models to compute linear series} \label{computing linear series}

In Proposition~\ref{nodal projection} we showed that any smooth projective curve $C$ can be linearly and birationall projected to a $C_0$ that has only nodes as singularities. In the first sections of this chapter we will show how to use such a \emph{plane model} to algorithmically determine the complete the linear series associated to any divisor.

In particular:
\begin{enumerate}
\item Given the equation $F(X,Y,Z)$ of a plane curve $C_0$, with normalization $C$, we will find a basis for $H^0(K_C)$; and
\item  Given, in addition, a divisor $D = \sum m_ip_i$ on $C$, we will describe the complete linear system $|D|$; that is, we will find all effective divisors $E$ on $C$ with $E \sim D$, or, equivalently, a basis for $H^0(\cO_C(D)$.
\end{enumerate}

Along the way we will see how to test when two given divisors $D$ and $E$ on $C$ are linearly equivalent; and whether a given divisor $D$ linearly equivalent to an effective divisor.

For clarity, we will pursue these goals in three stages: first when $C = C_0$ is a smooth plane curve (\S \ref{linear series on smooth plane curves}); next for nodal curves (\S~\ref{nodal plane curves}), which in principle this covers all smooth curves; and finally for arbitrary reduced, irreducible plane curves (\S\ref{arbitrary plane curves}): many times a curve $C$ is given to us as (the normalization of) a plane curve with singularities other than nodes, and while Proposition~\ref{nodal projection} assures us in principal that we can also realize $C$ as the normalization of a nodal plane curve, it is often easier to work with the given plane model. 

\section{Differentials on a smooth plane curve}\label{canonical series on smooth plane curves}

Let $C \subset \PP^2$  be a smooth plane curve, given as the zero locus of a homogeneous polynomial $F(X,Y,Z)$ of degree $d$. We'll introduce coordinates $x = X/Z$ and $y = Y/Z$ on the affine open subset $U \cong \AA^2$ given by $Z \neq 0$, and let $f(x,y) = F(X,Y,1)$ be the inhomogeneous form of $F$, so that $\widetilde C = C \cap U$ is given as the zero locus $V(f) \subset  \AA^2$. 

Since an automorphism of $\PP^2$ can carry any line in the plane to the line at infinity, and any point on that line to the point $(0,1,0)$, we may assume:
\begin{enumerate}
\item The point $[0,1,0]$ (that is, the point at infinity in the vertical direction) does not lie on $C$; equivalently,  the projection $C \to \PP^1$ from $(0,1,0)$, which is given by $[X,Y,Z] \mapsto [X,Z]$ (or, in affine coordinates, $(x,y) \mapsto x$)  has degree $d$; and
\item The line $L$ at infinity given by $Z = 0$ intersects $C$ transversely in $d$ distinct points $p_1, \dots, p_d$; We write $H = p_1+ \dots +p_d$ for the corresponding divisor, the ``hyperplane section at infinity''.
\end{enumerate}

These conditions are not necessary: in Exercise~\ref{****} we will see how to do  without them.
 
We start toward our first goal by writing down a single rational 1-form on $C$: 
 take a regular 1-form on $\AA^2$, such as $dx$, and restrict/pull back to $C$. 

Though $dx$ is regular on $\widetilde C$, writing
$$
dx = d\frac{X}{Z} = \frac{X dZ+ Z dX}{Z^2}
$$
 shows that $dx$ has double poles at the points $p_1,\dots,p_d$ of the divisor $D := C \cap L$.
 
How do we get rid of the poles of $dx$? The extension of $\PP^2$ of a polynomial $h(x,y)$ of degree $d$ on
$\AA^2$ has a pole of order $d$ along the line $L$ at infinity. Thus if $h$ has degree at least 2 then $dx/h$ will have no poles at infinity. However, $h(x,y)$ will vanish at points of $C \cap U$, and this may create new poles of $dx/h$. Of course if $h$ vanishes only at  points of $C \cap U$ where $dx$ already has a zero, the zeroes of $h$ may cancel the zeroes of $dx$ rather than creating new poles.
 
 To avoid producing new poles in this way we may take
 $$
 h(x,y) = \frac{\partial f}{\partial y}(x,y).
 $$
 Note that on $\widetilde C$,
 $$
 df = \frac{\partial f}{\partial x}dx + \frac{\partial f}{\partial y}dy \equiv 0.
 $$
Because $C$ is smooth, the functions $\frac{\partial f}{\partial x}$ and $\frac{\partial f}{\partial y}$ have no common zeroes on $\widetilde C$. Moreover, the differentials $dx$ and $dy$ have no common zeros on $\widetilde C$. It follows that at for all $p \in \widetilde C$ we  have
$$
\ord_p(dx) = \ord_p(\frac{\partial f}{\partial y}), 
$$ 
and thus the quotient 
$$
\varphi_0 = \frac{dx}{\partial f/\partial y}
$$
is everywhere regular and nowhere 0 in $\widetilde C$.

The differential $dx$ has poles of order $2$ at the points $p_i$. The polynomial $\partial f/\partial y$, having degree $d-1$, has poles of order $d-1$. Thus $\varphi_0$ has zeroes of order $d-3$ at the points $p_i$; in other words, as divisors,
$$
(\varphi_0) = (d-3)D.
$$
In particular, if $d \geq 3$ then $\varphi_0$ is a global regular differential on $C$.

Moreover, we can  multiply $\varphi_0$ by any polynomial $e(x,y)$ 
  of degree $d-3$ or less without introducing poles, so that 
$$
g\varphi_0 = \frac{e(x,y)dx}{\partial f/\partial y}
$$ 
is likewise a global regular differential, for $g$  any polynomial of degree $\leq d-3$.

We have thus found a vector space of regular differentials, of dimension $\binom{d-1}{2}$. But at the same time, the degree of a differential like $\varphi_0$ is
$$
\deg((\varphi_0)) = (d-3)\deg(D) = d(d-3),
$$
so that the genus of $g(C)$ satisfies
$2g(C)-2 = d(d-3)$, whence
$$
\frac{d(d-3)}{2} + 1 = \binom{d-1}{2}.
$$
In other words, we have found all the global regular differentials on $C$! We have
$$
H^0(K_C) = \left\{ \frac{e(x,y)dx}{\partial f/\partial y} \mid \deg e \leq d-3\right\};
$$
or, equivalently, the space of regular differentials on $C$ has basis $\{\varphi_{i,j} \}_{i+j \leq d-3}$, where
$$
\varphi_{i,j} =  \frac{x^iy^jdx}{\partial f/\partial y}
$$

We could have achieved the same result by using the adjunction formula (see Section~\ref{Adjunction Formula}: we have
$$
K_C = (K_{\PP^2} \otimes \cO_{\PP^2}(d))|_C = \cO_C(d-3),
$$
and from the exact sequence
$$
0 \to \cO_{\PP^2}((d-3)-d) \rTo^f \cO_{\PP^2}(d-3) \to \cO_C(d-3)=K_C \to 0
$$
and the vanishing of $H^1(\cO_{\PP^2}(-3))$, we see that the map on global sections
$$
H^0(\cO_{\PP^2}(d-3)) \to H^0(K_C)
$$
is surjective. 

\begin{exercise}\label{gonality of smooth plane curve}
Let $C$ be a smooth plane curve of degree $d$. Show that $C$ admits a one-parameter family of maps $C \to \PP^1$ of degree $d-1$. Using the Riemann-Roch Theorem, show that $C$ does not admit a map $C \to \PP^1$ of degree $d-2$ or less.
\end{exercise}


\section{Linear series on a smooth plane curves}\label{linear series on smooth plane curves}

Suppose that $D$ is any divisor on a smooth plane curve $C$, expressed as the difference of
two effective divisors, $D= D_0-D_\infty$. We would like to find all the \emph{effective} divisors linearly equivalent to $D$, that is, of the form
$D + (H/G)$, where $G, H$ are forms of the same degree $m$. Choose $m$ large enough so that
there is
 a form $G$ of degree $m$ that vanishes on $D_0$ plus some divisor $A$ (but not on all of $C$). If we can find a form $H$ of degree $m$ that vanishes on both $D_\infty$ and $A$, as well as a further divisor $D'$, but does not vanish identically on $C$, then
$$
D' = D + (H/G) = D_0- D_\infty - (D_0+A)+(D_\infty+A+D')
$$
as required. Since $m$ is already chosen, there may not exist any such polynomial; we shall see that in this case there is no effective divisor linearly equivalent to $D$. 

\begin{example}
Suppose that $C$ has degree 3, so that $C$ has genus 1. åIf we choose as origin on the curve $C$ a point $o$, then to add two points $p$ and $q \in C$ means to find the (unique) effective divisor of degree 1 linearly equivalent to $p + q - o$. In this situation, we can carry out the process described above with $m=1$: draw the line $L$ through the points $p$ and $q$, and let $r \in C$ be the remaining point of intersection of $L$ with $C$; then draw the line $M$ though the points $r$ and $o$, and let $s \in C$ be the remaining point of intersection of $L$ with $C$. This is the classical construction of the group law.
\end{example}

We claim that we find in this way all effective divisors $D' \sim D$ a special case of the Completeness of the Adjoint series, Proposition~\ref{adjoint completeness}. In particular, this will show that if there is no polynomial $H$ as above, then there are no effective divisors equivalent to $D$.

Indeed, suppose $D'$ is any effective divisor with $D' \sim D$. Carrying out the first step of the process as before, we arrive at a divisor $A$ with 
$$
\cO_C(A+D_\infty+D') = \cO_C(A+D_\infty+D)  = \cO_C(m),
$$
that is, $A+D_\infty+D$ is linearly equivalent on $C$ to the divisor (H) defined by the vanishing of some form $H$ of degree $m$. This means that
$A+D_\infty+D  = (H') +(P/Q)$ for some forms $P,Q$ of equal degree, with $Q$ not vanishing identically on $C$. Since $A+D_\infty+D$ is effective,
the zeros of $Q$ on $C$ must be contained in the zeros of $H'P$ on $C$. Writing
$G$ for the generator of the ideal of $C$, and using the fact that
$G,Q$ is a regular sequence, and thus is unmixed (that is, has no embedded primary component), we see that $H'P = LG+HQ$ for some
forms $L,H$ of degree $\deg HP - \deg Q$. In particular, $H = (H'P- LG)/Q$ is a form
of degree $m$ defining $A+D_\infty+D$, as desired.

Alternatively, the fact that any regular sequence $G,Q$ defines an unmixed ideal is equivalent to the vanishing of the intermediate cohomology of all twists of the structure sheaf of $\PP^2$; and we can use this to achieve the same conclusion with fewer symbols, though more sophistication: from the exact sequence 
$$
0 \to \cO_{\PP^2}(m-d) \to \cO_{\PP^2}(m)  \to \cO_C(m) \to 0
$$
and the vanishing of $H^1(\cO_{\PP^2}(m-d))$, we again see that every global section of $ \cO_C(m)$ is the restriction to $C$ of a homogeneous polynomial of degree $m$ on $\PP^2$. 

Note that if, in the process described, it turns out there is no polynomial $H$ vanishing on  $A + D_\infty + D$ but not vanishing identically on $C$, that simply means that $|D| = \emptyset$; that is, $D$ is not linearly equivalent to any effective divisor. (It may not be obvious that the existence of such an $H$ is independent of the choice of $m$ or $G$, but the argument here shows that it is.)



\section{Differentials on a nodal plane curve}\label{canonical series on nodal plane curves}

As noted, smooth plane curves are very special among all curves. We now want to carry out the analyses above for curves with at most nodes as singularities. As we have seen in Section~\ref{nodal curves}, every smooth curve is the normalization of a nodal plane curve.


Given a smooth projective curve $C$ and a birational map of $C$ to $\PP^2$ with image a nodal curve $C_0$, our goal is as before:
\begin{enumerate}
\item to write out explicitly all global regular 1-forms on $C$; and
\item given a divisor $D$ on $C$, to  determine $|D|$; that is, find all effective divisors linearly equivalent to $D$.
\end{enumerate}

As before, we may choose homogeneous coordinates  $[X,Y,Z]$ on $\PP^2$ so that the curve $C_0$ intersects the line $L = V(Z)$ at infinity transversely at points $p_1,\dots,p_d$ other than $[0,1,0]$. In particular,  all the nodes of $C_0$ will lie in the affine plane $U = \PP^2 \setminus L$.
In addition, we can assume that  neither branch of $C_0$ at a node has vertical tangent. (These conditions serve only to keep the notation reasonably simple, and are satisfied by a general choice of coordinates.) Let the nodes of $C_0$ be $q_1,\dots,q_\delta$, with $r_i, s_i \in C$ lying over $q_i$; we'll denote by $\Delta$ the divisor $\sum r_i + \sum s_i$ on $C$.

Let $F(X,Y,Z)$ be the homogeneous polynomial of degree $d$ defining the curve $C_0$, and let $f(x,y) = F(x,y,1)$ be the defining equation of the affine part $C_0 \cap U$ of $C_0$. Let $\nu: C\to C_0$ be the normalization map. We start by considering the rational differential $\nu^*(dx)$ on $C$. In the smooth case, we saw that this differential was regular and nonzero in the finite plane, but had poles of order 2 at the points of $C \cap L$; this followed from the equation
$$
 df = \frac{\partial f}{\partial x}dx + \frac{\partial f}{\partial y}dy \equiv 0.
 $$
and the fact that $\frac{\partial f}{\partial x}$ and $\frac{\partial f}{\partial y}$ have no common zeroes on $C_0$. But now $\frac{\partial f}{\partial x}$ and $\frac{\partial f}{\partial y}$ \emph{do} have common zeroes; specifically, the pullbacks $\nu^*(\frac{\partial f}{\partial x})$ and $\nu^*(\frac{\partial f}{\partial y})$ have simple zeroes at the points $r_i$ and $s_i$. We conclude, accordingly, that the differential $\nu^*dx$ has double poles at the points $p_i$, 

\fix{ want to show that $\nu^*(dx)/\partial f/\partial y)$ is regular at $r_i$ and $s_i$; do it locally analytically}; proceeding as before, we see that for a polynomial $e(x,y)$ of degree $\leq d-3$, the differential
$$
\nu^*( \frac{e(x,y)dx}{\partial f/\partial y})
$$
will be regular except for simple poles at the points $r_i$ and $s_i$.

We can get rid of these poles by requiring that $e$ vanishes at the points $q_i$. We say in this case that $e$ (and the curve defined by $e$) \emph{satisfies the conditions of adjunction}. (In the following section, we'll describe the  conditions of adjunction associated to an arbitrary singularity.) In any event, we see that
$$
 \left\{ \nu^* \frac{e(x,y)dx}{\partial f/\partial y} \mid \deg e \leq d-3 \text{ and } e(q_i) = 0 \; \forall i \right\} \subset H^0(K_C).
$$
Now, in the smooth case, we were able to compare dimensions to conclude that this inclusion was indeed an equality. We can do the same thing here: to begin with, we have seen that the  rational 1-form $\varphi = \nu^*(\frac{dx}{\partial f/\partial y})$ has zeroes of order $d-3$ at the points $p_1,\dots,p_d$ and simple poles at the points $r_i$ and $s_i$ and is otherwise regular and nonzero; in other words, if we set $H = p_1+\dots + p_d$, the divisor
$$
(\varphi) = (d-3)H - \Delta.
$$
In particular, we see that
$$
\deg((\varphi)) = d(d-3) - 2\delta
$$
and correspondingly
$$
g(C) = \binom{d-1}{2} - \delta;
$$
this is called the genus formula for plane curves.

On the other hand, the space of polynomials $e$ of degree $\leq d-3$ vanishing at the points $q_i$ has dimension at least $ \binom{d-1}{2} - \delta$; we conclude from this that indeed
$$
H^0(K_C) =  \left\{ \nu^* \frac{e(x,y)dx}{\partial f/\partial y} \mid \deg e \leq d-3 \text{ and } e(q_i) = 0 \; \forall i \right\},
$$
and as lagniappe we have proved the useful

\begin{lemma}\label{adjoint independent}
The nodes $q_i$ of an irreducible nodal plane curve of degree $d$ impose independent conditions on curves of degree $d-3$, and hence on curves of any degree $m \geq d-3$.
\end{lemma}

We will need this in Section~\ref{severi variety}.

In Exercise~\ref{gonality of smooth plane curve}, we saw how to use the description of the canonical series on a smooth plane curve to determine its gonality. Now that we have an analogous description of the canonical series on (the normalization of) a nodal plane curve, we can deduce a similar statement about the gonality of such a curve. Here are the first two cases: 
\begin{exercise}
Let $C_0$ be a plane curve of degree $d\geq 4$ with one node and no other singularities, and let $C$ be its normalization. Show that $C$ admits a unique map $C \to \PP^1$ of degree $d-2$, but does not admit a map $C \to \PP^1$ of degree $d-3$ or less.
\end{exercise}

\begin{exercise}
Let $C_0$ be a plane curve of degree $d\geq 5$ with two nodes and no other singularities, and let $C$ be its normalization. Show that $C$ admits two maps $C \to \PP^1$ of degree $d-2$, but does not admit a map $C \to \PP^1$ of degree $d-3$ or less.
\end{exercise}

\fix{Is it true that a curve of degree $\geq \delta +3$ has gonality $d-2$ and only the projections from the nodes?
use: $n\leq 2m+1$ points impose indep cond on curves of degree $m$ in the plane unless they contain m+2 colinear points.}

\section{Linear series on a nodal plane curve}\label{linear series on nodal plane curves}

Given a divisor $D$ on $C$, we next compute the complete linear series $|D|$, using the birational map $\nu$ from 
$C$ to the nodal curve $C_0$.

We'll do this first in the case where $D = D_0-D_\infty$ is the difference of two effective divisors whose support is disjoint from the support $\{r_i, s_i\}$ of $\Delta$; the general case is only notationally more complicated. To start, we find an integer $m$ and a polynomial $G$ vanishing on the divisor $D_0$ \emph{and at the nodes $r_1,\dots,r_\delta$ of $C_0$}, but not vanishing identically on $C_0$. We can then write the zero locus of $G$ pulled back to $C$ as
$$
(\nu^*G) = D_0 + \Delta + A,
$$
as before. Once more, 
 for simplicity, let's assume that the support of $A$ is disjoint from the support of $\Delta$; this means 
  that the curve $V(G)$ is smooth at the points $q_i$ and is not tangent to either of the branches of $C_0$ there (this can certainly be done if we take $m$ large).

Next, we find polynomials $H$ of the same degree $m$, vanishing at $A+D_\infty$ and at the points $q_i$  but not on all of $C_0$. Let $D'$ be the divisor cut on $C$ by $H$ residual to $D_0 + \Delta + A$; that is, we write
$$
(\nu^*H) = D_0 + \Delta + A + D'.
$$
Finally, since $\nu^*(G/H)$ is a rational function on $C$, we see that 
$$
D_0 + \Delta + A = (\nu^*H) \sim (\nu^*G) = D_0 + \Delta + A + D',
$$
and we conclude that $D'$ is an effective divisor linearly equivalent to $D$ on $C$.

To prove that we get \emph{all} divisors $D'$ in this way we will work on the surface $S$ obtained by blowing up
$\PP^2$ at the points $q_i$. 

The following result, known classically as \emph{completeness of the adjoint series}, is what we need:

\begin{proposition}\label{adjoint completeness}
If $C_0 \subset \PP^2$ is a nodal plane curve and $\nu : C \to C_0$ its normalization $C$ then the linear series cut by plane curves of degree $m$ passing through the nodes is complete.
\end{proposition}
\fix{strictly speaking, this statement is illogical: it has a conventional meaning, but may be mysterious to a naive reader. Maybe
spell out that the linear series is the pullback of... with the two preimages of each node subtracted -- or better, with the notation
introduced already.}

\fix{Given what we have been supposing the reader NOT to know, almost every line of this proof needs an exegesis. What to do?}
\begin{proof}
To prove Proposition~\ref{adjoint completeness}, it will be helpful to introduce another surface: the blow-up $\pi : S \to \PP^2$ of $\PP^2$ at the points $r_i$. The proper transform on $C_0 \subset \PP^2$ in $S$ is the normalization of $C_0$, which we will again call $C$.

There are two divisor classes on $S$ that will come up in our analysis: the pullback of the class of line in $\PP^2$, which we'll denote $H$; and the sum of the exceptional divisors, which we'll call $E$. We write $h= H\cap C$and $e = \sum_i(p_i+q_i) = E\cap C$ for the corresponding divisors on $C$. In these terms, we have
$$
C \sim dH - 2E \quad \text{and} \quad K_S \sim -3H + E
$$
(the first follows from the fact that $C_0$ has multiplicity 2 at each of the points $q_i$, the second from considering the pullback to $S$ of a rational 2-form on $\PP^2$).
\fix{maybe expand the surface section of ch 1 to include this?}

We will use two instances of the Leray spectral sequence \fix{sketch Leray in this context}.

 If $A$ is a curve in $\PP^2$ of degree $m$ passing through the points $q_i$, we can associate to it the effective divisor $\pi^*A - E$; this gives us an isomorphism
$$
H^0(\cI_{\{q_1,\dots,q_\delta\}/\PP^2}(m)) \cong H^0(\cO_S(mH-E)).
$$
In these terms we can describe the linear series cut on $C$ by plane curves of degree $m$ passing through the nodes of $C_0$ as the image of the map
$$
H^0(\cO_S(mH-E)) \to H^0(\cO_C(mH-E)),
$$
and the proposition amounts to the assertion that this map is surjective.

The obvious way to prove this is to view this map as part of the long exact cohomology sequence associated to the exact sequence of sheaves
$$
0 \to \cO_S(mH-E-C) = \cO_S((m-d)H + E)  \to \cO_S(mH-E) \to \cO_C(mH-E) \to 0,
$$
from which we see that it will suffice to establish that $H^1(\cO_S((m-d)H + E)) = 0$. To do this, we apply Serre duality, which says that $H^1(\cL) \cong H^1(K_S\otimes \cL^{-1})^*$; in this instance it 
tells us that
$$
H^1(\cO_S((m-d)H + E)) \cong H^1(\cO_S((d-m-3)H))^*
$$
Now, the line bundle $\cO_S((d-m-3)H)$ is 
 the pullback to $S$ of the bundle $\cO_{\PP^2}(d-m-3)$, which has vanishing $H^1$; thus the Proposition will follow from the 
\begin{lemma}
Let $X$ be a smooth projective surface, and $\pi : Y \to X$ a blow-up. If $\cL$ is any line bundle on $X$, then
$$
H^1(Y, \pi^*\cL) = H^1(X, \cL).
$$
\end{lemma}
The lemma follows by applying the Leray spectral sequence, which relates the cohomology of $\cL$ on $Y$ to the cohomology of the direct image $\pi_*\pi^*\cL$ (Leray is particularly simple in this setting, since all higher direct images are 0), and the observation that $\pi_*\pi^*\cL \cong \cL$.
\end{proof}

\section{Linear series on the normalization of an arbitrary plane curve} \label{arbitrary plane curves}

Suppose again that $C_0 \subset \PP^2$ is reduced and irreducible, but with arbitrary singularities, and again let $\nu : C \to C_0$ be its normalization. Again we want to find the regular differentials on $C$ and the effective divisors on $C$ linearly equivalent to a given $D \in \Div(C)$. Again we take $\widetilde C_0$ to be the intersection of $C_0$ with the open set $z \neq 0$, that is, with $\AA^2\subset \PP^2$, and assume that
all the singular points of $C_0$ are contained in $\widetilde C_0$.

To mimic the analysis in the nodal case we need to generalize what we called the ``conditions of adjunction''. In the nodal case, these were the conditions that a curve $e(x,y)=0 \subset \AA^2$ pass through the nodes of $C_0$, that is, locally, $e$ was contained in the maximal ideal
at each node. For an arbitrary singular point, the ideal that will play the role of the maximal ideal is called the \emph{adjoint ideal} of the singularity. It is easy to compute in simple cases, and has a nice description in terms of $\nu$ for arbitrary plane curves that will be given in Theorem~\ref{general adjoint}.

We first turn to the canonical series; that is, we wish to find expressions for all the regular differential forms on $C$. In the case of smooth and nodal curves we found we could express every regular differential form
on $C$ as a rational function times the restriction of the differential form written as $dx$ on $\AA^2$. We justified this
by counting---that is, by showing that we could get a $g(C)$-dimensional space of regular differentials in this way. The justification for 
this procedure for a reduced, irreducible curve with arbitrary singularities relies on the fact that $x$, as a function on $\widetilde C_0$
is a \emph{finite} map to $\AA^1$, and thus the field of rational functions $\kappa(C) = \kappa(\widetilde C_0)$ is a finite
separable extension of $\CC(x)$. By Theorem~\cite[****]{Eisenbud1995} that the module of differentials 
$\omega_{\kappa(C)/\CC}$ is generated over $\kappa(\widetilde C_0)$ by $dx$; that is, every differential can be expressed as a rational function
times $dx$. 

We focus for now on one singular point $q \in C_0$, with points $r_1,\dots,r_k \in C$ lying over $q$, and we wish to describe the conditions for a rational differential $e\varphi_0$ on $C$ to be regular, where
$$
\varphi_0 = \nu^* \frac{dx}{\partial f/\partial y},
$$
and $f$ is the defining equation of $C_0$ in an affine open containing $q$. As in the case of a smooth curve $C$, the differential
form $\varphi_0$ has a zero of order $d-3$ at each of the points of $C$ lying over the intersection of $C_0$ with the line  $L = \PP^2\setminus \AA^2$
at infinity. Thus we must must choose $e$ to be a function with poles on $C_0$ of order $\leq d-3$ on $L\cap C_0$ and no poles in $\widetilde C$. Any such function is represented (modulo $(f)$ by 
a polynomial $e$ in $x,y$ which must have degree $\leq d-3$, since otherwise $edx$ would have poles at infinity. In addition, $\varphi_0$ will have poles at the points points $r_i$,
so $e$ must satisfy some ``conditions of adjunction'', represented by belonging to an ideal---the adjoint ideal---at each singular point.

Let $m_i$ be the order of the pole of $\varphi_0$ at $r_i$. We can define the \emph{adjoint ideal} of $C_0$ at $q$ to be the ideal
$$
\mathfrak A_{q} = \left\{ e \in \cO_{\PP^2, q} \mid \ord_{r_i}(\nu^*e) \geq m_i \; \forall i \right\}
$$

In other words, $\mathfrak A_q$ is the ideal of functions $e$ such that $\nu^* \frac{gdx}{\partial f/\partial y}$ is regular at all the points $r_i$. We define the \emph{adjoint ideal $\mathfrak A_{C/C_0}$ of $C_0$} to be the intersection of $A_q$ over all singular points  $q \in C_0$; the \emph{adjoint series of degree $m$} is then the linear series $H^0(\mathfrak A_{C/C_0}(m))$. 

We now see  that every global regular 1-form on the curve $C$ is of the form 
$$
e(x,y) \varphi_0,
$$
with $e$ a polynomial of degree $\leq d-3$ in the adjoint ideal $\fA_{C/C_0}$.

With this definition of the adjoint ideal we can compute complete linear series as in the nodal case, simply replacing
the divisor $\Delta = \sum q_i$ with the divisor determined by the adjoint ideal. We omit the details, which involve replacing
the surface $S$ with a repeated blowup of the plane on which the strict transform of $C_0$ is the normalization $C$.

In simple cases, the adjoint ideal is not difficult to compute. 

\subsection{The adjoint ideal of a plane curve}

We begin as usual with examples:

\begin{example}[nodes and cusps]
We have already seen that in case $q$ is a node of $C_0$, there are two points of $C$ lying over it, and the multiplicities of $\varphi_0$ at these two points are $m_1=m_2=1$; the adjoint ideal is thus 
 the maximal ideal $\cI_q$ at $q$. In the case of a cusp, for example the zero locus of $y^2-x^3$, there is only one point $r=r_1$ of $C$ lying over $q$, and the differential $\varphi_0$ vanishes to order $m_1=2$; since the pullback to $C$ of any polynomial $g$ vanishing at $q$ will vanish to order at least two at $r$, the adjoint ideal is again the maximal ideal at $q$.
\end{example}

\begin{example}[tacnodes]
Next, consider the case of a \emph{tacnode}; that is, a singularity with two smooth branches simply tangent to one another, such as the zero locus of $y^2-x^4$. In this case there are again two points of $C$ lying over $q$, and a simple calculation shows that $m_1=m_2=2$. The adjoint ideal is thus the ideal of functions vanishing at $q$ and having derivative 0 in the direction of the common tangent line to the branches.
\end{example}

\begin{exercise}[ordinary triple points]
In the case of an ordinary triple point---three smooth branches pairwiset ransverse to one another---there are three points of $C$ lying over $q$, and we have $m_1=m_2=m_3= 2$; the adjoint ideal is correspondingly 
 the square of the maximal ideal at $q$
\end{exercise}

\begin{exercise}
Find the adjoint ideals of the following plane curve singularities:
\begin{enumerate}
\item a \emph{triple tacnode}: three smooth branches, pairwise simply tangent
\item a triple point with an infinitely near double point: three smooth branches, two of which are simply tangent, with the third transverse to both
\item a unibranch triple point, such as the zero locus of $y^3-x^4$
\end{enumerate}
\end{exercise}

Here is a  general description in case the individual branches of $C_0$ at $p$ are each smooth:

\begin{exercise}
Let $\nu : C \to C_0$ be the normalization of a plane curve $C_0$ and $p \in C_0$ a singular point. Denote the branches of $C_0$ at $p$ by $B_1,\dots,B_k$, and let $r_i$ be the point in $B_i$ lying over $p$. If the individual branches $B_i$ of $C_0$ at $p$ are each smooth, and we set
$$
m_i = \sum_{j \neq i} mult_p(B_i \cdot B_j)
$$
then the adjoint ideal of $C_0$ at $p$ is the ideal of functions $g$ such that $ord_{r_i}(\nu^*g) \geq m_i$.
(Hint: The computation can be done locally analytically. Let $R = \widehat{\sO_{C_0, p}}$ be the completion of the local ring
of $C_0$ at $r_i$. The integral closure is then the product of rings $R_i = \widehat{\sO_{B_i}} \cong k[[t_i]]$,
with $R_i = R/P_i$ as $P_j$ runs over the minimal primes of $R$. The multiplicity
$m_i$ is the colength of the ideal $\sum_{j\neq i}P_j \subset R$.
)
\end{exercise}

In the Theorem~\ref{general adjoint} we shall prove that the adjoint ideal can be computed
as the \emph{conductor} ideal, the annihilator in $\sO_{C_0}$ of the quotient
$\nu_*\sO_C/\sO_{C_0}$.

%\begin{example}
%\fix{restate for the local or affine case -- this is nonsense globally since there are no functions. Best is to do it locally analytically.} In the case of a node $q \in \widetilde{C_0}$, with $r_1,r_2$ the points of $C$ lying over $q$, we see that any function on $C$ vanishing at both $r_1$ and $r_2$ is the pullback of a function on $C_0$; thus the conductor is simply the maximal ideal at $q$. Similarly, if $q \in C_0$ is a cusp, with $r \in C$ lying over it, a function $f$ on $C$ will descend to $C_0$---that is, be the pullback of a function on $C_0$---if it vanishes to order 2 at $r$; since the pullback to $C$ of any function on $C_0$ vanishing at $q$ vanishes to order at least 2 at $r$, the conductor ideal is 
% the maximal ideal at $q$. 
%
% Plane curves satisfy the \emph{Gorenstein} condition 
% $$
% \Hom_{\PP^1}(\sO_{C_0}, \sO_{\PP^1}) \cong \sO_{C_0}$$
% as sheaves on $C_0$, and Theorem~\ref{adjoint equals conductor} is true for
%any \emph{Gorenstein} curve singularlity, but not in general. For example, the conductor ideal of a spatial triple point
%is the maximal ideal, but the $\delta$-invariant $\length \nu_*(\sO_C)/\sO_{C_0} = 2$. \fix{add comparison with the 
%planar triple point}
%\end{example}
%
%\begin{fact}
% There is another ideal we can associate to a singularity, called the \emph{conductor ideal}. If $X_0$ is any reduced projective scheme and  $\nu : X \to X_0$ its normalization, the conductor ideal is the annihilator of the quotient $\nu_*\cO_X/\cO_{X_0}$. In concrete terms, on any affine open $U \subset X_0$ this is the ideal of functions $g \in \cO_{X_0}(U)$ such that for any function $h \in \cO_X(\nu^{-1}(U))$ the product $hg$ is the pullback of a function on $X_0$.
%
%\begin{theorem}
%If $C_0$ is a reduced plane curve, then the adjoint ideal of $C_0$ is equal to the conductor ideal of $C_0$.
%\end{theorem}
%\end{fact}

\subsection{The ``deficiency" of a curve}

Even before the Riemann-Roch theorem and the modern definitions of the genus of a curve, algebraic geometers had
defined an invariant called the \emph{deficiency} that is equal to the genus. When Clebsch, Brill and Noether tried to 
compute what amounts to the geometric genus of a plane curve, this was the idea they used, and we can shed some light
on the meaning of the adjoint ideal by examining the old definition.

%One thing that may elucidate both the notion of the adjoint ideal of a plane curve $C$, and the algorithm described above for finding the complete linear system associated to a divisor on the normalization of $C$, is a historical discussion of how the notion of genus first appeared.
%
%If you mention the genus of a curve most people think of the topological definition, in terms of the classification of compact oriented 2-manifolds. But the genus was defined long before this classification was carried out, and indeed was defined without any reference to the complex points of the curve or their topology.

The starting point may have been the observation that, while any $2n$ points on a plane conic curve $C$ form the intersection of $C$ with a  curve of degree $n$, the analogous statement---that any $3n$ points on a smooth plane cubic comprise the intersection of $C$ with a plane curve of degree $n$---is not true. This is a reflection of the fact that there are fewer rational functions on the cubic than on the conic: if $D = p_1+\dots + p_d$ is a $d$-tuple of points on a conic curve $C$, we have
$$
h^0(\cO_C(D)) = d+1,
$$ 
and so there is a rational function with poles just along $D$ and vanishing at any given $d$-tuple of points; by contrast, a plane cubic $C$ has genus 1, and so by Riemann-Roch for such a divisor we have
$$
h^0(\cO_C(D)) = d.
$$
This lack of rational functions was viewed as a defect of the curve, and called its \emph{deficiency} (and typically denoted $p$, rather than $g$). .

%Of course, at the time the notion of deficiency first appeared, Riemann-Roch was still well into the future. But the method of finding rational functions described in the algorithm above was known, and they applied it. 

In general, if $C$ is a smooth plane curve $C \subset \PP^2$ of degree $n$, and suppose that $D = p_1+\dots + p_d$ is a divisor of degree $d$. To find the complete linear system $|D|$ by the method of Section~\ref{smooth plane curves} we start by choosing a plane curve $B$ of degree $m$ containing $D$ but not containing $C$; again for simplicity of notation we'll assume $m \geq n$. The intersection $B \cap C$ will then consist of $D$ plus another divisor $E$ on $C$, of degree $mn-d$; and what we saw is that the complete linear series $|D|$ will be cut on $C$ by plane curves of degree $m$ containing $E$, modulo those containing $C$.

We can easily estimate the size of this linear series: If the $(mn-d)$ points of $E$ impose independent conditions on curves of degree $m$, which will be the case when $d$ is large compared with $n$, the space of curves of degree $m$ containing $E$ will have dimension
$$
h^0(\cI_{E/\PP^2}(m)) = \binom{m+2}{2} - (mn-d);
$$ 
and the subspace of curves of degree $m$ containing all of $C$ has dimension
$$
h^0(\cO_{\PP^2}(m-n)) = \binom{m-n+2}{2}
$$
so the dimension of $H^0(\cO_C(D))$ is
$$
h^0(\cO_C(D)) \geq \binom{m+2}{2} - (mn-d) -  \binom{m-n+2}{2} = d + 1 - \binom{n-1}{2}
$$
and the inequality will be an equality if $d$ is large enough compared to $n$ (in fact,  when $d> 2\binom{n-1}{2}-2 = n^2-3n$,
as we know from the Riemann-Roch theorem plus the genus formula).  That is, a smooth plane curve of degree $n$ has deficiency $\binom{n-1}{2}$.

Now suppose the curve $C$ maps birationally to a curve $C_0$ which has a node at a point $p$; let $D$ again be a divisor of degree $d$, whose support we assume does not contain $p$. If we take our curve $B$ of degree $m$ to contain $D$ and also pass through the point $p$, then the residual intersection $E$ to $D+\nu^{-1}(p)$ on $C$ will consist of $mn-d-2$ points rather than $mn-d$. To construct the complete linear system $|D|$, we take curves of degree $m$ passing through this residual divisor $E$ and passing through $p$.

Here we have a sort of ``two-for-one" deal: the curves of degree $m$ that cut out the linear series $|D|$ have to satisfy the one additional condition of passing through the node $p$; but the number of points of $E$ that these curves have to contain has been reduced by 2. The expected dimension of the linear series associated to $DS$ is thus
$$
h^0(\cO_C(D)) = \binom{m+2}{2} - (mn-d-2) -  \binom{m-n+2}{2} = d  - \binom{n-1}{2}.
$$
so the deficiency of the curve is $\binom{n-1}{2}-1$, or one less. More generally, if $C$ has $\delta$ nodes, we can get this two-for-one deal $\delta$ times, resulting in a deficiency of $\binom{n-1}{2} - \delta$, giving us an early version of the formula for the  geometric genus of a plane curves with nodes.

What if $C$ has an ordinary triple point $p$? In this case, we can get a ``three-for-one" deal by requiring the curve $B$ of degree $m$ to pass through $p$. In this case the residual divisor $E$ will have degree 3 less; again, the curves of degree $m$ that cut out the linear series $|D|$ only have to satisfy the one additional condition of passing through $p$, so the apparent deficiency will be 2 less than for a smooth plane curve of degree $n$.

But we can do even better! If we require our initial curve of degree $m$ to be double at $p$, that reduces the degree of the residual divisor $E$  by 6. Of course, now the curves $B$ of degree $m$ containing $E$ that cut our the linear system $|D|$  will have to be double at $p$ as well, but this is only 3 linear conditions, the vanishing at $p$ along with the vanishing of the first derivatives. In effect, we have gotten a ``six-for-three" deal, suggesting (correctly, as we know) that the presence of a triple point should reduce the deficiency by 3. 

In general---for singularities beyond nodes or triple points---the adjoint ideal can be characterized as the largest ideal that gives the best ``deal" in this sense. \fix{citation needed}

\begin{exercise}
Continuing the example of a plane curve with a triple point $p$, show that requiring our curve of degree $m$ to be triple at $p$ gives us a ``nine-for-six" deal---the same net effect as when we required our curve of degree $m$ to be double. (In general, an ideal contained in the adjoint ideal will work as well; the adjoint ideal is characterized as the largest ideal that works.)
\end{exercise}

\begin{exercise}
Now let $C \subset \PP^2$ be a plane curve with a tacnode at $p$. Show that by taking our curve of degree $m$ to pass through $p$ and be tangent to the branches of $C$ at $p$ we get a four-for-two deal; and that this is the best we can do, so that the effect of a tacnode is to drop the deficiency by 2.
\end{exercise}


\section{The canonical sheaf of a singular curve}

Suppose again that $\nu:C\to C_0$ is the normalization of a singular curve. It seems natural that
in order to understand the adjoint ideal, one would want to compare the canonical sheaf of $C$ with
that of $C_0$. But the sheaf of differentials on $C_0$ is generally not well-behaved, not even
locally free, and it is not useful for this purpose. Instead we must define a canonical sheaf in a different way.

Possibly singular curves (and more generally all locally Cohen-Macaulay schemes) have canonical    sheaves (also called \emph{dualizing sheaves}) that play a role similar to that of the 
sheaf of regular differential forms on a smooth curve. In particular,
when the scheme is locally Gorenstein---as is the case with any smooth curve or any plane curve---the canonical
sheaf is an invertible sheaf, just as in the smooth case. Recall that the canonical sheaf of
$\PP^1$ is $\omega_{\PP^1} = \sO_{\PP^1}(-2)$.

\begin{definition}
Let $C$ be a locally Gorenstein curve, and let $\rho: C\to \PP^1$ be a finite morphism. The canonical sheaf $\omega_C$
is the sheaf $\Hom_{\PP^1}(\rho_*\sO_C, \omega_{\PP^1})$, regarded as an 
$\sO_C = \rho^{-1}(\rho_*\sO_C)$-module.
\end{definition}

To demystify the last phrase of this definition, note that because the map
$\rho$ is finite, the open sets $U = \rho^{-1}V$, where $V\subset \PP^1$ is open, form a basis for the open sets of $C$; and for
such an open set $U$ the ring $\sO_C(U)$ is equal, as a set, to the ring $(\rho^{-1}(\rho_*\sO_C))(U) = 
\rho_*(\sO_C)(V)$. Still more concretely, if $R\to S$ is a finite map of rings in the sense that
$S$ is a finitely generated $R$-module, and $\rho: U=\Spec S \to V = \Spec R$ is the corresponding map
of schemes, then the pushforward of any finitely generated $S$-module is set-theoretically the same module, regarded as an $R$-module via the map $R\to S$.

\begin{example}
Consider the case when $C$ is smooth, connected projective curve. If $\psi: C\to \PP^1$ is a finite  ($\equiv$ non-constant) morphism to $\PP^1$, then Hurwitz' Theorem asserts that the canonical sheaf on
$C$ is $(\rho^*\omega_{\PP^1})(R)$, where $R$ is the ramification divisor.
For example at a point  $ p\in\PP^1$ over which there are two disjoint smooth branches
we can complete the local ring at $p$ and, after tensoring
with $\widehat \sO_{C,p} \cong k[[x]]$, the map of rings becomes 
$$
R := k[[x]] \subset R':= k[[x]]e_1\times k[[x]]e_2; \quad x =xe_1+xe_2,
$$
where the $e_i$ are orthogonal idempotents. Tensoring with the quotient field $Q = k((x))$ of $k[[x]]$
we get a map $Q \to Q':= Qe_1\times Qe_2$. As in any such situation there is a natural map of $Q$-vectorspaces in the other direction, the trace, which takes any element of $Q'$ to the trace of that element
regarded as a homomorphism $Q' \to Q'$ of $Q$-modules. Because $R'$ is finite, and thus integral, over $R$, the trace takes elements of $R'$ to $R$; that is $Tr \in \widehat \omega_{R'} = \Hom_R(R', R) \cong R^2$.

In this situation the trace generates $\widehat \omega_{R'}$ \emph{as an $R'$-module}: 
$$
(e_1Tr) (e_1) = Tr(e_1^2) = Tr(e_1) = Tr 
\begin{pmatrix}
 1&0\\0&0
\end{pmatrix} 
=1$$
while $e_1Tr(e_2) = Tr(e_1e_2) = Tr(0) = 0$
and similarly with $(e_2Tr)$, the other projection.

However, if $p$ is a simple branch point then, upon completing, the map of local rings becomes
$$
R := k[[x]] \subset R':= k[[y]; \quad x = y^2
$$
Again taking $Q = k((x))$, the quotient field of $R$, we see that $Q' = Q\otimes_RR'$ is freely generated as a $Q$-module by 1 and $y$. Again, since $R'$ is integral over $R$ the map $Tr$ takes $R'$ to $R$.
We have $Tr(1) = 2$ but
$$
Tr(y) = Tr
\begin{pmatrix}
 0&1\\1&0
\end{pmatrix} 
=0
$$
to $\frac{1}{2}Tr$ is the projection onto the first summand. Furthermore, $yTr$ takes 1 to $Tr(y) =0$ and $y$ to $Tr(y^2) = Tr(x) = 2x$,
so the cyclic module $R'Tr$ does not contain a projection onto the second factor taking $y$ to a scalar.
However $y^{-1}= x^{-1}y$ so
$$
y^{-1}Tr(1) = 
Tr
\begin{pmatrix}
0&1\\ x^{-1}&0
\end{pmatrix} 
=0
$$
while
$
y^{-1}Tr(y) = Tr(1) = 2
$
so 
$$
\frac{1}{2}y^{-1}Tr: R' = R\oplus Ry \to R
$$
 is the second projection, and $y^{-1}Tr$ generates $\omega_{R'} = \Hom_R(R', R)$ as an $R'$-module.
This corresponds to the fact that the local generator of the module of regular differential forms
on $\Spec R'$ is $y^{-1}$ times the pullback of the local generator $dx$. Note that if we write
$R' = k[[x,y]]/(f)$  with $f(x,y) = y^2-x$, then 
$$
y^{-1}dx = \frac{dx}{\partial f/\partial y}
$$
a formula we have seen before.
\end{example}
 

The reader may be concerned with applying the name ``canonical'' to a definition that seems to
depend on the choice of a map $\rho$, but in fact if $\rho': C \to \PP^1$ is another such map,
there is a canonical isomorphism between the apparently different sheaves $\omega_C$ defined above.


More generally:

\begin{theorem}
If $\omega_X$ is a canonical sheaf on a $\psi: C \to X$ is any finite morphism of pure-dimensional schemes, then there is a canonical isomorphism
$$
\omega_C \cong \sExt^{\dim X -\dim C}(\sO_C, \omega_X).
$$
\end{theorem}
For a proof in the case of the inclusion of a projective variety see \cite[Section III.7]{Hartshorne 1977}, while for the more general assertion above the
reader may consult \cite{AltmanKleiman}. Note that this result is independent of whether
or not $C$ is smooth. The difference is that when $C$ is not smooth, the canonical
sheaf is \emph{not} the sheaf of global differential forms (though it can be identified with
a certain subsheaf of the sheaf of rational differential forms.)

\begin{example}
 If $C$ is a plane curve of degree $d$, then 
$$
\omega_C = \sExt^1(\sO_C, \omega_{\PP^2}) = \sExt^1(\sO_C, \sO_{\PP^2}(-3)) \cong \sO_C(d-3),
$$
where the last isomorphism can be seen from the long exact sequence in $\sExt$ applied
to the locally free resolution
$$
0\to \sO_{\PP^2}(-d) \to \sO_{\PP^2} \to\sO_{X} \to 0
$$
of $\sO_C$ as a sheaf on $\PP^2$. 
\end{example}

Using this theory we can give a formula for the adjoint ideal of any curve singularity.

\begin{theorem}\label{general adjoint}
If $\nu: C \to C_0$ is the normalization of a reduced irreducible projective curve then the 
adjoint ideal 
$$
\fA_{C/C_0} :=\ann_{\sO_{C_0}}\frac{\omega_{C_0}}{\nu_* \omega_C}
$$
is equal to the conductor ideal
$$
\mathfrak f_{C/C_0}: = \ann_{\sO_{C_0}}\frac{\nu_* \sO_C}{\sO_{C_0}}	
$$
Moreover, if $C_0$ is a plane curve, then 
$$
\delta(C_0) = \length \frac{\nu_* \sO_C}{\sO_{C_0}} = \length \frac {\sO_{C_0}}{\mathfrak f_{C/C_0}}.
$$
\end{theorem}

Here $\delta(C_0)$ is the ``number of nodes equivalent to the singularities of $C_0$'' as
explained in Chapter~\ref{RiemannRochChapter}. The notation $\mathfrak f$ for the conductor comes from the german \emph{F\"uhrer}. The property in the last statement of the
Theorem  was first noted (for plane curves) in Daniel Gorenstein's thesis under Oscar Zariski\footnote{Gorenstein is better remembered for his work on the classification of finite simple groups.}. This is the
reason why the name ``Gorenstein" was given to Cohen-Macaulay rings of having a cyclic canonical 
module. Indeed, the property in the last statement holds whenever $C_0$ is locally Gorenstein.

Note that the use made of the adjoint ideal in the previous chapter---as a condition on a polynomial
$e$ for $e\phi$ to belong to $\omega_C$ is always sufficient, but may be necessary only
when $\omega_{C_0}$ is cyclic---which is equivalent to the statement that $C_0$ is locally
Gorenstein. Fortunately this condition is always satisfied for plane curve singularities. See Example~\ref{nongorenstein} for a case that behaves differently.


\begin{proof}[Proof of Theorem~\ref{general adjoint}]
  Let 
$\rho: C_0 \to \PP^1$ be a nonconstant homomorphism. Both $\rho_*\nu_*\sO_C$ and $\rho_*\sO_{C_0}$
are torsion free coherent sheaves over $\sO_{\PP^1}$, and are thus locally free. Moreover, since $\nu$
is birational, the inclusion $\sO_{C_0} \subset \nu_*\sO_C$ pushes forward to an inclusion
$$
\alpha: \rho_*\sO_{C_0} \hookrightarrow \rho_*\nu_*\sO_C
$$
that is generically an isomorphism, so $\coker \alpha$ has finite length; indeed, it is supported at the 
image of the singular locus of $C_0$. Since the maps $\nu$ and $\rho$ are finite, we may harmlessly think of both 
$\sO_{C_0}$ and $\sO_C$ as coherent sheaves on $\PP^1$, and we will accordingly drop the notations $\nu_*$ and $\rho_*$.
Taking duals into $\sO_{\PP^1}$ and defining
$\alpha^\vee := \Hom(\alpha, \sO_{\PP^1}) $ we get a map that fits into the long exact sequence
of $\sExt(-, \sO_{\PP^1})$:
$$
\begin{diagram}[small]
 0&\rTo& 
 \Hom(\coker \alpha,\sO_{\PP^1})
&\rTo&
\omega_{C}
& \rTo^{\alpha^\vee}&
\omega_{C_0}\\
&\rTo&
\sExt^1(\coker \alpha, \sO_{\PP^1})
&\rTo&
\sExt^1(\rho_*\nu_*\sO_C, \sO_{\PP^1})
&\rTo&
\cdots
\end{diagram}
$$
Since $\coker \alpha$ has finite support, $ \Hom(\coker \alpha,\sO_{\PP^1}) = 0$ and
$\sExt^1(\coker \alpha, \sO_{\PP^1})$ is has the same length and the same annihilator
as $\coker \alpha$. Furthermore, because $\rho_*\nu_*\sO_C$ is locally free, the term
$\sExt^1(\rho_*\nu_*\sO_C, \sO_{\PP^1})$ vanishes, and we get the more manageable exact sequence
$$
\begin{diagram}
 0&\rTo&
\omega_{C}
& \rTo^{\alpha^\vee}&
\omega_{C_0}
&\rTo&
\sExt^1(\coker \alpha, \sO_{\PP^1})
&\rTo&
0
\end{diagram}
$$
It follows that the sheaves $\nu_*\sO_C/\sO_{C_0}$ and $\omega_{C_0}/\omega_C$ have the same
length $\delta(C_0)$. Note that the \emph{conductor} $\mathfrak f_{C/C_0}$ of $C/C_0$, which is defined to be the annihilator of $\sO_C/\sO_{C_0}$ 
in $\sO_{C_0}$, is at the same time an ideal sheaf of $\sO_{C_0}$ and an ideal sheaf of $\sO_C$ via the inclusion $\sO_{C_0}\subset \sO_C$. The argument above shows that $\mathfrak f_{C/C_0}$ is also the annihilator ideal of $\omega_{C_0}/\omega_C$, the adjoint ideal of $C_0$ proving the first statement
of the Theorem.

A further simplification occurs when $C_0\subset \PP^2$ is a plane curve, or more generally any
locally Gorenstein curve. If the defining equation of 
$C_0$ is the form $F$ of degree $d$, then there is a locally free resolution of the homogeneous coordinate ring $S_C$ of $C$ of the form
$$
0\rTo \sO_{\PP^2}(-d) \rTo^F \sO_{\PP^2} \rTo \sO_C \rTo 0
$$
and thus $\omega_C \cong \sExt^1(\sO_{C_0}, \omega_{\PP^2})$
is the sheafication of the map $\sO_{\PP^2}(-3) \to \sO_{\PP^2}(d-3)$ given by multiplication by $F$. Thus
$\omega_{C_0}$ is locally cyclic, and thus, since its support is finite, it is also globally cyclic, that is,
$\omega_{C_0}/\omega_C \cong \sO_{C_0}/\mathfrak f_{C/C_0}$.
Since the length of $\omega_{C_0}/\omega_C$ is equal to the length of 
$\sO_{C}/\sO_{C_0}$, the last statement of the Theorem follows.
\end{proof}

\begin{example}
 Working locally, consider the germ of a node, represented by the ring $R_0:= k[[x,y]]/(xy)$, and
 the projection to a line represented by the inclusion 
 $$
 P:= k[[t]] \subset R_0: t\mapsto x+y.
 $$
 The normalization of $R_0$ is the map $R_0 \to R := k[[x]]e_1\times k[[y]]e_2$,
 where $e_1= x/t, e_2= y/t$ are orthogonal idempotents.Writing 
 $Q_1 = k((t)) \subset Q:= k((x))\times k((y))$
 for the map of total quotient rings, we know that, because the extension is separable, the trace map
 $Tr := Tr_{Q/Q_1}: Q \to Q_1$ generates $\Hom_{Q_1}(Q,Q_1)$ as a $Q$-vector space. Thus we may write the
 elements of $\omega_{R_0} = \Hom_{P}(R_0,P)$ and $\omega_R = \Hom_{P}(R,P)$ as
 multiples of $Tr$ by elements of $Q$.
 
 Since $R \cong Pe_1\oplus Pe_2$ as a $P$-module, the module $\Hom_P(R,P)$ is
 generated by the two projections, and it is easy to check that these are the maps
 $(x/t)Tr$ and $(y/t)Tr$. One can also check easily that 
 $$
 g := \frac{x-y}{t^2} Tr \in \Hom_P(R_0,R).
 $$
 Since
$xg = x/t$ and $yg = y/t$ in $Q$ we have
 $xg = x/tTr$ and $yg= y/tTr$, the generators of $\Hom_{P}(R,P)$. 
 The ring $R_0$, regarded As a $P$-module, is freely generated by 1 and $x$.
 Immediate computation shows that $gTr(1) = 0$ while $gTr(x) = 1$.
 Furthermore $(x-y)g = 1$ in $Q$,  and thus $\frac{1}{2}(x-y)gTr = Tr$ takes 1 to 1
 and $x$ to $t$, proving that $gTr$ from which we see that $gTr$ generates
 $\Hom_P(R_0,P)$. We also see directly from this that the adjoint ideal
 of $\omega_{R_0}/\omega_R$ is the conductor ideal $(x,y)R_0 = (x,y)R = \mathfrak f_{R/R_0}$,
 as shown by  Theorem~\ref{general adjoint}. 
\end{example}

\begin{example}\label{nongorenstein}
 Consider the germ of a spatial triple point singularity $R_0 := k[[x,y,z]]/(xy, xz,yz)$, the vertex of the cone over 3
 non-colinear points in the plane, with normalization $R = k[[x]]\times k[[y]]\times k[[z]]$.
 If we set $t = x+y+z\in R_0\subset R$, then the three idempotents that generated $R$ as an $S$-module
 can be written as $x/t, y/t, z/t$. We have $x^2/t = xt_t= x$ and similarly for $y$ and $z$, so
 the conductor is given by $\ff_{R/R_0} = (x,y,z)R = (x,y,z)R_0$.
 
 The ring $R$ is also finite over $S := k[[x,y,z]]$, and is isomorphic as such to 
 $S/(x,y)\oplus S/(x,z) \oplus S/(y,z)$, so we can compute it's canonical module from the
 resolution that is the direct sum of the three Koszul complexes resolving these summands, and 
 as such the canonical module $\omega_R = \Ext^2(R,S)$ is isomorphic to $R$ as an $S$-module.
 

 The $S$-module $R_0$, on the other hand,   has free resolution
 $$
 0\rTo S^2\rTo^{
	\begin{pmatrix}
 0&z\\
 y&-y\\
 -x&0
\end{pmatrix}}
 S^3 \rTo^{
\begin{pmatrix}
 xy&xz&yz
\end{pmatrix}}
 S \rTo R_0 \rTo 0. 
 $$
The canonical module of $R_0$ (which would be the germ of the canonical module of a global curve with such a singularity) is thus 
 $$
 \omega_{R_0} = \Ext^2(R_0, S) = 
 \coker 
\begin{pmatrix}
 0&y&-x\\z&-y&0
\end{pmatrix}
$$
a module requiring 2 generators.
\end{example}
The inclusion $\omega_{R} \subset \omega_{R_0}$ is thus induced by the 
dual of the last map in a comparison map between the two resolutions. Computation
confirms the conclusion of Theorem~\ref{general adjoint} that $\fA_{R/R_0} = \ff_{R/R_0} = (x,y,z)$. However, the length of $R/R_0$ is 2, and the length of $R_0/\ff_{R/R_0} = R_0/(x,y,z) = 1$, so the
last conclusiong of Theorem~\ref{general adjoint} fails, along with its hypothesis.

\section{Severi varieties}\label{severi variety}

%As we said at the outset of this chapter, there is a trade-off when we go from studying curves in $\PP^3$ and higher-dimensional projective space to studying plane curves. On the one hand, a curve $C \subset \PP^n$ with $n \geq 3$ is defined by a collection of polynomials, which in turn (unless the curve is a complete intersection) have to satisfy non-trivial syzygies. It's thus not a priori clear how we can vary the coefficients of these polynomials without losing the syzygies they satisfy; as a consequence, things like the dimension of the family of such curves can be obscure.
%
%A plane curve $C_0 \subset \PP^2$, by contrast, is simply the zero locus of a single polynomial, and we can vary the coefficients of that polynomial arbitrarily to arrive at a family of curves. But as we said, there's a trade-off: unless we're dealing with the very special case of curves of degree $d$ and geometric genus $g = \binom{d-1}{2}$, the plane model of a curve $C$ of genus $g$ will be singular; and it's not so clear how we can vary the coefficients of its defining polynomial so as to preserve those singularities and arrive at a family of curves of degree $d$ and geometric genus $g$.
%
%In this section, we'll address exactly this question. 

%The set of plane curves of given degree is naturally an algebraic variety---the projective space of forms of that degree. The idea of varying a plane curve by varying the coefficients of its defining equation was exploited from the very beginning of the subject in the vague ``principle of conservation of number''. Perhaps this obvious family of curves is what originally suggested a key feature of algebraic geometry, that sets of ``similar'' algebraic varieties, or vector bundles, or still more complicated objects, often can be made into algebraic varieties in a natural way---the various sorts of moduli, of which several are addressed in this book.

Despite its antiquity, many questions about the family of plane curves, such as which ones degenerated into which others, and in what way, remain open. All plane curves of degree $d$ have the same Hilbert funcdtion, and thus the same arithmetic genus, but since curves of degree $d$ can have different sorts and numbers of singularities, they can have many different geometric genera, all the way from 0 to $\binom{d-1}{2}$, as we have seen. In this section we will explore the subset of of (reduced, irreducible) curves of degree $d$ with a fixed geometric genus. We will focus on the open set consisting of curves with only nodes as singularities, which we call \emph{nodal curves}, and compute its dimension. We will also prove the existence of specializations from a smooth projective curve of genus $g$ to a general $g$-nodal curve, a result used in Chapter~\ref{InflectionsChapter}.

Let $\PP^N := \PP^{{d_1+2\choose 2} - 1}$ be the projective space parametrizing plane curves of degree $d$.

Since we will always be working with reduced irreducible curves, we begin by noting that this set is an open subset of the space 
$\PP^N$---it is the complement of the union of the images of the maps 
$$
\PP^{{d_1+2\choose 2} - 1}\times\PP^{{d_2+2\choose 2}-1} \to \PP^N
$$ 
with $d_1+d_2 = d$ given by multiplication of forms.

\def\Vdg{{V_{d,g}}}
\def\Vdgtilde{{\widetilde{V}_{d,g}}} 
\def\Vdgbar{{\overline{V}_{d,g}}} 
\begin{propdef}
The \emph{Severi variety} $\widetilde V_{d,g} \subset V_{d,g}$ is the locus of plane curves of degree $d$ with $\delta = \binom{d-1}{2} - g$ nodes and no other singularities. This is a locally closed subset of $\PP^N$. It is sometimes
called the \emph{small Severi variety}, since we are excluding curves with more complicated singularities.

\end{propdef}

\begin{proof}
\fix{ How about proving that $V_{d,g}$ is locally closed, and at least mentioning that $\widetilde V_{d,g}$ is open in $\overline V_{d,g}$}
\end{proof}

We will see that in a neighborhood of the small Severi variety $\widetilde {V}_{d,g}$,  the large Severi variety $\overline V_{d,g}$  is well behaved; but away from this,
even the singularities of $\overline V_{d,g}$  are not well understood. It is is an interesting open problem to find a better compactification of $\widetilde V_{d,g}$.

\fix{We should at least mention the irreducibility result as a "fact"! Also, list some more of what is NOT known about these sets.}

\subsection{Local geometry of the Severi variety}\label{local severi geometry}

We first consider the \emph{universal singular point}
$$
\Phi := \left\{ (C, p) \in \PP^N \times \PP^2 \mid p \in C_{sing} \right\}
$$
and its image $\Delta\subset \PP^N$, the \emph{discriminant} variety. 

\begin{proposition}
 $\Phi$ is smooth and irreducible of dimension $N-1$, and the discriminant $\Delta$ is a hypersurface in $\PP^N$.
\end{proposition}
\begin{proof}
Projection on the second factor expresses $\Phi$ as a $\PP^{N-3}$-bundle over $\PP^2$. Explicitly, if $[X,Y,Z]$ are homogeneous coordinates on $\PP^2$, and $\{a_{i,j,k} \mid i+j+k = d \}$ are homogeneous coordinates on $\PP^N$, then the universal curve 
$$
\CC := \left\{ (C, p) \in \PP^N \times \PP^2 \mid p \in C \right\}
$$
is given as the zero locus of the single bihomogenous polynomial of bidegree $(1, d)$
$$
F([a_{i,j,k}], [X,Y,Z] ) = \sum a_{i,j,k} X^iY^jZ^k;
$$
and the universal singular point is the common zero locus of the three partial derivatives $\partial F/\partial X$, $\partial F/\partial Y$ and  $\partial F/\partial Z$. 

The set of forms $F$ define curves singular at a given point is defined by 3 independent linear conditions, and since the set of 
points is 2-dimensional, $\Delta$ has dimension $N-1$.
\end{proof}
 
We next compute the differential of the map $\pi : \Phi \to \PP^N$:

\begin{lemma}\label{tangent space to discriminant}
Let $C \subset \PP^2$ be a plane curve of degree $d$, regarded as a point in $\PP^N$,  having a node at a point $p$. The differential 
$$
d\pi : T_{(C,p)}\Phi \to T_C \PP^N
$$
is injective, with image the hyperplane $H_p \subset \PP^N$ of plane curves containing the point $p$.
\end{lemma}

Thus, if $p$ is the only singularity of $C$, then $\Delta$ is smooth at $C$; and more generally the image of a small analytic neighborhood of $(C,p) \in \Phi$ is smooth, and we can identify its tangent space at $p$ with the hyperplane $H_p$. 

\begin{proof}
We will prove this using affine coordinates on $\PP^2$ and $\PP^N$. Changing coordinates if necessary, we may assume that the point $[1,0,0] \notin C$, and that the point $p$ is $[0,0,1]$. let $x = X/Z$ and $y = Y/Z$ be coordinates on the affine plane $Z \neq 0$ and write the polynomial $F(x,y,1)$ above as
$$
f(x,y) = \sum_{i+j \leq d} a_{i,j} x^iy^j
$$
with $a_{d,0}$ normalized to 1. 

Let $g,h$ be the two partial derivatives of $f$, that is:
$$
g(x,y) := \binom{\partial f}{\partial x} = \sum_{i+j \leq d} i a_{i,j} x^{i-1}y^j
$$
and
$$
h(x,y) := \binom{\partial f}{\partial y} = \sum_{i+j \leq d} j a_{i,j} ix^{i}y^{j-1}.
$$
The functions $f, g$ and $h$ are local defining equations for $\Phi$; we consider their partial derivatives with respect to $x, y$ and $a_{0,0}$, evaluated at the point $(C,p)$, as in in figure~\ref{tang to Delta}.

\begin{table}[h!]\label{tang to Delta}
  \begin{center}
     \begin{tabular}{c|c|c|c} % <-- Alignments: 1st column left, 2nd middle and 3rd right, with vertical lines in between
            & $f$ & $g$ & $h$ \\
      \hline
$\frac{\partial}{\partial x}$ & 0 & $a_{2,0}$ & $a_{1,1}$ \\
$\frac{\partial}{\partial y}$ & 0 & $a_{1,1}$ & $a_{0,2}$ \\
$\frac{\partial}{\partial a_{0,0}}$ & 1 & 0 & 0 
    \end{tabular}
  \end{center}
\end{table}

The point $p$ is a node of $C$ (and not a more complicated singularity) if and only if the upper right $2 \times 2$ submatrix is nonsingular, which shows that the differential $d\pi$ is injective, and its image is the hyperplane $a_{0,0} = 0$ in $\PP^N$, which is exactly the hyperplane of curves containing $p$.
\end{proof}

\begin{corollary}\label{local geometry of Severi}
If $C$ is a nodal curve of degree $d$ with geometric genus $g = \binom{d-1}{2}-g$, then in a neighborhood of $C\in \PP^N$
the discriminant hypersurface consists of $\delta$ smooth sheets, meeting transversely. Thus in a neighborhood  $C \in \PP^N$ 
the variety $\overline V_{d,g}$ is the union of $\binom{\delta}{\delta'}$ smooth branches, each of dimension $N - \delta'$, corresponding bijectively with subsets of $\{p_1,\dots,p_\delta\}$ of cardinality $\delta'$.
\end{corollary}
\begin{proof}
Lemma~\ref{tangent space to discriminant} shows that in an analytic neighborhood of $C\in \PP^N$ the discriminant hypersurface $\Delta$ will consist of $\delta$ smooth sheets, each corresponding to one node, and Lemma~\ref{adjoint independent} implies that the tangent spaces to these sheets are linearly independent. 
\end{proof}


\begin{corollary}\label{dim Severi}
The small Severi variety $V_{d,g}$ has pure dimension $N - \delta$, where $\delta = \binom{d-1}{2} - g$.
\end{corollary}

\fix{for the following to make sense, we have to include curves of geometric genus $g$ --- the Hilbert scheme doesn't include these.}
\fix{ expand this to follow the deriviation :curve plus line bundle with enough sections plus basis} 
In Section~\ref{estimating dim hilb}, we give a heuristic calculation of the ``expected dimension'' $h(d,g,r)$ of the variety parametrizing curves of degree $d$ and genus $g$ in $\PP^r$
$$
h(g,r,d) := 4g-3 + (r+1)(d-g+1) - 1.
$$
The actual dimension of the restricted Hilbert scheme may be quite different. But  Corollary~\ref{dim Severi} shows that in case $r=2$ (as in the case of $r=1$), \emph{the actual dimension is always the expected}.

Corollary~\ref{local geometry of Severi} has an important consequence that we use in Chapter~\ref{InflectionsChapter}: the existence of a families of smooth curves of genus $g$ specializing to a $g$-nodal rational curve. 

%In fact, such families are already explicit in Lemma~\ref{local geometry of Severi}: if we start with a rational nodal  curve $C_0 \subset \PP^2$---for example, the general projection of a rational normal curve $\PP^1 \hookrightarrow \PP^d$ to $\PP^2$---the lemma says that we can find a family of nodal curves $C_t$ of geometric genus $g$ specializing to $C_0$, in which the  $\delta = \binom{d-1}{2} - g$ nodes of $C_t$ specialize to a subset of $\delta$ of the nodes of $C_0$. Taking the normalization of the total space of this family yields a family of smooth curves of genus $g$ specializing to a $g$-nodal rational curve, as desired. \fix{watch out! the normalization of a flat family
%is not always the normalization of each fiber! -- eg there are normal surfaces with both smooth and singular fibers.}
%
%To carry this out in detail, let us first state precisely the lemma we seek to establish:

\begin{corollary}\label{smoothing nodes}
Let $p_1, \dots, p_g, q_1, \dots, q_g \in \PP^1$ be any $2g$ distinct points, and let $C := \PP^1/p_i \sim q_i$ be the nodal curve of arithmetic genus $g$ obtained by identifying $p_i$ with $q_i$ for $i = 1,\dots,g$. There exists a family $\cC \to  \Delta $ of curves, parametrized by the disc $\Delta$, with $C_t$ a smooth projective curve of genus $g$ for all $t \neq 0$ and $C_0 = C$ as above.
\end{corollary}

\begin{proof}
Let's start by realizing the curve $C_0$ in projective space. This is straightforward: to begin, choose a degree $d > 2g+2$, and embed $\PP^1$ as a rational normal curve in $\PP^d$ via the Veronese map. Let $L_i = \overline{p_i,q_i} \subset \PP^d$ be the line spanned by $p_i$ and $q_i$, and let $\Lambda \cong \PP^{g-1} \subset \PP^d$ be the $(g-1)$-plane spanned by a general point on each of these
lines.
Let $\pi_\Lambda : \PP^d \to \PP^{d-g}$ be the projection with center $\Lambda$, and let $C \subset \PP^{d-g}$ be the image of our rational normal curve. We claim that the curve $C$ has degree $d$; that  $C$ has ordinary nodes at the points corresponding to the pairs $p_i,q_i$; and that $C$ has no other singularities.

Thus we have to check that
\begin{enumerate}
\item $\Lambda$ is disjoint from the rational normal curve, so that the map $\pi_\Lambda$ is regular on $\PP^1$;
\item $\Lambda$ does not meet any secant or tangent lines to $\PP^1$ other than the $L_i$, so that the map $\pi_\Lambda$ is an isomorphism away from the points $p_i, q_i$; and
\item for each $i$, the 3-plane $\overline{2p_i + 2q_i}$ spanned by the tangent lines to $\PP^1$ at $p_i$ and $q_i$ meets $\Lambda$ in only one point (the point of intersection of $\Lambda$ with $L_i$), so that the common image point $\pi_\Lambda(p_i) = \pi_\Lambda(q_i) \in C$ is indeed a node of $C$.
\end{enumerate}

Each of these assertions can be verified by a  dimension count. Denote by $\Sigma_{d-g}(L_i) \subset \GG(g-1, d)$ the Schubert cycle of $(g-1)$-planes in $\PP^d$ meeting $L_i$. The cycles $\Sigma_{d-g}(L_i)$ have codimension $d-g$ in $\GG(g-1,d)$. By Proposition~\ref{independence on rnc} the lines $L_i$ are linearly independent , the Schubert cycles intersect properly in a subvariety
$$
X := \bigcap_{i=1}^g \Sigma_{d-g}(L_i) \subset \GG(g-1,d)
$$
of dimension $g(d-g+1) - g(d-g) = g$. (Thus a $(g-1)$-plane $\Lambda \in X$ is determined by its points of intersection with the $L_i$.) Since $\Lambda$ corresponds to a general point of $X$, we 
 have to show that the locus of $(g-1)$-planes violating each of the conditions above has strictly smaller dimension; we leave these verifications as Exercise~\ref{} below.

Next, we project again: we take $\Gamma \cong \PP^{d-g-3} \subset \PP^{d-g}$ a general $(d-g-3)$-plane, and consider the projection $\pi_\Gamma : C \to \PP^2$. We claim that this map is regular and birational onto a rational nodal plane curve $C_0$, so that $C_0$ has $\binom{d-1}{2}$ nodes $r_1,\dots,r_{\binom{d-1}{2}}$, of which $r_1,\dots,r_g$ are the images of the nodes of $C$. Again, this requires a series of verifications: we have to show that the locus of planes $\Gamma \cong \PP^{d-g-3} \subset \PP^{d-g}$ for which each part of the statement fails has dimension strictly less than $\dim \GG(d-g-3, d-g) = 3(d-g-2)$; again, we leave this as an exercise.

Finally, given all this, Lemma~\ref{local geometry of Severi} implies that we can find an arc $\{C_t\}$ in the Severi variety $\overline V_{d,g}$ whose general member has $\binom{d-1}{2} - g$ nodes and whose special member $C_0$ is the curve we've just constructed, with the $\binom{d-1}{2} - g$ nodes of $C_t$ specializing to the nodes $r_{g+1}, \dots r_{\binom{d-1}{2}} \in C_0$.

 Taking the normalization of the total space of this family yields a family of smooth curves of genus $g$ specializing to a $g$-nodal rational curve, as desired. \fix{this NEEDS a proof. the normalization of a flat family
is not always the normalization of each fiber! In this case the general fiber gets normalized, but not the new nodes in the
special fiber.}
\end{proof}


\input{footer}