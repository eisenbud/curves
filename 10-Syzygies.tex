\input{header}

\chapter{Syzygies}
\label{SyzygiesChapter}


%$$
%\vbox{\offinterlineskip %\baselineskip=15pt
%\halign{\strut\hfil# \ \vrule\quad&# \ &# \ &# \ &# \ &# \ &# \ 
%&# \ &# \ &# \ &# \ &# \ 
%\cr
%degree&\cr
%\noalign {\hrule}
%0&1&--&--&--&--&--&--\cr
%1&--&17&46&45&4&--&--\cr
%2&--&--&--&--&25&18&4\cr
%\noalign{\bigskip}
%\omit&\multispan{8}{\bf Conjectural shape of $F_\bullet$}\cr
%\noalign{\smallskip}
%}}
%$$
%
%
%
%
%\centerline{\scriptsize
%\begin{tabular}{r|ccc} 
%$j\backslash i$&0&1&2\\ 
%\hline 
%0&1&$-$&$-$\\ 
%1&$-$&3&2\\ 
%\end{tabular}}
%
%
%$$
%\begin{matrix} 
%j\backslash i&\vline&0   &  1    & \cdots & n    \cr\hline
%\vdots&\vline&\vdots&\vdots & \cdots    &\vdots     \cr 
%       0&\vline&\beta_{0,0}&\beta_{1,1}&\cdots&\beta_{n,n}\cr
%       1&\vline&\beta_{0,1}&\beta_{1,2}&\cdots&\beta_{n,n+1}\cr
%\vdots&\vline&\vdots&\vdots & \cdots    &\vdots     \cr 
%\end{matrix}
%$$         
%
%
\section{Introduction} 
%Motivation: canonical embedding turns intrinsic invariants into projective invariants. Hilbert Function. Projective Normality; Canonical Module.
%
%What are the projective invariants that correspond to Clifford index? Conjecturally, Green's conjecture. Inequality from Eagon-Northcott.
%
%Hilbert Syzygy theorem, Hilbert function derivation, Unique minimal resolution, Betti table, 
%\fix{ introduce tools as they are used}

In this Chapter we will study  invariants associated to a free resolution, or syzygies, of the homogeneous coordinate ring of a curve in projective space, with an emphasis on their relation to the varieties (or schemes) containing the curve. We have two cases in mind:

For curves in $\PP^{3}$ we ask about the relationship of a curve to the 1-dimensional complete intersections containing it---this is the theory of \emph{linkage} (often called by its French name \emph{liaison}). The theory leads quickly away from smooth curves to other purely 1-dimensional subschemes of $\PP^{3}$, and to the canonical (or dualizing) sheaves of these schemes, so we will spend some time on the general theory of dualizing sheaves.

Questions about abstract curves can be turned into questions about embedded curves via the canonical embedding. Here the existence of a low-degree linear series on a curve implies the existence of a rational normal scroll containing the canonical image of the curve, and this implies something about the syzygies of that embedded curve. Green's conjecture is roughly the converse of this chain of implications. Here the main tool is the Eagon-Northcott complex, which makes explicit the syzygies of rational normal scrolls. 

\section{Syzygies and free resolutions} 
\fix{start from regular local rings, free res; do CM as a weakening of reg loc ring is a domain,
 max ideal is a reg seq; Do Gor via a weakening of Ext vanishing. The say what's different in the graded cases.
 OR: retitle this section ``homological theory''. 
 subsect: Syzygies and free resDo free res in local, graded cases. 
 subsect: Regular, CM, Gor.
 Somewhere regular sequences}

We begin by reviewing some of the basic facts from homological commutative ring theory. Regular local rings and free resolutions; Cohen-Macaulay rings; and Gorenstein rings. 

All rings will be Noetherian. Let $R$ be a local ring with maximal ideal $\gm$ and residue field $R/\gm = k$ (sometimes we simply say: ``Let $(R,\gm,k)$ be a local ring.'') We denote by $\dim R$ the \emph{Krull dimension} of $R$; that is, the maximum length of a chain of prime ideals in $R$.

\subsection{Regular local rings and syzygies}
Note that, by the Principal Ideal Theorem \cite[]{E}, the maximal ideal $\gm$ cannot be generated by  $<\dim R$ elements.

\begin{definition}
 We say that $R$ is \emph{regular} if $\gm$ can be generated by $\dim R$ elements.
\end{definition}

This deceptively simple property was first identified as important by Krull, and later recognized by Zariski as the appropriate algebra expression of nonsingularity: A point $p$ on a scheme $X$ is nonsingular if and only if the local ring $R = \sO_{X,p}$ is \emph{regular}.It has many surprising consequences. We prove a simple one by way of example:

\begin{proposition}
 If $R$ is regular local ring is an integral domain; that is, 0 is a prime ideal.
\end{proposition}
\begin{proof}
 We do induction on the dimension. If $\dim R = 0$ then by definition $\gm$ is generated by 0 elements, so $R = k$,
 a field. If $\dim R>0$ then by the prime avoidance theorem \cite[]{E} there is an element $x$ not contained in trhe union of $\gm^{2}$ and the minimal primes of $R$. By the Principal Ideal Theorem, $R/(x)$ has dimension $\dim R -1$ and the maximal ideal $\gm/(x)$ has $\dim R-1$ generators, so $R/(x)$ is again regular.
 
 By induction, $(x)$ is a prime ideal of $R$ that is not a minimal prime. If $Q$ is a minimal prime contained in $(x)$,
 then $q\in Q$ implies $q = q'x$ for some $q'\in R$, and since $Q$ is prime, we have $q'\in Q$. Thus
 $Q = Qx$, and it follows from Nakayama's Lemma that $Q=0$, so $R$ is a domain.
\end{proof}

\begin{corollary}
 Let $R$ be a regular local ring of dimension $d$. If$x_{1}, \dots, x_{d}$  generate $\gm$, then 
 $x_{i+1}$ is a nonzerodivisor modulo $(x_{1}, \dots, x_{i})$ for every $i = 1,\dots, n$
\end{corollary}
\begin{proof}
 Obvious, since $R/(x_{1},\dots, x_{i})$ is again regular, and thus a domain, and $x_{i+1}\notin (x_{1},\dots,x_{i})$.
\end{proof}
We say that a sequence of elements satisfying the condition of the Corollary is a \emph{regular sequence}.

The theory of regular local rings came into its own with the work of Auslander, Buchsbaum and Serre, who gave regularity a homological interpretation. Recall
that if $M$ is a finitely generated $R$-module, then an \emph{$R$-free resolution} of $M$ is a sequence of free modules and maps
$$
\FF:\qquad F_{0} \lTo^{d_{1}} F_{1}\lTo^{d_{2}} F_{2}\cdots,
$$
an \emph{augmentation} map $F_{0} \rOnto^{d_{0}} M$ such that the kernel of $d_{i}$ is equal to the image of $d_{i+1}$ for every $i$. We say that the resolution is \emph{finite of length $n$} if $F_{n+1}= 0$ but $F_{n}\neq 0$.The resolution is called \emph{minimal} if the $d_{i}(F_{i}) \subset \gm F_{i-1}$ for all $i$; it follows from Nakayama's Lemma that this is the case if and only if the rank of $F_{i}$ is equal to the minimal
number of generates of $\ker d_{i-1}$ for all $i$. 

The minimal resolution of a module is a direct summand of any resolution; and it follows that any two minimal resolutions of a module are isomorphic~\cite[Theorem ***]{E}. 

\begin{example}
 The Koszul complex \fix{ add here. do 2 elements first}.
\end{example}

Here is the homological characterization of regularity:

%\begin{theorem}(Auslander, Buchsbaum, Serre \cite{}
% A local ring $R$ is regular if and only if the following equivalent statements hold:
% 
% every finitely generated $R$-module has an $R$-free resolution of finite length; and indeed of length $\leq \dim R$.
%\end{theorem}

\begin{theorem}[Auslander, Buchsbaum, Serre \cite{}]
The following conditions on an $n$-dimensional local Noetherian ring $R$ with residue field $k$ are equivalent:
\begin{enumerate}
 \item $R$ is regular.
\item Every finitely generated $R$-module has a finite free resolution.
\item Every finitely generated $R$-module has a  free resolution of length at most $d$.
\item The Koszul complex of a set of generators of $\gm$ is the free resolution of  $k$.
\item $\Ext^{i}(k,M) = 0$ for all $i>n$ and all finitely generated modules $M$.
\end{enumerate}
\end{theorem}


The reader may one implication of this result as a vast extension of Hilbert's Syzygy Theorem, which says every module over a positively graded polynomial ring $S = k[x_1,\dots,x_{d}]$ over a field $k$ has a free resolution of length $\leq d$. The result enabled the proof of long-standing conjectures:
\begin{theorem} \cite{AB} If $R$ is a regular local ring then:
\begin{itemize}
 \item Every localization of $R$ at a prime ideal is again a regular local ring
  \item  $R$ is a unique factorization  domain
\end{itemize}
 \end{theorem}

\subsection{Cohen-Macaulay rings and regular sequences}

\subsection{Gorenstein rings and duality}
A related condition is important for the study of linkage in the Chapter~\ref{}, and duality in Chapter~\ref{}:

\begin{theorem}
 An $n$-dimensional local Noetherian ring $R$ with residue field $k$ is said to be Gorenstein if  the following
 equivalent conditions are satisfied:
\begin{enumerate}
  \item $\Ext^{i}(M,R) = 0$ for all $i>n$ and all finitely generated modules $M$.
  \item $\Ext^{i+1}(k,R) = 0$. 
\end{enumerate}  
  \qed
\end{theorem}



$S = S_{0} \oplus S_{1}\oplus\cdots$ be a local or a positively graded ring with $S_{0}$ a field,
 and let $M$ be a finitely generated graded $S$-module. An  \emph{$S$-free resolution} of $M$ is a sequence of graded free $R$ modules $F_{i}$ and homogeneous degree 0 maps $d_{i}$ of the form
$$
\FF:\qquad F_{0}:=\oplus_{j}R(-j)^{\beta_{0,j}} \lTo^{d_{1}} F_{1}:=\oplus_{j}R(-j)^{\beta_{0,j}}\lTo^{d_{2}} F_{2}\cdots,
$$
where $R(-j)$ denotes the rank one free $R$-module with generator in degree $j$ (so that 
$R(-j)_{k} = R_{k-j}$), 
and an \emph{augmentation} map $F_{0} \rOnto^{d_{0}} M$ such that the kernel of $d_{i}$ is equal to the image of $d_{i+1}$ for every $i$. 

The resolution $\FF$ is \emph{minimal} if every entry of matrices representing the $d_{i}$ (for $i>0$ is of strictly positive degree. A minimal free resolution of $M$ can be constructed inductively by first choosing a minimal set of homogeneous generators of $M$, determining the map $d_{0}$, then choosing a minimal set of generators of $\ker d_{0}$, determining a map
$F_{1} \rOnto \ker d_{0} \subset F_{0}$, and so on. The image of $F_{i}$ in $F_{i-1}$ is called the $i$-th syzygy module of $M$. A syzygy of a set of elements 
$e_{1}, \dots, e_{s}$ of an $R$-module is a linear relation over $R$; that is, a sequence of elements
$r_{1},\dots, r_{s}$ such that $\sum_{i}r_{i}e_{i} = 0$. The set of all syzygies is thus a submodule of the free module on $s$ generators. Thus the minimal free resolution of $M$ is a way of
packaging a minimal set of  generators of the module of syzygies of the generators of $M$; then szygyies of the generators of the syzygy module; etc.

\begin{example}\label{canonical in P3}
The minimal free resolution of the homogeneous coordinate ring $S_{C}$ of a canonical curve $C$ of genus 4 in $\PP^{3}$ whose ideal is generated by a quadric $q$ and a cubic $f$, as a module over the homogeneous coordinate ring $S = \CC[x_{0},\dots,x_{3}]$ of $\PP^{3}$, has the form
\small
$$
S \lTo^{
\begin{pmatrix}
  q& f
\end{pmatrix}}
S(-2) \oplus S(-3) \lTo^{
\begin{pmatrix}
f\\-q 
\end{pmatrix}
}
S(-5)\lTo 0.
$$
\normalsize
The reason that this sequence, called the Koszul complex of $(q,f)$, is exact, is that
$q$ and $f$ are relatively prime, so that the only multiples of $q$ that are multiples of $f$ are actually multiples of $qf$. 
\end{example}
The following result assures us that invariants of the minimal free resolution of $M$ are invariants of $M$:

\begin{theorem}[Uniqueness]\cite[Theorem ***]{E}\label{uniqueness} With hypotheses as above, the minimal free resolution of of a finitely generated graded is unique up to (non-unique) isomorphism.
\end{theorem}

This and the other results in this section are usually stated for
modules over a local ring, and in that form the results here can be found in \cite[Ch ?]{E}. The proofs are essentially identical in the graded case presented here.

The numbers $\beta_{i,j}$ in  the minimal free resolution of $M$ are called the \emph{graded Betti numbers} of $M$; it follows from Theorem~\ref{uniqueness} that the graded Betti numbers, and all the invariants of the matrices $d_{i}$, are invariants of $M$. 
We sometimes refer to $\beta_{i,j}$ informally as the \emph{number of $i$-th syzygies of degree $j$}; more properly, it is the number of minimal generators of degree $j$ required by the module of $i$-th syzygies of $M$.

For convenience, the graded Betti numbers are usually displayed in a compact \emph{Betti table}, with the nonzero $\beta_{i,j}$ appearing in the $i$ column and the $(j-i)$-th row. (The reason for the initially non-intuitive choice $j-i$ instead of $j$ is that, for the resolution $\FF$ to be minimal, it is necessary that if $\beta_{i,j}\neq 0$, then some $\beta_{i-1,k}\neq 0$ for some $k<j$. Thus shift by $-j$ makes the diagram more compact.)

We sometimes speak of the \emph{Betti table of a variety $X\subset \PP^{n}$}, by which we will mean the Betti table of the minimal free resolution
of the homogeneous coordinate ring $S_{X}$ of $X$, as a module over the homogeneous coordinate ring of $\PP^{n}.$

For example, the canonical curve in $\PP^{3}$ discussed in Example~\ref{canonical in P3} has Betti table:

\centerline{\small %\scriptsize
\begin{tabular}{r|ccc} 
$j\backslash i$&0&1&2\\ 
\hline 
0&1&$-$&$-$\\ 
1&$-$&1&$-$\\ 
2&$-$&1&$-$\\ 
3&$-$&$-$&1\\ 
\end{tabular}}
\noindent where, for clarity, we have suppressed the $\beta_{i,j}$ that are 0, and replaced some of
them with $-$.

From now on in this section, we let $S = \CC[x_{0},\dots, x_{n}]$ be the homogeneous coordinate ring of $\PP^{n}$, and we consider only free resolutions of finitely generated graded $S$-modules. In this case something quite special happens \cite[****]{E}:

\begin{theorem}[Hilbert's Syzygy Theorem]\label{hst}
The minimal $S$-free resolution $\FF$ of any finitely generated graded $S$-module $M$ is finite: in fact, $F_{i}=0$ for all $i>n+1$.
\end{theorem}

\begin{fact}
 There are in fact finite resolutions for all $S$-modules; however there is generally no reasonable notion of a  minimal resolution outside the positively graded or finitely generated local cases. See \cite{???}.
\end{fact}

 In particular since we know the Hilbert function of $S$, and thus of $S(-j)$,
$$
H_{S(-j)}(m) = 
\begin{cases}
 {n+m-j \choose n} & \hbox{for $t\geq 0$}
  \\ 
 0 & \hbox{for $t<0$}
\end{cases}
$$
we can compute the Hilbert function for a finitely generated graded $S$-module $M$ from its graded Betti numbers 
$$
H_{M}(m) = \sum_{i,j} (-1)^{i}\beta_{i,j}{n+m-j\choose n}.
$$
\begin{example} [The homogeneous coordinate ring of a plane curve] 
For the simplest non-trivial example, if $C$ is a plane curve with equation $F(x_{0},x_{1}x_{2})$ of 
degree $d$, then the minimal free resolution of the homogeneous coordinate ring $S_{C}$ has the form
$$
\FF: S\lTo^{F}S(-d)\lTo 0
$$
Thus the only nonzero graded Betti numbers of $S_{C}$ as an $S$-module are
 $\beta_{0,0} = \beta_{1,d} = 1$, so
$$
 H_{S_{C}}(m) = {2+m\choose 2} - {2-d+m\choose 2}
 $$
 which has the value  $dm + 1+(2-d)(2-d-1)/2 = dtm+ (d-1)(d-2)/2 +1$. Since the degree is the leading coefficient and the arithmetic genus is the constant term minus 1, we get
$\deg C = d,\ p_{a}(C) = (d-1)(d-2)/2$ as we should expect.  Note that this method of computation is not sensitive at all to whether the curve is smooth and irreducible; it works for any divisor in $\PP^{2}$.
\end{example}

\begin{exercise} 
\begin{enumerate}
 \item Show that any curve in $\PP^{3}$ whose homogeneous coordinate ring has the
 form given in Example ~\ref{canonical in P3} has degree 6 and (arithmetic) genus 4.
 
\item In Section **** we computed the genus of a smooth complete intersection curve inductively, by using the adjunction formula for curves on a smooth surface along with Bertini's Theorem.
Show that the same formula gives the arithmetic genus of an arbitrary 1-dimensional complete intersection $C$ hypersurfaces 
$X_{i} := \{F_{i} = 0\}$ of degrees $d_{i}$,
using the fact that the minimal free resolution of the homogeneous coordinate ring 
$S/(F_{1}, \dots, F_{n-1})$ of $C$  is the Koszul complex (see \cite{???}):
%\scriptsize
\small
$$
 S \lTo \oplus_{1\leq i<n}S(-d_{j}) \lTo  \oplus_{1\leq j<k<n}S(-d_{j}-d_{k}) \cdots S(-\sum_{1\leq j<n}d_{j})\lTo 0.
 $$
\normalsize
\end{enumerate}
\end{exercise}

Computing the Hilbert function was the application for which Hilbert proved the Syzygy Theorem; but if that were the only use of free resolutions, we would not be introducing it here. A more interesting feature that the Betti table of the homogeneous coordinate ring (or homogeneous ideal) of a variety $X$ reflects is the presence of a variety $Y$ containing 
$X$ and having low degree syzygies. 

Green's conjecture, which we shall meet below, is a sophisticated (potential) application of this principle. Here is a much simpler version:

We have seen in Chapter~\ref{Scrolls}, the homogeneous ideal $I$ of the twisted cubic curve in $\PP^{3}$ is generated by the three $2\times 2$ minors of the matrix
$$
M = \begin{pmatrix}
 x_{0}&x_{1}&x_{2}\\
  x_{1}&x_{2}&x_{3}
\end{pmatrix}
$$
We shall soon compute the Betti tables of all rational normal scrolls. In particular, we shall see that the Betti table of the twisted cubic has the form:

\centerline{\small
\begin{tabular}{r|ccc} 
$j\backslash i$&0&1&2\\ 
\hline 
0&1&$-$&$-$\\ 
1&$-$&3&2\\ 
\end{tabular}}
\noindent
where the dashes indicate that the corresponding $\beta_{i,j}$ is zero. In plain language, the table indicates  that  the ideal $I$ of the curve is minimally generated by 3 elements of degree 2, and that there are two linear relations on the 3 (that is, generators of total degree $2+1=3$, and that these freely generate the module of  syzygies of $I$ (the two relations are in fact just the columns of the transpose of the matrix $M$).

The homogeneous ideal $J$ of any set of points $\Gamma$ that lies on this curve contains $I$, and the 2 linear relations on the generators of $I$ must be consequences of relations on the generators of $J$. But since the relations on $I$ are linear, they are of the lowest possible degree of any relations on $J$, so there must be at least 2 relations on the generators of $J$. Here is the way this can be used:
\begin{fact}
 A lemma of Castelnuovo shows  that every set of 6 points in linearly general position
in $\PP^{3}$ lies on a twisted cubic;  a set of points $\Gamma\subset \PP^{3}$ in linearly general position of cardinality $n\geq 7$ lies on a twisted cubic curve if and only if
the Betti table of $\Gamma$ is termwise $\geq$ that of the twisted cubic. \fix{is Castelnuovo's Lemma proven somewhere in this book? should we convert this from a fact to a proposition? Else refer to ``Geometry of Syzygies''.}
\end{fact}

\subsection{Projective dimension}
The first new invariant that we can read from the minimal $S$-free resolution of a module $M$ is its length; that is, the number of nonzero maps, which is finite by the Syzygy Theorem. This is called the \emph{projective dimension} of $M$ as an $S$-module, written $pd_{S}M$. An older name, in some ways more suitable, was \emph{homological codimension}; this is justified by the following results:

\begin{proposition}\label{pd lower bound}
If $M$ is a graded $S$-module then $\pd(M)$ is at least the codimension of the support of $M$.
\end{proposition}

In case $\pd(M)$ is equal to the codimension of the support of $M$, we say that $M$ is a
Cohen-Macaulay $S$-module, or equivalently that the sheaf $\widetilde M$ is 
\emph{arithmetically Cohen-Macaulay}. When $M = S_{X}$, the homogeneous coordinate ring of a projective scheme $X$, we say that $X$ is itself is arithmetically Cohen-Macaulay. From the examples above we see that plane curves, and also the twisted cubic, are Cohen-Macaulay.

By Proposition~\ref{pd lower bound}, if $C\subset \PP^{n}$ is 1-dimensional, then the projective dimension of $S_{C}$ is at least $n-1$. But we can be much more precise. Recall that a curve $C\subset \PP^{n}$ is said to be \emph{projectively normal} if the homogeneous coordinate ring of $C$ is integrally closed (which implies, in particular, that $C$ is smooth).

\begin{theorem}
 Let $C\subset \PP^{n}$ be a purely 1-dimensional subscheme. The projective dimension of the homogeneous coordinate ring $S_{C}$ of $C$  is
$$
 pd_{S}S_{C} = 
\begin{cases}
n-1 &\hbox{if $H^{1}(\sI_{C}(t)) = 0$ for all $t\in \ZZ$}\\
n &\hbox{otherwise}.
\end{cases}.
$$
Thus in the first case $S_{C}$ is Cohen-Macaulay. In particular, if $C$ is a smooth curve, the $pd_{S}(S_{C}) = n-1$ if and only if $C$ is projectively normal. \fix{we used Serre's Criterion. Ref?}
\end{theorem}

Here is a version that gives a measure of how far $S_C$ is  from being Cohen-Macaulay:

\begin{theorem}
Let $C\subset \PP^{n}$ be a purely 1-dimensional subscheme, and let  
$$
\FF: F_{0}\lTo^{d_{1}} F_{1}\lTo^{d_{2}} F_{2}\lTo \cdots \lTo F_{n-1}\lTo {d_{n}}F_{n}\lTo F_{n+1} \lTo 0
$$
be the minimal $S$-free resolution of the homogeneous coordinate ring of $C$. We have $F_{n+1}=0$, and 
$$
\oplus_{t\in \ZZ} (H^{1}\sI_{C}(t)) = \Hom_{\CC}(\Ext^{n}(S_{C}, S(-n-1)),\CC)
$$ 
which is sometimes called the \emph{Rao module} of $C$. Thus, up to a shift in grading,
the Rao module of $C$ is the vector space dual of the cokernel of the dual $d_{n}^{*}: F_{n-1}^{*}\to F_{n}$. This is a graded module of finite length.
\end{theorem}


\fix{it's not clear how much of the material here to prove; or, if we do prove it, whether we should introduce the general machinery of depth and admit that local cohomology makes the statements look cleaner. The rest of this section is a possible start on this...}

A famous result of Auslander and Buchsbaum clarifies the meaning of projective dimension. We define the 
\emph{depth} of $M$ to be the maximum length $\ell$ of a \emph{regular sequence on $M$}; that is, a sequence $G_{1},\dots,G_{\ell}$ of homogeneous forms of strictly positive degree such that 
\begin{align*}
G_{1} &\hbox{ is a nonzerodivisor on } M;\\
G_{2} &\hbox{ is a nonzerodivisor on } M/G_{1}M;\\
\vdots&\phantom{\hbox{ is a nonzerodivisor on } }\vdots\\
G_{\ell} &\hbox{ is a nonzerodivisor on } M/(G_{1},\dots,G_{\ell-1})M.
\end{align*}

\begin{theorem}
If $M$ is a finitely generated graded module over the polynomial ring $S := \CC[x_{0},\dots,x_{n}]$, and $M$ has depth $\ell$, then the projective dimension of $M$ is $n+1-\ell$.
\end{theorem}

Though this is not obvious from the definition, all maximal regular sequences on $M$ have the same length, and if the depth of $M$ is $\ell$ then a sequence of general linear forms of length $\ell$ is a regular sequence. This makes the depth easier to compute. Even better, the depth has an interpretation in terms of sheaf cohomology:
 
\begin{theorem} Suppose that $X\subset \PP^{n}$ is a  subscheme without 0-dimensional (isolated or embedded) components. The module $M = \oplus_{t\in \ZZ}H^{0}(\cO_{X}(t))$
is finitely generated, and $\depth M$ is the largest integer $\ell$ such that 
$H^{i}(\cO_{X}(t)) = 0$ for all $0<i<ell-1$ and all $t$.
\end{theorem}

\section{Liaison of curves in $\PP^3$.}
%Rao module, Hartshorne-Rao theorem. Resolution of the rational quartic.

One way in which syzygies are useful is in understanding \emph{linkage}. We  give the definition in the case of curves in $\PP^{3}$, where the idea is most useful. See~\cite{PeskineSzpiro} for the general situation.

\begin{definition}
If $I$ and $J$ are unmixed ideals of codimension $2$ in $\PP^{3}$ then $I$ and $J$ are \emph{directly linked} if there exists a homogeneous complete intersection $G \subset I\cap J$ such that $I = G:J$. We define \emph{linkage} to be the equivalence relation generated by direct linkage. We say that two ideals are \emph{evenly} linked if they are
connected by an even number of direct linkages, and similarly for \emph{oddly linked}.
\end{definition}

We first note that direct linkage is a symmetric relation on unmixed ideals of codimension 2:
\begin{lemma}
 If $G$ is a complete intersection of codimension 2, and $I$ is an ideal of codimension 2 containing $G$, then $G:(G:I)$ is the unmixed part of $I$. In particular, if $I$ is unmixed and $J = G:I$, then $I = G:J$, so each of $I$ and $J$ is directly linked, via $G$, to the other.
\end{lemma}

\begin{proof} \fix{this is the wrong beginnng. Localize at a prime of $G$, 
prove that a RLR mod a regular sequence has appropriately vanishing exts by induction?}

 We first prove that $G:I$ is unmixed. Since $G$ is a complete intersection, it is unmixed; that is,  there are prime ideals 
 $P_{j}$ of codimension 2, and $P_{j}$-primary ideals $Q_{j}$, such that 
 $
 G = \bigcap_{j}Q_{j}.
 $
For any ideal $I$ we have $G:I = \bigcap (Q_{j}:I)$, so it suffices to show that $J_{j}:= Q_{j}:I$
is either the unit ideal (if $I=Q_{j}$) or else is $P_{j}$-primary; that is, to show that $xy\in J_{j}$ but $x\not \in J_{j}$ implies $y\in P_{j}$. However, if $x\not \in J_{j}$ then
$xI$ contains an element $xy'\not\in Q_{j}$, and of course $xy'y\in Q_{j}$, so $y\in P_{j}$ as claimed. 

Thus $J = G:I$ has a (possibly redundant) primary decomposition 
$\bigcap_{j=1}^{s} (Q_{j}:I)$. By the same argument, $G:(G:I) = \bigcap_{j} Q_{j}:(Q_{j}:I)$.

A codimension 2 prime ideal associated to $I$ is one of the 
ideals $P_{j}$. Thus after re-indexing we may write $I = \bigcap_{j=1}^{t} Q'_{j}$, where
$Q'_{j}$ is $P_{j}$ primary and $t\leq s$.

\end{proof}
\begin{fact} We say that curves $C,C'\subset \PP^{3}$ are ``connected by a linkage'' if $C\cup C'$
is a complete intersection.
 The Hartshorne-Rao Theorem \cite{} asserts that 
$C$ and $C'$ can be connected by an even length sequence of linkages if and only if their Rao modules are equal up to a shift; and by an odd length sequence of linkages if and only if their Rao modules differ by a shift and dualization into $\CC$.
\end{fact}


Genus formula by filtration: Suppose that $D$ is a complete intersection of surfaces of degrees $d_1,d_2$, and 
$C\subset D$ is unmixed of dim 1. Define $C'$ by $\cI_{C'} = (\cI_D:\cI_C)$. Prove by unmixedness that 
$\cI_C = (\cI_D:\cI_{C'})$,  and by local duality (?) that 
$$
\omega_{C'} = \cHom_{\cO_D}(\cO_C, \omega_D) = 
\cHom_{\cO_D}(\cO_C, \cO_D(d_1+d_2-4))
=  \frac{(\cI_D:\cI_C)}{\cI_{D}}(d_1+d_2-4).
$$
Thus there is an exact sequence
$$
0\to \omega_{C'}(-d_1-d_2+4) \to \cO_D \to \cO_C \to 0.
$$
Computing Hilbert polynomials via RR gives the genus formula.

Construction of curves with given Rao module: Bourbaki's theorem.

\section {Dualizing sheaves} 

\fix{Put the linkage computation of the dualizing sheaf in here explicitly!}
%%in the text below we used \HH instead of H for cohomology. This is fixed with a macro:
\def\HH{{H}}

Other than  the structure sheaf, the most important line bundle on a smooth curve $C$  is the cotangent line bundle, usually called the canonical line bundle or canonical sheaf $\omega_{C}$, and  we have many times used it's key property, that if  $\cF$  is a line bundle on $C$, then $\HH^{0}(\sF^{-1}\otimes \omega_{C})$ is the vector space dual of $\HH^{1}(\cF)$. Because $\sF$ is locally free, we may rewrite the formula in the attractively symmetric form:
$$
\HH^{0}(\sHom_{C}(\sF, \omega_{C})) 
\cong 
\Hom_{k}(\HH^{1}(\cF), k).
$$

This isomorphism is most familiar in the case where $\cF$ is a line bundle, but
in fact it holds for any coherent sheaf:

\begin{proposition} Let $C$ be a smooth curve.
There are natural isomorphisms
$$
\HH^{0}(\sHom_{C}(\sF, \omega_{C})) 
\cong 
\Hom_{k}(\HH^{1}(\cF), k).
$$
for any coherent sheaf $\cF$ on $C$.
\end{proposition}

\begin{proof}
 Let $\cF'$ be the torsion subsheaf  of $\cF$, a sheaf of finite support. And let
 $\cF'' = \cF/\cF'$.
 Since
$\cF'$ is locally free, the sequence is locally split (in fact it is globally split too, but we don't need this.)

Since $\omega_{C}$ is a line bundle, 
$$
\sHom_{\PP^1}(\sF, \omega_{C}) = 
\sHom_{\PP^1}(\sF', \omega_{C}) \oplus \sHom_{\PP^1}(\sF'', \omega_{C})  = 
\sHom_{\PP^1}(\sF', \omega_{C}) 
$$
and 
$\HH^{1}(\cF) = \HH^{1}(\cF'')
$
because $\HH^{1}(\cF') = 0$, so the duality formula for arbitrary coherent sheaves follows from the case of line bundles.
\end{proof}

We can make a somewhat more explicit version of the isomorphism by
choosing an isomorphism $\eta_{C}: \HH^{1}(\omega_{C})\to k$. 
Since $\HH^{1}(\omega_{C})$ is 1-dimensional, such a nonzero functional $\eta$ is unique up to scalars. When $C$ is smooth over $\CC$, we could take $\eta$ to be the classical residue map of complex analysis.

The map $\eta_{C}$
determines, for every $\sF$ a map
$$
f_{\eta}: \HH^{0}(\sHom_{C}(\sF, \omega_{C}))
\to
\Hom_{k}(\HH^{1}(\cF), k).
$$
sending a homomorphism
$\alpha \in \HH^{0}(\sHom_{C}(\sF, \omega_{C})) = \Hom_{C}(\sF, \omega_{C})$
to $\eta \circ \HH^{1}(\alpha)$ so that, for example, $\eta$ itself corresponds to the 
identity map of $\omega_{C}$  




Another manifestation of these phenomena is a
special case of the Serre duality theorem on $\PP^{r}$, which asserts that  there is an isomorphism $\eta: H^{r}(\omega_{\PP^{r}}) \cong k$, where $\omega_{\PP^{r}} = \cO_{\PP^{r}}(-r-1)$, the top exterior power of the cotangent bundle. Again, there is
a natural map
$$
H^{0}(\cF^{-1}\otimes \omega_{\PP^{r}}) \to \Hom(H^{r}(\cF), k)
$$
Of course $\cF^{-1}\otimes \omega_{\PP^{r}}$ may be rewritten as
$\Hom(\cF, \omega_{\PP^{r}})$, and in the form
$$
\Hom(\cF, \omega_{\PP^{r}}) \to \Hom(H^{r}(\cF), H^{r}(\omega_{\PP^{r}})) 
\rTo^{\eta \circ -} \Hom(H^{r}(\cF), k)
$$
the map is, as before, an isomorphism for every coherent sheaf $\cF$.

Grothendieck extended these ideas to all pure-dimensional projective schemes and beyond. Here is the basic definition:

\begin{definition}
If $X$ is a purely $r$-dimensional projective scheme over the field $k$, we say that a coherent sheaf $\omega$ on $X$, together with a linear
functional $\eta:\HH^{r}(\omega) \to k$ is \emph{dualizing} if the map
$$
f_{\eta}: \HH^{0}(\sHom_{X}(\sF, \omega))
\to
\Hom_{k}(\HH^{r}(\cF), k).
$$
defined as above is an isomorphism for every coherent sheaf $\sF$.
\end{definition}

\begin{proposition} Any two dualizing pairs $(\omega_{X}, \eta)$ and $(\omega'_{X}, \eta')$, on a scheme $X$ are canonically isomorphic.
\end{proposition}

 
\begin{proof}
We will show that there is a unique isomorphism $g: \omega\to \omega'$ making the diagram
$$
\begin{diagram}
 H^{1}(\omega)&\rTo^{g}&H^{1}(\omega')\\
 &\rdTo_{\eta}&\dTo_{\eta'}\\
 &&k
\end{diagram}
$$
commute. 

 The duality property of $\omega'$ yields
$$
\Hom_{X}(\omega, \omega') = \HH^{0}(\sHom(\omega, \omega')) = \Hom(\HH^{1}(\omega), k).
$$
Let $g: \omega \to \omega'$ be the map corresponding under this isomorphism to $\eta'$. It follows from the relation of $\eta'$ to the duality isomorphism, that 
$\eta'g = \eta$. Similarly, we get a map $g':\omega'\to \omega$ such that
$\eta g = \eta'$, and it also follows that $\eta gg' = f_{\eta}(gg') =  \eta$, so that
$gg' = 1_{\omega'}$. Similarly, $g'g = 1_{\omega}$, and we are done.
\end{proof}
 


We often abuse the terminology, and say simply that $\omega$ is a dualizing sheaf. If $X$ is reduced and connected, so that $\HH^{0} (\sHom(\sO_{X} , \sO_{X})) = k$, then
$\HH^{r}(\omega) \cong k$, whence $\eta$ is unique up to a scalar. 

In general, one can construct a dualizing pair on a variety $X$ by comparing $X$ with a 
variety $Y$ that already has a dualizing pair, such as $Y=\PP^{r}$. For simplicity
we treat only the case we need. 

\begin{theorem}\label{construction of omega}
Let $\pi: X \to Y$ is a finite morphism of a purely $1$-dimensional schemes, and suppose that
$\omega_{Y}, \eta_{y}$ is a dualizing pair on $Y$.  , and let $\pi: X\to Y$ be a finite morphism. 
The sheaf $\omega := \sHom(\pi_{*}\cO_{X}, \omega_{Y})$, regarded as a sheaf on $X$
together with the map $\eta: \HH^{1}(\omega) \to k$ such that
the corresponding maps
$$
f_{\eta}: \HH^{0}(\sHom_{X}(\sF, \omega))
\to
\Hom_{k}(\HH^{1}(\cF), k): \qquad \alpha \mapsto \eta\circ \HH^{1}(\alpha)
$$
are isomorphisms for any coherent sheaf $\sF$ on $X$. 
\end{theorem}

Note that one possible choice of $\pi: X\to Y$ in the theorem would be a Noether normalization, that is a finite map to $\PP^{1}$, where $\omega_{\PP^{1}} = \sO_{\PP^{1}}(-2)$. 

\begin{proof}
The sheaf  
$\omega:= \sHom(\pi_{*}\cO_{X}, \omega_{Y})$
which is, a priori a sheaf on $Y$, has the structure of a sheaf on $X$
specified by the property that
$$
\pi_{*}(\omega) = \sHom(\pi_{*}\cO_{X}, \omega_{\PP^{1}}).
$$
as a sheaf on $Y$.

To see that there is such a sheaf, take an open affine cover $\{U_{i}\}$ of $\PP^{1}$ and pull it back to an open affine cover $\{V_{i} = \pi^{-1}(U_{i})\}$ of $X$. Because $\pi$ is finite, the restriction of 
$\pi_{*} \cO_{X}$ to $U_{i}$ is naturally isomorphic to $\sO_{V_{i}}$, regarded as an $\sO_{U_{i}}$-module, and thus the restriction of
$\sHom(\pi_{*}\cO_{X}, \omega_{\PP^{1}}$ to $U_{i}$ is 
$Hom_{U_{i}}(\cO_{V_{i}}, \omega_{\PP^{1}}|_{U_{i}})$,
which is naturally a module over $\cO_{V_{i}}$. This gives $\omega_{X}:= \sHom(\pi_{*}\cO_{X}, \omega_{\PP^{1}}$
the structure of a sheaf on $X$, and it is obvious from the construction that this has the desired pushforward. Uniqueness (up to isomorphism) follows easily, but we will soon prove a stronger version.

Because $\pi$ is finite we have
$$
\HH^{1}(\omega) = \HH^{1}(\pi_{*}\omega) 
= \HH^{1}(\pi_{*}\sHom(\cO_{C}, \omega_{\PP^{1}}).
$$
We may use the structure map $\cO_{\PP^{1}} \to \pi_{*}\cO_{C}$ to deduce
a map  
$$
\HH^{1}(\omega) = 
\HH^{1}(\pi_{*}\sHom(\cO_{C}, \omega_{\PP^{1}})
\to
\HH^{1}(\sHom(\cO_{\PP^{1}}, \omega_{\PP^{1}})
= \HH^{1}\omega_{\PP^{1}}
$$
and thus any residue map $\eta_{\PP^{1}}: \HH^{1}(\omega_{\PP^{1}}) \to k$
gives rise, by composition, to a residue map 
$\eta: \HH^{1}(\omega)\to k$.

We next prove that the pair $(\omega, \eta)$ has the dualizing property given in the 
Theorem.  Because $\pi$ is finite, the cohomology of a sheaf on $X$ is the same as the cohomology of its pushforward. In view of the construction of $\omega$, and the fact that $\omega_{\PP^{1}}$ is a dualizing sheaf for $\PP^{1}$, it suffices to show that there is a natural isomorphism
$$
\pi_{*}\sHom_{X}(\sF,\sHom_{\PP^{1}}(\pi_{*\sO_{X}}, \omega_{\PP^{1}})) \to \sHom_{\PP^{1}}(\pi_{*}\sF, \omega_{\PP^{1}}).
$$
Passing to an affine open set $U_{i}\subset \PP^{1}$ and its preimage $V_{i}\subset X$
as in the definition of $\omega$,  the left hand side becomes
$$
\Hom_{V_{i}}(\sF|_{V_{i}}, \Hom_{U_{i}}(\cO_{X}|V_{i}, \omega_{\PP^{1}}|_{U_{i}}))
$$
where all the $V_{i}$-modules are considered $U_{i}$-modules via the structure
map $\cO_{U_{i}} \to \cO_{V_{i}}$. The natural map sending an element $a$ to
the map 
$$
f(a) \in \sHom_{U_{i}}(\sF|_{V_{i}}, \omega_{\PP^{1}}|_{U_{i}})
$$
that takes $t\in \sF|_{V_{i}}$ to $a(t)(1)\in \omega_{\PP^{1}}|_{U_{i}}$ is the natural
isomorphism required.
\end{proof}

\begin{fact}[Dualizing sheaves in higher dimension]  There are two important extensions of Theorem~\ref{construction of omega}:

First, the proof given for curves above actually works for a purely $r$-dimensional projective scheme $X$ over $k$ if we replace the occurrences of  $\HH^{1}$ by $\HH^{r}$, and shows that every such scheme has a dualizing sheaf $\omega$. However, the isomorphisms
$$
\HH^{i} (\sHom(\sF, \omega)) \not\cong \Hom_{k}(\HH^{r-i}(\sF), k) 
$$
hold for all coherent $\sF$ if and only if $X$ is Cohen-Macaulay. In our situation
this condition means that, if $\pi: X\to \PP^{r}$ is a finite map, then $\pi_{*}\cO_{X}$
is locally free.
\end{fact}

 

\begin{exercise}[Adjunction formula] Prove directly that if $\omega_{Y}$ is a dualizing sheaf on a surface $Y$ and $X$ is a Cartier divisor on $Y$, then
$\omega := \cO_{X}\otimes_{Y}\omega_{Y}(X))$ is a dualizing sheaf for $X$.  
Use this to show by induction that if 
$$
X = \bigcap_{i=1}^{c}H_{1}\cap \cdots \cap H_{n}
$$ 
is a complete intersection
in $\PP^{r}$ of hypersurfaces of degrees $\deg H_{i} = d_{i}$,  then
$$
\omega_{X} = (\cO_{X}(\sum_{i=1}^{c} d_{i}) - r-1.
$$
\end{exercise}

%%The classical adjunction formula gives the canonical line bundle on a curve $C$ on a smooth surface $X$ in terms of the canonical bundle $\omega_{X}$ of $X$ as 
%%$$
%%\omega_{C} = \omega_{X}(C) |_{C},
%%$$
%%and thus, even more familiarly, gives the genus of $C$ as an intersection number,
%%$2\g(C)-2 = (K_{X}+C).C$. 
%%
%%We can reinterpret this formula homologically by noting that there is a short exact sequence
%%$$
%%0\to \sO_{X}(-C) \to \sO_{X}\to \sO_{C}\to 0.
%%$$
%%giving a long exact sequence in $\sExt_{\sO_{X}}(-, \omega_{X})$. Taking into account
%%that $\sExt_{\sO_{X}}(\sO_{X}, \omega_{X}) =0$ because $\sO_{X}$ is locally free, we get the
%%exact sequence
%%$$
%%\to \sHom_{\sO_{X}}(\sO_{X}, \omega_{X}) \to \sHom_{\sO_{X}}(\sO_{X}(-C), \omega_{X})
%%\to \sExt^{1}_{\sO_{X}}(\sO_{C}, \omega_{X}) \to 0,
%%$$ 
%%proving that
%% $\sExt^{1}_{\sO_{X}}(\sO_{C}, \omega_{X}) = \omega_{X}(C)|_{C}$, 
%% and thus showing in this case that 
%% $$
%% \omega_{C} = \sExt^{1}_{\sO_{X}}(\sO_{C}, \omega_{X}).
%% $$
%%
%% It turns out that the ``1'' in the $\sExt^{1}_{\sO_{X}}$ in this formula is just the codimension of $C$ in $X$, and that the result holds in great generality:
% 
%\begin{theorem}\label{canonical is ext}
%Let $C\subset X$ be a purely 1-dimensional subscheme of $\PP^{n}$. The canonical sheaf of $C$ is 
%$$
%\omega_{C} \cong \sExt^{n-1}_{\sO_{\PP^{n}}}(\sO_{C}, \omega_{\PP^{n}}) = 
%\sExt^{n-1}_{\sO_{\PP^{n}}}(\sO_{C}, \sO_{\PP^{n}})(-n-1).
%$$
%which is the sheafification of the graded module $\Ext^{n-1}(S_{C},S)(-n-1)$.
%\end{theorem}
%
%For an abstract definition of the canonical bundle as a ``dualizing sheaf'' see \cite{AltmanKleiman}. For a smooth variety over $\CC$ the definition is satisfied by the the top exterior power of the cotangent bundle, and for $\PP^{n}$ this is $\sO(-n-1)$. 
%\section{Noether's Theorem}\label{sec:canonical curves} 
%
%\fix{we need to do this in a setting where we know the statement of Riemann-Roch. How general is that? Not much harm in retreating to the case of irreducible curves or even smooth ones, and adding a ``fact'' for the general case.}

As we remarked at the beginning of this Chapter, all canonically embedded smooth curves have the same Hilbert functions. We shall now show that they are all arithmetically Cohen-Macaulay.
We follow the treatment in \cite{Schreyer}, and treats a more general situation than that of the 
images of smooth curves under the canonical embeddings.

We define a \emph{canonical curve} in $\PP^{g-1}$ to be a purely one-dimensional, nondegenerate closed subscheme  such that
$$
 h^{0}(\sO_{C}) = 1, h^{0}(\sO_{C}(1) = g, \hbox{ and } \omega_{C} = \sO_{C}(1).
$$

We say that $C$ has a \emph{simple} $g-3$-dimensional $g-2$ secant if $C$ contains $g-2$ reduced points spanning a $(g-3)$ dimensional
plane in $\PP^{g-1}$ that meets $C$ only in the $g-2$s points.

\begin{theorem}[Max Noether]
A canonical curve in $\PP^{g-1}$ has degree $2g-2$ and arithmetic genus $g$. If the curve has a simple
$g-3$-dimensional $g-2$ secant, then it is arithmetically Cohen-Macaulay; that is,
$\h^{1}\sI_{C/\PP^{g-1}}(m) = 0$ for all $m\in \ZZ$.
\end{theorem}
 
Note that for a canonically embedded irreducible curve, the hypothesis of having a simple $g-3$-dimensional $g-2$ secant plane $\Lambda$ is the same as having a base-point free pencil of degree $g-2$; this is the linear series 
cut out by the hyperplanes containing $\Lambda$.

 Note that these hypotheses imply that $C$ is connected and Gorenstein.
 
\begin{proof}
We begin by showing that $\sO(-m)$ has no global sections for $m>0$.
If $D$ is a divisor equivalent to $n$ times the hyperplane section, we have an exact sequence
$$
0\to \HH^{0}(\sO_{C}(-n)) \to \HH^{0}(\sO_{C}) \to \HH^{0}(\sO_{D}) \to \cdots.
$$
By hypothesis, the vector space $\HH^{0}\sO_{C}$ is spanned by the constant functions, and these
restrict non-trivially to $\sO_{D}$, and $\HH^{0}(\sO_{C}(-n)) = 0$ as claimed.

Using the Riemann-Roch Theorem we can now compute the Hilbert function $\chi_{C}(m)$:
We have 
$$
\chi_{C}(0) = h^{0}(\sO_{C}) - h^{1}(\sO_{C}) = h^{0}(\sO_{C}) - h^{0}(\omega_{C}) = 1-g.
$$
On the other hand 
$$
\chi_{C}(0) = h^{0}(\sO_{C}(1)) - h^{1}(\sO_{C}(1)) = h^{0}(\sO_{C}(1_{}) - h^{0}(\sO_{C}) = g-1.
$$
Since $\chi_{C}(m)$ is a polynomial of degree1 in $m$, we deduce
$\chi_{C}(m) = (2g-2)m -g+1$, whence we see that the degree of $C$ is $2g-2$ and $\p(C) = g$ as claimed.

To show that
$C$ is arithmetically Cohen-Macaulay we use the sequence
$$
\cdots \to \HH^{0}(\sO_{\PP^{n}}(m)) \to \HH^{0}(\sO_{C}(m))
\to \HH^{1}(\sI_{C}(m))\to \HH^{1}(\sO_{\PP^{n}}(m)) \to\cdots .
$$
Since $\HH^{0}(\sO_{\PP^{n}}(m)) = 0$, it
is enough to show that the natural map 
$$
\HH^{0}(\sO_{\PP^{n}}(m)) \to \HH^{0}(\sO_{C}(m))
$$
 is surjective for all $m\in \ZZ$. For $m=0,1$ this is immediate from the hypothesis.

For $m <0$ we must show $\HH^{0}(\sO_{C}(m))=0.$ 
If $D$ is a divisor equivalent to $-m$ times the hyperplane section, we have an exact sequence
$$
0\to \HH^{0}(\sO_{C}(m)) 
\to \HH^{0}(\sO_{C}) 
\to \HH^{0}(\sO_{D}) \to \cdots.
$$
By hypothesis, the vector space $\HH^{0}\sO_{C}$ is spanned by the constant functions, and these
restrict non-trivially to $\sO_{D}$, so the kernel, $\HH^{0}(\sO_{C}(m))$, is 0 as claimed. 

To prove surjectivity for $m\geq 2$ we use the remaining hypothesis, the existence of
a simple $g-3$-dimensional $g-2$ secant plane $\Lambda$  and an idea sometimes called the \emph{base-point-free pencil trick}. Let $p_{0},\dots p_{g-3}$ be the points in which $\Lambda$ meets $C$.  Since the
$p_{i}$ are linearly independent by hypothesis, we may choose homogeneous coordinates $x_{i} \in \HH^{0}(\sO_{C}(1))$ so that
$x_{i}(p_{j} \neq 0$ if and only if $i = j$. It follows that the sections
$x_{i}^{m}$ of $\sO_{C}(m)$ span $\HH^{0}(\sO_{C}(m)|_{\{p_{0}, \dots, p_{g-3}\}}$. Let 
$V\subset \HH^{0}(\sO_{C}(1))$ be the two-dimensional subspace of linear forms vanishing on
$\Lambda$, and thus on the $p_{i}$. 

For $m\geq 2$ there are maps of vector spaces
$$
\wedge^{2} V\otimes \HH^{0}(\sO_{C}(m-2)) \to V\otimes \HH^{0}(\sO_{C}(m-1)) 
\to \HH^{0}(\sO_{C}(m))
$$
where the right hand map is multiplication and the left hand map sends
$s_{1}\wedge s_{2}\otimes \sigma$ to $s_{1}\sigma-s_{2}\sigma$ for any local section $\sigma$.
The sequence is exact because the sections $s_{1},s_{2}$ that span $V$ never vanish simultaneously except on the $p_{i}$, and has image  consisting of sections that vanish on the points $p_{i}$

\end{proof}
\section{Castelnuovo's theorem: $2g+1$ is projectively normal.}

\fix{I'm inclined to make this a ``cheerful fact''}

 Regularity in terms of resolution and in terms of local cohomology. (has the relation of local to global coho been done already?)

We'll need local cohomology, local duality, 
 WMACE
recall the $2g+1$ theorem from Ch 4. Say that it's ACM+smooth. relate it to regularity as in "geom of syz". Say that the projective
normality of smooth CI's is really ACM for all CI's. Say that ACM is measured by the length of the free resolution.




\subsection{How syzygies can reflect geometry}

One of the main ways in which syzygies can be seen to reflect the geometry of an embedded  reduced, irreducible curve $C\subset \PP^r$
(or other variety) is linked to the possibility of factoring the line bundle $\sO_C(1)$ as the tensor product of two bundles with sections. Suppose for example that $\sO_C(1) = \sL_1\otimes \sL_2$. Choose 2 independent global sections
$\sigma_1, \sigma_2$ of  $H^0(\sL_1)$ and a basis $\tau_1,\dots, \tau_n$ of $H^0(\sL_2)$. Set
$l_{i,j}= \sigma_i\tensor \tau_j$ and consider the matrix 
$$
M = 
\begin{pmatrix}
 l_{1,1}&l_{1,2}&\dots&l_{1,n}\\
  l_{2,1}&l_{2,2}&\dots&l_{2,n}
\end{pmatrix}.
$$
We claim that  the $2\times 2$ minors $l_{1,j} l_{2,j'}-l_{1,j'}l_{2,j}$ are in the homogeneous ideal of $I_C$ of $C$ in $\PP^r$. 

\begin{example}
The most familiar example is that of the twisted cubic. In this case the global sections $x_0\dots x_3$ of $\sO_C(1)$ may be identified with the forms $s^3, s^2t, st^2, t^3 \in k[s,t]$, and if $p\in C \cong \PP^1$ then the multiplication of sections
in the factorization  $\sO_C(1) = \sO_C(p) \otimes \sO_C(2p)$ 
$$
\bordermatrix{
 &s^2&st&t^2\cr
 s& s^3&s^2t&st^2\cr
 t& s^2t&st^2&t^3
}
$$
 leads to the familiar matrix
$$
\begin{pmatrix}
x_0&x_1&x_2\\
x_1&x_2&x_3 
\end{pmatrix}.
$$
We have $I_2(M) = I_C$, and the same idea works for the rational normal curve of any degree.

\end{example}

To see that, in general, $I_C$ contains the ideal $I_2(M)$ generated by the $2\times 2$ minors of $M$, 
let $K(C)$ be the ring of rational functions on $C$ \fix{have we made this definition somewhere?}. Choosing identifications $\sL_i\otimes K(C) \cong K(C)$ we see that the $\sigma_i$ and the $\tau_j$ commute with each other as elements of $K(C) \otimes_{\sO_X} K(C)$, and thus 
$$
\bigl(l_{1,j} l_{2,j'}-l_{1,j'}l_{2,j}\bigr)|_C = \sigma_1\tau_j\sigma_2\tau_j' - \sigma_1\tau_j'\sigma_2\tau_j =0.
$$

In case $C$ is reduced and irreducible the matrix above has a special property: $K(X)$ is a domain, so no product of a nonzero
section of $\sL_1$ with a nonzero section of $\sL_2$ can be zero. We can state this without any reference to $C$:

\begin{definition}
Let $R$ be a commutative ring. A map $M:R^n\to R^m$ is 1-generic if the kernel of the corresponding
 map $R^{n}\otimes R^{m*} \to R$  contains no pure tensor $a\otimes b$. In more concrete terms, a matrix
$M$ is \emph{1-generic} if there are no invertible matrices $A,B$ such that  $AMB$ has some entry equal to 0.
\end{definition}

By the material in Chapter~\ref{scrolls}, the ideal $I_2(M)$ of a 1-generic matrix of linear forms is the homogeneous ideal of a rational normal 
scroll
of codimension $n-1$ and degree $n$. 

In the next section we will show that it has a free resolution of a special form called the 
Eagon-Northcott complex that is a subcomplex of the minimal free resolution of $I_C$. The presence of such a variety containing $C$ or
a subcomplex of this special form in the minimal free resolution of $C$ is thus necessary for the 
factorization of the line bundle $\sO_C(1)$ as above, and it is sometimes sufficient, as well.

\section{The Eagon-Northcott Complex of a $2\times n$ matrix of linear forms}

The Eagon-Northcott complex is a complex of free modules associated to any matrix over any commutative ring. The most familiar special case is the Koszul complex, which one may think of as the Eagon-Northcott complex of a $1\times n$ matrix, and  even in the general case the Eagon-Northcott complex is in a sense built out of the Koszul complexes. A full treatment of the Eagon-Northcott complex and a whole family of related constructions can be found in 
\cite[Appendix ***]{E}, and, from a more conceptual and general point of view, in \cite{Weyman}. Here we will only
make use of the case of a matrix such as the one above, we will present a simplified account in that case only. Here is the result we need:

\begin{theorem}\label{Eagon-Northcott}
 Let $S = k[x_0,\dots, x_r]$ be a polynomial ring,  and let $M: F\to G$ be a homomorphism with
 $F = S^n(-1), G= S^2$. If $M$ is 1-generic, then the minimal free resolution of $S/I_2(M)$ has the form:
\begin{align*}
EN(M) := 
S \lTo{\bigwedge^2 M} 
 \bigwedge^2 F&
 \lTo^{\delta_{2}}
 S^{2*}\otimes \bigwedge^3 F  \lTo^{\delta_{3}}
  (\Sym^2S^{2})^*\otimes\bigwedge^4F  \\
 &\lTo^{\delta_{4}}\cdots\lTo^{\delta_{n-1}} 
(\Sym^{n-2}S^{2})^*\otimes\bigwedge^nF 
 \lTo 0.
\end{align*}
\end{theorem}

From Chapter **** we know also that the ideal of minors defines a rational normal scroll.

\begin{proof} We first show that $r\geq n$; more precisely, we show that the span of the entries of $M$ has dimension $\geq n+1$. As noted above, to say that the $2\times n$ matrix of linear forms $M$ is 1-generic means that
the kernel of the corresponding map $ \phi: k^2\otimes k^n \to S_1$ contains no pure tensors. In the projective
space $\PP^{2n-1} = \PP(k^2\otimes k^n)$ the pure tensors form a variety isomorphic to $\PP^1\times \PP^{n-1}$, and thus of dimension $n$. Consequently the kernel of $\phi$ can have dimension at most $n-1$, whence the image of $\phi$ 
in $S_1 = k^{r+1}$ has dimension at least $2n-(n-1) = n+1$. 

We begin the discussion of $EN(M)$ by defining the maps $\delta_i$ and and proving that the given sequence is indeed a complex---that is, consecutive maps compose to 0. For simplicity of notation, we choose a generator of $\wedge^2 S^2$
 and identify it with $S$, which gives a sense to the map labeled $\bigwedge^2M$.
 
  Although it is not hard to do this directly, the dual maps
 $$
 \partial_i: \Sym^{i-2} G \otimes \bigwedge^i F^* \rTo \Sym^{i-1} G \otimes \bigwedge^{i+1} F^*
 $$
 have a more familar-looking description, so we define these instead. Indeed, the map $M$ corresponds to an
 element $\mu\in G\otimes F^*$. We may think of $ \Sym^{i-2} G \otimes \bigwedge^i  F^*$
 as a (bigraded) component of the exterior algebra over $ \Sym G$ of 
 $$
  \Sym G \otimes \bigwedge_S  F^*= \bigwedge_{ \Sym G} (\Sym G \otimes  F^*).
 $$
We define $\partial_i$ to be  multiplication by $\mu$ in the sense of this exterior algebra. Since $\mu$ has degree 1
in this sense, its square is 0. 

To show that $(\bigwedge^2 M)\circ \delta_2$ is zero, it is simplest to choose a matrix representing $M$.
Direct computation using only the usual expansion of a determinant
along a row shows that, up to sign,
pure basis vector $e\otimes f_i\wedge f_j\wedge f_k$ of $G^*\otimes \bigwedge^3 F$
maps under the composition $(\bigwedge^2) M\circ \delta_2$ to the determinant
of the $3\times 3$ matrix obtained from $M$ by repeating the row corresponding to $e$ and
the columns $i,j,k$, which is 0 because of the repeated row.

We next prove the split exactness of a complex of the form $EN(M')$ where $M'$ is surjective, so that we
may write $F = G\oplus F'$ and the map $M': G\oplus F' \to G$ as projection on the first factor. 
Of course
it suffices to prove the split exactness of the dual sequence, $EN(M')^*$:
\begin{align*}
EN(M')^* := 
S \rTo{\bigwedge^2 M'^*} 
 \bigwedge^2 F^*&
 \rTo^{\partial_{2}}
 G\otimes \bigwedge^3 F^*  
 \rTo^{\partial_{3}}
  \Sym^2G\otimes\bigwedge^4F^*  \\
 &\rTo^{\partial_{4}}\cdots\rTo^{\partial_{n-1}} 
\Sym^{n-2}G\otimes\bigwedge^nF^* 
 \rTo 0.
\end{align*}
In this case the proof
is an exercise in multilinear algebra. 
We begin by proving split exactness at the 
positions $\Sym^{i} G \otimes \bigwedge^{i+2}  F^*$ where $i\geq 1$.

The module
$ \Sym^{i} G \otimes \bigwedge^{i+2}  F^*$
decomposes as
\begin{align*}
&\Sym^{i} G \otimes \bigwedge^2 G^* \otimes \bigwedge^{i} F'^*\oplus \\
&\Sym^{i} G \otimes  G^*\otimes \bigwedge^{i+1} F'^* \oplus \\
&\Sym^{i} G \otimes  \bigwedge^{i+2} F'^* 
\end{align*}
Note that under our hypothesis, the element $\mu' \in G\otimes F^* = G\otimes G^* \oplus G\otimes F'^*$
has the form $(\mu_G, 0)$, where $\mu_G$ represents the identity map $G \to G$. Thus the complex
$EN(M')^*$ is a direct sum over $i$ of 3-term complexes of the form
%$$
%\Sym^{i+1} G \otimes \bigwedge^2 G^* 
%\lTo^{-\wedge \mu'} 
%\Sym^{i} G \otimes  G^*
%\lTo^{-\wedge \mu'} 
%\Sym^{i-1} G
%$$
$$
\Sym^{i-1} G 
\rTo^{-\wedge \mu'} 
\Sym^{i} G \otimes  G^*
\rTo^{-\wedge \mu'} 
\Sym^{i+1} G \otimes \bigwedge^2 G^* 
$$
tensored with various $\bigwedge^j F'^*$, and it suffices to show that the former are split exact when
$i\geq 0$. Now $\Sym G$ may be identified with $R:= S[x,y]$, where $x,y$ are a basis of $S^2$, and
as such the sequences above may be identified with components of the Koszul complex of $x,y$ over $R$,
%$$
%R\otimes \wedge^2 G\lTo R\otimes G \lTo R .
%$$
$$
0\to R \rTo R\otimes G \rTo R\otimes \wedge^2 G
$$
The only homology of this sequence is $R/(x,y)R$ at the right so if we replace  $R\otimes \wedge^2 G \cong R$ by the ideal $(x,y)R$, this sequence is a split exact sequence of free $S$-modules. This is the desired result.

It remains to treat the beginning of the complex $EN(M')^*$,
$$
S \rTo{\bigwedge^2 M'^*} 
 \bigwedge^2 F^*
 \rTo^{-\wedge \mu'}
G\otimes \bigwedge^3 F^*
$$
which, in our case, may be written:
%$$
%\wedge^2 F^* = \bigwedge^2 G^* \oplus (G^*\otimes F'^*) \oplus \bigwedge^2 F'*
%$$
%Consider the pair of maps
\begin{align*}
S \rTo{\bigwedge^2 M'^*} 
 &\bigwedge^2 G^* \ \oplus\ (G^*\otimes F'^*)\ \oplus\ \bigwedge^2 F'^*
 \rTo^{-\wedge \mu'} \\
 &G\otimes \bigwedge^2 G^*\otimes F'^*\ \oplus\ (G\otimes G^*\otimes \bigwedge^2 F'^*)\ \oplus\ G\otimes \bigwedge^3 F'^*
\end{align*}
The map $\bigwedge^2 M'$ is the projection to $\bigwedge^2 G$ composed with the chosen isomorphism
$\bigwedge^2 G \cong S$, and is thus a split monomorphism. To complete the argument, we must show that
 the map marked $-\wedge \mu'$ is a monomorphism on $(G^*\otimes F'^*) \oplus \bigwedge^2 F'^*$.
 But this map is the direct sum of the two maps
  $$
 (G^* \rTo^{-\wedge \mu'} G\otimes \bigwedge^2 G^*)  \otimes F'^*
 $$
 and
 $$
(S  \rTo^{\mu'} G\otimes G^*) \otimes \bigwedge^2 F'^*
 $$
 which are evidently split monomorphisms. 
completing the proof of split exactness of $EN(M')^*$ and thus of $EN(M')$.


To go further we use a basic result, proven in a more general form (and with a slightly different statement) in \cite[Theorem ***]{E}. We make the convention
that the codimension of the empty set is infinity.

\begin{theorem}\label{WMACE}
 Let $S = k[x_0,\dots, x_r]$, and
 $$ 
\FF:  F_0\lTo^{\phi_1}F_1 \lTo \cdots \lTo F_{n-1}\lTo^{\phi_n} F_n\lTo 0
 $$
be a finite complex of free $S$-modules. Set
$$
X_i = \{p\in \AA^{n+1} \mid  H_i(\FF \otimes \kappa(p)) \neq 0\}
$$
The complex $\FF$ is \emph{acyclic} (that is, $H_i(\FF) = 0$ for all $i>0$) if and only if
$$
\codim X_i \geq i
$$
for all $i>0$. Moreover, $X_{0}\supseteq X_{1}\supseteq \cdots \supseteq X_{n}$
\qed
\end{theorem}

For example, Nakayama's Lemma implies that $X_{0}$ is the support of $\coker \phi_{1}$; thus $X_{0}$ is the set defined by the $\rank F_{0}$-sized minors of $\phi_{1}$. Similarly, 
and that $X_{n}$ is the support of the cokernel of the dual of $\phi_{n}$. 

Also, if $n=1$, the theorem simply says that a map $F_1\to F_0$ is a monomorphism iff it becomes a monomorphism after tensoring with the field of rational functions $K$, which follows from the flatness of
localization and the fact that $F_1$ is torsion-free, so that
$F_1 \subset F_1 \otimes K$. 

\begin{fact}
Theorem~\ref{WMACE} is true in this form over any Cohen-Macaulay ring; for more general
rings, ``codimension'' must be replaced by ``grade'', as in the given reference.
The Theorem can be generalized
to case where the $F_i$ are not free, but are sufficiently ``like'' free modules, too.
\end{fact}

Conclusion of the proof of Theorem~\ref{Eagon-Northcott}.
Let $X_{i}\subset \AA^{r+1}$ be the variety defined from the complex $EN(M)$ as in 
Theorem~\ref{WMACE}. Since $EN(M)$ becomes split exact after inverting any $2\times 2$ minor of $M$
$X_{i}$ is
contained in the closed set defined by $I_{2}(M)$, for all $i$. Thus if $I_{2}(M)$ has codimension $n-1$,
then $EN(M)$ is acyclic. 
\end {proof}

%
%
%
%\fix{consider moving this to the intro}
%We will also use a special case of the Auslander-Buchsbaum formula connecting projective dimension and depth:
%
%\begin{theorem}\label{Auslander-Buchsbaum}
%If $R$ is a regular local ring of dimension $d$, and $M$ is a finitely generated $R$-module, then the projective dimension of $M$ is $\leq d$ with equality only if
%$M$ contains a submodule of finite length. 
%\end{theorem}
%
%\begin{corollary}\label{associated primes}
%If $R$ is a regular local ring of dimension $d$, and $M$ is a finitely generated $R$-module, then the codimension of an associated prime of $A$ is at most the projective dimension of $A$. 
%\end{corollary}
%\begin{proof}[Proof of  Corollary~\ref{associated primes}]
% Projective dimension can only decrease under localization, and
% the associated primes $P$ of $A$ are those for which $A_{P}$ contains a submodule
% of finite length.
%\end{proof}
%
%With this and the multi-linear algebra above we can  prove the basic acyclicity result for an Eagon-Northcott complex:
%
%\fix{the Theorem as now stated doesn't need the following. I've copied the short proof
%of acyclicity into the end of the proof above.}
%\begin{proposition}\label{acyclicity}
%Let $S = k[x_0,\dots, x_r]$ be a polynomial ring,  and let $M: F\to G$ be a homomorphism with
% $F = S^n(-1), G= S^2$.
% $$
% S^n \cong F \rTo^M G \cong S^2
% $$
% is a (not necessarily homogeneous) map of free $S$-modules.
% The Eagon-Northcott complex $EN(M)$ is acyclic if and only if $\codim I_2(M) \geq n-1$, in which case the dual complex is also acyclic and
% the associated primes of $I_2(M)$ are all minimal and of codimension $n-1$.
% \end{proposition}
%
%\begin{proof}[Proof of Proposition~\ref{acyclicity}]
%Let $X_{i}\subset \AA^{r+1}$ be the variety defined from the complex $EN(M)$ as in 
%Theorem~\ref{WMACE}. Since $EN(M)$ becomes split exact after inverting any $2\times 2$ minor of $M$
%$X_{i}$ is
%contained in the closed set defined by $I_{2}(M)$, for all $i$. Thus if $I_{2}(M)$ has codimension $n-1$,
%then $EN(M)$ is acyclic. 
%
%In this case the projective dimension
%of $S/I_{2}(M)$ is $n-1$, so all the associated primes of $I_{2}(M)$ have codimension
%exactly $n-1$.
%
%If $EN(M)$ is  acylic then, by Theorem~\ref{WMACE}, the codimension of $X_{n-1}$ is at least $n-1$. Thus to prove that the acyclicity of $EN(M)$ implies  $\codim I_{2}(M) \geq n-1$ (and thus
%$\codim I_{2}(M))  n-1$, it suffices to show that $X_{n-1} = X_{0}$ as algebraic sets.
%
%To see this, note that
%the ideal of $2\times 2$ minors of $M$. By definition, $X_{n-1}$ 
%is the set of points $p$ where $\kappa(p)\otimes \delta_{n-1}$ is not an inclusion, 
%or equivalently, that 
%that 
%$$
%\kappa(p)\otimes F\otimes \Sym^{n-3}G 
%\cong 
%\kappa(p)\otimes \bigwedge^{n-1} F^{*} \otimes  \Sym^{n-3}G 
%\rTo^{\partial_{n-1}}
%\kappa(p)\otimes \bigwedge^{n} F^{*} \otimes  \Sym^{n-2}G
%\cong
%\kappa(p)\otimes \Sym^{n-2}G
%$$
%is not a split surjection, and it is easy to see that the composite map takes
%$a\otimes b$ to $\kappa(p) \otimes M(a)\cdot b$, so the cokernel is the $(n-2)$-nd symmetric power
%of the cokernel of the map $\kappa(p) \otimes M$. Thus $X_{n}$ is equal to the support
%of the cokernel of $M$ itself. 
%
%By Nakayama's Lemma, $X_{0}$ is the support of $M$; furthermore, the localization of $\coker M$ at $p$ is 0 if and only if
%one of the 
%$2\times 2$ minors of $M$ is a unit locally at $p$ so $X_{0}$, so this is defined
%set-theoretically by $I_{2}(M)$.
%
%It now follows from Theorem~\ref{WMACE} that all the $X_{i}$ are equal, so $EN(M)$ is 
%acyclic if and only if $EN(M)^{*}$ is acyclic. 
%
%
%Since $M$ is 1-generic the entries of of the second row of $M$ are linearly independent, and since the dimension of the span of all the linear forms is at least $n+1$, some element in the first row is outside the span of the the elements in the second. After a permutation of columns we may assume that $l_{1,1}, l_{2,1}, l_{2,2},\dots l_{2,n}$ are linearly independent, and we may take them to be a subset of the variables, say $x_{0},\dots x_{n+1}$
%
%We next show by induction on $n$ that  $I_{2}(M)$ is prime. In the case $n=2$ we have $I_{2}(M) =  (x_{0}x_{2}-x_{1}l_{1,2})$ which obviously does not factor. 
%
%Now suppose that $n>2$, and let $M'$ be the matrix $M$ with the first column omitted. we know by induction that $I_{2}(M')$ is prime of codimension $n-2$. Since $I:=I_{2}(M)$ does not have the maximal ideal as an associated prime, it is saturated. The ideal $I_{2}(M)+x_{0}$ properly contains $I_{2}(M')$ and thus has codimension $\geq n-1$ in $S/x_{0}$, whence we see that every component of $I_{2}(M)$ meets the open set
%$x_{0} = 1$. Restricting to this open set
%\end{proof}

%
%The first non-trivial example of a finite free resolution is the Koszul complex on 3 variables, which is the minimal $S = k[x,y,z]$-free resolution of the module $S/(x,y,z)$:
%$$
%0\to S(-3) \rTo^{
%\begin{pmatrix}
%x\\y\\z 
%\end{pmatrix}}
% S^3(-2) \rTo^{\begin{pmatrix}
%0&-z&y\\
%z&0&-x\\
%-y&x &0
%\end{pmatrix}}
%S^3(-1) \rTo^{
%\begin{pmatrix}
%x&y&z
%\end{pmatrix}}
%S
%$$
%In fact this is the first example that Hilbert presented in his famous paper \cite{}. 																											

\section{Syzygies and the Clifford index}
Green's Conjecture, Voisin's Theorem, Ein-Lazarsfeld Theorem --- all cheerful facts. proof that low gonality implies long linear part.

\subsection{Low genus canonical embeddings} Schreyer's table (include $g=9$)?

\section{Cheerful facts about Stillman's problem}
%\section{Low degree}

\input{footer}