\input{header.tex}

\fix{notation: the normalization should always be $C$, the other models $C_0$ or...}
\chapter{What linear series exist?}\label{Brill-Noether}\label{BNChapter}

If we only wish to know when a curve $C$ of genus $g$ has a $g^r_d$, then for $d>2g-2$ (or more generally nonspecial linear series) the Riemann-Roch Theorem gives a complete answer. Any special series must have $d\leq2g-2$, and in this case Clifford's Theorem gives the bound $r< d/2$, except in the case of hyperelliptic curves, where the answer is different but also completely understood. Together, these cases cover all possibilities:

\begin{theorem}\label{arbitrary linear series}
There exists a curve $C$ of genus $g$ and line bundle $\cL$ of degree $d$ on $C$ with $h^0(\cL) \geq r+1$ if and only if
$$
r \leq
\begin{cases}
d-g, \quad \text{if } d \geq 2g-1; \text{ and} \\
d/2,  \quad \text{if } 0 \leq d \leq 2g-2.
\end{cases}
$$
\end{theorem}


If we ask the---perhaps more interesting---question of when there can be a $g^r_d$ that is birationally
very ample, then Castelnuovo's theorem gives a bound. 

In both these situations, the curves that achieve the bounds are quite special. Perhaps the most interesting question of all is, for which $r,d$ do \emph{all} curves of genus $g$ have a $g^r_d$, and what is the
behavior of these series on a general curve? Brill-Noether theory provides some answers to both these questions.

\section{Brill-Noether theory}

\begin{theorem}[Basic Brill Noether]\label{basic BN}
A general curve $C$ of genus $g$  possesses a linear series of degree $d$ and dimension $r>d-g$ if and only if
$$
 \rho(g,r,d) := g - (r+1)(g-d+r) \geq 0.
$$
\end{theorem}

\fix{Add chart from 3264 comparing the Clifford, Castelnuovo and Brill-Noether bounds}

In the following sections, we'll see why we might naively expect this to be the case, and we'll also state some of the many refinements and strengthenings of the theorem.  A proof of the existence half of the theorem (the ``if" part of the statement) may be found in \cite[Theorem ****]{3264};  we will give in Chapter~\ref{InflectionsChapter} of this book a relatively simple proof of the nonexistence part (the ``only if"). 

The case $r=1$ is already interesting:

\begin{corollary}
If $C$ is any curve of genus $g$, then $C$ admits a rational function of degree $d$ for some positive $d \leq \lceil \frac{g+2}{2}\rceil$.
\end{corollary}

Thus any curve of genus 2 is hyperelliptic, any curve of genus 3 or 4 is either hyperelliptic or trigonal  (admits a 3-1 map to $\PP^1$), and so on.


\subsection{Heuristic argument leading to the statement of Brill-Noether}

The proof of the Brill-Noether theorem starts with a simple dimension count---one that was first carried out almost a century and a half ago. \fix{let's say more about the history here, or at the end of this section}

Let $C$ be a smooth projective curve of genus $g$, and $D = p_1 + \dots + p_d$ a divisor on $C$. We'll assume here the points $p_i$ are distinct; the same argument (with  more complicated notation) can be carried out in general.

When does the divisor $D$ move in an $r$-dimensional linear series? Riemann-Roch gives an answer: it says that $h^0(D) \geq r+1$ if and only if the vector space $H^0(K-D)$ of 1-forms vanishing on $D$ has dimension at least $g-d+r$---that is, if and only if the  evaluation map
$$
H^0(K) \to H^0(K|_D) = \bigoplus k_{p_i}
$$
has rank at most $d-r$. 

We can represent this map by a $g \times d$ matrix. Choose a basis $\omega_1,\dots,\omega_g$ for the space $H^0(K)$ of 1-forms on $C$; choose an analytic open neighborhood $U_j$ of each point $p_j \in D$ and choose a local coordinate $z_j$ in $U_j$ around each point $p_j$, and write
$$
\omega_i = f_{i,j}(z_j)dz_j
$$
in $U_j$. We will have $r(D) \geq r$ if and only if the  matrix-valued function
$$
A(z_1,\dots,z_d) = 
\begin{pmatrix}
f_{1,1}(z_1) & f_{2,1}(z_1) & \dots & f_{g,1}(z_1) \\
f_{1,2}(z_2) & f_{2,2}(z_2) & \dots & f_{g,2}(z_2) \\
\vdots & \vdots &  & \vdots \\
f_{1,d}(z_d) & f_{2,d}(z_d) & \dots & f_{g,d} (z_d)
\end{pmatrix}
$$
has rank $d-r$ or less at $(z_1,\dots,z_d) = (0,\dots,0)$.

The point is, we can think of $A$ as a matrix valued function in an open set $U = U_1 \times U_2 \times \dots \times U_d \subset C_d$; and for divisors $D \in U$, we have $r(D) \geq r$ if and only if $\rank(A(D)) \leq d-r$. Now, in the space $M_{d,g}$ of $d \times g$ matrices, the subset of matrices of rank $d-r$ or less has codimension $r(g-d+r)$ (\cite[Theorem ****]{Eisenbud1995},  so if the map $A$ is dimensionally transverse to this degeneracy locus in $M_{d,g}$, we could deduce that the locus of divisors with $r(D) \geq r$ has dimension $d - r(g-d+r)$, and such divisors would exist only if
$$
d - r(g-d+r) \; \geq \; r.
$$
At the same time, if any divisor of degree $d$ with $h^0(D) \geq r+1$ exists, then there must be at least an $r$-dimensional family of them; this is exactly the statement of the Brill-Noether Theorem.


\subsection{Refinements of the Brill-Noether theorem}

As we indicated, Theorem~\ref{basic BN} is just a starting point. It raises a slew of questions, both about the geometry of the schemes $W^r_d(C)$ parametrizing linear series on a general curve $C$ (what are their dimensions, are they irreducible, etc.), and about the geometry of the linear systems themselves (do they give embeddings; what's the Hilbert function of the image, and so on). A great deal of progress has been made on these fronts. Here are statements of some of the main results:

\begin{theorem}[Brill-Noether theorem, omnibus version]\label{BN omnibus}
Let $C$ be a general curve of genus $g$. If we set $\rho = g - (r+1)(g-d+r)$, then
\begin{enumerate}
\item $\dim(W^r_d(C)) = \rho$;
\item\label{sing wrd} the singular locus of $W^r_d(C)$ is exactly $W^{r+1}_d(C)$;
\item\label{irr wrd} if $\rho > 0$ then $W^r_d(C)$ is irreducible;
\item\label{rho=0} if $\rho = 0$ then $W^r_d$ consists of a finite set of  points of cardinality
$$
\#W^r_d = g! \prod_{\alpha=0}^r \frac{\alpha!}{(g-d+r+\alpha)!};
$$
\item\label{Petri} if $L$ is any invertible sheaf on $C$, the map
$$
\mu : H^0(L) \otimes H^0(\omega_CL^{-1}) \rTo H^0(\omega_C)
$$
is injective, and the Zariski tangent space to the scheme $W^r_d(C)$ at the point $L$ is the annihilator of the image of $\mu$;
\item\label{general va} if $|D|$ is a general $g^r_d$ on $C$, then
\begin{enumerate}
\item if $r \geq 3$ then $D$ is very ample; that is, the map $\phi_D : C \to \PP^r$   embeds $C$ in $\PP^r$;
\item if $r=2$ the map $\phi_D : C \to \PP^2$ gives a birational embedding of $C$ as a nodal plane curve; and 
\item if $r=1$, the map $\phi_D : C \to \PP^2$ expresses $C$ as a simply branched cover of $\PP^1$.
\end{enumerate}

\item\label{maximal rank}[The maximal rank theorem] If $L \in W^r_d(C)$ is a general point (or any point, if $\rho = 0$), then for each $m > 0$ the multiplication map
$$
\rho_m : \Sym^m H^0(L) \to H^0(L^m)
$$
has maximal rank; that is, it is either injective or surjective.
\item\label{interpolation}[The interpolation theorem]
Let $d, g$ and $r$
be nonnegative integers with $\rho(d, g, r) \geq 0$. There is a general curve of degree $d$ and genus $g$ through $n$ general
points in $\PP^r$
if and only if
$$
(r-1)n \leq (r + 1)d-(r-3)(g-1)
$$
except in the four exceptional cases $(d, g, r) = (5, 2, 3),(6, 4, 3),(7, 2, 5)$ or $(10, 6, 5)$.
\end{enumerate}

\fix{add references, attributions, etc.}

\end{theorem}

A few special cases are worth noting:
\begin{enumerate}

\item As a special case of Part~\ref{rho=0}, we see that the number of $g^1_{k+1}$s on a general curve of genus $g = 2k$ is the $k$th Catalan number 
$$
c_k = \frac{2k!}{k!(k+1)!}.
$$
We have already seen this in the first case: in genus 2, it says the canonical series $|K|$ is the unique $g^1_2$ on a curve of genus 2. In the next chapter, we'll also see how to verify this directly for curves of genus 4---where it says that there are exactly two $g^1_3$s on a general curve of genus 4---and in genus 6, where it says that a general curve of genus 6 has 5 $g^1_4$s.  In genus 8, it says that a general curve of genus 8 has 14 $g^1_5$s, but we don't know of any way of seeing this directly from the geometry of a general curve of genus 8; and we know even less for larger $k$.

\item Part\ref{Petri} implies Part\ref{sing wrd}. In fact, a fairly elementary argument shows that at a point $L \in W^r_d(C) \setminus W^{r+1}_d(C)$, the tangent space to $W^r_d$ at the point $L$ is the annihilator
in $(H^0(\omega_C))^*$ of the image of $\mu$; given that $\mu$ is injective, we can compare dimensions and deduce that $W^r_d$ is smooth at $L$.

\item Part~\ref{maximal rank} is the celebrated \emph{maximal rank theorem} of Eric Larson. It answers in general a question that has come up multiple times so far in this book: every time we've asked what hypersurfaces contain a curve $C \subset \PP^r$ embedded by a linear system $|L|$, we've looked at the maps $\rho_m$. Each time, we knew the dimensions of the spaces $\Sym^m H^0(L)$ and $H^0(L^m)$, and the question was the rank of $\rho_m$; now we know the answer for a general linear system of any degree and dimension.Thus the maximal rank theorem tells us the Hilbert function of a general curve $C \subset \PP^r$ embedded by a general linear system.

\item There is a possible extension of the maximal rank theorem of Part~\ref{maximal rank}. If $C \subset \PP^r$ is a general curve embedded by a general linear series, the maximal rank theorem tells us the dimension of the $m$th graded piece of the ideal of $C$, for any $m$: this is just the dimension of the kernel of $\rho_m$. But it doesn't tell us what a minimal set of generators for the homogeneous ideal of $C$ might look like. For example, if $m_0$ is the smallest $m$ for which $I(C)_m \neq 0$, or numerically the smallest $m$ such that $\binom{m+r}{r} > md-g+1$, we can ask: is the homogeneous ideal $I(C)$ generated by $I(C)_{m_0}$?

To answer this question---given that we know the dimensions of $I(C)_m$ for every $m$---we would need to know the ranks of the multiplication maps
$$
\sigma_m : I(C)_m \otimes H^0(\cO_{\PP^r}(1)) \to I(C)_{m+1}
$$
for each $m$. In particular, we may conjecture that \emph{the maps $\sigma$ have maximal rank}; if this were true we could deduce the degrees of a minimal set of generators for the homogeneous ideal $I(C)$.

\item There is another object worth mentioning: for any curve $C$, there exists a scheme $G^r_d(C)$ parametrizing linear series of degree $d$ and dimension $r$; that is, in set-theoretic terms,
$$
G^r_d = \left\{ (L, V) \mid L \in Pic^d(C), \text{ and } V \subset H^0(L) \text{ with } \dim V = r+1 \right\}.
$$

(This requires a little more technical machinery to construct, which is why we haven't introduced it.) $G^r_d(C)$ maps to $W^r_d(C)$; the map is a birational isomorphism, being an isomorphism over the open subset $W^r_d(C) \setminus W^{r+1}_d(C)$ and having positive-dimensional fibers over $W^{r+1}_d(C)$. In fact, another version of Part~\ref{sing wrd} is the statement that \emph{for a general curve $C$, the scheme $G^r_d(C)$ is smooth for any $d$ and $r$}.

\item Parts~\ref{general va} and~\ref{maximal rank} describe the geometry of a general curve $C$ as embedded in projective space by a general linear series. But there are many remaining questions! One is the question of secant planes: a naive dimension count would suggest that an irreducible, nondegenerate curve $C \subset \PP^3$ will have a finite number of 4-secant lines, but no 5-secant lines. Is this true for a general curve embedded in $\PP^3$ by a general linear series?
\end{enumerate}

\section{Exercises}
\begin{exercise}
Prove a slightly stronger version of Theorem~\ref{arbitrary linear series} in the range $d \leq g-1$: that under the hypotheses of Theorem~\ref{arbitrary linear series} there exists a \emph{complete} linear series of degree $d$ and dimension $r$ for any $r \leq d/2$.
\end{exercise}

\begin{exercise}\label{rarity of Castelnuovo}
We have seen that complete intersections $C = Q \cap S \subset \PP^3$ of a quadric surface $Q$ and a surface $S$ of degree $k$ achieve Castelnuovo's bound $g = \pi(2k, 3)$ on the genus of curves of degree $2k$ in $\PP^3$. In fact, we will see in Chapter~\ref{ScrollsChapter} that any curve $C \subset \PP^3$ of degree $2k$ and genus $g = \pi(2k, 3) = (k-1)^2$ is of this form.
\begin{enumerate}
\item Find the dimension of the subvariety $\Gamma \subset M_g$ consisting of Castelnuovo curves.
\item Find the dimension of the subvariety $H \subset M_g$ of hyperelliptic curves, and compare this to the result of the first part.
\end{enumerate}
\end{exercise}

\input footer.tex