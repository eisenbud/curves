\input{header.tex}

\chapter{Hyperelliptic curves and curves of genus 2 and 3}\label{genus 2 and 3 chapter}

\section{Hyperelliptic Curves}\label{hyperelliptic}
 
We met hyperelliptic curves in Chapter 2, and proved there that, in genus $g$, the canonical
map has image the rational normal curve of degree $g-1$ in $\PP^{g-1}$. We used this to show that every special divisor on a hyperelliptic curve is a sum of divisors in the 
unique $g^1_2$ plus base points. We will begin this chapter with an explicit construction of hyperelliptic curves and use it to give a very concrete computation of the canonical series, reproving what we did in Chapter 2. Then we will consider the projective embeddings of curves of genus 2 (which are all hyperelliptic) and genus 3.
 
There will be a further discussion of hyperelliptic curves in Chapter~\ref{ScrollsChapter}, focussing on the algebra and geometry of their projective embeddings; the analysis here will cover most of the questions we'll be asking about curves in general in the next four chapters. 
  
 \subsection{The equation of a hyperelliptic curve}
 
By definition, a hyperelliptic curve $C$ a curve of genus $\geq 2$ admitting a degree two map $\pi : C \to \PP^1$, and we have seen that such a map is unique. Because the degree is only 2, each point in $\PP^1$ has either two distinct preimages, or only one, a ramification point. 
The ramification index of such a point $p$, defined as 1 less than the length of the fiber $\pi^{-1}(\pi(p)$, is 1, and there can be no higher ramification. Because at all but finitely many points $p \in C$ the map $\pi$ is a local isomorphism (``local" here in the complex analytic/classical or \'etale topology, not the Zariski topology!); at any other point $p \in C$, the map is given in terms of local analytic coordinates on $C$ and $\PP^1$ simply by $z \mapsto z^2$. In particular, both the ramification divisor and the branch divisor (as defined in Chapter~\ref{linear systems chapter}) are reduced. Thus by the Riemann-Hurwitz formula there are exactly $2g+2$ branch points $q_1,\dots,q_{2g+2} \in \PP^1$. These points determine the curve:
  
 
\begin{theorem}\label{hyperelliptic existence}
There is a unique smooth projective hyperelliptic curve $C$ expressible as a 2-sheeted cover of $\PP^1$ branched over any set of $2g+2$ distinct points.
\end{theorem}

\begin{proof} 
We can easily construct such a curve, postponing for a moment the uniqueness:
If the coordinate of the point $p_i \in \PP^1$ is $\lambda_i$, it is the smooth projective model of the affine curve 
  $$
C^\circ = \big\{ (x,y) \in \AA^2 \; \mid \; y^2 = \prod_{i=1}^{2g+2} (x - \lambda_i) \big\}.
$$ 
Note that we're choosing a coordinate $x$ on $\PP^1$ with the point $x = \infty$ at infinity not among the $q_i$, so that the pre-image of $\infty \in \PP^1$ is two points $r, s \in C$. Concretely, we see that as $x \to \infty$, the ratio $y^2/x^{2g+2} \to 1$, so that 
$$
\lim_{x \to \infty} \; \frac{y}{x^{g+1}} \; = \; \pm 1;
$$
  the two possible values of this limit correspond to the two points $r,s \in C$.
  
  It's worth pointing out that $C$ is \emph{not} simply the closure of the affine curve $C^\circ \subset \AA^2$ in either $\PP^2$ or $\PP^1 \times \PP^1$: as you can see from a direct examination of the equation, each of these closures will be singular at the (unique) point at infinity.
  
   The remainder of the proof of Theorem~\ref{hyperelliptic existence} will be done in a more general situation in Section~\ref{branched covers} below.
  
To give a smooth projective model of the hyperelliptic curve $C$ with given branch divisor, we divide the $2g+2$ branch points  into two sets of $g+1$---say, for example, $q_1,\dots,q_{g+1}$ and $q_{g+2}, \dots, q_{2g+2}$. We can then take $C$ to be the closure in $\PP^1 \times \PP^1$ of the  locus
  $$
  \big\{ (x,y) \in \AA^2 \; \mid \; y^2\prod_{i=1}^{g+1} (x - \lambda_i) = \prod_{i=g+2}^{2g+2} (x - \lambda_i) \big\};
  $$
  in projective coordinates, this is
   $$
  C \; = \; \big\{ (X,Y) \in \PP^1 \times \PP^1 \; \mid \; Y_1^2\prod_{i=1}^{g+1} (X_1 - \lambda_iX_0) = Y_0^2\prod_{i=g+2}^{2g+2} (X_1 - \lambda_iX_0) \big\}.
  $$
To see that $C \subset \PP^1 \times \PP^1$ is smooth we note that it is a curve of bidegree $(2,g+1)$ in $\PP^1 \times \PP^1$, and the formula for the genus of a curve in $\PP^1 \times \PP^1$ derived in Section~\ref{rational quartics section} tells us that such a curve has arithmetic genus $g$, and thus no singular points.
\fix{we only stated the genus formula for smooth curves on a surface in Ch 2; needs to be repaired there.}
  
 The map $\iota : C \to C$ that exchanges the two points in each reduced fiber of the map $C \to \PP^1$ and fixes the ramification points is algebraic: in terms of the last representation of $C$, it is given by $([X_0,X_1], [Y_0,Y_1]) \mapsto  ([X_0,X_1], [Y_0,-Y_1]) $). The map $\iota$ is called the \emph{hyperelliptic involution} on $C$.

  
  \subsection{Differentials on a hyperelliptic curve}

We can give a very concrete description of the differentials, and thus the canonical linear system, on a hyperelliptic curve $C$ by working with the affine model $C^\circ = V(f) \subset \AA^2$, where
$$
f(x,y) = y^2 - \prod_{i=1}^{2g+2} (x - \lambda_i).
$$
We will again denote the two points at infinity---that is, the two points of $C \setminus C^\circ$ by $r$ and $s$; for convenience, we'll denote the divisor $r+s$ by $D$. We write $\pi:C \to \PP^1$ for the morphism that, on $C^\circ$, sends $(x,y) \in C$ to $x$.

We can construct a differential form on $C$ by following the proof of the Riemann-Hurwitz Theorem of Chapter~\ref{linear systems chapter}.
Let $dx$ denote the usual different on $\PP^1$ having a double poll at infinity, and consider $\pi^*dx$ on $C$.  The function $x$ is regular on $C^\circ$, and is a local parameter over points other than the $\lambda_i$; from the local description of the map $\pi$, we see that $\pi^*dx$ is regular on $C^\circ$  with simple zeros at the ramification points $q_i = (\lambda_i, 0)$. Since $dx$ has a double pole at the point at $\infty\in \PP^1$ and $\pi$ is a local isomorphism near $r$ and $s$, the differential $\pi^*dx$ has double poles at the points $r$ and $s$. Thus the canonical
divisor of $C$ is 
$$
K_C \sim (dx) \sim R - 2D,
$$
where $R$ denotes the ramification divisor, in this case the sum of the ramification points. .

How can we find differentials that are regular everywhere on $C$? If we divide $dx$ by $x^2$ (or any quadratic polynomial in $x$) to kill the poles we  introduce new poles in the finite part $C^\circ$ of $C$. 

Instead, we want to multiply $dx$ by a rational function with zeros at $p$ and $q$, but \emph{whose poles occur only at the points where $dx$ has zeroes}---that is, the points $q_i$.  A natural choice the reciprocal of the partial derivative $f_y := \partial f/ \partial y = 2y$, which vanishes at the points $q_i$, and has  a pole of order $g+1$ at each of the points $r$ and $s$ (reason: the involution $y\to -y$ fixes $C^\circ$ and $x$, and exchanges the points $r$ and $s$). In other words, as long as $g \geq 1$, the differential
$$
\omega = \pi^*(\frac{dx}{f_y})
$$
is regular, with divisor
$$
(\omega) = (g-1)r + (g-1)s = (g-1)D.
$$
The remaining regular differentials on $C$ are now easy to find: Since $x$ has only a simple pole
at the two points at infinity we can  multiply $\omega$ by any $x^k$ with $k = 0, 1, \dots, g-1$. Since this gives us $g$ independent differentials, we see that the differentials
$$
\omega, x\omega, \dots, x^{g-1}\omega
$$
  form a basis for $H^0(K_C)$.

\subsection{The canonical map of a hyperelliptic curve}\label{hyperelliptic special}

Given that a basis for $H^0(K_C)$ is given by 
$$
H^0(K_C) = \langle \omega, x\omega,\dots,x^{g-1}\omega \rangle,
$$
we see that the canonical map $\phi : C \to \PP^{g-1}$ is given by $[1,x,\dots,x^{g-1}]$. In other words, the canonical map $\phi$ is  the composition of the map $\pi : C \to \PP^1$ with the Veronese embedding $\PP^1 \hookrightarrow \PP^{g-1}$ of $\PP^1$ into $\PP^{g-1}$ as a rational normal curve of degree $g-1$.


   \section{Interlude: branched covers with specified branch divisor}\label{branched covers}
   
   We will describe here the classification of branched covers $\pi : C \to B$ of a given curve $B$ with specified branch points. To give ourselves a concrete goal, we will address the question: given a curve $B$ and a collection $\Delta = \{p_1,\dots,p_b\} \subset B$ of points in $B$, how many branched covers $\pi : C \to B$ of degree $d$ are there with specified branching over each of the points $p_i$, up to isomorphism over $B$? Our analysis will consist of two steps: first, we will reduce the problem to the classification of topological covering spaces of the complement $U = B \setminus \Delta$; we will then use our knowledge of the fundamental group of $U$ to enumerate such covering spaces.
   
\begin{theorem}
 Let $B$ be a smooth curve, let $\Delta\subset B$ be a finite set of points, and let $U := B\setminus Delta$.
If $\pi^\circ : V \to U$ is a topological covering space then $V$ may be given the structure of a Riemann surface in a unique way so that the map $\pi^\circ$ is holomorphic; and $V$ may be compactified to a compact Riemann surface in $C$ a unique way such that the map $\pi^\circ$ extends to a holomorphic map $\pi : C \to B$.
\end{theorem} 

\begin{proof}
The space $V$ inherits the structure of a complex manifold from $U$ because if $D \subset U$ is any simply connected coordinate chart, then the preimage $({\pi^\circ})^{-1}(D)$ is a disjoint union of $d$ copies of $D$, and we may use them as coordinate charts on $V$. 
   
To compactify $V$ we observe that if $D^* = \{ z \in \CC \mid 0 < |z| < 1 \}$ is a punctured disc, then
the map $D\to D: z \mapsto z^n$ restricts to a connected $n-fold$ covering space $D^*\to D^*$. 
Since $\pi_1(D^*) = \ZZ$, any connected covering space $E$ of degree $n$ is homeomorphic to this one
by a homeomorphism inducing the identity on the target of $\pi$.
If we  define a holomorphic structure on $E$ by pulling back the one on $D$, then
this homeomorphism is biholomorphic.

Thus if $D_i$ is a small neighborhood of the point $p_i \in B$ biholomorphic to a disc, then the preimage  in $V$ of the punctured disc $D_i^* := D_i \cap U$ is a disjoint union of punctured discs, and $V$ can then be compactified to a compact Riemann surface in a unique way by completing each one to a full disc.
\end{proof}
   
 The problem of classifying smooth curves $C$ that have a map $\pi : C \to B$ of degree $d$ is thus the problem becomes one of classifying covering spaces of $U$. 
    
 \subsection{Branched covers of $\PP^1$} 

We continue with the notation $U = B\setminus \Delta$, now supposing that $B = \PP^1_\CC$, the Riemann sphere. Again, let $\pi:V\to U$ be a covering space.

Choose a base point $p_0 \in U$, and draw simple, non-intersecting arcs $\gamma_i$ joining $p_0$ to $p_i$ in $U$. If $\Sigma$ is the complement of the union of these arcs in the sphere, then the preimage of $\Sigma$ in $V$ will be the disjoint union of $d$ copies of $\Sigma$, called the \emph{sheets} of the cover; label these $\Sigma_1,\dots,\Sigma_d$
   
  \includepdf{"pic41"}
   
   Now, a covering space $V \to U$ of $U$ is determined by its \emph{monodromy}, which is the map
   $$
   \pi_1(U, p_0) \to S_d
   $$
   associating to each path  $\beta$ in $U$ from $p_0$ to $p_0$  the permutation of the points of $\pi^{-1}(p_0)$ given by sending a point $q \in \pi^{-1}(p_0)$ to the endpoint of the unique lift of $\beta$ starting at $q$. Let $\beta_i$ be the path starting at $p_0$, going out along the arc $\gamma_i$ until just short of $p_i$, going once around $p_i$ and then going back to $p_0$ along the same path $\gamma_i$, as drawn in the Figure. Let $\tau_i$ i the corresponding permutation of $\{1,2,\dots,d\}$. The paths $\beta_i$  generate the fundamental group $\pi_1(U, p_0)$, with the one relation that the product $\beta_1\cdot \dots \cdot \beta_b = Id$ is the identity; the permutations $\tau_1,\dots,\tau_b$ thus determine the covering space $V$.
   
\includepdf{"pic42"} 
 
If we assume that the covering
$\pi : C \to B$ is simply branched, so each $\tau_i$ is a transposition; and if we assume that
$C$, and thus $V$, is connected, then the subgroup $\langle \tau_1, \dots, \tau_b \rangle \subset S_d$ is transitive. If we were to relabel the sheets $\Sigma_\alpha$ according to some permutation $\sigma$, the effect would be to conjugate each $\tau_i$ by $\sigma$. 

Summarizing we have proven:   
   \begin{lemma}\label{branched cover classification}
   Let $p_1,\dots, p_b \in \PP^1$ be any $b$ given points. There is a natural bijection between 
   \begin{enumerate}
   \item the set of  simply branched covers $\pi : C \to \PP^1$ of degree $d$, branched over the points $p_i$, up to isomorphism over $\PP^1$; and
   \item the set of $b$-tuples of transpositions $\tau_1, \dots, \tau_b \in S_d$ such that $\prod \tau_i = id$ and such that $\tau_1, \dots, \tau_b$ generate a transitive subgroup of $S_d$, modulo simultaneous conjugation by $S_d$.
   \end{enumerate}
   \end{lemma}

In the case $d=2$ that is relevant to hyperelliptic curves, we note that there is only one transposition in $S_2$. Thus there is a unique double cover of $\PP^1$ with given branch points $p_1,\dots,p_b$. The product
condition shows again that the number of branch points must be even. . This completes the proof of Theorem~\ref{hyperelliptic existence}.
\end{proof}

We can use the same technique to count the number of 3 to 1 branched covers  $C \to \PP^1$ with given branch points, using that fact that every odd permutation $\tau \in S_3$ is a transposition. Thus if $b$ is even and  $\tau_1,\dots,\tau_{b-1} \in S_3$ are arbitrary transpositions, then the product 
$\tau_1\cdot \cdots,\tau_{b}$ is also a
 transposition. It follows that the number of $b$-tuples of transpositions $\tau_1,\dots,\tau_{b} \in S_3$ with $\prod \tau_i$ equal to the identity is $3^{b-1}$. The requirement that the group generated by the $\tau_i$ is transitive eliminates just the three cases where all the $\tau_i$ are equal. The group $S_3$ acts on the set of $b$-tuples of permuations without stabilizing any $b$-tuple, so every cover corresponds to exactly 6 collections $\tau_1,\dots,\tau_b$. In sum, the number of simply branched three-sheeted covers of $\PP^1$ with specified branch points $q_1,\dots,q_b \in \PP^1$ is
$$
\frac{3^{b-1} - 3}{6} \; = \; \frac{3^{b-2} - 1}{2} 
$$


\subsection{More general covers}\label{general covers}

As we indicated, there are natural extensions of this basic theory to covers with arbitrary branching, and to covers of curves of any genus. For the first, suppose that instead of specifying ``simply branched"---meaning that the fiber over any branch point consists of $d-2$ simple points and one double point---we specified that the fiber over a given branch point $q_i$ consisted of $m_1$ simple points, $m_2$ double points, $m_3$ triple points and so on. This amounts to specifying a conjugacy class in $S_d$, and instead of associating to $q_i$ a transposition, we want to specify an element $\tau_i$ of this conjugacy class. Again, the permutations $\tau_i$ have to have product the identity, and to generate a transitive subgroup of $S_d$; and again, they are determined up to simultaneous conjugation by an element of $S_d$.

\begin{exercise}
Find the number of 3-sheeted covers $C \to \PP^1$ of genus $g$ with simple branching except for one point of total ramification (that is, one point with just a single preimage point.)
\end{exercise}

Similarly, we can enumerate covers of curves $B$ of genus $g>0$ by a modification of the construction above. Choosing a base point $p \in B$ we can draw $2g$ loops $\alpha_1,\dots,\alpha_{g},\beta_1, \dots, \beta_g$ based at $p$ and disjoint except for $p$ so that the complement $B \setminus \cup \alpha_i$ is a disc with boundary $\alpha_1, \beta_1, \alpha_1^{-1}, \beta_1^{-1}, \dots, \alpha_g, \beta_g, \alpha_g^{-1}, \beta_g^{-1}$. If we draw arcs $\gamma_i$ joining $p$ to each of the branch points $q_i$, we can associate to a cover a collection of permutations $\sigma_1, \dots, \sigma_b, \mu_1,\dots,\mu_g, \nu_1,\dots,\nu_g$ (with $\sigma_i$ a transposition, if we are assuming simple branching, or of specified conjugacy class in general, and the $\mu_i$ and $\nu_i$ arbitrary). These, up to conjugacy, determine the cover, and have to satisfy the relation
$$
\prod_{i=1}^b \sigma_i = \prod_{\alpha=1}^g \; [\mu_\alpha, \nu_\alpha]
$$
and generate a transitive subgroup of $S_d$

\begin{exercise}
Let $B$ be a curve of genus $h$. How many unramified double covers of $B$ are there? 
\end{exercise}


\begin{exercise} Let $E$ be a curve of genus 1, and $q_1,\dots,q_b \in E$. How many double covers $C \to E$ are there branched over the $q_i$?
\end{exercise}


\begin{exercise} Let $E$ be a curve of genus 1, and $q, q' \in E$. How many triple covers $C \to E$ are there simply branched over $q$ and $q'$?
\end{exercise}


In general, the numbers of branched covers of a given curve with given branching are called \emph{Hurwitz numbers}; they are of interest to physicists, for reasons we can't fathom.



\section{Curves of genus 2}

Since  curves of genus 2 are hyperelliptic, everything we said above applies to them; in particular, the canonical map $\phi_K : C \to \PP^1$ on a curve of genus 2 is the expression of $C$ as a double cover of $\PP^1$, branched over 6 points in $\PP^1$, which are unique up to automorphisms of $\PP^1$. 

In this section, we'll consider other maps from a hyperelliptic curves $C$ to projective space, starting with maps $C \to \PP^1$.

\subsection{Maps of $C$ to $\PP^1$}\label{genus 2 pencil}

Of course, $C$ may be expressed as a degree 2 cover of $\PP^1$ by taking the map associated to the canonical system $|K_C|$. But what about other degrees? For example, can we express $C$ as a three-sheeted cover of $\PP^1$?

The answer is ``yes," and in fact we can do so in many ways. First, start with an invertible sheaf $L$ of degree 3 on $C$. Since $3 > 2g-2$, Riemann-Roch tells us immediately that $h^0(L) = 2$, and we see that there are two possibilities:

\begin{enumerate}
\item First, if the linear system $|L|$ has a base point $p \in C$, then $h^0(L(-p)) = 2$, and hence $L$ must be of the form $L = K_C(p)$. Conversely, if $L = K_C(p)$, then $h^0(L(-p)) = h^0(L)$, which is to say $p$ is a base point of $|L|$.
\item On the other hand, if $L$ is not of the form $L = K_C(p)$, then $|L|$ does not have a base point, and so defines a degree 3 map $\phi_L : C \to \PP^1$.
\end{enumerate}

Do both possibilities occur? Certainly the first does; there's a one-parameter family of invertible sheaves of the form $K_C(p)$. But we know that the variety $\Pic^3(C)$ is 2-dimensional, so we see that the general invertible sheaf of degree 3 does  give an expression of $C$ as a 3-sheeted cover of $\PP^1$; in fact there exists a 2-parameter family of such maps.

There are plenty of higher-degree maps as well: an invertible sheaf of degree $d \geq 4 = 2g+2$ is automatically base-point free, and gives a map to $\PP^{d-2}$, from which we can project in many ways
to $\PP^1$.

\subsection{Maps of $C$ to $\PP^2$} Next consider maps of our curve $C$ of genus 2 to the plane. By theRiemann-Roch theorem, an invertible sheaf $L$ of degree 4 on $C$ will have $h^0(L) = 3$; and since $h^0(L(-p)) = 2$ for any point $p \in C$ (again by Riemann-Roch), we see that the linear system $|L|$ will give a regular map $\phi_L : C \to \PP^2$. We ask now about the geometry of this map.

There are three possibilities:

\begin{enumerate}
\item First, suppose $L = K_C^2$ is  the square of the canonical sheaf on $C$. We have then a map
$$
\Sym^2 H^0(K_C) \to H^0(L).
$$
Recalling that the elements of $H^0(K_C)$ may be written as $\omega, x\omega$ we see that
the map is injective, and since both sides are 3-dimensional vector spaces, we have equality. In other words, every divisor $D \sim K_C^2$ is the sum of two divisors $D_1, D_2 \in |K_C|$ in the canonical system. We conclude that the map $\phi_L$ is the composition of the canonical map $\phi_K : C \to \PP^1$ with the Veronese embedding $\nu_2 : \PP^1 \to \PP^2$ of $\PP^1$ as a conic curve in the plane and the map $\phi_L$ is generically 2-to-1 onto the conic.

\item Suppose now that $L$ is not equal to $K_C^2$; equivalently, $M = L \otimes K_C^{-1}$ is an invertible sheaf
of the form $\sO_C(p+q)$ for some pair of points $p,q$. Since $h^0(M) = 1$, this pair is unique, and $L = K_C(p+q)$ for a unique pair of points $p, q \in C$.

If $p \neq q$ then every section of $L$ vanishing at $p$ vanishes at $q$ and vice versa, so that $\phi_L(p) = \phi_L(q)$. However, for any effective divisor $D = r+s$ of degree 2 on $C$  other than $p+q$, we have $h^0(L(-D)) = 1$, so apart from the fact that $\phi_L(p) = \phi_L(q)$, the map $\phi_L$ is an embedding. We'll see in Exercise~\ref{nodal quartic} below that the point $\phi_L(p) = \phi_L(q)$ is an ordinary node of the image curve $\phi_L(C)$. Thus if $L = K_C(p+q)$, with $p \neq q$ and $p+q \neq K_C$, then the map $\phi_L : C \to \PP^2$ is a birational embedding of $C$ as a quartic plane curve with one node, the node being the common image of $p$ and $q$.

\item In the remaining case $L = K_C(2p)$, where $p \in C$ is any point such that $2p \not\sim K_C$. Here the map $\phi_L$ is one-to-one with vanishing differential at $p$, and the image curve $\phi_L(C)$ has  a cusp at the point $\phi_L(p)$.
\end{enumerate}

To summarize: the map $\phi_L : C \to \PP^2$ associated to an invertible sheaf $L$ of degree 4 on $C$ is either
\begin{enumerate}
\item two-to-one onto a plane conic curve, if $L = K_C^2$;
\item birational onto a plane quartic curve with a cusp, if $L = K_C(2p)$ with $2p \not\sim K_C$; and
\item birational onto a plane quartic curve with a node, if $L = K_C(p+q)$ with $p \neq q$ and $p+q \not\sim K_C$.
\end{enumerate}

Note that the last case is the ``general" one, meaning it holds for $L$ in an open subset of $\Pic^4(C)$; the second case holds for a one-dimensional locus in $\Pic^4(C)$, and the first case holds for just one point in $\Pic^4(C)$.

\begin{exercise}\label{nodal quartic}
Let $L \in \Pic^4(C)$ be an invertible sheaf of the form $L = K_C(p+q)$ with $p \neq q$ and $p+q \not\sim K_C$. Show that
\begin{enumerate}
\item $h^0(L(-2p)) = h^0(L(-2q)) = 1$, and
\item $h^0(L(-2p-2q)) = 0$.
\end{enumerate}
Deduce from this that the map $\phi_L$ is an immersion, and that the tangent lines to the two branches of $\phi_L(C)$ at the point $\phi_L(p) = \phi_L(q)$ are distinct, meaning the point $\phi_L(p) = \phi_L(q)$ is a node of $\phi_L(C)$.
\end{exercise}


\subsection{Embeddings in $\PP^3$}

By Corollary~\ref{degree 2g+1 embedding} any invertible sheaf $L$ of degree 5 is very ample. 
Write $\phi_L : C \to \PP^3$ for the map given by the complete linear system $|L|$. Since $\phi_L$ is an embedding, we'll also denote the image $\phi_L(C) \subset \PP^3$ by $C$ and write $\cO_C(1)$ for $L$.

What degree surfaces in $\PP^3$ contain the curve $C$? We start with degree 2, and consider the restriction map
$$
H^0(\cO_{\PP^3}(2)) \to H^0(\cO_C(2)) = H^0(L^2).
$$
The space on the left has dimension 10; by the Riemann-Roch Theorem we have $h^0(L^2) = 2\cdot5 - 2 + 1 = 9$. It follows that $C$ lies on a quadric surface $Q$. Since $C$ a plane or a union of planes, any quadric containing $C$ is irreducible; if there were more than one such, Bezout's Theorem would imply that $\deg(C) \leq 4$. Thus $Q$ is unique.

We might ask at this point: is $Q$ smooth or a quadric cone? The answer depends on the choice of invertible sheaf $L$. 

\begin{proposition}\label{genus 2 embedding}
Let $C \subset \PP^3$ be a smooth curve of degree 5 and genus 2 and $Q \subset \PP^3$ the unique quadric containing $C$. If $L = \cO_C(1) \in \pic^5(C)$, then $Q$ is singular if and only if we have
$$
L \cong K^2(p)
$$
for some point $p \in C$; in this case, the point $p$ is the vertex of $Q$.
\end{proposition}

Note that the variety $\pic^5(C)$ has dimension 2, while the sheaves of the form $K^2(p)$ form a one-dimensional subfamily. Thus in general $Q$ will be smooth; the set of invertible sheaves $L$
for which the quadric is singular is 1-dimesnional, and thus of codimension one.

\begin{proof}
First, suppose that the invertible sheaf $L \cong K^2(p)$ for some $p \in C$. Then $L(-p) \cong K^2$, so that the map $\pi : C \to \PP^2$ given by projection from $p$ is the map $\phi_{K^2} : C \to \PP^2$ given by the square of the canonical sheaf. As we've seen, the map $\phi_{K^2}$ is two-to-one onto a conic curve $E \subset \PP^2$, so that the curve $C$ lies on the cone $Q$ over $E$ with vertex $p$, and this is the unique quadric surface containing $C$.

Next, let's consider the case where $L$ is not of the form $K^2(p)$. Set $M = LK^{-1}$, so that we can write
$$
L = K \otimes M,
$$
where by hypothesis $M$ is not of the form $K(p)$. As we saw in Section~\ref{genus 2 pencil}, this means that the pencil $|M|$ gives a degree 3 map $C \to \PP^1$.

This gives us a way of factoring the map $\phi_L : C \to \PP^3$: we have maps $\phi_K : C \to \PP^1$ of degree 2 and $\phi_M : C \to \PP^1$ of degree 3, and we can compose their product with the Segre embedding $\sigma : \PP^1 \times \PP^1 \to \PP^3$:
\begin{diagram}
& & \PP^1 & & & &\\
& \ruTo^{\phi_K} & & \luTo & & & \\
C & & \rTo^{\phi_K \times \phi_M} & & \PP^1 \times \PP^1 & \rTo^\sigma & \PP^3 \\
& \rdTo^{\phi_M} & & \ldTo & & & \\
& & \PP^1 & & & & \\
\end{diagram}

This description of the map $\phi_L$  shows  that \emph{$C$ is a curve of type $(2,3)$ on a smooth quadric $Q \subset \PP^3$}, completing the proof of Proposition~\ref{genus 2 embedding}.
\end{proof}

Whether the quadric $Q$ is smooth or not, we can describe a minimal set of generators of the homogeneous ideal $I(C) \subset \CC[x_0, x_1, x_2, x_3]$ similarly. First, we look at the restriction map
$$
H^0(\cO_{\PP^3}(3)) \to H^0(\cO_C(3));
$$
since the dimensions of these spaces are 20 and $15-2+1 = 14$ respectively, we see that  vector space of cubics vanishing on $C$ has dimension at least 6. Only four of these are multiples of the defining equation of $Q$ linear forms on $\PP^3$. It follows that there are at least two cubics vanishing on $C$ that are linearly independent modulo those vanishing on $Q$.

We can identify these cubics geometrically, and show that there are no more than 2 linearly independent curbics modulo the ideal of $Q$. Suppose first that $Q$ is smooth, so that $C$ is a curve of type $(2,3)$ on $Q$. In that case, if $L \subset Q$ is any line of the first ruling, the sum $C+L$ is the complete intersection of $Q$ with a cubic $S_L$, unique modulo the ideal of $Q$; conversely, if $S$ is any cubic containing $C$ but not containing $S$, the intersection $S \cap Q$ will be the union of $C$ and a line $L$ of the first ruling; thus, mod $I(Q)$, $S = S_L$. A similar argument applies in case $Q$ is a cone, and $L$ is any line of the (unique) ruling of $Q$.

\begin{exercise}
Show that for any pair of lines $L, L'$ of the appropriate ruling of $Q$, the three polynomials $Q$, $S_L$ and $S_{L'}$ generate the homogeneous ideal $I(C)$. Find relations among them. Write out the minimal resolution of $I(C)$.
\end{exercise}



\subsection{The dimension of $M_2$ via maps to projective space}

Each of the types of maps that we described from a curve $C$ of genus 2 to projective space suggests the dimension of the moduli space $M_2$ of curves of genus 2.

To start, we know that every curve $C$ of genus 2 is uniquely expressible as a double cover of $\PP^1$ branched at six points, modulo the group $PGL_2$ of automorphisms of $\PP^1$. The space of such double covers has dimension 6, and $\dim(PGL_2) = 3$, and since the group acts with finite stabilizers this suggests that $\dim(M_2) = 6-3 = 3$.

Similarly, we've seen that a curve $C$ of genus 2 is expressible as a 3-sheeted cover of $\PP^1$ (with eight branch points) in a 2-dimensional family of ways. As we saw in the preceding section, such a triple cover is determined up to a finite number of choices by its branch divisor, so the space of such triple covers has dimension 8; modulo $PGL_2$ it has dimension 5, and since every curve is expressible as a triple cover in a two-dimensional family of ways, we arrive again at $\dim M_2 = 5-2 = 3$.

We've also seen that $C$ can be realized as (the normalization of) a plane quartic curve with a node in a 2-dimensional family of ways. The space of plane quartics has dimension 14; the family of those with a node has codimension one (\ref{PlaneCurvesChapter}) and hence dimension 13. Since  the automorphism group $PGL_3$ of $\PP^2$ has dimension 8, we see that the family of nodal plane quartics modulo $PGL_3$ has dimension 5, and since every curve of genus 2 corresponds to a 2-parameter family of such curves, we have $\dim M_2 = 5-2=3$.

Finally, a curve of genus 2 may be realized as a quintic curve in $\PP^3$ in a two-parameter family of ways. To count the dimension of the family of such curves, note that each one lies on a unique quadric $Q$, and is of type $(2,3)$ on $Q$. Thus to specify such a curve we have to specify $Q$ (9 parameters) and then a bihomogeneous polynomial of bidegree $(2,3)$ on $Q \cong \PP^1 \times \PP^1$ up to scalars; these have $3\cdot 4 - 1 = 11$ parameters. Altogether, then, there is a 20-dimensional family of such curves; modulo the automorphism group $PGL_4$ of $\PP^3$, this is a 5-dimensional family. Again, every abstract curve $C$ of genus 2 corresponds to a 2-parameter family of these curves modulo $PGL_4$, so once more we have $\dim M_2 = 5 - 2 = 3$.

\section{Curves of genus 3}

If $C$ be a smooth projective curve of genus 3. The is an immediate bifurcation into two cases, hyperelliptic and non-hyperelliptic curves; we will discuss hyperelliptic curves of any genus in Section~\ref{hyperelliptic}, and so for the following we'll assume $C$ is nonhyperellitic. By our general theorem~\ref{canonical system is very ample}, this means that the canonical map $\phi_K : C \to \PP^2$ embeds $C$ as a smooth plane quartic curve; and conversely, by Proposition~\ref{Adjunction Formula} any smooth plane curve of degree 4 has genus 3 and is embedded by the complete canonical system (that is, $\cO_C(1) \cong K_C$). 

Note that this gives us a way to determine the dimension of the moduli space $M_3$ of smooth curves of genus $3$: if $\PP^{14}$ is the space of all plane quartic curves, and $U \subset \PP^{14}$ the open subset corresponding to smooth curves, we have a dominant map $U \to M_3$ whose fibers are isomorphic to the 8-dimensional affine group $PGL_3$. (Actually, the fiber over a point $[C] \in M_3$ is isomorphic to the quotient of $PGL_3$ by the automorphism group of $C$; but since $Aut(C)$ is finite this is still 8-dimensional.) We conclude, therefore, that
$$
\dim M_3 = 14 - 8 = 6.
$$

What about other linear system on $C$, and the corresponding models of $C$? By hypothesis $C$ is not a 2-sheeted cover of $\PP^1$. On the other hand, it is a 3-sheeted cover: if $L \in \pic^3(C)$ is an invertible sheaf of degree 3 then, by the Riemann-Roch Theorem, we have
$$
h^0(L) = 
\begin{cases}
2, &\text{if $L \cong K-p$ for some point $p \in C$; and} \\
1 &\text{otherwise.}
\end{cases}
$$
There is thus a 1-dimensional family of representations of $C$ as a 3-sheeted cover of $\PP^1$. These are  visible directly from the canonical model: a degree 3 map $\phi_{K-p} : C \to \PP^1$ is the composition of the canonical embedding $\phi_K : C \to \PP^2$ with a projection from $p$. 

There are other representations of $C$ as the normalization of a plane curve. By the Riemann-Roch Theorem, $C$ has no $g^2_3$, and the canonical system is the only $g^2_4$, but there are plenty of models as plane quintic curves: by Proposition~\ref{very ample}, if $L$ is any invertible sheaf of degree 5, the linear system $|L|$ will be a base-point-free $g^2_5$ as long as $L$ is not of the form $K+p$, so that $\phi_L$ maps $C$ birationally onto a plane quintic curve $C_0 \subset \PP^2$. These can also be described geometrically in terms of the canonical model: any such invertible sheaf $L$ is of the form $2K-p-q-r$ for some trio of  points $p, q, r \in C$ that are not colinear in the canonical model, and we see  that $C_0$ is obtained from the canonical model of $C$ by applying a Cremona transform with respect to the points $p, q$ and $r$, that is, by applying the birational transformation
of the plane defined by the linear series of conics through $p,q,r$.

We can also embed $C$ in $\PP^3$ as a smooth sextic curve by Theorem~\ref{g+3 theorem}. In this case we can also apply Proposition~\ref{very ample} to conclude that an invertible sheaf $L \in \pic^6(C)$ of degree 6 will be very ample if and only if it is not of the form $K+p+q$ for any $p, q \in C$. 

\begin{fact}
If $C \subset \PP^3$ is a smooth non-hyperelliptic curve of degree 3 and genus 6, then there exists a $3 \times 4$ matrix $M$ of linear forms on $\PP^3$ such that 
$$
C = \{ p \in \PP^3 \mid \rank(M(p)) \leq 2 \}.
$$
This is an application of the ``Hilbert-Burch Theorem"; see ~\cite{geomsyz}
\end{fact}


\section{Theta characteristics}

In this section we sketch the algebraic theory of theta-characteristics, mostly as it applies to curves of genus 3.

Suppose that $C \subset \PP^2$ is a smooth plane curve. A \emph{bitangent} to $C$ is a line $L \subset \PP^2$ that is either tangent to $C$ at two distinct points, or has contact of order $\geq 4$ with $C$ at a point. Alternatively, we can say that a bitangent  corresponds to an effective divisor of degree 2 on $C$ such that $2D$ is contained in the intersection of $C$ with a line $L \subset \PP^2$.

A naive dimension count suggests that a smooth plane curve should have a finite number of bitangents (it's one condition on a line $L \in {\PP^2}^*$ to be tangent to $C$, so it should be two conditions for it to be bitangent). Indeed, this is the case; By Bezout's Theorem a conic or cubic curve cannot have any bitangents, but it is known that every smooth curve of degree $d \geq 4$ has 
$$
12\binom{d+1}{4} - 4d(d-2),
$$
counted with appropriate multiplicities~\cite[p. 282]{Griffiths-Harris1978}. For example, a line tangent to $C$ at 3 points  counts as three bitangents. Accordingly, a smooth plane quartic has 28 bitangents.

The bitangents to a plane quartic $C$ have a special significance: since $4 = 2 \times 2$, if $D = p+q$ is a bitangent, then the divisor $2D$ comprises the complete intersection of $C$ with a line; in other words, we have a linear equivalence
$$
2D \sim K_C
$$
or equivalently the invertible sheaf $\cO_C(D)$ is a square root of the canonical sheaf of $C$. Because of their appearance in the theory of theta functions, Riemann named the square roots of the canonical sheaf theta-characteristics.

How many such square roots are there? If $\cL$ and $\cM$ are invertible sheaves with $\cL^2 = \cM^2 = K$, then $\cL$ and $\cM$ differ by an invertible sheaf of order 2; that is,
$$
\cM = \cL \otimes \cF, \quad \text{where} \quad \cF \otimes \cF \sim \cO_C.
$$
In other words, $\cF$ is an invertible sheaf of degree 0, and  corresponds to a point of order 2 in the Picard group $\Pic_0(C)$. Since we've seen that $\Pic_0(C) = Jac(C)$ is a complex torus of dimension g = 3---the quotient of $\CC^3$ by a lattice $\Lambda \cong \ZZ^6$---we see that there are $2^6 = 64$ such invertible sheaves, and thus, given that there is some invertible sheaf $\cL$ satisfying $\cL^2 \cong K_C$, there are exactly $64 = 2^{2g}$ of them.

 \begin{exercise}
 Let $C$ be a curve of genus 2, expressed as a 2-sheeted cover of $\PP^1$ with ramification points $p_1,\dots,p_6$
 \begin{enumerate}
 \item Show that the theta-characteristics on $C$ are either of the form $\cL = \cO_C(p_i)$ or of the form $\cL = \cO_C(p_i + p_j - p_k)$ with $i, j, k$ distinct. 
 \item Show that in the first case we have $h^0(\cL) = 1$, and in the second case we have $h^0(\cL) = 0$. 
 \item Finally, show that there are six of the former kind, and 10 of the latter, making $2^4 = 16$ in all.
 \end{enumerate}
 \end{exercise}
 
The reader will have noticed that the number 64 of theta-characteristics does not agree with the number 28 of bitangents. The reason is easy to see: bitangents correspond to \emph{effective} divisors $D$ with $2D \sim K$, while a theta characteristic $\cL$ may have $h^0(\cL) = 0$, that is, may not correspond to an effective divisor. What can we say about the dimensions $h^0(\cL)$ of the space of sections of the theta-characteristics on $C$?
 
 There is a beautiful partial answer to this question, which can be deduced from a remarkable fact: \emph{the dimension $h^0(\cL)$ of the space of sections of a theta characteristic mod 2 is invariant under deformation}:
  
 \begin{theorem}\label{locally constant sign} Let $\cC \to B$ be a family of smooth curves, and $\cL_b$ a family of theta characteristics on the curves in this family---in other words, an invertible sheaf $\cL$ on $\cC$ such that $(\cL|_{C_b})^2 \cong K_{C_b}$ for each $b \in B$. If we define a function $f : B \to \ZZ/2$  by
 $$
 f(b) = h^0(\cL|_{C_b}) \;  \; (\text{mod } 2)
 $$
then $f$ is locally constant.
\end{theorem}

We say that a theta-characteristic $\cL$ is \emph{even} or \emph{odd} according to the parity of $h^0(\cL)$. Given the irreducibility of the moduli space $M_g$,  Theorem~\ref{locally constant sign} says that all curves of genus $g$ have the same number of even theta characteristics given by: 

\begin{theorem}\label{number of theta characteristics}
If $C$ is any curve of genus $g$, then $C$ has $2^{g-1}(2^g - 1)$ even theta characteristics and $2^{g-1}(2^g+1)$ odd theta characteristics.
\end{theorem}

Note that in case of a nonhyperelliptic curve $C$ of genus 3, the dimension $h^0(\cL)$ of a theta characteristic $\cL$ cannot be $\geq 2$, so this says exactly that there are $2^{g-1}(2^g-1) = 28$ effective theta-characteristics corresponding to the 28 bitangents.

We'll sketch here the proofs of these theorems; for details, see~\cite{MumfordPaper} and~\cite{JHPaper}. 

The proof of Theorem~\ref{locally constant sign} follows, via an ingenious construction of Mumford's, from an elementary fact about quadratic forms in an even number of variables. To state this, suppose that $V$ is a complex vector space of dimension $2n$ and $Q$ a nondegenerate symmetric bilinear form on $V$. By an \emph{isotropic plane} we mean a linear space $\Lambda \subset V$ such that $Q(\Lambda, \Lambda) = 0$. 

\begin{fact}
 \begin{enumerate}
\item The maximal isotropic subspaces for $Q$ have dimension $n$;
\item The set of maximal isotropic subspaces for $Q$ is a subvariety of the Grassmannian $G(n,V)$, or dimension $\binom{n}{2}$ and having exactly two connected components (the ``rulings" of $Q$); and
\item If $\Lambda, \Lambda' \subset V$ are any two maximal isotropic subspaces, then
$$
\dim(\Lambda \cap \Lambda') \equiv n \text{ (mod 2)} \quad \iff \quad \Lambda, \Lambda' \text{ belong to the same ruling.}
$$
\end{enumerate} 
\end{fact}

The first of these assertions is completely elementary: since the map $\tilde Q : V \to V^*$ associated to the form $Q$ carries an isotropic subspace to its annihilator, there can't be an isotropic plane of dimension $>n$; and similarly if $\Lambda \subset V$ is any isotropic plane of dimension $<n$ we can include $\Lambda$ in a larger isotropic plane by adding any nullvector for the induced quadratic form on $\ann(\Lambda)/\Lambda$.

The second and third assertions are less elementary, but the reader may already have seen the first two nontrivial cases of each. When $n=2$, they amount to observing that a smooth quadric surface in $\PP^3$ has two rulings by lines, and lines of opposite rulings meet in a point, while lines of the same ruling are either disjoint or equal. When $n=3$, we can see both assertions via the identification of a smooth quadric in $\PP^5$ with the Grassmannian $\GG(1,3)$: the two families of maximal isotropic subspaces are the loci of lines containing a given point $p \in \PP^3$ and the loci of lines contained in a given plane $H \subset \PP^3$.

Now suppose that $C$ is a smooth curve of genus $g$, and $\cL$ an invertible sheaf on $C$ with $\cL^2 \cong K_C$; that is, a theta characteristic. Choose a divisor $D = p_1 + \dots + p_n$ of degree $n> g-1$ consisting of distinct points, and let $V$ be the $2n$-dimensional vector space
$$
V := H^0( \cL(D) / \cL(-D) ).
$$
(Note that the sheaf $ \cL(D) / \cL(-D) $ is supported on $D$, with stalk of dimension 2 at each $p_i \in D$.) We can define a quadratic form on $V$ by setting
$$
Q(\sigma, \tau) := \sum_i \text{Res}_{p_i}(\sigma \cdot \tau)
$$
where we use the isomorphism $\cL^2 \cong K_C$ to identify the product $\sigma\tau$ with a rational differential.

We now introduce two isotropic subspaces for $Q$: first, we set
$$
\Lambda := H^0( \cL / \cL(-D) );
$$
this is isotropic simply because the product $\sigma\tau$ of two elements of $\Lambda$ corresponds to a regular differential, and so has no residues. Second, we set
$$
\Lambda' := \im\left( H^0(\cL(D)) \to H^0( \cL(D) / \cL(-D) ) \right)
$$
Since the $H^0(\cL(-D)) = 0$, the map is injective and according to Riemann-Roch, $h^0(\cL(D)) = n$, so this is again an $n$-dimensional subspace of $V$; it's isotropic because the sum of the residues of a global rational differential on $C$ is 0. Finally, the payoff: we observe that
$$
H^0(\cL) \cong \Lambda \cap \Lambda',
$$
and Theorem~\ref{locally constant sign} follows.

As for Theorem~\ref{number of theta characteristics}, there are two ways we can go. One is to dig a little deeper and actually describe the configurations of odd and even theta characteristics as subsets of the set $S$ of all theta characteristics, which as we've seen is a principle homogeneous space for the group $\Jac(C)_2 \cong (\ZZ/2\ZZ)^{2g}$ of points of order 2 on the Jacobian. Alternatively, we can use the invariance of these configurations under deformation to reduce to the hyperelliptic case; the result in that case is expressed in the following exercise.

\begin{exercise}
Let $C$ be a hyperelliptic curve of genus $g$, expressed as a 2-sheeted cover of $\PP^1$ with ramification points $p_1,\dots,p_{2g+2}$. If $\cE$ is the (unique) $g^1_2$ on $C$, show that any theta characteristic on $C$ is represented by a divisor
$$
D = m\cdot \cE + \sum_{i \in I} p_i
$$
for some $m \geq -1$ and $I \subset \{1,\dots, 2g+2\}$ a subset of cardinality $g-1-2m$; and that in this case
$$
h^0(D) = m+1.
$$
Using this, count the number of even and odd theta characteristics on $C$ (and thus on any curve of genus $g$).
\end{exercise}

Of course, if we do describe the configurations $S^+$ and $S^-$ of even and odd theta characteristics, we get more information. We won't go in to that here---again, the result is in~\cite{MumfordPaper} and~\cite{JHPaper}---but we will mention one remarkable fact that we can derive from it.

As noted, if we choose any theta characteristic on a curve $C$, we may identify the set $S^-$ of odd theta-characteristics with a subset of the group $\Jac(C)_2$ of points of order 2 on the Jacobian of $C$. We might expect, then, that some 4-tuples of these points will add up to 0 in $\Jac(C)$; in other words, there should exist some 4-tuples $\cL_1,\dots,\cL_4 \in S^-$ such that
$$
\cL_1+ \dots +\cL_4 = 2K_C.
$$
What this means in the specific case of genus $g=3$ is: \emph{among the 28 bitangents to a smooth plane quartic curve $C$, there will be some subsets of 4 whose eight points of tangency form the intersection of $C$ with a plane conic curve}; if we know the configuration $S^-$, we should be able to say how many. Indeed, the number was first found by Salmon; it is 315.

\section{Exercises}
 \begin{exercise}
  In the case $g=1$, show that the closure $\overline{C^\circ}$ of $C^\circ \subset \AA^2$ in either $\PP^2$ or $\PP^1 \times \PP^1$ consists of the union of $C^\circ$ with one additional point, with that point a tacnode of $\overline{C^\circ}$ in either case.
  \end{exercise}


\input footer.tex


