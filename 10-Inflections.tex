\input{header}

\chapter{Inflection points}\label{inflections chapter}
\label{InflectionsChapter}


In this chapter, we will introduce the \emph{inflection points} of a linear system. This is a fascinating topic in its own right; in addition, it will provide the tools to give a proof of the Brill-Noether theorem in the following chapter.

Just as a point $p \in C$ on a smooth plane curve $C \subset \PP^2$ is called a \emph{flex point} if there is a line $L \subset \PP^2$ having contact of order 3 or more with $C$ at $p$, a point on a smooth, nondegenerate curve $C \subset \PP^r$ will be called an \emph{inflection point} if there is a hyperplane $H \subset \PP^r$ having contact of order $r+1$ or more with $C$ at $p$. This notion can be extended to arbitrary linear series on smooth curves (as opposed to very ample ones); we'll see below that (in characteristic 0) every linear series has finitely many inflection points, and how to count them.


\section{Inflection points,  Pl\"ucker formulas and Weierstrass points}

\subsection{Definitions}
To define the inflection points of a linear series $\sD = (\sL, V)$ on a curve $C$, we will use the following result:

\begin{proposition}\label{vanishing sequence} Let $V$ be a vector space of global sections of an invertible sheaf $\sL$ on a smooth curve $C$, and let $p \in C$ be a point. There exists a basis $\sigma_0, \dots, \sigma_r$ of $V$ consisting of sections vanishing to different orders at $p$. Thus the set
$$
\{ \ord_p(\sigma) \mid \sigma \neq 0 \in V \}
$$
 has cardinality $\dim V$.
\end{proposition}

\begin{proof} Start with any basis $\tau_0, \dots, \tau_r$ of $V$. If  $\tau_i$ and $\tau_j$ vanish to the same order $a$, then 
some nonzero linear combination $\tau_i' := a\tau_i+b\tau_j$  will vanish to strictly higher order. Since the coefficients $a$ and $b$ are both necessarily nonzero we may modify our basis, replacing $\tau_i$ with $\tau_i'$. As long as our basis contains elements vanishing to the same order we can repeat this process; since the order $\ord_p(\sigma)$ of any section at $p$ is bounded above by the degree of $\sL$, this process must terminate.
\end{proof}

According to  Proposition~\ref{vanishing sequence}, we may write
$$
\{ \ord_p(\sigma) \mid \sigma \neq 0 \in V \} = \{a_0,\dots,a_r\} \; \text{ with } \; 0\leq a_0 < a_1 < \dots < a_r.
$$
The sequence $a_i = a_i(\cD,p)$ is called the \emph{vanishing sequence} of $\cD$ at $p$.  Since $a_i \geq i$, the numbers $\alpha_i = \alpha_i(\cD,p) := a_i - i$ are often more interesting, and the sequence $0 \leq \alpha_0 \leq \alpha_1 \leq \dots \leq \alpha_r$ is called the \emph{ramification sequence} of $\cD$ at $p$. 

We say that $p$ is an \emph{inflection point} of the linear series $\cD$ if $(\alpha_0,\dots,\alpha_r) \neq (0,\dots,0)$---equivalently, if $\alpha_r > 0$---and we define the \emph{weight} of $p$ to be
$$
w(\cD, p) = \sum_{i=0}^r \alpha_i(\cD, p).
$$

If $\cD$ is very ample, so that it may be viewed at the linear series cut on $C$ by hyperplanes for some embedding $C \subset \PP^r$, then this coincides with the notion above: $p$ is an inflection point if $a_r > r$; that is, if there is a hyperplane $H \subset \PP^r$ having contact of order $r+1$ or more with $C$ at $p$.

The first two terms in the ramification sequence are particularly important: $\alpha_0(\cD, p)$ is nonzero if and only if $p$ is a base point of $\cD$; and if $\alpha_0(\cD, p)=0$, then $\alpha_1(\cD, p) = 0$ if and only if, in addition, the map $\phi_\cD$ is an immersion (that is, has nonzero derivative) at $p$.


\subsection{The Pl\"ucker formula}

In characteristic 0, a linear series on a smooth projective curve can have only finitely many inflection points (we'll prove this in Lemma~\ref{finite infections} below), and in fact the sum of the weights of all the inflection points depends only on the genus of the curve and the degree and dimension of the the linear series. The result is called the Pl\"ucker Formula:

\begin{theorem}\label{Plucker}
If $C \subset \PP^r$ is a nondegenerate smooth curve of genus $g$ and $\cD$ is a
linear series of degree $d$ and dimension $r$, then
 \begin{equation}\label{Plucker formula}
\sum_{p \in C} w(\cD, p) \; = \; (r+1)d + r(r+1)(g-1).
\end{equation}
\end{theorem}
For a proof, see for example~\cite[Theorem 7.13]{allthat}.

Theorem~\ref{Plucker} also holds in positive characteristic under the hypothesis that the number of inflection points is finite (equivalently, not every point is an inflection point). This may seem like an unnecessary hypothesis---it's hard even to imagine a plane curve in which every point is a flex!---but in positive characteristic there are such curves.

As an immediate consequence of the Pl\"ucker formula, we have

\begin{corollary}\label{uninflected curves}
 If $C\subset \PP^r$ is a smooth nondegenerate curve with no inflection points, then $C$ is the rational normal curve of degree $r$. 
\end{corollary}

\begin{proof}
Suppose $C \subset \PP^r$ is a curve of degree $d$ and genus $g$. If $C$ has no inflection points then, by the Pl\"ucker formula, we must have
$$
(r+1)d + r(r+1)(g-1) = 0.
$$
This immediately implies that $g=0$, so that we must have $(r+1)(d-r) = 0$ and hence $d=r$; thus $C$ is a rational normal curve.
\end{proof}

This in turns implies a converse to  Proposition~\ref{independence on rnc}, which says that if $C \subset \PP^r$ is a rational normal curve, and $\Gamma \subset C$ any proper subscheme of $C$ of degree $r+1$, then $\Gamma$ spans $\PP^r$. But if $C \subset \PP^r$ is any smooth, irreducible, nondegenerate curve and $p \in C$ is any inflection point, then $(r+1)p$ is such a subscheme, and lies in a hyperplane. Thus the rational normal curve is the only curve with this property.


Another immediate consequence is the converse of Proposition~\ref{Veronese is projectively homogeneous}: Recall that $C\subset \PP^r$ is \emph{projectively homogeneous} if the automorphisms of $\PP^r$ fixing
$C$ act transitively on $C$. The rational normal curve has this property; and now we can see that it's the only irreducible, nondegenerate curve that does: if $C \subset \PP^r$ is any curve and $\phi : \PP^r \to \PP^r$ any automorphism carrying $C$ to itself, $\phi$ will carry inflection points of $C$ to inflection points of $C$, so that a curve with inflection points cannot be projectively homogeneous.


The Pl\"ucker formula leaves many questions unanswered. One thing we do know is the behavior of the inflection points for a general linear series; we'll state this here and prove it as a corollary to the proof of the Brill-Noether theorem later in this chapter.

\begin{theorem}\label{Brill Noether Plucker}
If $C$ is a general curve of genus $g$, $L \in W^r_d(C) \subset \pic_d(C)$ a general line bundle of degree $d$ with $h^0(L) = r+1$ and $V = H^0(L)$, then every inflection point of the linear series $\cD = (L, V)$ has weight 1 and hence ramification sequence $(0, \dots, 0, 1)$.
\end{theorem}

\subsection{Pl\"ucker formula for plane curves}\label{plane curve pluecker}
\subsection{Weierstrass points}

As with any extrinsic invariant of a curve in projective space, we can derive an intrinsic invariant of an abstract curve by applying the invariant to the canonical linear series. We define a \emph{Weierstrass point} of a curve $C$ to be an inflection point of the canonical linear series $|K_C|$. 

Thus $p$ is a Weierstrass point of $C$ if there exists a  differential form on $C$ vanishing to order $g$ or more at $p$. The \emph{weight} $w_p$ of a Weierstrass point $p \in C$  is defined to be the weight $w(|K_C|,p)$ of $p$ as an inflection point of the canonical series. 

The Pl\"ucker formula tells us  the total weight of the Weierstrass points on a given curve $C$:

\begin{corollary}\label{plucker formula}
The sum of the weights of the Weierstrass points on a curve $C$ of genus $g$ is
$$
\sum_{p \in C} w_p = g^3-g.
$$\qed
\end{corollary}

Note that Theorem~\ref{Brill Noether Plucker} implies that on a general curve $C$ of genus $g$, every Weierstrass point has weight 1; thus there are $g^3-g$ distinct Weierstrass points on $C$

%Since there are only finitely many ramification points of the canonical series, a general point $p$ on any curve $C$ has gap sequence $(1,2,\dots,g)$, and correspondingly its Weierstrass semigroup
%is $W_p = (0, g+1, g+2, \dots)$. A Weierstrass point is called \emph{normal} if it has weight 1; this is tantamount to saying that the gap sequence is $(1,2,\dots,g-1,g+1)$, or that the semigroup is $(0, g, g+2, g+3, \dots)$. (The full Brill-Noether theorem tells us that a general curve $C$ has only normal Weierstrass points; this will be a consequence of Theorem~\ref{BN with inflection and dimension} below.)

For example, suppose $C$ is a curve of genus 2. The canonical series on $C$ gives a map $\phi_K : C \to \PP^1$ of degree 2; the Weierstrass points of $C$ are the 6 ramification points of this map. 

In genus 3, if $C$ is hyperelliptic then the Weierstrass points are exactly the 8 ramification points of the 2-sheeted cover $C \to \PP^1$, and each has weight 3. If $C$ is non-hyperelliptic, then it is a plane quartic curve. A general such curve will have 24 ordinary flexes, which will be Weierstrass points of weight 1; special quartics may have some number $\alpha$ of \emph{hyperflexes}---points where the tangent line has contact of order 4 with the curve---which will be Weierstrass points of weight 2; in this case $C$ will have $\alpha$ Weierstrass points of weight 2 and $24-2\alpha$ Weierstrass points of weight 1. (It has been shown that $\alpha$ cannot be 11, but  all  other values  between 0 and 12 occur. \fix{need citation})

\subsubsection{The Weierstrass semigroup} 

By definition, a point $p \in C$ on a curve $C$ of genus $g$ is a Weierstrass point iff $h^0(K_C(-gp)) \neq 0$; that is, iff there exists a holomorphic differential on $C$ vanishing to order at least $g$ at $p$. Now, the Riemann-Roch formula tells us that
$$
h^0(\cO_C(gp)) = g - g + 1 + h^0(K_C(-gp))
$$
so the condition $h^0(K_C(-gp)) \neq 0$ is equivalent to saying that $h^0(\cO_C(gp)) > 1$; in other words, there exists a nonconstant rational function on $C$, regular on $C \setminus \{p\}$ and having a pole of order at most $g$ at $p$.

This suggests that we look at the set of all possible orders of pole at $p$ of rational functions regular on $C \setminus \{p\}$; that is,
$$
W(C,p) := \left\{ -\ord_p(f) \mid f \in K(C) \text{ with $f$ regular on } C \setminus \{p\} \right\}.
$$
This is clearly a sub-semigroup of the natural numbers $\NN$; it is called the \emph{Weierstrass semigroup} of the point $p$.  

Now, another way to characterize the condition that there exists a rational function on $C$, regular on $C \setminus \{p\}$, with a pole of order exactly $k$ at $p$ is to say that
$$
h^0(\cO_C(kp)) = h^0(\cO_C((k-1)p)) + 1.
$$
Applying Riemann-Roch to both sides of this equation, we see that it is equivalent to the condition
$$
h^0(K_C(-kp)) = h^0(K_C((-k+1)p)).
$$

In English: there exists a rational function on $C$, regular on $C \setminus \{p\}$, with a pole of order exactly $k$ at $p$, if and only if there does \emph{not} exist a regular differential on $C$ with a zero of order exactly $k-1$ at $p$.
 In other words, the complement $\NN \setminus W(C,p)$ is exactly the vanishing sequence of the canonical series at $p$, shifted by 1; in particular, it has cardinality  exactly $g$. This is called the \emph{Weierstrass gap sequence} of the point $p$.

%
%By the Riemann-Roch theorem, $p\in C$ is a Weierstrass point if and only if $h^0(\cO_C(gp)) \geq 2$, or in other words to saying that there exists a non-constant rational function on $C$, regular away from $p$ and having a pole of order $g$ or less at $p$. The same argument shows more generally that for any $k \geq 0$, there exists a rational function on $C$, regular on $C \setminus \{p\}$ and having a pole of order exactly $k$ at $p$---that is,
%$$
%h^0(\cO_C(kp)) > h^0(\cO_C((k-1)p))
%$$
%if and only if 
%$$
%h^0(K_C(-kp)) = h^0(K_C((-k+1)p)).
%$$
%This holds  if and only if there does \emph{not} exist a regular differential on $C$ with a zero of order exactly $k-1$ at $p$. 
%
%In sum, for each point $p\in C$ there exist exactly $g$ values of $k$ such that there does \emph{not} exist a rational function on $C$ with a pole of order exactly $k$ at $p$; these are called the \emph{gap values} of the point $p \in C$, and by the above they comprise exactly the vanishing sequence of the canonical series $|K_C|$ at $p$, shifted by 1. Note that the set of $k$ such that there \emph{does} exist a rational function on $C$ with a pole of order exactly $k$ at $p$, regular on $C \setminus \{p\}$---forms a subsemigroup of $\NN$, called the \emph{Weierstrass semigroup} of $p \in C$. Its complement in $\NN$ is the set of $g$ gap values.  

There is still much we don't know about Weierstrass points in general. Most notably, we don't know what semigroups of finite index in $\NN$ occur as Weierstrass semigroups; an example of Buchweitz shows that not all semigroups occur, but there are also positive results, such as the statement ([EH]) that every semigroup of weight $w \leq g/2$ occurs, and its refinement and strengthening in~\cite{MR3892968}).


\section{Flexes and bitangents are isolated}\label{isolated flexes and bitangents}

There are two results concerning the inflectionary behavior of a curve in projective space that we needed for the proof of the uniform position lemma in Chapter~\ref{uniform position}; we'll prove them here.

\subsection{Not every tangent line is a flex}\label{isolated tangents and bitangents}

\begin{lemma}\label{finite infections}
If $C \subset \PP^r$ is a smooth, irreducible and nondegenerate curve, then not every point of $C$ is an inflectionary point.
\end{lemma}

We'll prove this here for a smooth curve embedded in $\PP^r$, but the proof applies to any linear series on a curve.

\begin{proof}
To set this up, suppose that the inclusion $C \hookrightarrow \PP^r$ is given parametrically, in terms of a local coordinate $t$ on $C$, by a vector-valued function $v(t) \in \CC^{r+1}$. To say that a point $p \in C$ is an inflection point is to say that there is a hyperplane $H \subset \PP^r$ having contact of order $>r$ with $C$ at $p$, which is
precisely to say that the vectors $v(p), v'(p), \dots, v^{(r)}(p)$ lie in a hyperplane, that is, are linearly dependent. To say that every point is inflectionary says that this holds for all $p \in C$; that is,
$$
v(p) \wedge v'(p) \wedge \dots \wedge v^{(r)}(p) \; \equiv \; 0.
$$
Now let $k$ be the smallest integer such that
$$
v(p) \wedge v'(p) \wedge \dots \wedge v^{(k)}(p) \; \equiv \; 0,
$$
so that the vectors $v(p), v'(p), \dots, v^{(k-1)}(p)$ span a $k$-plane $\Lambda \subset \CC^{r+1}$, and $v^{(k)}(p) \in \Lambda$.

When we take the derivative of the wedge product $v(p) \wedge v'(p) \wedge \dots \wedge v^{(k)}(p)$ by applying the product rule we see that the first $k$ terms are automatically zero because they contain a repeated factor; it follows that
$$
v(p) \wedge v'(p) \wedge \dots \wedge v^{(k-1)}(p)\wedge v^{(k+1)}(p) \equiv 0,
$$
so that $v^{(k+1)}(p) \in \Lambda$ as well. Indeed, as we continue to take derivatives, we see in each case that all but one term is automatically zero, and we deduce that \emph{$v^{(l)}(p) \in \Lambda$ for all $l$}; in characteristic 0 this says that $C$ lies in a $(k-1)$-plane in $\PP^r$, contradicting the hypothesis of nondegeneracy.
\end{proof}

 \subsection{Not every tangent is bitangent}
 
 This statement seems even more obvious than Lemma~\ref{finite infections} above, but---like that lemma---is false in characteristic $p$!
 
 \begin{lemma}\label{tangent not bitangent}
 Let $C \subset \PP^r$ be a smooth, irreducible, nondegenerate curve, with $r > 1$. If $p \in C$ is a general point, then the tangent line $\TT_p(C) \subset \PP^r$ is not tangent to $C$ at any other point.
 \end{lemma}
 
 \begin{proof}
 To set this up, we introduce the variety parametrizing bitangents: we set
 $$
 \Sigma := \{ (p,q) \in C \times C \mid p \neq q \text{ and }\TT_p(C) = \TT_q(C) \}
 $$
 Our goal is to say that the projection maps $\Sigma \to C$ are not dominant; suppose instead that they are, and let $(p,q) \in \Sigma$ be a general point. Since $\Sigma$ cannot contain an open subset of a fiber, a local coordinate $t$ on $\Sigma$ at the point $(p,q)$ will serve as a local coordinate on $C$ at both $p$ and $q$; that is, we can write neighborhoods of $p$ and $q \in C$ parametrically via vector-valued functions $v(t)$ and $w(t) \in \CC^{r+1}$. The statement that the tangent lines to $C$ at the points $v(t)$ and $w(t)$ are equal then says that the vectors $v(t), v'(t), w(t)$ and $w'(t)$ all lie in a 2-dimensional subspace of $\CC^{r+1}$; in particular,
 $$
 v(t) \wedge v'(t) \wedge w(t) \equiv 0 \quad \text{and likewise} \quad v(t) \wedge w(t) \wedge w'(t) \equiv 0
 $$
We proceed now exactly as in the proof of Lemma~\ref{finite infections}: taking derivatives, we see that \emph{all derivatives of $v(t)$ at $t=0$ lie in a subspace $\Lambda$}, and hence $r=1$.
 \end{proof}

Note: it's much less clear whether it can be the case that a general tangent line to $C$ can intersect $C$ in a point other than $p$, except of course in case $r=2$. %See~\cite{} for results on this question.
%\fix{Joe will write to Noam to ask for a reference.}

\section{Finiteness of the automorphism group}\label{finiteness section}


\begin{theorem}\label{finite autos}
If $C$ is a smooth curve of genus $\geq 2$ then the automorphism group $\Aut(C)$ is finite.
\end{theorem}

  The idea behind the argument is simple: because the Weierstrass points of a curve $C$ are intrinsically defined, \emph{any automorphism of $C$ must carry Weierstrass points to Weierstrass points}. We will show that the subgroup of $Aut(C)$ of automorphisms of $C$ that fix each  of the finitely many Weierstrass point is either
  trivial or, in the case of hyperelliptic curves, just the $\ZZ/2$ generated by the hyperelliptic involution.
    
We will study the fixed points of automorphisms by studying the intersection of the graph of
an automorphism with the diagonal divisor in $C\times C$. For this we use
\emph{Neron-Severi group} $N(S)$ of a surface $S$. This consists of divisors modulo \emph{numerical equivalence}---that is, in $N(S)$ we identify divisors $H, H'$ if for all divisors $D$ on $S$ we have $H\cdot D = H'\cdot D$. The group
$N(S)$ is a  finitely generated free abelian group for any surface---in characteristic 0 it is a subgroup of the quotient of the second integral homology group by the torsion elements. Its rank is called the \emph{Picard number} of the surface. The result about $N(S)$ that we need is:

\begin{theorem}[Hodge Index theorem]\label{hodge index}
If $H\subset S$ is an ample divisor on a smooth projective surface, and $D \neq 0 \in N(S)$ is a divisor class with $D\cdot H = 0$, then 
$D^2<0$; that is, the intersection pairing is negative definite on the orthogonal complement of an
ample divisor.
\end{theorem}
\begin{proof}
The result follows easily from the Riemann-Roch theorem for surfaces; see \cite[Theorem V.1.9]{Hartshorne1977}.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{finite autos}]
 
The following two lemmas prove Theorem~\ref{finite autos} in a strong form:

\begin{lemma}Let $C$ be a smooth projective curve of genus $g \geq 2$, and $f: C \to C$ an automorphism of $C$.
\begin{enumerate}
\item If $f$ has $2g+3$ or more distinct fixed points, then $f$ is the identity; and
\item If $f$ has $2g+2$ distinct fixed points, then either $f$ is the identity or $C$ is hyperelliptic and $f$ is the hyperelliptic involution.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $S = C\times C$, and let $\Delta$ and $\Gamma \subset S$ be the diagonal and the graph of $f$ respectively, and let $\Phi_1$ and $\Phi_2 \subset S$ be fibers of the two projection maps. Let $\delta, \gamma, \varphi_1$ and $\varphi_2$ be the classes of these curves in  $N(S)$. The number of fixed points of $f$ (counted with multiplicities) is the intersection number  $b = \delta \cdot \gamma$.

We know all the other pairwise intersection number of these classes: the ones involving $\varphi_1$ or $\varphi_2$ are obvious. The normal bundle of the diagonal is the tangent bundle of $C$, so
$$
\delta^2 = 2 - 2g.
$$
Since the automorphism $id_C \times f : C\times C \to C \times C$ carries $\Delta$ to $\Gamma$, we see that $\gamma^2 = 2-2g$ as well.

We can now apply the index theorem for surfaces to deduce our inequality. To keep things relatively simple, let's introduce two new classes: set
$$
\delta' = \delta - \varphi_1 - \varphi_2 \quad \text{and} \quad \gamma' = \gamma - \varphi_1 - \varphi_2,
$$
so that $\delta'$ and $\gamma'$ are orthogonal to the class $\varphi_1 + \varphi_2$. Since $\varphi_1 + \varphi_2$ has positive self-intersection, the index theorem  tells us that the intersection pairing must be negative definite on the span $\langle \delta',\gamma' \rangle \subset N(S)$. In particular, the determinant of the intersection matrix
\begin{center}
\begin{tabular}{c|c|c}
& $\delta'$ &  $\gamma'$  \\
\hline
$\delta'$ & $-2g$ & $b-2$ \\
\hline
$\gamma'$ & $b-2$ & $-2g$ 
\end{tabular}
\end{center}
(where again $b = \gamma \cdot \delta$) is nonnegative, or equivalently, $b\leq 2g+2$.
\end{proof}

Having established an upper  bound on the number of fixed points an automorphism $f$ of $C$ (other than the identity) may have, it remains to find a lower bound on the number of distinct Weierstrass points; this is the content of the next lemma.


\begin{lemma}
If $C$ is a smooth projective curve of genus $g \geq 2$, then $C$ has at least $2g+2$ distinct Weierstrass points; and if it has exactly $2g+2$ Weierstrass points it is hyperelliptic.
\end{lemma}

\begin{proof}
Let $p \in C$ be any point, and $w_1=w_1(p),\dots,w_g = w_g(p)$ the ramification sequence of the canonical series $|K_C|$ at $p$. By definition, 
$$
h^0(K_C(-(w_i+i)p)) = g - i.
$$
Applying Clifford's theorem we have
$$
g-i \leq \frac{2g - 2 - w_i - i}{2} + 1;
$$
solving, we see that
$$
w_i \leq i
$$
and hence
$$
w_p \leq \binom{g}{2}
$$
where $w_p$ is the total weight of $p$ as a Weierstrass point. Since the total weight of the Weierstrass points on $C$ is $g^3-g$ by the Pl\"ucker formula~\ref{***}, we see that the number of distinct Weierstrass points must be at least
$$
\frac{g^3-g}{\binom{g}{2}} = 2g+2.
$$
Finally, by the strong form of Clifford's Theorem \ref{***}, equality implies that the curve is hyperelliptic.\end{proof}


\end{proof}

\section{Inflections of linear series on $\PP^1$}

We are in a position to describe all possible inflectionary behavior of linear series on $\PP^1$. We will do this both because it's a natural question to ask, and because it will provide the essential ingredient in our proof of the Brill-Noether theorem in the next chapter.

Our approach to this question is straightforward: If we embed $\PP^1$ in $\PP^d$ as a rational normal curve $C$, any $g^r_d$ on $\PP^1$ will be the linear system cut out on $C$ by hyperplanes containing a fixed $(d-r-1)$-plane $\Lambda$, and the inflectionary behavior of the $g^r_d$ is determined by how $\Lambda$ intersects various \emph{osculating spaces} (defined below) to $C$.

In order to carry this out, we need to introduce the notion of \emph{Schubert cycles}, subvarieties of Grassmannians that are central to our discussion. We'll do that in the following section; then, once we've established the  definitions of and basic facts about Schubert cycles we'll come back and use this to answer almost completely the question of inflectionary behavior of linear series on $\PP^1$.

\subsection{Schubert cycles}

Let $G = \GG(k, d)$ be the Grassmannian of $k$-planes $\PP^k \subset \PP^d$, or equivalent the Grassmannian $G(k+1,d+1)$ of $(k+1)$-dimensional subspaces of a $(d+1)$-dimensional vector space $V$.
(In the applications, we'll want to think of it in the projective setting, but for now it will be clearer to work in the context  of vector spaces.) We start with a basic definition:

\begin{definition}
By a \emph{flag} $\cal V$  in $V$ we will mean a nested sequence of vector spaces
$$
0 \subset V_1 \subset V_2 \subset \dots \subset V_d \subset V_{d+1} = V.
$$
with $\dim V_i = i$.
\end{definition}

Now, suppose we are given a flag in $V$. If $\Lambda \subset V$ is any $(k+1)$-plane, we can associate to it a nested sequence of $d+1$ subspaces of $\Lambda$:
$$
0 \; \subset \; \Lambda \cap V_1 \; \subset \;  \Lambda \cap V_2 \; \subset \;  \dots \; \subset \;  \Lambda \cap V_d \; \subset \;  \Lambda \cap V_{d+1} = \Lambda
$$
Note that in this sequence, each term is either equal to the preceding one, or of dimension 1 greater; the former will occur $d-k$ times, and the latter $k+1$ times. For a general $(k+1)$-plane $\Lambda$, the jumps occur at the end; that is, we have $\Lambda \cap V_{d-k} = 0$, and thereafter the dimension of the intersection goes up by 1 each time. For any sequence $a_1,\dots, a_{k+1}$, accordingly, we consider the locus of planes $\Lambda$ for which the $i$th jump occurs $a_i$ steps early; unwinding this, we arrive at the

\begin{definition}
Let ${\bf a} = (a_1,\dots,a_{k+1})$ be a sequence of integers with $n-k \geq a_1 \geq a_2 \geq \dots \geq a_{k+1} \geq 0$.
The \emph{Schubert cycle $\Sigma_{\bf a}({\cal V}) \subset G$} is defined to be
$$
\Sigma_{\bf a}({\cal V}) \; := \; \left\{ \Lambda \in G \mid \dim(\Lambda \cap V_{d-k+i-a_i}) \geq i \; \forall i \right\}
$$
\end{definition}

One note about notation: in general, the definition of the Schubert cycle $\Sigma_{\bf a}({\cal V}) \subset G$ involves only a subset of the linear spaces $V_i$ in the flag $\cal V$; in many instances, it involves only one element $V_i$ of the flag. In such a case, we will sometimes write $\Sigma_{\bf a}(V_i)$ in place of $\Sigma_{\bf a}({\cal V})$.

\begin{exercise}
Show that the codimension of $\Sigma_{\bf a}({\cal V})$ in $G$ is equal to $\sum a_i$.
\end{exercise}

By way of language, a sequence ${\bf a} = (a_1,\dots,a_{k+1})$ of integers with $n-k \geq a_1 \geq a_2 \geq \dots \geq a_{k+1} \geq 0$ is called a \emph{Schubert index}. The codimension $\sum a_i$ of $\Sigma_{\bf a}({\cal V})$ in $G$ is denoted $|{\bf a}|$.

One more thing to observe is that we have a natural isomorphism $\phi$ between the Grassmannian $G(k+1, V)$ of $(k+1)$-planes in a $(d+1)$-dimensional vector space $V$, and the Grassmannian  $G(d-k, V^*)$ of $(d-k)$-planes in  the dual vector space $V^*$, sending a subspace $\Lambda \subset V$ to its annihilator in $V^*$. This isomorphism carries Schubert cycles in $G(k+1, V)$ defined relative to a flag $\cal V$ to Schubert cycles in $G(d-k, V^*)$ defined relative to the dual flag ${\cal V}^*$, but with different indices.

To describe the correspondence between Schubert indices,
suppose that ${\bf a} = (a_1,\dots, a_{k+1})$ is a Schubert index in $G(k+1, V)$; that is, we have $n-k \geq a_1 \geq a_2 \geq \dots \geq a_{k+1} \geq 0$. We define the \emph{transpose} Schubert index to be the sequence ${\bf b} = (b_1,\dots, b_{n-k})$ given by 
$$
b_j \; := \; \#\{ i \mid a_i \geq j \};
$$
we'll write ${\bf a}^*$ for the transpose Schubert index of $\bf a$.

\begin{exercise} If ${\bf a}^*$ is the transpose Schubert index to $\bf a$,
\begin{enumerate}
\item  Show that $|{\bf a}^*| = |{\bf a}|$
\item Show that $({\bf a}^*)^* = {\bf a}$
\item Show that the isomorphism $\phi : G(k+1, V) \rTo^\cong G(n-k, V^*)$ carries the Schubert cycle $\Sigma_{\bf a}({\cal V})$ to the Schubert cycle $\Sigma_{{\bf a}^*}({\cal V}^*)$.
\end{enumerate}
(Of course, the first two parts follow from the third; think of the first two as warmups.)
\end{exercise}

% $n-k \geq a_1 \geq a_2 \geq \dots \geq a_{k+1} \geq 0$
%
%or any Schubert index ${\bf a} = (a_1,\dots,a_{k+1})$ in $G(k+1, V)$, the Schubert cycle $\Sigma_{\bf a}({\cal V})$ is carried into the Schubert cycle $\Sigma_{\bf b}({\cal V}^*)$, where $\bf b$ is what's called the \emph{transpose} Schubert index of $\bf a$; this can be defined by
%$$
%b_i = \#\{ j : a_j \geq i \}
%$$

There are a couple immediate observations. First, since the set of all flags $\cal V$ is a rational variety, the class of $\Sigma_{\bf a}({\cal V})$ in either the Chow ring or the cohomology ring of the Grassmannian $G$ (they're the same) does not depend on $\cal V$; this class is typically denoted $\sigma_{\bf a}$. Second, and less obviously, \emph{the classes $\sigma_{\bf a}$ form a basis for the Chow ring of $G$}. Thus a complete description of the Chow ring of $G$ is given by expressing the product $\sigma_{\bf a} \cdot \sigma_{\bf b}$ as a linear combination of Schubert classes; this is called the \emph{Schubert calculus}. We will give one example of this in \emph{Pieri's formula} (Proposition~\ref{Pieri} below); for Schubert calculus in general, the literature is vast.



\subsection{Special Schubert cycles and Pieri's formula}

To give an example of the Schubert calculus, and also for applications in the next chapter, we mention one classical formula.

To begin with, a \emph{special Schubert cycle} is a Schubert cycle of the form $\Sigma_{\bf a}({\cal V})$ with 
$a_2=\dots = a_{k+1} = 0$; that is
$$
\Sigma_a({\cal V})  \; := \; \left\{ \Lambda \in G \mid \Lambda \cap V_{n-k+1-a} \neq 0 \right\}
$$

Pieri's formula is an explicit formula for the product of an arbitrary Schubert class with a special Schubert class; to wit,
\begin{proposition}\label{Pieri}
If $\sigma_a$ is a special Schubert class and $\sigma_{\bf b}$ is an arbitrary Schubert class, then
$$
\sigma_a \cdot \sigma_{\bf b} \; = \; \sum \sigma_{\bf c}
$$
where the sum ranges over all indices ${\bf c} = (c_1, \dots c_{k+1})$ with
$$
\sum c_i = a + \sum b_i \quad \text{and} \quad b_i \leq c_i \leq b_{i-1} \text{ for all } i
$$
\end{proposition}

To understand what this is saying, imagine we represent the Schubert class $\sigma_{\bf b}$ by stacks of coins, with $b_1$ coins in the first stack, $b_2$ coins in the second stack, and so on. We now want to add a total of $a$ coins to the stacks; we can add any number of them to any stack (including a stack that was previously empty), with the one condition that the new height of each stack can't be larger than the previous height of the stack to its left. This interpretation makes the following corollary clear:

\begin{corollary}
If $\sigma_a$ is any special Schubert class  and $\sigma_{\bf b}$ any Schubert class with $l a + \sum b_i \leq \dim G$, the product  $(\sigma_a)^l \cdot \sigma_{\bf b} \neq 0$.
\end{corollary}

This is all the Schubert calculus we'll need for the applications we have in mind. For an account of basic Schubert calculus, see~\cite{3264}.

\subsection{Osculating flags}

We now want to relate the discussion above to inflection points of linear series on $\PP^1$.  To start with, let's introduce the notion of the \emph{osculating flag} to a curve at a point.

We'll do this first for a rational normal curve $C \subset \PP^d$. Here things are straightforward: for any point $p \in C$ and any $m \leq d+1$, we've seen that the span $\overline{mp}$ is an $(m-1)$-plane in $\PP^d$; thus we have a flag of linear subspaces
$$
\{p\} \subset \overline{2p} \subset \overline{3p} \subset \dots \subset \overline{dp} \subset \overline{(d+1)p} = \PP^d
$$
which we call the \emph{osculating flag} to $C$ at $p$. Note that the second term $\overline{2p}$ is the tangent line to $C$ at $p$; in general, the $k$-plane $\overline{(k+1)p}$ is called the \emph{osculating $k$-plane to $C$ at $p$}.

Though we'll only be using this construction on rational normal curves, it's worth pointing out that we can define the osculating flag to any nondegenerate curve $C \subset \PP^d$ at any smooth point. Here it may no longer be the case that $\overline{mp}$ is an $(m-1)$-plane, but we can look at the nested sequence of subspaces
$$
\{p\} \subset \overline{2p} \subset \overline{3p} \subset \dots 
$$
and pick out exactly the terms whose dimension is strictly greater than the preceding one; we arrive in this way at the full flag
$$
\{p\} \subset \overline{b_2p} \subset \overline{b_3p} \subset \dots \subset \overline{b_{d+1}p} = \PP^d
$$
Note that if the point $p$ is not an inflectionary point, this is just the flag $\{\overline{mp}\}_{m=1}^d$; in general, we have the 

\begin{exercise}
Show that the sum $\sum b_i - i$ is equal to the weight of the point $p$ as an inflectionary point of the hyperplane series.
\end{exercise}

Let's now see what all this says about inflectionary behavior of $g^r_d$s on $\PP^1$. To set this up, first embed $\PP^1$ in $\PP^d$ as a rational normal curve $C \subset \PP^d$. For any $(d-r-1)$-plane $\Lambda \subset \PP^d$, let $V_\Lambda$ be the linear series cut on $C$ by hyperplanes in $\PP^d$ containing $\Lambda$. (Note that if $\Lambda \cap C \neq \emptyset$, the linear series $V_\Lambda$ will have base points; we do not throw those away, since we want $V_\Lambda$ to always be a $g^r_d$.) All $g^r_d$s on $\PP^1$ are given in this way.

Now let $p \in C$ be any point, and let $\cal V$ be the osculating flag to $C$ at $p$. It is reasonable to expect that the ramification sequence of the linear series $V_\Lambda$ at $p$ is related to whether $\Lambda$ lies in a Schubert cycles relative to the osculating flag to $C$ at $p$, and indeed the relationship is simple:

\begin{proposition}\label{ramification}
Let ${\bf a}$ be a Schubert index in the Grassmannian $G(d-r, d+1)$; that is ${\bf a} = (a_1, \dots a_{d-r})$ with $r+1 \geq a_1 \geq \dots \geq a_{d-r} \geq 0$, and let ${\bf a}^*$ be the transpose Schubert index. If $\cal V$ is the osculating flag to the rational normal curve $C \subset \PP^d$ at a point $p$,
then for any $(d-r-1)$-plane $\Lambda \subset \PP^d$, 
$$
\Lambda \in \Sigma_{\bf a}({\cal V}) \; \iff \; \alpha_i(V_\Lambda, p) \geq {\bf a}^*_{r+1-i}.
$$
\end{proposition} 

In other words, the ramification sequence $\alpha(V_\Lambda, p)$ of the linear series $V_\Lambda$ at $p$ is exactly the transpose of the Schubert index of the smallest Schubert cycle containing $\Lambda \in G(d-r, d+1)$, in reverse order.

\subsection{Conclusions}

The assertions made in the last section may seem like elementary restatements of obvious facts. But when we combine them with the Pl\"ucker formula, we can derive some fairly striking results, both about the existence (or non-existence) of linear series with specified ramification, and about the transversality of intersection of Schubert cycles in the Grassmannian.

The first theorem is a direct consequence of the Pl\"ucker formula:

\begin{theorem}\label{osculating intersection}
Let $p_1,\dots,p_\delta \in C$ be any points on a rational normal curve $C \subset \PP^d$, and ${\cal V}^1, \dots, {\cal V}^\delta$ the corresponding osculating flags. If ${\bf a}^1, \dots, {\bf a}^\delta$ are any $\delta$ Schubert indices, the Schubert cycles $\Sigma_{{\bf a}^1}({\cal V}^1), \dots, \Sigma_{{\bf a}^\delta}({\cal V}^\delta) \subset G(d-r, d+1)$ intersect properly.
\end{theorem}

Note that this does not depend on the choice of points $p_i$!

\begin{proof}
We start with the case
$$
\sum_{i=1}^\delta |{\bf a}^i| \; > \; (r+1)(d-r) = \dim G(d-r, d+1);
$$
in this case we have to show the intersection of the Schubert cycles $\Sigma_{{\bf a}^i}({\cal V}^i)$ is empty. But now suppose we had a $(d-r-1)$-plane 
$$
\Lambda \; \in \; \bigcap_{i=1}^\delta \Sigma_{{\bf a}^i}({\cal V}^i),
$$
and consider the linear series $V_\Lambda$ cut by hyperplanes containing $\Lambda$. By Proposition~\ref{ramification}, the weight of $p_i$ as an inflectionary point of $V_\Lambda$ is at least $|{\bf a}^i|$, so that the sum of the weights of the points $p_1,\dots,p_\delta$ is strictly greater than $(r+1)(d-r)$ by hypothesis. But the Pl\"ucker formula says that the sum of the weights of $V_\Lambda$ at \emph{all} inflectionary points of $C$ is equal to  $(r+1)(d-r)$, so we have a contradiction.

Next, we can deduce the general case from the above. To do this, we make use of the fact that the Schubert cycle $\Sigma_1$ is a hyperplane section of the Grassmannian $G(d-r, r+1)$, so that if $\Phi \subset G$ is any subvariety of dimension $m$, its intersection with $m$ Schubert cycles $\Sigma_1$ is nonempty. Thus, if the intersection
$$
\bigcap_{i=1}^\delta \Sigma_{{\bf a}^i}({\cal V}^i)
$$
had dimension strictly bigger than the expected
$$
\rho \; := \; (r+1)(d-r) - \sum_{i=1}^\delta |{\bf a}^i|,
$$
we could simply choose $\rho + 1$ additional points $q_1,\dots,q_{\rho + 1}$ on $C$, with osculating flags ${\cal W}^1, \dots, {\cal W}^{\rho + 1}$ and throw in the Schubert cycles $\Sigma_1({\cal W}^i)$. We would then have a nonempty intersection of Schubert cycles defined relative to osculating flags to $C$ and having total codimension strictly greater than $(r+1)(d-r)$, contradicting the first part.
\end{proof}

We will use this to prove a sort of converse, asserting the existence of linear series on $\PP^1$ with specified ramification, but first we want to mention one consequence of Theorem~\ref{osculating intersection}. First, a definition: given a curve $C \subset \PP^d$, we say that a \emph{secant flag} in $\PP^d$ is a flag
$$
0 \subset V_1 \subset V_2 \subset \dots \subset V_{d-1} \subset V_d = \PP^d
$$
where each $V_i$ is spanned by its (scheme-theoretic) intersection with $C$. In other words, there is a sequence of points $p_1, p_2, \dots, p_{d+1} \in C$ such that
$$
V_i \; = \; \overline{p_1+p_2+ \dots + p_{i+1}}
$$
(An osculating flag is just the special case where all $p_i$ are equal.) Since any secant flag can specialize to an osculating flag, we can deduce the

\begin{corollary}\label{secant schubert proper}
Schubert cycles defined relative to \emph{general} secant flags to a rational normal curve intersect properly.
\end{corollary} 

\begin{exercise}
Show by example that Schubert cycles defined relative to arbitrary secant flags to a rational normal curve may fail to intersect properly. (Hint: it's enough to look at the case $d=2$ and $r=1$.)
\end{exercise}

Finally, we can use all of the above to answer the question of existence of $g^r_d$s on $\PP^1$ with specified ramification. To state it, suppose we are given a collection of distinct points $p_1,\dots,p_\delta \in \PP^1$, and for each point $p_i$ a possible ramification sequence
$$
\alpha^i = (\alpha^i_0, \alpha^i_1, \dots, \alpha^i_r) \quad \text{with} \quad 0 \leq \alpha^i_0 \leq \alpha^i_1 \leq \dots \leq \alpha^i_r \leq d-r.
$$
Let ${\bf a}^i$ be this sequence in reverse (and relabelled); that is
$$
{\bf a}^i \; = \; (\alpha^i_r, \alpha^i_{r-1}, \dots, \alpha^i_1, \alpha^i_0)
$$
and finally let ${\bf b}^i$ be the transpose of the Schubert index ${\bf a}^i$. We have then the

\begin{theorem}
There exists a $g^r_d$ on $\PP^1$ with ramification sequence at $p_i$ equal to $(\alpha^i_0, \alpha^i_1, \dots, \alpha^i_r)$ if and only if 
$$
\prod_{i=0}^\delta  \sigma_{{\bf b}^i} \; \neq \; 0 \quad \text{in} \quad A^*(G(d-r, r+1)).
$$
\end{theorem}

\begin{proof}
Our arguments so far show the existence of a $g^r_d$ on $\PP^1$ with ramification sequence greater than or equal to $\alpha^i$ at $p_i$. But by Theorem~\ref{osculating intersection}, the ones with ramification strictly greater than $\alpha^i$ form a family of strictly smaller dimension. Thus a general $g^r_d$ with ramification sequence greater than or equal to $\alpha^i$ at $p_i$ will have  ramification sequence exactly equal to $\alpha^i$ at $p_i$
\end{proof}


\input{footer}