\input header.tex

\chapter{Jacobians}


Up to now, we have been treating line bundles on a curve $C$ individually. It is a fundamental fact, however, that the set of line bundles/linear equivalence classes of divisors of a given degree $d$ on $C$ is naturally parametrized by the points of a variety, called the \emph{Picard variety} and denoted ${\rm Pic}^d(C)$. Many of the deeper results about linear systems on $C$ are expressed in terms of the geometry of this variety, and indeed the simple fact of its existence is the key to proving many theorems about linear systems on curves (see for example Theorem~\ref{g+3 theorem}
below).

In this chapter, we will describe the construction of these varieties, and their relationship with the spaces parametrizing effective divisors of a given degree $d$ on $C$. We then exhibit some of the consequences of these constructions.

\section{Jacobians}

We start with the construction of a classical object, the \emph{Jacobian} $J(C)$ of a curve $C$, via the notion of \emph{abelian integrals}. This necessitates that we work over the complex numbers $\CC$, and it produces a complex manifold rather than an algebraic variety, but has the virtue of being relatively concrete. The Jacobian $J(C)$ is in fact a projective variety, and may be constructed purely algebraically---so that, for example, if the curve $C$ is defined over a given field $K$ then $J(C)$ will be as well. (Indeed, the search for such a construction was one of the driving forces of algebraic geometry in the first half of the 20th century, giving rise ultimately to the notion of abstract algebraic varieties.) We will not do that here, though; the interested reader can find an account in \cite{??s} [Kleiman must have something for this].

The goal of the 19th century mathematicians who first described abelian integrals was simply to make sense of integrals of algebraic functions. Very briefly: in the early development of calculus, mathematicians figured out how to evaluate explicitly integrals such as
$$
\int_{t_0}^t \frac{dx}{\sqrt{x^2+1}}.
$$
To describe the solution in algebrao-geometric terms, the idea was that such integrals could be thought of as path integrals of meromorphic differentials on the Riemann surface associated to the equation $y^2 = x^2+1$. This surface is isomorphic to $\PP^1$, meaning that $x$ and $y$ could be expressed as rational functions of a single variable $z$; making the corresponding change of variables transformed the integral into one of the form
$$
\int_{s_0}^s R(z)dz,
$$
with $R$ a rational function, and such integrals are readily evaluated by the technique of partial fractions.

When they tried to extend this to similar-looking integrals like
$$
\int_{t_0}^t \frac{dx}{\sqrt{x^3+1}},
$$
however, they were stymied. The reason gradually emerged: the problem is that the Riemann surface associated to the equation $y^2 = x^3+1$ is not $\PP^1$, but rather a curve of genus 1. In particular  the integral depended on a choice of path; that is, it was defined only modulo a lattice $\ZZ^2 \subset \CC$. This meant, among other things, that the inverse function would be a doubly periodic meromorphic function on $\CC$, and not an elementary function. This led to the introduction of a host of new special functions, such as the Weierstrass $\sP$-function.

The next step was to try to extend this theory to path integrals of holomorphic differentials on curves of arbitrary genus. One problem is that the dependence of the integral on the choice of path is much worse; the set of homology classes of paths between two points $p_0, p \in C$ is identified with $H_1(C,\ZZ) \cong \ZZ^{2g}$ rather than $\ZZ^2$. The solution to this is to consider the integral of \emph{all} holomorphic differentials on $C$ simultaneously, rather than one at a time.

To express the resulting construction in relatively modern terms, let $C$ be as above a smooth projective curve of genus $g$ over $\CC$, and consider the space $V = H^0(K_C)^*$ of linear functions of the space of holomorphic differentials. Integration over closed loops in $C$ defines a linear function on 1-forms, so that we have a map
$$
H_1(C,\ZZ) \; \to \;  H^0(K_C)^*.
$$
Using fairly basic Hodge theory, we can see that \emph{this map is injective, with image a discrete, cocompact lattice $\Lambda \subset V$}; we define the \emph{Jacobian} $J(C)$ of $C$ to be the quotient
$$
J(C) \; = \; V/\Lambda.
$$
(As we said, $J(C)$ is in fact an abelian variety, though for any of the applications we have in mind here we don't need to know that; it's sufficient to know that $J(C)$ is a complex torus of dimension $g$.) The point of this construction is that for any pair of points $p, q \in C$, the expression $\int_q^p$ describes a linear functional on $H^0(K_C)$, defined up to functionals obtained by integration over closed loops, and thus a point of $J(C)$. Thus, for example, if we fix the point $q$, we get a holomorphic map
$$
\mu \; : \; C \; \to \; J(C).
$$
This is an example of what is called an \emph{Abel-Jacobi map}.

To fully utilize this, we want to extend it from points  to divisors on $C$, and to do this we need to find a space parametrizing effective divisors on $C$. This is readily available: since an effective divisor of degree $d$ on $C$ is an unordered $d$-tuple of points on $C$, with repetitions allowed, it corresponds to a point in the \emph{$d$th symmetric power} $C_d$ of $C$, defined to be the quotient of the ordinary product $C^d$ by the action of the symmetric group $\Sigma_d$ on $d$ letters. This is a smooth, $d$-dimensional projective variety. Having chosen a base point $q \in C$ as above, we get for each $d$ a map
$$
\mu_d \; : \; C_d \; \to \; J(C),
$$
defined by
$$
\mu_d(p_1 + \dots + p_d) \; = \; \sum \int_q^{p_i}.
$$
These are similarly called  Abel-Jacobi maps; when there is no ambiguity about $d$, we will denote them simply by $\mu$.

There is a lot to say about these maps; in the following sections, we'll see a description of their differentials, and show that they are birational onto their images for $d \leq g$ and surjective for $d \geq g$. (These statement in case $d=g$ form the celebrated \emph{Jacobi inversion theorem}.) But before we get into these, we should say what all this has to do with our main concern, the geometry of linear series on curves.

To this point, the discussion in this chapter might seem more at home in an advanced calculus text than in an algebraic geometry book. The connection is made by \emph{Abel's theorem}:

\begin{theorem}
Two divisors $D, D' \in C_d$ on $C$ are linearly equivalent if and only if $\mu(D) = \mu(D')$; in other words, the fibers of $\mu_d$ are exactly the complete linear systems of degree $d$ on $C$.
\end{theorem}

\begin{proof}[Half-proof]
One direction of Abel's theorem---the ``only if" part---is relatively elementary, and that is what we will prove here. (This was in fact the only part proved by Abel; the converse, which is substantially more subtle, was proved by Clebsch. See \cite{} [GH] for a proof.)

To prove the easy half of Abel's theorem, suppose that $D$ and $D'$ are linearly equivalent; that is, $\cO_C(D) \cong \cO_C(D')$. Call this line bundle $\cL$, and suppose that $D$ and $D'$ are the zero divisors of sections $\sigma, \sigma' \in H^0(\cL)$.
Taking linear combinations of $\sigma$ and $\sigma'$, we get a pencil $\{D_\lambda\}_{\lambda \in \PP^1}$ of divisors on $C$, with
$$
D_\lambda \; = \; V(\lambda_0\sigma + \lambda_1\sigma'),
$$
and this corresponds to a regular map $\alpha : \PP^1 \to C_d$. 

Consider now the composition
$$
\phi = \mu \circ \alpha \; : \; \PP^1 \; \to \; J(C).
$$
We observe that, since $J(C)$ is a complex torus, the global holomorphic 1-forms on $J(C)$ generate the cotangent bundle everywhere. But for any 1-form $\omega$ on $J(C)$, the pullback $\phi^*\omega$ is a global holomorphic 1-form on $\PP^1$, and hence identically zero. It follows that the differential $d\phi$ vanishes identically, and hence (since we are blessedly in characteristic 0) that $\phi$ is constant; thus $\mu(D) = \mu(D')$.
\end{proof}

Note that many of the statements about the Abel-Jacobi map made above follow immediately from Abel's theorem. For example, if  $D = p_1+\dots+p_d\in C_d$ is a general point and $d \leq g$, the points $p_i \in C$ are general and so impose independent conditions on $H^0(K_C)$; thus $h^0(K_C(-D)) = g-d$ and by Riemann-Roch $h^0(\cO_C(D)) = 1$. In other words, the fiber of $\mu_d$ containing $D$ consists just of the single point $D$, and so the map $\mu_d$ is birational onto its image. Similarly, if $d \geq g$, we will have $h^0(K_C(-D)) = 0$ and hence $h^0(\cO_C(D)) = d-g+1$; it follows that the fiber of $\mu_d$ through $D$ has dimension $d-g$, and hence that $\mu_d$ is surjective. In particular, when $d=g$ the map $C_g \to J(C)$ is a birational isomorphism; indeed, it was by using this isomorphism that Weil first gave an algebraic construction of $J(C)$.

To illustrate some of the power of Abel's theorem, we will use it to prove a basic result:

\begin{theorem}\label{g+3 theorem}
Let $C$ be a smooth projective curve of genus $g$, and $D \in C_{g+3}$ a general divisor of degree $g+3$ on $C$. Then $D$ is very ample; in particular, every curve of genus $g$ may be embedded in projective space as a curve of degree $g+3$.
\end{theorem}

This is, of course, a substantial improvement over our earlier result (\ref{****}) that every curve of genus $g$ may be embedded in projective space as a curve of degree $2g+1$. It is also sharp: hyperelliptic curves, for example, cannot be embedded in projective space as curves of any degree less than $g+3$. Nonetheless, we will see in Chapter~\ref{****} that we can improve on this: ``most" curves of genus $g$ can in fact be embedded in projective space as curves of degree $d = \lceil 3g/4 \rceil + 3$.

\begin{proof}
As we observed above, since $D$ is general of degree $g+3$ we have $h^0(\cO_C(D)) = 4$. To show that it is very ample, we have to show that
\begin{enumerate}
\item for any point $p \in C$, we have $h^0(\cO_C(D-p)) = 3$ (that is, $|D|$ has no base points, and so defines a regular map $\phi_D : C \to \PP^3$); and
\item for any pair of points $p, q \in C$, we have $h^0(\cO_C(D-p-q)) = 2$.
\end{enumerate}
The second of these assertions immediately implies the first, and this is what we will prove.

To do this, suppose on the contrary that for some pair of points $p, q \in C$ we have $h^0(\cO_C(D-p-q)) \geq 3$. It follows from Riemann-Roch that $h^0(K_C(-D + p + q)) \geq 1$; that is, $K_C -D + p + q$ is linearly equivalent to an effective divisor $E = r_1 + \dots + r_{g-3}$ of degree $g-3$.

Now consider the map
$$
\nu : C_{g-3} \times C_2 \; \to \; J(C)
$$
given by
$$
\nu : (E,F) \; \mapsto \; \mu(K_C) + \mu(E) - \mu(F),
$$
where the $+$ and $-$ on the right refer to the group law on $J(C)$. By what we have just said, and Abel's theorem, our divisor $D$ will fail to be very ample only if there exist effective divisors $F = p+q$ and $E = r_1+\dots+r_{g-3}$ such that $D \sim K_C +E-F$, that is, if
$\mu(D) \in {\rm Im}(\nu)$. But the source $C_{g-3} \times C_2$ of $\nu$ has dimension $g-1$, and so its image in $J(C)$ must be a proper subvariety; since $\mu_{g+3}$ is dominant, the image $\mu(D)$ of a general point $D \in C_{g+3}$ will be a general point of $J(C)$ and so will not lie in ${\rm Im}(\nu)$. It follows that $D$ is very ample, and gives an embedding of $C$ in $\PP^3$ as a curve of degree $g+3$.
\end{proof}

Thus Abel's theorem, which was born out of an effort to evaluate calculus integrals, winds up proving a basic fact in the theory of algebraic curves!

\

\

****A minor issue, but one that's bothering me: we said early on that we don't need to know that $J(C)$ is algebraic; for the present purposes, it's enough to know that $J(C)$ is a  complex torus of dimension $g$. But in that case we do need to know that if $f : X \to Y$ is a holomorphic map of compact complex manifolds with $\dim X < \dim Y$, then $f(X)$ is a proper analytic subvariety of $Y$. Should this bother us?****

trivial change to Jacobians

\section{Picard varieties}

\section{Differential of the Abel-Jacobi map}

In this section we will describe the differential $d\mu$ of the Abel-Jacobi map $\mu : C_d \to J(C)$; this turns out to be pretty straightforward, but yields among other things a sharper form of Abel's theorem.

To start, suppose $D = p_1 + \dots + p_d$ is a divisor consisting of $d$ distinct points on our curve $C$. Since the quotient map $C^d \to C_d$ is unramified at $D$, the tangent space to $C_d$ at the point $D$ is naturally identified with the tangent space to $C^d$ at $(p_1,\dots,p_d)$; that is, the direct sum of the tangent spaces to $C$ at the points $p_i$:
$$
T_D(C_d) = \bigoplus T_{p_i}(C).
$$
On the other hand, the tangent space to $J(C)$ at the image point $\mu(D)$ is simply the vector space $H^0(K_C)^*$ of which $J(C)$ is a quotient (as it is at every point!). The differential $d\mu_D$ is thus a linear map
$$
\bigoplus T_{p_i}(C) \rTo H^0(K_C)^*,
$$
and the transpose of this a linear map
$$
H^0(K_C) \rTo \bigoplus T^*_{p_i}(C).
$$
This last map is easy to describe: since the map $\mu$ is given by 
$$
\mu_d(p_1 + \dots + p_d) \; = \; \sum \int_q^{p_i},
$$
we can simply differentiate under the integral sign to conclude that \emph{the codifferential $d_\mu^*$ is the map}
\begin{align*}
H^0(K_C) &\to \bigoplus T^*_{p_i}(C) \\
\omega &\mapsto (\omega(p_1), \dots, \omega(p_d).
\end{align*}

There is a natural extension of this to the case of non-reduced divisors $D$, that is, divisors with repeated points. We need here a description of the tangent space to $C_d$ at the point $D$, and to this end we have the

\begin{proposition}\label{symmetric product tangent space}
The tangent and cotangent spaces to $C_d$ at the point corresponding to an arbitrary divisor $D = \sum a_ip_i$ are naturally identified with $H^0(\cO_C(D)/\cO_C)$ and $H^0(K_C/K_C(-D))$ respectively.
\end{proposition}

Note that we have a natural pairing between the spaces $H^0(\cO_C(D)/\cO_C)$ and $H^0(K_C/K_C(-D))$, given by sending $(f, \omega)$ to $\sum_i Res_{p_i}(f\omega)$. Note also that the term ``natural" has a precise meaning here: if we let 
$$
\cD = \{ (D, p) \in C_d \times C \; \mid \; p \in D \}
$$
be the universal effective divisor of degree $d$ on $C$, the proposition says that the cotangent sheaf $T^*_{C_d}$ is the direct image $\alpha_*(\beta^*K_C/\beta^*K_C(-\cD))$, where $\alpha$ and $\beta$ are the projections of $C_d \times C$ onto the two factors.

If you wanted to see an argument for Proposition~\ref{symmetric product tangent space} done out in coordinates (you really don't, but if you did) you could find it in [ACGH].

In any event, given Proposition~\ref{symmetric product tangent space}, we can extend our earlier statement to the

\begin{proposition}\label{differential of Abel-Jacobi}
The codifferential $d\mu^*$ of the Abel-Jacobi map is simply the natural restriction map
$$
H^0(K_C) \rTo H^0(K_C/K_C(-D)).
$$
\end{proposition}

Now, note that the codimension of the image of $d\mu^*$---equivalently, the dimension of the kernel of the differential $d\mu$---is by the geometric Riemann-Roch theorem exactly the dimension of the fiber of $C_d$ over the point $\mu(D) \in J(C)$. In other words, the fibers of $\mu$ are smooth, and in particular reduced. Thus we can think of Proposition~\ref{differential of Abel-Jacobi} as a strengthening of the Abel-Clebsch theorem: while Abel and Clebsch show that the fibers of $\mu$ are complete linear series set-theoretically, we see from the above that it is in fact true scheme-theoretically.

\section{Further consequences}

One consequence of the description of the Jacobian and the Abel-Jacobi map of a curve $C$ is that \emph{the set of linear series on $C$ of given degree $d$ and dimension $r$ can be given the structure of a scheme in its own right}.

To start with, we can define $W^r_d(C) \subset \Pic^d(C)$ to be simply the set of line bundles $L \in \Pic^d(C)$ such that $h^0(L) \geq r+1$. We can see readily that this is a Zariski closed subset of $\Pic^d(C)$, for example by pointing out that it is exactly the locus where the fiber dimension of the Abel-Jacobi map $\mu : C_d \to \Pic^d(C)$ is at least $r$; this is closed by upper-semicontinuity of fiber dimension. 

Note that among the subvarieties $W^r_d$ are the images $W^0_d$ of the Abel-Jacobi maps; in other words, the locus of \emph{effective} divisor classes of degree $d$. The superscript is often omitted, meaning $W^0_d$ is usually written simply $W_d$.

Two other constructions come up in this setting. For one, the subsets $W^r_d \subset \Pic^d(C)$ can be given the structure of a scheme, in a natural way. One way to characterize this scheme structure is to say that the scheme $W^r_d$ represents the functor of families of line bundles $L \in \Pic^d(C)$ on $C$ with  $h^0(L) \geq r+1$.

In the other construction, we can actually parametrize the set of linear series $g^r_d$ on $C$: that is, there is a scheme $\cG^r_d(C)$ parametrizing pairs $(L, V)$ with $L \in \Pic^d(C)$ and $V \subset H^0(L)$ a subspace of dimension $r+1$. Again, the scheme structure may be characterized by saying that $\cG^r_d(C)$ represents the functor of families of linear series on $C$. Note that the natural map $\cG^r_d \to W^r_d$ is a birational isomorphism: it is an isomorphism over the open subset $W^r_d \setminus W^{r+1}_d$, and more generally its fiber over a point of $W^s_d \setminus W^{s+1}_d$ is a copy of  the Grassmannian $\GG(r, s)$. (****David: is it OK to use the term ``birational isomorphism" when $W^r_d$ may be reducible? It is a birational isomorphism on each component.****)

\subsection{Examples in low genus}

\subsubsection{Genus 2} There is not a lot going on here, but there a couple observations to make. First of all, the map $\mu_1 : C \to J(C)$ embeds the curve $C$ in $J(C)$. Secondly, the map $\mu_2 : C_2 \to J(C)$ is an isomorphism except along the locus $\Gamma \subset C_2$ of divisors of the unique $g^1_2$ on $C$; in other words, \emph{the symmetric square $C_2$ of $C$ is the blow-up of $J(C)$ at a point}.

\begin{exercise}
Let $C \subset J(C)$ be the image of the Abel-Jacobi map $\mu_1$. Show that the self-intersection of the curve $C$ is 2,
\begin{enumerate}
\item by applying the adjunction formula to $C \subset J(C)$; and
\item by calculating the self-intersection of its preimage $C + p \subset C_2$ and using the geometry of the map $\mu_2$.
\end{enumerate}
\end{exercise}

\subsection{Genus 3}


\subsection{Genus 4}

In genus 4 we encounter for the first time a scheme $W^r_d(C)$ that is neither of the form $W_d$ or $K - W_e$. This is the subscheme $W^1_3(C)$ parametrizing $g^1_3$s on $C$.

\subsection{Genus 5}

Want: for general curve $C$ of genus 5, the scheme $W^1_4(C)$ is smooth \& irreducible; but when $C$ becomes trigonal, $W^1_4(C)$ becomes reducible, with one component of the form $W^1_3 + C$ and the other $K - W^1_3 - C$.



\section{The Torelli theorem}

In the examples above, we see that a lot of information about a curve $C$ is encoded in the geometry of its Jacobian. In fact, we can make this official: we have the celebrated

\begin{theorem}[Torelli]
A curve $C$ is determined by the pair $J(C), \Theta)$.
\end{theorem}

\begin{proof}
In fact, there are many ways of reconstructing a curve from its Jacobian; this one is  due to Andreotti. We use the fact that the Jacobian $J(C) = H^0(K_C)^*/H_1(C,\ZZ)$ is a torus, and so has trivial tangent bundle, with fiber $H^0(K_C)^*$ at every point. What this means is that if $X \subset J(C)$ is a smooth, $k$-dimensional subvariety, we have a \emph{Gauss map}
$$
\cG : X \to G(k, g) = G(k, H^0(K_C)^*),
$$
sending a point $x \in X$ to its tangent plane $T_xX \subset T_xJ(C) = H^0(K_C)^*$; more generally, if $X$ is singular then $\cG$ will be a rational map. In particular, if $X = \Theta = W_{g-1}$, we get a rational map
$$
W_{g-1} \rTo \PP^{g-1} = \PP(H^0(K_C)^*)
$$
between two $g-1$-dimensional varieties, and it is the geometry of this map from which we can recover the curve $C$.

\end{proof}

\input footer.tex

