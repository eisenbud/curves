\input header.tex

\chapter{Jacobians}\label{new Jacobians chapter}

%
%Up to now, we have been treating line bundles on a curve $C$ individually. This makes sense, given that in genus 0 there is only one line bundle of a given degree, and on a curve of genus 1 all line bundles of a given degree are congruent under the automorphism group of the curve.
%
%It is a fundamental fact that in general the set of line bundles/linear equivalence classes of divisors of a given degree $d$ on $C$ is naturally parametrized by the points of a variety, called the \emph{Picard variety} and denoted ${\rm Pic}^d(C)$. Many of the deeper results about linear systems on $C$ are expressed in terms of the geometry of this variety, and indeed the simple fact of its existence is the key to proving many theorems about linear systems on curves (see for example Theorem~\ref{g+3 theorem}
%below).
%
%In this chapter, we will describe the construction of these varieties, and their relationship with the spaces parametrizing effective divisors of a given degree $d$ on $C$. We then exhibit some of the consequences of these constructions.
%
%One thing to point out before we get started is that the whole subject of Jacobians and Picard varieties has a truly unusual history. As we said, the main import of the theory for modern algebraic geometers is that the line bundles of a given degree $d$ on a given curve $C$ are parametrized by a $g$-dimensional variety. But that is not at all how the theory arose in the first place: rather, as we'll indicate, Jacobians initially grew out of a desire to describe certain integrals of algebraic functions called \emph{abelian integrals}. 


An essential construction in studying a curve $C$ is the association to a given divisor of degree $d$ of a invertible sheaf of that degree---in other words, the map
$$
\mu : \big\{ \text{effective divisors of degree } d \big\} \rTo \big\{ \text{invertible sheaves of degree } d \big\}.
$$

A priori, this is a map of sets. But it is a fundamental fact that both sets may  be given the structures of  algebraic varieties in a natural way, so that the map between them is regular. The geometry of this map governs the geometry of the curve in many ways.

One part is relatively easy: the divisors on a smooth curve are parametrized by the \emph{symmetric powers} $C^{(d)}$ of the curve $C$, described in Section~\ref{symmetric section}. By contrast, the parametrization of the set of invertible sheaves on $C$ of a given degree by the points of an algebraic variety $\pic^d(C)$ is a major undertaking, one that historically brought complex analysis and algebraic geometry together. We'll describe the original construction of the varieties $\pic^d(C)$ by complex analysis in Section~\ref{picard section} below, and touch briefly on the algebraic constructions.

The fact that invertible sheaves of a given degree of a curve $C$ are parametrized by the points of a variety $\pic^d(C)$ has many consequences.  For example, applying dimension theory to $\pic^d(C)$, we will show in Theorem~\ref{g+3 theorem} that every curve can be embedded in projective space as a curve of degree $g+3$.

\section{Symmetric products}\label{symmetric section}

If $G$ is a finite group acting by automorphisms on an affine scheme $X:=\Spec A$ then $X/G$ is by definition $\Spec(A^G)$, the spectrum of the ring $A^G$ of invariant elements of $A$. It is a basic theorem of commutative algebra that the map $X\to X/G$ induced by the inclusion of rings is finite, and the fibers of the map $X\to X/G$ are actually the orbits of $G$ (see for example \cite[Theorem ***]{E}), something that often fails when $G$ is infinite. Since the map $X\to X/G$ is finite, $\dim X/G = \dim X$. The construction commutes with the passage to $G$-invariant open affine sets, and thus passes to more general schemes---and in particular to projective schemes (see exercise~\ref{quotient of projective})---as well.

\begin{exercise}
 Let $G$ be a finite group acting on a quasi-projective scheme $X$. Show that there is a finite covering of $X$ by invariant open affine sets. (Hint: consider the sum of the $G$-translates of a very ample divisor.)
\end{exercise}

For any variety $X$ \fix{I guess we need to say in the intro that varieties are quasi-projective...} we define the $d$-th symmetric power of $X$ to be the quotient of the Cartesian product $X^d$ of $d$ copies of $X$ by the action of the group of all permutations of the factors. The resulting variety $X^d/S_d$ is called the \emph{$d$-th symmetric power}, or \emph{$d$-th symmetric product}, of $X$, denoted  $X^{(d)}$. 

For example, if $X=\AA^{1}$ then $X^{d} = \AA^{d}$, and the ring of invariants of the symmetric group acting on
$\cO_{\AA^{d}} = k[x_{1}, \dots, x_{d}]$ by permuting the variables is generated by the $d$ elementary symmetric functions, which generate a polynomial subring. Since the symmetric functions of the roots of a polynomial are the coefficients of
the polynomial, we may identify the scheme $X^{d}$ with $\AA^{d}$. (\cite[Exercises 1.6, 13.2-13.4]{E})

If $X = \PP^1$ we can observe that on the product $(\PP^1)^d$, taking the homogenesous coordinates of the
$i$-th copy of $\PP^1$ to be $(s_i,t_i)$, the multilinear symmetric functions of degree $d$,
$$
s_0t_1t_2\cdots t_d,\dots,s_0s_1\cdots s_d
$$
localize on each of the standard affine open sets $(\AA^1)^d=\AA^d$ to the usual ordinary symmetric functions, and define
an isomorphism $\Sym^d(\PP^1)\to \PP^d$.
Again, we may think of this map as taking a $d$-tuple of points to the
homogeneous form of degree $d$ vanishing on it, which is unique up to scalars.

Note that this argument does not say anything about the symmetric products of $\AA^2$, which are in fact singular---see Exercise~\ref{sym2A2}.

Since an effective divisor of degree $d$ on a curve $C$ is an unordered $d$-tuple of points on $C$, with repetitions allowed, it corresponds to a point in the \emph{$d$th symmetric power} $C^{(d)}$.

There is one aspect of the symmetric powers that is special to the case of curves:  

\begin{proposition}\label{sym2A2}
If $X$ is a smooth curve then each symmetric power $X^{(d)}$ is smooth.
\end{proposition}
\begin{proof}
 The general case follows from the case of $\AA^{1}$ because locally analytically the action of the symmetric group on $C^d$ is the same as for $\AA^1$: If  $\overline p \in X^{(d)}$, then it suffices to
 show that the quotient of an invariant formal neighborhood of the preimage $p_1,\dots, p_s$ of
 overline $p$ is smooth. After completing the local rings, we get an action of the symmetric group
 $G$ on the product of the completions of $X$ at the $p_i$, and this depends only on the orbit
 structure of $G$ acting on $\{p_1,\dots, p_s\}$. Thus it would be the same for some orbit of
 points on $\AA^1$.
 \end{proof}

By contrast, if $\dim X \geq 2$ then the symmetric powers $X^{(d)}$ are singular for all $d \geq 2$.

\begin{exercise}
\begin{enumerate}
 \item We say that a group $G$ acts freely on $X$ if $gx = gy$ only when $g =1$ or $x=y$. Show that
 if $G$ is a finite group acting freely on a smooth affine variety $X$ then the quotient $X/G$ is smooth.
\item Let $X = (\AA^{2})^{2}$ and let $G = \ZZ/2$ act on $X$ by permuting the two copies of $\AA^{2}$; algebraically,
$(\AA^{2})^{2} = \Spec S$, with $S = k[x_{1},x_{2}, y_{1}, y_{2}]$ and the nontrivial element $\sigma\in G$ acts by
$\sigma(x_{i}) = y_{i}$. 
\item. Show that $G$ acts freely on the complement of the diagonal, but fixes the diagonal pointwise.
\item Show that the algebra $S^{G}$ has dimension 4 and is generated by the 5 elements
$$ 
f_{1} = x_{1}+y_{1}, f_{2} = x_{2}+y_{2}, g_{1} = x_{1}y_{1}, g_{2} = x_{2}y_{2}, h = x_{1}y_{2}+x_{2}y_{1},
$$
perhaps by appropriately modifying the steps given in \cite[Exercise 1.6]{E}. 
\item Show that $h^2$ lies in the subring generated by $f_1,\dots, f_4$, and thus $S^{(2)}$ is a hypersurface, singular
along the  codimension 2 subset $f_{1} = f_{2} = 0$, which is the image of the diagonal subset of the 
cartesian product $(\AA^{2})^{2}$.
\end{enumerate}
\end{exercise}


\begin{exercise}[The universal divisor of degree $d$]\label{universal divisor}
Let $C$ be a smooth projective curve, and $C^{(d)}$ its $d$th symmetric power. Show that the locus
$$
\cD := \{ (D, p) \in C^{(d)} \times C \mid p \in D \}
$$
is a closed subvariety of the product $C^{(d)} \times C$, whose fiber over any point $D \in C^{(d)}$ is the divisor $D \subset C$.
\fix{How do our readers do this? We need to have proven the universal property of
the symmetric product -- the fine moduli space for invariant divisors of degree $d$.}

\end{exercise}

The variety $\cD$ is called the universal divisor on $C$ by virtue of the fact that for any family of divisors of degree $d$ on $C$---that is, a scheme $B$ and a subscheme $\cE \subset B \times C$ flat of degree $d$ over $B$, there is a unique morphism $\phi : B \to C^{(d)}$ such that $\cE$ is the pullback via $\phi$ of $\cD\subset C^{(d)} \times C$. Indeed, this amounts to saying that $C^{(d)}$ is the \emph{Hilbert scheme} parametrizing subschemes of $C$ of degree $d$. These statements are not generally true for higher-dimensional varieties; see Chapter~\ref{hilbert scheme chapter} and especially Exercise~\ref{symmetric power vs Hilbert scheme}


\section{Jacobians}

To construct $\Pic^d(C)$ we start with $d=0$, and identify $\Pic^0(C)$ with  the \emph{Jacobian} $J(C)$ of $C$ using \emph{abelian integrals} and the classical topology. This produces a complex manifold rather than an algebraic variety, but has the virtue of being relatively concrete. \fix{I think we should make the following into a formal theorem-- in the characterization section --- which maybe doesn't exist yet?} The Jacobian $J(C)$ is in fact a projective variety, and may be constructed purely algebraically---so that, for example, if the curve $C$ is defined over a given field $K$ then $J(C)$ will be defined over $K$ as well. The search for such a construction was one of the driving forces of algebraic geometry in the first half of the 20th century, giving rise to the notion of abstract algebraic varieties. See for example \cite{??s} [Kleiman must have something for this].

The goal of the 19th century mathematicians who first described abelian integrals was simply to make sense of integrals of algebraic functions. In the early development of calculus, mathematicians figured out how to evaluate explicitly integrals such as
$$
\int_{t_0}^t \frac{dx}{\sqrt{x^2+1}}.
$$
Such integrals can be thought of as path integrals of meromorphic differentials on the Riemann surface associated to the equation $y^2 = x^2+1$. This surface is isomorphic to $\PP^1$, meaning that $x$ and $y$ can be expressed as rational functions of a single variable $z$; making the corresponding change of variables transformed the integral into one of the form
$$
\int_{s_0}^s R(z)dz,
$$
with $R$ a rational function, and such integrals are readily evaluated by the technique of partial fractions.

When they tried to extend this to similar-looking integrals like
$$
\int_{t_0}^t \frac{dx}{\sqrt{x^3+1}},
$$
which arises when one studies the length of an arc of an elipse and was thus called an elliptic integral, they were stymied. The reason gradually emerged: the problem is that the Riemann surface associated to the equation $y^2 = x^3+1$ is not $\PP^1$, but rather a curve of genus 1, and so has nontrivial homology group $H_1(C, \ZZ) \cong \ZZ^2$. In particular, if one expresses this ``function'' of $t$  as a path integral, then the value depends on a choice of path; it is defined only modulo a lattice $\ZZ^2 \subset \CC$. This implies that the inverse function is a doubly periodic meromorphic function on $\CC$, and not an elementary function. Many new special functions, such as the Weierstrass $\sP$-function were studied as a result. The name ``elliptic curve'' arose from these considerations too.

Once this case was understood, the next step was to extend the theory to path integrals of holomorphic differentials on curves of arbitrary genus. One problem is that the dependence of the integral on the choice of path is much worse; the set of homology classes of paths between two points $p_0, p \in C$ is identified with $H_1(C,\ZZ) \cong \ZZ^{2g}$ rather than $\ZZ^2$. The Jacobian arises when one considers the integrals of \emph{all} holomorphic differentials on $C$ simultaneously. 

%\fix{insert abstract characterization of the Jacobian; say its defined over any field, and depends on a choice of base point; and that we're just constructing the complex points of the underlying variety.}
To express the resulting construction in relatively modern terms, let $C$ be a smooth projective curve of genus $g$ over $\CC$, and let $\omega_{C}$ be the sheaf of differential forms on $C$. We will consider $C$ as a complex manifold. Every meromorphic differential form is in fact algebraic
\cite{****}, and we consider $\omega_{C}$ as a sheaf in the analytic topology.

We consider the space $V = H^0(\omega_C)^*$ of linear functions on the space of differentials $H^0(\omega_C)$.  Integration over a closed loop in $C$ defines a linear function on 1-forms, so that we have a map
$$
\iota: \ZZ^{2g} = H_1(C,\ZZ) \; \to \;  H^0(\omega_C)^* \cong H^1(\sO_C) = \CC^{g}.
$$
Using  Hodge theory\footnote{By Hodge theory 
$$
H^1(C, \CC) \cong H^1(C, \cO_C) \oplus \overline{H^1(C, \cO_C)}
$$
where the bar denotes complex conjugation $H^1(C, \CC)$, and the map $\iota$ is the composition of 
 the natural inclusion with the projection to the first summand.
 Now
$H_1(C,\CC) = \CC\otimes_\ZZ H_1(C,\ZZ)$, so any basis of $H_1(C,\ZZ)$ maps to a basis of 
 $H^1(C, \CC)$ invariant under conjugation in $H^1(C, \CC)$---See Voisin \cite{} or Griffiths-Harris~\cite{}. 
  If there were a real dependence relation among elements 
 of the image of this basis under $\iota$, then it the same relation would hold after complex
 conjugation and thus hold on the image of the basis in $H_1(C,\CC)$, a contradiction. 
}
one can show that $\iota$ induces an injective map of vector spaces 
$$
\RR \otimes H_1(C,\ZZ) = H_1(C,\RR) \to H^0(\omega_C)^*
$$

 The complex structure on $H^0(\omega_C)^*$ yields a complex analytic structure on the quotient $\CC^{g}/(\iota(\ZZ^{2g})$, which is thus a torus of real dimension $2g$.  We call this quotient, with its structure as a $g$-dimensional complex manifold, the Jacobian of $C$, denoted
$$
J(C) \; = \; V/\Lambda.
$$
The point of this construction is that for any pair of points $p, q \in C$, the expression $\int_q^p$ describes a linear functional on $H^0(\omega_C)$, defined up to functionals obtained by integration over closed loops, and thus a point of $J(C)$. Thus, for example, if we choose a ``base point''  $q\in C$, we get a holomorphic map
$$
\mu \; : \; C \; \to \; J(C); \quad p\mapsto \int_{q}^{p}
$$

%To fully utilize this, we want to extend it from points  to divisors on $C$, and to do this we need to find a space parametrizing effective divisors on $C$. This is readily available: since an effective divisor of degree $d$ on $C$ is an unordered $d$-tuple of points on $C$, with repetitions allowed, it corresponds to a point in the \emph{$d$th symmetric power} $C_d$ of $C$, defined to be the quotient of the ordinary product $C^d$ by the action of the symmetric group $\Sigma_d$ on $d$ letters. This is a smooth, $d$-dimensional projective variety; for a description, see for example Section 10.3.1 of~\ref{3264}.
%
%\fix{insert the discussion 3264 showing that the symmetric power is smooth; note that this fails in higher dimension.} 

Having chosen a base point $q \in C$ as above, we get for each $d\geq 0$ the \emph{Abel-Jacobi} map
$$
\mu_d \; : \; C^{(d)} \; \to \; J(C),
$$
defined by
$$
\mu_d(p_1 + \dots + p_d) \; = \; \sum \int_q^{p_i}.
$$
When there is no ambiguity about $d$, we will denote them simply by $\mu$.  and we 
we define $\mu(-D)$ to be $-\mu(D)$. 
The map $\mu$ is a group homomorphism in the sense that if $D, E$ are divisors, then
$\mu (D+E) = \mu(D) + \mu(E)$; this is immediate when the divisors are effective, and 
follows in general because the group of divisors is a free group.
The connection between the discussion above and the geometry of linear series is made by \emph{Abel's theorem}:

\begin{theorem}
Two divisors $D, D' \in C^{(d)}$ on $C$ are linearly equivalent if and only if $\mu(D) = \mu(D')$; in other words, the fibers of $\mu_d$ are the complete linear systems of degree $d$ on $C$.
\end{theorem}

See \cite[Section 2.2]{GH}  for a complete proof; we will just prove the ``only if" part. This was in fact the only part proved by Abel; the converse, which is substantially more subtle, was proved by Clebsch.

\begin{proof}[Proof of ``only if'']
Suppose that $D$ and $D'$ are linearly equivalent; that is, $\cO_C(D) \cong \cO_C(D')$. Call this invertible sheaf $\cL$, and suppose that $D$ and $D'$ are the zero divisors of sections $\sigma, \sigma' \in H^0(\cL)$.
Taking linear combinations of $\sigma$ and $\sigma'$, we get a pencil $\{D_\lambda\}_{\lambda \in \PP^1}$ of divisors on $C$, with
$$
D_\lambda \; = \; V(\lambda_0\sigma + \lambda_1\sigma'),
$$
and by Exercise~\ref{universal divisor} this corresponds to a regular map $\alpha : \PP^1 \to C^{(d)}$. 

Consider now the composition
$$
\phi = \mu \circ \alpha \; : \; \PP^1 \; \to \; J(C).
$$
Now, $J(C)$ is the quotient of the complex vector space $V = H^0(\omega_C)^*$ by a discrete lattice. If $z$ is any linear functional on $V$, then, the differential $dz$  on $V$ descends to a global holomorphic 1-form on the quotient $J(C)$, so that the regular one-forms on $J(C)$ generate the cotangent space to $J(C)$ at every point. But for any 1-form $\omega$ on $J(C)$, the pullback $\phi^*\omega$ is a global holomorphic 1-form on $\PP^1$, and hence identically zero. It follows that the differential $d\phi$ vanishes identically, and hence (since we are in characteristic 0) that $\phi$ is constant; thus $\mu(D) = \mu(D')$.
\end{proof}

Abel's Theorem goes surprisingly far to describe the Jacobian. The first statement of the following Corollary suggests how to describe the structure of the Jacobian algebraically, and was used by Andre Weil in the first such construction.

\begin{corollary}
If $C$ is a smooth curve of genus $g$ then the Abel-Jacobi map $\mu_{g}: C^{(g)} \to J(C)$ is a surjective birational map.
More generally, $\mu_{d}$ is generically injective for $d\leq g$ and surjective for $d\geq g$.
\end{corollary}

\begin{proof}
For $d\leq g = \dim H^{0}(\omega_{C})$,  a divisor $D$ that is the sum of $d$ general points $p_{1}, \dots,  p_{d} \in C$ will impose independent vanishing conditions on the sections of $\omega_{C}$, and thus
$$
h^{1}\cO_{C}(D) = h^0(\omega_C(-D)) = g-d,
$$
by Serre duality. Using this, the Riemann-Roch formula gives $h^{0}\cO_{C}(D) = 1$, so the fiber of 
$\mu_{d}$ consists of a single point, proving generic injectivity. In particular when $d= g$, the image of $\mu_{d}$ has
dimension $g$, and since $C^{(g)}$ is compact, the image is closed, so it must be equal to $J(C)$.

Similarly, if $d \geq g$, we will have $h^0(\omega_C(-D)) = 0$ and hence $h^0(\cO_C(D)) = d-g+1$. Since this is the affine
dimension, the linear series $|D|$ has dimension $d-g = \dim C^{(d)} - \dim J(C)$, and again it follows that
$\mu_{d}$ is surjective.
\end{proof}

\subsection{Applications to linear series}

To illustrate some of the power of Abel's theorem, we will use it to prove a basic result:

\begin{theorem}\label{g+3 theorem}
Let $C$ be a smooth projective curve of genus $g$. If $D \in C_{g+3}$ is a general divisor of degree $g+3$ on $C$, then 
$D$ is very ample. In particular, every curve of genus $g$ may be embedded in $\PP^{3}$ as a curve of degree $g+3$.
\end{theorem}

We proved in Theorem~\ref{very ample} that \emph{every divisor} of degree $\geq 2g+1$ is very ample; the difference here is that we are taking a \emph{general} divisor. This result is sharp in the sense that hyperelliptic curves, for example, cannot be embedded in projective space as curves of any degree less than $g+3$, as we'll see in Chapter~\ref{ScrollsChapter}. However, if we consider only general divisors on general curves, we can do still better: ``most" curves of genus $g$ can in fact be embedded in $\PP^{3}$ as curves of degree $d = \lceil 3g/4 \rceil + 3$ \cite{}.

\begin{proof}
If $D$ is general of degree $g+3$ we have $h^0(\cO_C(D)) = 4$. To show that it is very ample, we have to show that
\begin{enumerate}
\item for any point $p \in C$, we have $h^0(\cO_C(D-p)) = 3$ (that is, $|D|$ has no base points, and so defines a regular map $\phi_D : C \to \PP^3$); and
\item for any pair of points $p, q \in C$, we have $h^0(\cO_C(D-p-q)) = 2$.
\end{enumerate}
The second of these assertions immediately implies the first, and this is what we will prove.

Now let $D$ be an arbitrary divisor of degree $g+3$. To say that $h^0(\cO_C(D-p-q)) \geq 3$ is equivalent, by the Riemann-Roch theorem, to the condition $h^0(\omega_C(-D + p + q)) \geq 1$; fixing a divisor 
$K_{C}\in |\omega_{C}|$, this is the condition that there exists  
an effective divisor $E$ of degree $g-3$ linearly equivalent to a divisor in $K_C - D + p + q|$. 

Now consider the map 
$$
\nu : C^{(g-3)} \times C^{(2)} \; \to \; J(C)
$$
given by
$$
\nu : (E,F) \; \mapsto \; \mu_{2g-2}(K_C) - \mu_{g-3}(E) + \mu_{2}(p+q), 
$$
where the $+$ and $-$ on the right refer to the group law on $J(C)$. 

By what we have just said, and Abel's theorem, the divisor $D$ fails to be very ample only if
$\mu(D) \in {\rm Im}(\nu)$. But the source $C^{(g-3)} \times C^{(2)}$ of $\nu$ has dimension $g-3+2 = g-1$, and so its image in $J(C)$ must be a proper subvariety; since $\mu_{g+3}$ is dominant, the image of a general divisor $D \in C^{(g-3)}$ is a general point of $J(C)$ and thus will not lie in ${\rm Im}(\nu)$. 
\end{proof}

Thus Abel's theorem, which was born out of an effort to evaluate calculus integrals, winds up proving a basic fact in the theory of algebraic curves!

\fix{we said early on that we don't need to know that $J(C)$ is algebraic; for the present purposes, it's enough to know that $J(C)$ is a  complex torus of dimension $g$. But in that case we do need to know that if $f : X \to Y$ is a holomorphic map of compact complex manifolds with $\dim X < \dim Y$, then $f(X)$ is a proper analytic subvariety of $Y$. we also need to know that the group law is algebraic. We need to have a formal statement of the existence as an algebraic group. Will be taken care of by the Characterization section, yet to be written.}

\fix{DE rev to here 1/8/22}

\section{Picard varieties}\label{picard section}
\fix{the rest of this chapter is more like an outline than a chapter. Joe, we could go over the material you want to
put in together, and I could try to write it, or you could write it.}

Possible contents for this section: definition and notation for $\Pic^d(C)$; the fact (cheerful or otherwise) that $\Pic^d(C)$ represents the functor of families of invertible sheaves of degree $d$ on $C$ (does it, by the way? I'm worried because invertible sheaves do have automorphisms). Explicit correspondence between first order deformations of a given invertible sheaf $L$ on $C$ and tangent vectors to $\Pic^d(C)$ at $L$ (that is, elements of $H^0(\omega_C)^* = H^1(\cO_C)$ via transition functions for $L$.

\def\cW{{\mathcal W}}

Existence of a universal family $\cP_{d,g}$ of Picard varieties over $M_g$ (that is, a coarse moduli space for pairs $(C,L)$ with $C$ of genus $g$ and $L \in \Pic^d(C)$. Likewise, analogs $\cW^r_d \subset \cP_{d,g}$, or ``universal Brill-Noether vareities."
Cheerful fact: $\cP_{d,g}$ is not in general isomorphic to $\cP_{d',g}$, unless $d' \equiv
 \pm d$ (mod $2g-2$). 
 
 Chow and/or cohomology groups of $\Pic^d(C)$: the fact that the Neron-Severi group of a very general Jacobian is $\ZZ$; maybe even the fact that the algebraic cohomology of a very general Jacobian is $\ZZ$ in every dimension.
 
 Introduce the varieties $W^r_d(C)$ here, or later? In any event, when we do we should give the full statement of the Brill-Noether theorem
 
 Notation: we should say at some point that when there's no danger of confusion, we suppress the $(C)$: that is, write $J$ for $J(C)$, $W^r_d$ for $W^r_d(C)$, etc.

\section{Differential of the Abel-Jacobi map}

In this section we will describe the differential $d\mu$ of the Abel-Jacobi map $\mu : C_d \to J(C)$; this yield a sharper form of Abel's theorem.

\fix{clarify the structure of the next few pages: what is *the* theorem, what are special cases to get an intuitive feel.}
To start, suppose $D = p_1 + \dots + p_d$ is a divisor consisting of $d$ distt oints on our curve $C$. Since the quotient map $C^d \to C_d$ is unramified at $D$, the tangent space to $C_d$ at the point $D$ is naturally identified with the tangent space to $C^d$ at $(p_1,\dots,p_d)$; that is, the direct sum of the tangent spaces to $C$ at the points $p_i$:
$$
T_D(C_d) = \bigoplus T_{p_i}(C).
$$
On the other hand, the tangent space to $J(C)$ at the image point $\mu(D)$ is simply the vector space $H^0(\omega_C)^*$ of which $J(C)$ is a quotient (as it is at every point!). The differential $d\mu_D$ is thus a linear map
$$
\bigoplus T_{p_i}(C) \rTo H^0(\omega_C)^*,
$$
and the transpose of this a linear map
$$
H^0(\omega_C) \rTo \bigoplus T^*_{p_i}(C).
$$
This last map is easy to describe: since the map $\mu$ is given by 
$$
\mu_d(p_1 + \dots + p_d) \; = \; \sum \int_q^{p_i},
$$
we can simply differentiate under the integral sign to conclude that \emph{the codifferential $d_\mu^*$ is the map}
\begin{align*}
H^0(\omega_C) &\to \bigoplus T^*_{p_i}(C) \\
\omega &\mapsto (\omega(p_1), \dots, \omega(p_d).
\end{align*}

There is a natural extension of this to the case of non-reduced divisors $D$, that is, divisors with repeated points. We first need a description of the tangent space to $C_d$ at the point $D$:

\begin{proposition}\label{symmetric product tangent space}
The tangent and cotangent spaces to $C_d$ at the point corresponding to an arbitrary divisor $D = \sum a_ip_i$ are naturally identified with $H^0(\cO_C(D)/\cO_C)$ and $H^0(\omega_C/\omega_C(-D))$ respectively.
\end{proposition}

Note that we have a natural pairing between the spaces $H^0(\cO_C(D)/\cO_C)$ and $H^0(\omega_C/\omega_C(-D))$, given by sending $(f, \omega)$ to $\sum_i Res_{p_i}(f\omega)$. Note also that the term ``natural" has a precise meaning here: if we let 
$$
\cD = \{ (D, p) \in C_d \times C \; \mid \; p \in D \}
$$
be the universal effective divisor of degree $d$ on $C$, the proposition says that the cotangent sheaf $T^*_{C_d}$ is the direct image $\alpha_*(\beta^*\omega_C/\beta^*\omega_C(-\cD))$, where $\alpha$ and $\beta$ are the projections of $C_d \times C$ onto the two factors.

\fix{give a real proof --- better than ACGH's}

If you wanted to see an argument for Proposition~\ref{symmetric product tangent space} done out in coordinates (you really don't, but if you did) you could find it in [ACGH].

In any event, given Proposition~\ref{symmetric product tangent space}, we can extend our earlier statement to the

\begin{proposition}\label{differential of Abel-Jacobi}
The codifferential $d\mu^*$ of the Abel-Jacobi map is simply the natural restriction map
$$
H^0(\omega_C) \rTo H^0(\omega_C/\omega_C(-D)).
$$
\end{proposition}

Now, note that the codimension of the image of $d\mu^*$---equivalently, the dimension of the kernel of the differential $d\mu$---is by the geometric Riemann-Roch theorem exactly the dimension of the fiber of $C_d$ over the point $\mu(D) \in J(C)$. In other words, the fibers of $\mu$ are smooth, and in particular reduced. Thus we can think of Proposition~\ref{differential of Abel-Jacobi} as a strengthening of the Abel-Clebsch theorem: while Abel and Clebsch show that the fibers of $\mu$ are complete linear series set-theoretically, we see from the above that it is in fact true scheme-theoretically.

\section{Further consequences}

One consequence of the description of the Jacobian and the Abel-Jacobi map of a curve $C$ is that \emph{the set of linear series on $C$ of given degree $d$ and dimension $r$ can be given the structure of a scheme in its own right}.

\fix{all this needs a base point, and some care to state the universal property precisely. OK to state it 
intuitively, then translate}
To start with, we can define $W^r_d(C) \subset \Pic^d(C)$ to be simply the set of invertible sheaves $L \in \Pic^d(C)$ such that $h^0(L) \geq r+1$. We can see readily that this is a Zariski closed subset of $\Pic^d(C)$, for example by pointing out that it is exactly the locus where the fiber dimension of the Abel-Jacobi map $\mu : C_d \to \Pic^d(C)$ is at least $r$; this is closed by upper-semicontinuity of fiber dimension. 

Note that among the subvarieties $W^r_d$ are the images $W^0_d$ of the Abel-Jacobi maps; in other words, the locus of \emph{effective} divisor classes of degree $d$. The superscript is often omitted, meaning $W^0_d$ is usually written simply $W_d$.

Two other constructions come up in this setting. For one, the subsets $W^r_d \subset \Pic^d(C)$ can be given the structure of a scheme, in a natural way. One way to characterize this scheme structure is to say that the scheme $W^r_d$ represents the functor of families of invertible sheaves $L \in \Pic^d(C)$ on $C$ with  $h^0(L) \geq r+1$.

In the other construction, we can actually parametrize the set of linear series $g^r_d$ on $C$: that is, there is a scheme  $G^r_d(C)$ parametrizing pairs $(L, V)$ with $L \in \Pic^d(C)$ and $V \subset H^0(L)$ a subspace of dimension $r+1$. Again, the scheme structure may be characterized by saying that $G^r_d(C)$ represents the functor of families of linear series on $C$. Note that the natural map $G^r_d \to W^r_d$ is an isomorphism over the dense open subset $W^r_d \setminus W^{r+1}_d$, and more generally its fiber over a point of $W^s_d \setminus W^{s+1}_d$ is a copy of  the Grassmannian $\GG(r, s)$. 



\subsection{Examples in low genus}

\subsubsection{Genus 2} There is not a lot going on here, but there are a couple observations to make. First of all, the map $\mu_1 : C \to J(C)$ embeds the curve $C$ in $J(C)$. Secondly, the map $\mu_2 : C_2 \to J(C)$ is an isomorphism except along the locus $\Gamma \subset C_2$ of divisors of the unique $g^1_2$ on $C$; in other words, \emph{the symmetric square $C_2$ of $C$ is the blow-up of $J(C)$ at a point}. \fix{true that the fiber is $\PP^1$, but is that enough? Maybe so for a birational map of smooth surfaces, but does the reader know this?}

\begin{exercise}
Let $C \subset J(C)$ be the image of the Abel-Jacobi map $\mu_1$. Show that the self-intersection of the curve $C$ is 2,
\begin{enumerate}
\item by applying the adjunction formula to $C \subset J(C)$; and
\item by calculating the self-intersection of its preimage $C + p \subset C_2$ and using the geometry of the map $\mu_2$.
\end{enumerate}
\end{exercise}

\subsection{Genus 3}


\subsection{Genus 4}

In genus 4 we encounter for the first time a scheme $W^r_d(C)$ that is neither of the form $W_d$ or $K - W_e$. This is the subscheme $W^1_3(C)$ parametrizing $g^1_3$s on $C$.

\subsection{Genus 5}

Want: for general curve $C$ of genus 5, the scheme $W^1_4(C)$ is smooth \& irreducible; but when $C$ becomes trigonal, $W^1_4(C)$ becomes reducible, with one component of the form $W^1_3 + C$ and the other $K - W^1_3 - C$.

\section{Martens' theorem and variants}

The general theorems we have described so far dealing with linear series on a curve $C$, like the Riemann-Roch and Clifford theorems, have to do with the existence or non-existence of linear series on $C$. Now that we've seen how to parametrize the set of linear series on $C$ by the varieties $W^r_d(C)$, we can ask more quantitative questions: for example, what can the dimension of $W^r_d(C)$ be? One basic result, for example, is the following.

\begin{theorem}[Martens' theorem]
If $C$ is any smooth projective curve of genus $g$, then for any $d$ and $g$ we have
$$
\dim(W^r_d(C)) \leq d-2r;
$$
moreover, if we have equality for any $r > 0$ and $d < 2g-2$ the curve $C$ must be hyperelliptic.
\end{theorem}

Note that if $C$ is hyperelliptic with $g^1_2 = |D|$, we have
$$
W^r_d(C) \supset W_{d-2r}(C) + \mu(rD).
$$
(In fact, as we'll see in the following chapter, this is an equality.) Since this has dimension $d-2r$, we see that Martens' theorem is sharp. Note also that Clifford's theorem is a special case of Martens' theorem!

\begin{proof}

\end{proof}

There are extensions of Martens' theorem to the case $\dim(W^r_d(C)) = d-2r-1$ (Mumford) and $d-2r-2$ (Keem).

\section{The full Brill-Noether theorem}

The existence of the varieties $W^r_d(C)$ parametrizing linear series on an arbitrary curve $C$ allows us to strengthen Clifford's theorem to Martens' theorem. If we ask about linear series on a \emph{general} curve, similarly, it allows us to give a much more detailed version of the Brill-Noether theorem: instead of simply saying when there exists a $g^r_d$ on a general curve $C$, we can give the dimension of the variety $W^r_d(C)$ parametrizing such linear series, and we can also talk about the geometry of a general linear series on $C$. We collect the basic facts into the 

\begin{theorem}[Brill-Noether theorem, omnibus version]
Let $C$ be a general curve of genus $g$. If we set $\rho = g - (r+1)(g-d+r)$, then
\begin{enumerate}
\item $\dim(W^r_d(C)) = \rho$;
\item the singular locus of $W^r_d(C)$ is exactly $W^{r+1}_d(C)$;
\item if $\rho > 0$ then $W^r_d(C)$ is irreducible;
\item if $\rho = 0$ then the variety $\cW^r_d$ is irreducible;
\item if $L$ is any invertible sheaf on $C$, the map
$$
H^0(L) \otimes H^0(\omega_CL^{-1}) \rTo H^0(\omega_C)
$$
is injective;
\item if $|D|$ is a general $g^r_d$ on $C$, then
\begin{enumerate}
\item if $r \geq 3$ then $D$ is very ample; that is, the map $\phi_D : C \to \PP^2$   embeds $C$ in $\PP^r$;
\item if $r=2$ the map $\phi_D : C \to \PP^2$ gives a birational embedding of $C$ as a nodal plane curve; and 
\item if $r=1$, the map $\phi_D : C \to \PP^2$ expresses $C$ as a simply branched cover of $\PP^1$.
\end{enumerate}
\end{enumerate}
\end{theorem}

\section{The Torelli theorem}
\fix{consider making this a cheerful fact. or exercise?}
In the examples above, we see that a lot of information about a curve $C$ is encoded in the geometry of its Jacobian. In fact, we can make this official: we have the celebrated

\begin{theorem}[Torelli]
A curve $C$ is determined by the pair $(J(C), \Theta)$.
\end{theorem}

\begin{proof}
In fact, there are many ways of reconstructing a curve from its Jacobian; this one is  due to Andreotti, and makes essential use of our description of the differential of the Abel-Jacobi map. 

A key  fact is that the Jacobian $J(C) = H^0(\omega_C)^*/H_1(C,\ZZ)$ is a torus, and so has trivial tangent bundle, with fiber $H^0(\omega_C)^*$ at every point. What this means is that if $X \subset J(C)$ is a smooth, $k$-dimensional subvariety, we have a \emph{Gauss map}
$$
\cG : X \to G(k, g) = G(k, H^0(\omega_C)^*),
$$
sending a point $x \in X$ to its tangent plane $T_xX \subset T_xJ(C) = H^0(\omega_C)^*$; more generally, if $X$ is singular then $\cG$ will be a rational map. In particular, if $X = \Theta = W_{g-1}$, we get a rational map
$$
W_{g-1} \rTo \PP^{g-1} = \PP(H^0(\omega_C))
$$
between two $g-1$-dimensional varieties, and it is the geometry of this map from which we can recover the curve $C$.

To start with, let's identify an open subset of $W_{g-1}$ where the Gauss map is defined. This is not hard: a point $L \in W_{g-1} \setminus W^1_{g-1}$ is the image of a unique point $D \in C_{g-1}$ under the map $\mu$, and moreover we've seen that the differential $d\mu$ is injective at $D$; it follows that $L$ is a smooth point of $W_{g-1}$. 

Moreover, we've identified the tangent space to $W_{g-1}$ at $L = \mu(D)$: as we saw, the differential $d\mu : T_D(C_{g-1}) \to T_L(J) = H^0(\omega_C)^*$ is just the transpose of the evaluation map $H^0(\omega_C) \to H^0(\omega_C(-D))$, and it follows that the tangent space to $W_{g-1}$ at the point $L$ is the hyperplane in $H^0(\omega_C)^*$ dual to the unique differential vanishing on $D$. To put it another way: if we think of $C$ as canonically embedded in $\PP(H^0(\omega_C)^*)$, then by geometric Riemann-Roch the divisor $D$ will span a hyperplane in $\PP(H^0(\omega_C)^*)$, and the Gauss map $\cG$ sends $L$ to the point in the dual projective space $\PP(H^0(\omega_C))$ corresponding to that hyperplane.

\begin{fact}
We have shown that the open subset $W_{g-1} \setminus W^1_{g-1}$ is contained in the smooth locus of $W_{g-1}$. In fact, they are equal; that is, $W^1_{g-1}$ is exactly the singular locus of $W_{g-1}$. This is a special case of the beautiful \emph{Riemann singularity theorem}, which says that for any point $L \in W_{g-1}$, the multiplicity $\mult_L(W_{g-1}) = h^0(L)$. For a proof of the Riemann singularity theorem, see for example [GH]. 
\end{fact}

\fix{David -- can we find another reference for the RST? The proof in [GH] is clear but somewhat sketchy; I don't have a copy handy, but as I recall it implicitly assumes that the tangent cone is generically reduced.}

We are now in a position to describe the Gauss map
$$
\cG : W_{g-1} \rTo  \PP(H^0(\omega_C))
$$
explicitly in terms of the geometry of the canonical curve $C \subset \PP(H^0(\omega_C)^*)$. To start, let $p \in \PP(H^0(\omega_C))$ be a general point, dual to a general hyperplane $H \subset \PP(H^0(\omega_C)^*)$. The hyperplane $H$ will intersect the canonical curve $C$ transversely in $2g-2$ points $p_1,\dots,p_{2g-2}$; these points will be in linear general position (in particular, any $g-1$ of them will be linearly independent and so span $H$). It follows that the fiber of $\cG$ over the point $H$ will consist of the invertible sheaves $L = \cO_C(p_{\alpha_1} + \dots + p_{\alpha_{g-1}})$, where $p_{\alpha_1}, \dots, p_{\alpha_{g-1}}$ is any subset of $g-1$ of the points $p_i$; in particular, we see that the degree of the map $\cG$ is
$$
\deg (\cG) = \binom{2g-2}{g-1}.
$$

The next question is, where does this analysis fail---in other words, for which hyperplanes $H \subset \PP H^0(\omega_C)^*$ does the fiber of $\cG$ not consist of $\binom{2g-2}{g-1}$ points, or equivalently,
what is the branch divisor of the map $\cG$? The answer is, the analysis above fails in two cases: when the points $p_1,\dots, p_{2g-2}$ are not in linear general position---specifically, when some $g-1$ of the points $p_i$ fail to be linearly independent; and when the hyperplane $H$ is not transverse to $C$, so that the hyperplane section $H \cap C$ consists of fewer than $2g-2$ distinct points.

The first of these occurs in codimension 2 in $\PP H^0(\omega_C)$, and so does not contribute any components to the branch divisor of $\cG$. It follows that the branch divisor of the map $\cG$ is exactly the locus of hyperplanes $H \subset H^0(\omega_C)^*$ tangent to the canonical curve $C$; in other words, \emph{the branch divisor of $\cG$ is the hypersurface in $\PP H^0(\omega_C)$ dual to the canonical curve $C \subset \PP H^0(\omega_C)^*$}.

Now we can  invoke the fact that the dual of the dual of a variety $X \subset \PP^n$ is $X$ itself (see for example [3264] or something by Kleiman). We thus have a way of recovering the curve $C$ from the data of the pair $(J, W_{g-1})$: simply put, \emph{the curve $C$ is the dual of the branch divisor of the Gauss map on $W_{g-1}$}, and the Torelli theorem is proved.

\end{proof}

The Torelli theorem for curves was the first instance of a class of theorems, called \emph{Torelli theorems}, to the effect that certain classes of varieties are determined to some degree by their Hodge structure; there are, for example, Torelli theorems of varying strength for K3 surfaces, cubic threefolds and fourfolds and hypersurfaces in $\PP^n$.

\section{Additional topics}

A couple of topics that would naturally go here, if we have the inclination and space.

\subsection{Theta characteristics}

Basically: introduce the notion of theta-characteristic (= square root of the canonical bundle), and prove the invariance of $h^0(\cL)$ mod 2. Describe the configuration of theta-characteristics on a given curve $C$ as a principal homogeneous space for the group $J(C)[2] \cong (\ZZ/2)^{2g}$ of torsion of order 2 in the Jacobian.

Example: bitangents to a plane quartic; distinguished triples of bitangents

\subsection{Intermediate Jacobians and the irrationality of cubic threefolds}

First, describe the intermediate Jacobians $J(X)$ of higher-dimensional varieties $X$ by analogy with the case of curves; introduce the Abel-Jacobi maps from parameter spaces of cycles on $X$ to $J(X)$.

Application: show that the intermediate Jacobian of a cubic threefold is not the Jacobian of a curve by calculating the degree of the Gauss map on the theta-divisor and showing it's not 70 (which by the calculation above it would be if $J(X)$ were a Jacobian). Deduce irrationality of $X$.

I know this is a bit of a stretch for the current volume, but I'd really like to include it if at all possible: the proof in Clemens-Griffiths is a mess, and this is much simpler

\input footer.tex

