\input{header}

\chapter{Fine Moduli spaces} 
\label{Moduli chapter}\label{ModuliChapter}

\section{What is a moduli problem?}

Algebraic geometry is almost unique among geometric theories in that the objects involved---varieties,  schemes or maps between them---can be parametrized by other varieties or schemes. The set of submanifolds of a given manifold, or more generally of maps between two given manifolds, seems too large to be given the structure of a finite-dimensional manifold itself. By contrast, any algebraic variety is specified by a finite collection of polynomials, which in turn have a finite number of coefficients, so it's not too far-fetched that the collection of all varieties with specified numerical invariants, or morphisms between two given varieties, could be given the structure of a ``moduli space'' that is a variety (or scheme or\dots) in its own right.

For an example---perhaps the original one---projective plane curves of degree $d$
are in natural one-to-one correspondence with the forms of degree $d$ modulo the group of nonzero scalars---that is, with the points of the dual of the projective space
$ \PP(H^0(\sO_{\PP^2}(d)))=\PP^{\binom{d+2}{2}-1} $.
Thus, for example, plane cubics are parametrized by $\PP^{9}$, and a  family $\cC \to B$ of cubics corresponds to a map $\phi: B \to \PP^9$.
In this chapter, we'll give a general framework for the notion of moduli space, introducing the main examples that we will treat in this book.

\begin{figure}
 \caption{One-parameter family of plane cubics}
\centerline {\includegraphics[height=2in]{"Fig6.1.pdf"}}
\end{figure}
 
There are several ways in which the possibility of making moduli spaces has been useful in algebraic geometry. First, the existence of a moduli space that  parameterizes objects of a certain type allows us to speak of ``the general object'', meaning that we allow ourselves to avoid the ``special'' properties of objects parameterized by closed subvarieties of the moduli space. We have already used this
possibility in many places in this book. 

Second, it allows us to speak coherently about
families of objects. Some moduli spaces carry \emph{universal families}, and every nice family of the sort of objects
they parameterize is pulled back from this one by a unique map.  

This idea was already exploited informally in the nineteenth century in the guise of ``preservation of number'', used to count configurations of points or curves with a given property by specializing the 
data, and we have also exploited this idea in
Chapter~\ref{JacobianChapter} to explain the count of odd and even theta characteristics on a a general curve by appealing to the existence of a specialization to a hyperelliptic curve. In a related manner, we have already seen how the fact that invertible sheaves of degree $d$ on a curve $C$ are parametrized by a $g$-dimensional variety allows us to prove the ``$g+3$" theorem (Theorem~\ref{g+3 theorem}).

Third, to the extent that we can describe the intersection theory of a moduli space, it opens up the possibility of doing enumerative geometry on it to count solutions of geometric problems---and in particular to prove the existence of solutions. For example, knowing that the parameter space for lines in $\PP^3$ is the Grassmannian $\GG(1,3)$, a projective variety of dimension 4, and that the condition that the set of lines meeting a given curve of degree $d$
is a divisor linearly equivalent to  $d$ times the hyperplane section, we can conclude  that there exists a line in $\PP^3$ meeting any any four given curves \cite[Section 3.4.1]{3264}. We will use the same idea to prove the much deeper existence of certain linear series on all curves (the ``existence" half of the Brill-Noether theorem, discussed in Chapter~\ref{Brill-Noether}). 

\begin{figure}
 \caption{In a one-parameter family of lines in $\PP^3$, a finite number will meet a given curve $C$}
\centerline {\includegraphics[height=3in]{"Fig6.2.pdf"}}
\end{figure}

In modern terms, a \emph{moduli problem} consists of a class of objects in algebraic geometry---schemes, subschemes of a given scheme, sheaves on schemes, maps of schemes, typically defined by some common attributes---and a notion of what it means to have a \emph{family} of these objects parametrized by a scheme $B$. The notion is formalized in the idea of a \emph{moduli functor}, 
which associates to each scheme $B$ the set of families over $B$ of the given sort. Examples will make this vague notion more concrete.

\subsection{Some moduli problems}

\begin{enumerate}\label{list of moduli problems}

\item \emph{Effective divisors on a given curve}. The objects are effective divisors of given degree on a given smooth, projective curve $C$. A family of such divisors is a subscheme $\cD \subset B \times C$, flat of degree $d$ over $B$. 
Here we are using
the equivalence between divisors of degree $d$ on a smooth curve and degree $d$ subschemes of the curve. The moduli space is the $d$-th symmetric power $C_d$ of $C$, discussed in Section~\ref{symmetric section}.

\item \emph{Line bundles on a given curve}. The objects are invertible sheaves on a given smooth projective curve $C$. A family over a scheme $B$ is an equivalence class of invertible sheaves $\cL$ on $B \times C$ whose restriction to each fiber of $B \times C$ over $B$ has degree $d$, where two families $\cL$ and $\cL'$ on $B \times C$ are equivalent if $\cL\cong \cL' \otimes \cM$, where $\cM$ is  an invertible sheaf pulled back from $B$. Usually one restricts attention to invertible sheaves 
whose restrictions to each fiber $b\times C$ have a given degree $d$.
The moduli spaces are the Jacobian and Picard varieties, discussed in Section~\ref{Picard section}.

\item \emph{Moduli of smooth curves}. The objects are isomorphism classes of smooth, projective curves of genus $g$. A family over $B$ is an equivalence class of smooth, projective morphisms $f : \cC \to B$ whose fibers are curves of genus $g$, where two such families $f, f'$
are equivalent if there is an isomorphism from the source of $f$ to the source
of $f'$ making the diagram
$$
\begin{diagram}[small]
\cC && \rTo^\cong && \cC'\\
&\rdTo_f&&\ldTo_{f'}\\
&&B
\end{diagram}
$$
commute.

The moduli spaces $M_g$ of curves are harder to construct, and we will have a separate discussion of them in the following chapter. Nonetheless, it will be useful at several points in this chapter to assume their existence, and we will do so accordingly.

\item \emph{Hurwitz spaces}. The objects are a curve $C$ of a given genus, together with a map $f: C\to \PP^1$ of given degree, up to isomorphisms of the curves that commute with the map, as in the diagram
$$
\begin{diagram}[small]
C && \rTo^\cong && C'\\
&\rdTo_f&&\ldTo_{f'}\\
&&\PP^{1}
\end{diagram}.
$$
A family over B is a flat map $\cC \to B\times \PP^{1}$.
 Often the allowable ramification indices are specified. We will discuss the simplest Hurwitz scheme in Chapter~\ref{CurvesModuliChapter}.

\item \emph{Severi varieties}. The objects are plane curves
of given degree $d$ and geometric genus $g$. If $g \neq {d-1\choose 2}$
the curves will necessarily be singular but are often
constrained to have only mild singularities, usually only nodes. We will discuss the Severi variety in Chapter~\ref{CurvesModuliChapter}.

\item \emph{Hilbert schemes}. The objects are subvarieties of a given projective space;   A family over $B$ is a subscheme $\cC \subset B \times \PP^r$, flat over $B$. If $B$ is reduced then the flatness condition is equivalent to the  constancy of the Hilbert polynomial \cite[]{Hartshorne1977}. In Chapter~\ref{HibertSchemesChapter} we will study the
open set consisting of smooth curves $C\subset \PP^{r}$ of given degree and genus. 

There are many useful variants of this notion, such as:
\begin{enumerate}

\item Subschemes of a given scheme

Though the Hilbert scheme is a priori about subschemes of projective space, it is easy to see that if $X\subset \PP^n$,
then the family of subschemes $Y$ of $X$ with given Hilbert function $p$ is a closed subscheme of $Hilb_p(\PP^n)$: we simply
add the condition that the vector space of forms of high degree defining $Y$  contain the vector space defining $X$---this is also a determinantal condition.

\item{Nested pairs} A variant of the Hilbert scheme construction can be used to parametrize \emph{nested pairs} of subschemes of $\PP^r$; that is, given a pair of polynomials $p(m)$ and $q(m)$ we can consider pairs $(X,Y)$ with $X \subset Y \subset \PP^r$, with $X$ having Hilbert polynomial $p$ and $Y$ having Hilbert polynomial $q$. The construction is simple: we find a suitably large $m$, and associate to any such pair $X \subset Y \subset \PP^r$ the point
$$
H^0(\cI_Y(m)) \subset H^0(\cI_X(m)) \subset H^0(\cO_{\PP^r}(m))
$$
in the flag manifold $F(\binom{r+m}{r} - q(m), \binom{r+m}{r} - p(m), \binom{r+m}{r})$.

For example, we could take $p=1$; the resulting space would parametrize pointed subschemes $(y,Y)$ with $Y \subset \PP^r$ having Hilbert polynomial $q$ and $y \in Y$.

\item{Relative Hilbert schemes} Suppose now that $\cX \to B$ is a family of projective schemes over some base $B$; that is, $\cX$ is a subscheme of $B \times \PP^r$ flat over $B$. For any Hilbert polynomial $q(m)$, we can parametrize pairs $(b, Y)$ with $b \in B$ and $Y \subset X_b$ a subscheme of the fiber $X_b$ having Hilbert polynomial $q$.

\item{Morphisms} Suppose we want to parametrize morphisms between two given projective schemes $X$ and $Y$. We can embed the product $X \times Y$ in a larger projective space $\PP^N$, and then consider the Hilbert scheme $\cH$ parametrizing subschemes of the product $X \times Y$. Among such subschemes are the graphs of maps $f: X \to Y$; since a map is determined by its graph, this expresses the family of morphisms from $X$ to $Y$ as a locally closed subscheme of $\cH$.

\item{The Isom functor}\label{Isom}
Finally, we can combine the last two constructions to construct what is called the Isom scheme. The situation is this: we are given families of projective varieties $\cX \subset B \times \PP^r$ and $\mathcal{Y} \subset B\times \PP^s$, and we want to parametrize the set of morphisms between members of these two families; that is, the set
$$
\{ (b, f) \mid b \in B \text{ and } f: X_b \to Y_b \}
$$
The techniques of the last two items allow us to do exactly that; and we can further restrict to the locus where $f$ is an isomorphism to arrive at a scheme, called the Isom scheme, parametrizing isomorphisms between corresponding fibers of $\cX$ and $\mathcal Y$.

\item{The Quot scheme} Subschemes of $\PP^{r}$ correspond to the quotients of $\sO_{\PP^{r}}$. Why not quotients of some other coherent sheaf? Indeed, the original construction by Grothendieck starts with a coherent sheaf $\sE$
on a relative scheme $X/S$, and forms the functor of families of surjections $\sE \to \sF$ such that $\sF$ is flat over $X$. See for example~\cite{MR2222646}.
 For variants involving Hilbert functions instead of Hilbert polynomials, and other gradings, see~\cite{MR2073194}.

\end{enumerate}


\end{enumerate}

\section{What is a solution to a moduli problem?}

Typically what we want from a solution to a moduli problem is to understand all possible families of the objects
in question. In particular, the individual objects should be in natural one-to-one correspondence with the closed points of the
moduli space.  The word \emph{natural} is the key. Most of the time, the set of objects we are interested in has cardinality $2^{\aleph_0}$, as do all positive-dimensional varieties $M$ over $\CC$, so a mere  bijection between the points of $M$ and the objects to be parametrized is meaningless.

In the nicest situations there is a \emph{universal} family $\phi: \cX\to M$ of these objects over $M$,
such that any family over a scheme $B$,  is pulled back from the one on $M$ via a unique morphism $B\to M.$  Such a space $M$ with its universal family $\phi$, if it exists, is called a \emph{fine moduli space}. This can be expressed more abstractly but more succinctly by saying that the moduli scheme \emph{represents the moduli functor}, which means there is an isomorphism of functors:
$$
\{ B \mapsto \text{families of } X \text{ over } B \} \cong \{ B\mapsto {\rm{Mor}}_{{\rm Schemes}}(B, M) \}.
$$
If $M$ is a fine moduli space then the identity map $M\to M$ corresponds to the ``universal family'' $\phi: \cX \to M$. 
For example, the Hilbert scheme, as well as $Div_d(C)$ and $\Pic_d(C)$ are fine moduli spaces; the moduli space of curves
and the Hurwitz schemes are not.

If a fine moduli space and its universal family exist, then it is unique up to unique isomorphism: given two avatars $M$ and $M'$
the universal family on $M$ corresponds to a map $M\to M'$, and we similarly produce a map $M'\to M$. The pullback of the universal family on $M$ by the composition of these two maps is again the universal family, so the composition is the identity map.

Although the moduli space of curves and the Hurwitz spaces are not fine moduli spaces, they are still defined
in a way that makes them unique, as we shall see below.

\def\eps{{\epsilon}}
One of the useful features of a fine moduli space is that it makes the computation of tangent spaces relatively easy.
Recall that if $(R,\gm)$ is the local ring at a point $m$ on a variety $\cM$ then the (Zariski) tangent
space to $M$ at $m$ is the vector space of linear functionals $Hom_{R/\gm}(\gm/\gm^2, R/\gm)$.   Assuming that
$R$ contains its residue field $k := R/\gm$, such functionals
are precisely the restrictions to $\gm/\gm^2$ of the ring homomorphisms $R \to k[\eps]/(\eps^2)$ inducing the identity on $k$.
 If $\cM$ is a fine moduli space for some functor $F$, then such maps are in one-to-one correspondence
with the set $F(E)$ of families over $E := \Spec(k[\eps]/(\eps^2))$. 


The vector space structure on the tangent space is also accessible from this description: since the representable
functor $\rm{Mor}_{\rm Schemes}(B, M)$ preserves products, the
 sum of tangent vectors corresponding to families $X_i \to E$ is the restriction to the diagonal
 $E \subset E\times E$
 of the product family $X_1 \times X_2 \to E\times E$.
Often one can to compute the tangent space to a moduli space before even knowing that the moduli space exists!

%Hilbert schemes are fine moduli spaces for subschemes of a given scheme, but 
%fine moduli spaces do not exist for all moduli problems. As we'll explain in Section~\ref{coarse moduli}, there does not exist a universal family of abstract curves of genus $g$: the moduli space of curves is
%not a fine moduli space, but has a slightly weaker property.

\section{Hilbert schemes}\label{hilbert scheme section}

The Hilbert scheme is a fine moduli space representing the functor of flat families of subschemes of $\PP^r$,
that is, the functor that takes a scheme $B$ over $\CC$ to the set of subschemes $\sX \subset B\times \PP^r$
that are flat over $B$; a morphism $f: B'\to B$ induces a map carrying a family to the pullback of the family by $f$.

\begin{example}[The Hilbert scheme of plane curves]\label{Hilb for plane curves}
Let $p(m) := dm+1-{d-1\choose 2}$ be the Hilbert polynomial of a plane curve of degree $d$, and consider the family $Hilb_p(\PP^2)$ of schemes $X \subset \PP^{2}$ having Hilbert polynomial $p$. Since 
$\dim X = \deg p = 1$, $X$ has at least a component that is 1-dimensional, and this component must have degree
equal to $d$, the leading coefficient of $p$. Since the Hilbert polynomial  of this component is already equal
to $p_X(m)$ we see that $X$ is in fact a plane curve of degree $d$. The space $Hilb_{p}(\PP^2)$ is thus the projective space $\PP^{{d+2\choose 2}-1}$ of forms of degree $d$,
and the universal family is the projection 
$$
\{(x,F) \in \PP^2 \times \PP^{{d+2\choose 2}-1} \mid F(x) = 0\} \to \PP^{{d+2\choose 2}-1}.
$$
\end{example}
 
Since the Hilbert polynomials of the fibers of a flat family are all equal (\cite[Section III.9]{Hartshorne1977}, the Hilbert scheme is the disjoint union of components corresponding to particular Hilbert polynomials. For example, the set of curves $C \subset \PP^r$ of degree $d$ and genus $g$ corresponds to a subset of the Hilbert scheme parametrizing subschemes of $\PP^r$ with Hilbert polynomial $p(m) = dm - g + 1$, though not all schemes with this hilbert polynomial are purely one-dimensional subschemes, as we shall see. In this section, we'll describe
 the tangent spaces to the Hilbert scheme and sketch the construction. For a rigorous treatment of the construction of the Hilbert scheme, including many generalizations,  see~\cite{HomogHilbert} or \cite{MR2222646}. In Chapters~\ref{HilbertSchemesChapter}, we'll describe  the
 open subsets of smooth curves in the Hilbert schemes of curves of low degree and genus in $\PP^3$ in more detail. 

\subsection{The tangent space to the Hilbert scheme}\label{tan hilbert section}

Following the general recipe for tangent spaces to fine moduli spaces, we need to understand flat families
of projective schemes over $E := \Spec \CC[\eps]/(\eps^2)$. Recall (\cite[p. 182]{Hartshorne1977} that if $X\subset \PP^r$ is a smooth subscheme then
 the normal bundle $\sN_{X/\PP^r}$ of $X$ in $\PP^r$ is defined in in terms of the tangent bundles
 of $X$ and $\PP^r$ by the exact sequence: 
$$
0\rTo \sT_X \rTo^{\phi} \sT_{\PP^r}\mid_X \rTo \sN_{X/\PP^r} \rTo 0.
$$
Thus a global section of 
$\sN_{X/\PP^r}$
can be thought of as an infinitesimal motion of $X$.

\begin{figure}
 \caption{Infinitesimal perturbation of a curve by a normal vector field.}
\centerline {\includegraphics[height=2in]{"Fig6.0.pdf"}}
\end{figure}

To define the normal sheaf for locally complete intersection subschemes $X$ we first define the \emph{conormal sheaf}
to be the kernel of the dual  of $\phi$, which is the natural map $\Omega_{\PP^r}\mid_X \to \Omega_X$,
and since $X$ is locally a complete intersection, this corresponds to the exact sequence:
$$
0\to \sI_{X/\PP^r}/\sI_{X/\PP^r}^2 \to \Omega_{\PP^r}|_X \to \Omega_X \to 0.
$$
We thus define $\sN_{X/\PP^r} := \sHom(\sI_{X/\PP^r}/\sI_{X/\PP^r}^2, \sO_X)$.

By analogy, for any subscheme $X\subset \PP^r$ we define the \emph{normal sheaf}
of $X$ to be
$$
\sN_{X/\PP^r} := \sHom(\sI_{X/\PP^r}/\sI_{X/\PP^r}^2, \sO_X).
$$
In the smooth case, we see from the geometric description that  The following theorem shows that this
has the same connection with infinitesimal motions for arbitrary subschemes $X$.


\begin{theorem}\label{tangent space of Hilb}
Let $X\subset \PP^r$ be a subscheme with Hilbert polynomial $p(m)$. The flat families 
$\sX \subset \PP^r\times E$ specializing to $X$ at the closed point defined by $(\eps)$
are in natural one-to-one correspondence with the vector space $Hom_{\PP^r}(\sI_{X/\PP^r}, \sO_X) = H^0(\sN_{X/\PP^r})$, which is thus the tangent space to the Hilbert scheme $Hilb_{p}(\PP^r)$ at $[X]$.
\end{theorem}

\begin{proof}
We will actually treat the analogous result for an affine subscheme $X \subset \AA^r$; since our construction is natural, it will patch on an affine cover to give the projective case stated above. To simplify the notation, set $U = \CC[\eps]/(\eps^2)= S \oplus \eps S$. 

A $U$-module $M$ is flat  over $U$ if and only if $\Tor_1^U(\CC,M) = 0$. 
Since the free resolution of $\CC$ as a $U$-module has the form
$$
\cdots \rTo^\eps U \rTo^\eps U \rTo^\eps U \rTo \CC \rTo 0
$$
we have $\Tor_1^U(\CC,M)=0$ if and only if the submodule of $M$ annihilated by $\eps$ is $\eps M$.

%The algebra $T/I'$ is flat over $U$ if and only if $\Tor_1^U(T/I', \CC) = 0$.
%Let 
%$$
%F_2 \to F_1 \to T \to T/I' \to 0
%$$
%be the beginning of a $T$-free resolution of $T/I'$. Since $-\otimes_U\CC$ is right exact, 
%$\Tor_1^U(T/I', \CC)$  is the kernel of $F_1 \otimes \CC \to I$ modulo the image of
%$F_2 \otimes \CC \to F_1\otimes C$. Thus $\Tor_1^U(T/I', \CC) = 0$ if and only if
%all the relations on generators of $I$ can be lifted to relations on generators of $I'$.

We now construct a flat family from a homomorphism: Let $I = (g_1,\dots, g_t)\subset S = \CC[x_1,\dots, x_r]$ be the ideal defining $X$. 
Note that $Hom_S(I/I^2, S/I) = Hom_S(I,S/I)$. Let $\phi: I\to S/I$ be a homomorphism, and let $h_i\in S$ be
any element reducing to $\phi(g_i)$ modulo $I$.  The ideal
$$
I' := (g_1+\eps h_1,\dots, g_t+\eps h_t)\subset S[\eps]/(\eps^2) =: S'
$$
defines a scheme $\Spec S'/I'$  over $\Spec U$ which restricts to $X$ modulo $(\eps)$; that is, $I' +(\eps) = I$. 

To see that $I'$ is 
independent of the lifting chosen, suppose that $k_1,\dots,k_t\in I$ so that the elements $g_i+\eps(h_i+k_i)$ are a different lifting,
generating an ideal $I''$.
Writing $k_i = \sum r_{i,j}g_j$ we have $g_i+\eps(h_i+k_i) = g_i+\eps h_i+ \sum \eps r_{i,j}(g_i+\eps h_i)$, so 
$I'' \subset I$, and symmetrically $I' \subset I''$.

To prove flatness, suppose that $a\in S'$ and  $\eps a  \in I'$,
so that we can write  $\eps a= \sum(r_i+\eps s_i)(g_i+\eps h_i)$ for some $r_{i}, s_{i} \in S$.
It follows that 
$\sum r_i\g_i = 0$. Since $\phi$ is a homomorphism this implies $\sum r_i h_i \in I.$ Thus
$\eps a \in  \eps I\subset S'$, whence $a\in I + (\eps)$.  Writing $a =\sum p_i g_i+\eps b'$
and using the relations $g_i \equiv \eps h_i \hbox{ mod } I'$ we get
 $a \equiv \eps (\sum p_i h_i+b') \hbox{ mod } I'$, as required.

Finally, starting from a flat family $S'/I'$ over $U$ with $I' + (\eps) = I +\eps$, 
let $J$ be the image of $I'$ in $S'/(\eps I) = S \oplus (\eps S)/(\eps I)$. We claim that $J$ is the graph of a homomorphism $\phi: I \to  (\eps S)/(\eps I) \cong S/I$. 

Since $I' + \eps S = I +\eps S$,  the projection  to the first  summand of $S'$ maps $J$ onto $I$. 
To prove that $J$ is the graph of a homomorphism, it suffices to show that this projection is an isomorphism.
The kernel is
the intersection of $J$ with $(\eps S)/(\eps I )$, so we must show that
if $r\in S$ and $\eps r \in I'$ then $\eps r \in \eps I$. 

Since $\eps r \in I'$, the condition of flatness implies
that the image of $r$ in $S'/I'$ is in $\eps(S'/I')$, which is to say that $r \in I' + \eps S = I +\eps S$.
Thus $r \in  I + \eps S,$ whence $\eps  r \in \eps I$ as required.

This shows that
$J$ is the graph of a homomorphism $\phi$ such that
 $I'$ is generated by $\{g+\phi g\mid g\in I\}$, so the two constructions are inverse to one another.
\end{proof}

\begin{example}\label{Hilb for plane curves-continued}
If $C$ is the plane curve of degree $d$ defined by a form $F$, then the ideal sheaf of $C$ is $\sO_{\PP^2}(-d)$, and thus
$$
\sI_{C/\PP^2}/\sI_{C/\PP^2}^2 = \sO_{\PP^2}(d)\mid_C = \sO_C(d).
$$
From the exact sequence 
$$
0\rTo\sO_{\PP^2}\rTo^F\sO_{\PP^2}(d) \rTo\sO_C(d)\rTo 0
$$
we deduce that the dimension of the tangent space to $Hilb_{p(m)}(\PP^2)=\PP^d$  at $C$
with $p(m) = dm+1-{d-1\choose 2}$,
is $h^0(\sO_C(d)) = h^0(\sO_{\PP^2}(d))-1 = \dim \PP^d$, as expected.
\end{example}

\

\subsection{Parametrizing twisted cubics} By Lemma~\ref{smooth is open} below, the set of twisted cubics---that is, smooth curves of degree 3 in $\PP^3$---is an open subset of the Hilbert scheme $Hilb_{3m+1}(\PP^3)$. As we've seen, a twisted cubic curve $C \subset \PP^3$ can be described as the zero locus of three homogeneous quadratic polynomials $Q_1, Q_2$ and $Q_3$ in the homogeneous coordinates on $\PP^3$; to specify the twisted cubic we could just list the $3 \times 10 = 30$ coefficients of these. But of course we could replace the three quadrics $Q_i$ with any three independent linear combinations of them; what matters---and what is is naturally associated to $C$---is the vector space $V = \langle Q_1, Q_2, Q_3 \rangle \subset H^0(\cO_{\PP^3}(2))$ that they span. This suggests that we consider the map of sets
$$
h : \{ \text{twisted cubic curves } C \subset \PP^3 \} \to G = G(3, H^0(\cO_{\PP^3}(2)))
$$
obtained by associating to a twisted cubic $C$ the second graded piece of its homogeneous ideal. 

This differs significantly from the example of plane curves given at the beginning of this chapter: there, the objects to be parametrized were the zero locus of a single polynomial, and we could vary those coefficients arbitrarily and still have a plane curve; thus, the image of the analogous map was open in the projective space $\PP^N$. But if we generically
perturb the coefficients of the three quadratic polynomials $Q_i$ defining the twisted cubic the resulting quadrics will
be a complete intersection, generating
 the ideal of a set eight points. Thus the image of the map $h$ does not contain an open set.
We will give equations defining the image in Section~\ref{hilb construction}, and we can consider it
the Hilbert scheme of twisted cubic.

We will be mainly  interested in the subsets of the Hilbert schemes corresponding to smooth irreducible curves:
\fix{It's a problem that we only do this for a smooth base. We want to talk about the Hilbert schemes of smooth curves
in cases where the base is not even reduced, meaning, I guess, that the closed fibers are nonsingular. This
can be done with a Jacobian determinant argument. We should probably replace this Lemma}

\begin{lemma}\label{smooth is open}
Suppose that $X \to B$ is a flat family of projective schemes (that is, the projection to the second factor of 
$X\subset B\times \PP^n$  is flat) and $B$ is smooth. The points $b\in B$ such that the fiber $X_b$ is smooth and irreducible is an open set.
\end{lemma}

\begin{proof}
Since $B$ is smooth, it's closed points are locally complete intersections, so if $p\in X$ is a singular point of $X$ then the fiber through $p$ is singular. Since the singular subset of $X$ is closed and the family is projective, the image of the singular set in $X$ is closed, and we may remove it and assume that $X$ is smooth from the start. Now the condition that a point on a fiber is singular is a closed condition on $X$, so again its image in $B$ is closed. Finally, a smooth fiber $X_b$ is irreducible if and only if it is connected. This holds if and only if $h^0(\sO_{X_b}) = 1$ and by the flat base change theorem~\cite[Theorem 12.11]{Hartshorne1977} this set is open as well.
\end{proof}


\begin{proposition}\label{hilb of twisted cubics}
The open subset $\cH^\circ$ of the Hilbert scheme $Hilb_{3m+1}(\PP^3)$ parametrizing twisted cubics is irreducible of dimension 12.
\end{proposition}

\begin{proof}  Let $C_0 \subset \PP^3$ be a twisted cubic, and consider the family of translates of $C_0$ by automorphisms $A \in \PGL_4$ of $\PP^3$: that is, the family
$$
\cC = \{ (A, p) \in \PGL_4 \times \PP^3 \; \mid \; p \in A(C_0) \}.
$$
Via the projection $\pi : \cC \to \PGL_4$, this is a family of twisted cubics, and so it induces a map
$$
\phi : \PGL_4 \to \cH^\circ.
$$
Since every twisted cubic is a translate of $C_0$, this is surjective, with fibers isomorphic to the stabilizer of $C_0$, that is, the subgroup of $\PGL_4$ of automorphisms of $\PP^3$ carrying $C_0$ to itself. By Exercise~\ref{projective automorphism}, every automorphism of $C_{0}$ is induced by an automorphism of $\PP^{3}$, so the stabilizer is isomorphic to $\PGL_2$ and  thus has dimension 3. Since $\PGL_4$ is irreducible of dimension 15, we conclude that \emph{$\cH^\circ$ is irreducible of dimension 12}.
\end{proof}


\subsection{Construction of the Hilbert scheme in general}\label{hilb construction}

The Hilbert scheme is more complicated than would appear from the examples above, starting with the Hilbert polynomial $3m+1$. There are many subschemes of $\PP^3$ that have the same Hilbert polynomial $3m+1$ as a twisted cubic---for example, the union of a plane cubic and a point---and are not the intersection of the quadrics containing them. (See Exercises \ref{characterization of degree} and Exercise~\ref{deg of disjoint union}). In Chapters~\ref{HilbertSchemesChapter} we will discuss many more components of Hilbert schemes.

A fundamental result of~\cite{Matsusaka} provides a place to start:

\begin{lemma}\label{matsusaka}
Let $p(m) \in \QQ[m]$ be a polynomial. There exists an integer $m_0$ such that

\begin{enumerate}  

\item For any subscheme $X \subset \PP^r$ with Hilbert polynomial $p_X = p$ we have
$$
h^0(\cI_{X/\PP^r}(m)) = \binom{m+r}{r} - p(m) \quad \text{for all } m \geq m_0
$$
or in other words the Hilbert function of $X$ agrees with the Hilbert polynomial $p_X = p$ for all $m \geq m_0$; and

\item For any subscheme $X \subset \PP^r$ with Hilbert polynomial $p_X = p$ and
the saturated ideal of $X$ is defined by forms of degree $\leq m$.
\end{enumerate}
\end{lemma}



Note that  for any given $X$ the existence of an $m_0$ satisfying the statement of the lemma is immediate by Serre's vanishing theorem~\ref{Serre-Grothendieck vanishing}. The point of the lemma is that we can find one value of $m_0$ that works for all $X$ with Hilbert polynomial $p$. The following result of~\cite{Gotzmann} provides a method for determining $m_0$. 

\begin{theorem}
The Hilbert polynomial  of the homogeneous coordinate ring of any scheme $X\subset \PP^r$ can be written uniquely in the form
$$
\chi(\sO_X(m) = {m+a_1\choose a_1}+ {m+a_2 -1\choose a_2}+ \cdots+{m+a_s -(s-1)\choose a_s},
$$
with 
$$
a_1\geq \cdots \geq a_s \geq 0
$$
where the binomial coefficients are interpreted as polynomials in $m$. Moreover, the saturated homogeneous ideal of $X$ is
 generated in degrees $\leq s$, and one can take $m_0 = s$ in the construction of the Hilbert Scheme, above.
\end{theorem}
See~\cite{MR1023391} %Green-Gotzmann
for an exposition and a proof. From the coefficients $a_j$ one can read off uniform vanishing theorems for $H^i(\sI_X)$
 as well.
 
 For example, the Hilbert polynomial $3m+1$ of the twisted cubic may be written as
 $$
 3m+1 =  {m+1\choose 1}+ {m+1 -1\choose 1}+{m+1 -2\choose 1}+{m+0 -(3)\choose 0},
 $$
 Here $s=4$, and indeed the homogeneous ideal of the union of a plane cubic with a point, also in the plane,
 requires equations of degree 4.
 
 \subsection{Equations defining the Hilbert scheme}\label{eqns of Hilb}

The theorem allows us to define an injective map of sets
$$
h : \left\{ \text{subschemes $X \subset \PP^r$ with $p_X=p$} \right\}  \to G\big(\binom{m_0+r}{r} - p(m_0),\binom{m_0+r}{r} \big)
$$
by sending $X$ to $H^0(\cI_{X/\PP^r}(m_0))$, and its image is the set of closed points of the Hilbert scheme.
It remains to describe the scheme structure.

We observed above that though there are vector spaces of 3 quadrics in $\PP^{3}$ that define
twisted cubics, a general such vector space  would generate the ideal of
8 points,  not a twisted cubic. What we want to know is how to tell these cases apart algebraically. Consider the multiplication map
$$
V \otimes H^0(\cO_{\PP^3}(1)) \to H^0(\cO_{\PP^3}(3)).
$$
We saw in Chapter~\ref{genus 0 and 1 chapter} that the cokernel of this map is the 10-dimensional space $H^0(\sO_{\PP^1}(9))$, so the image of this map is 10-dimensional, whereas
3 general quadrics form a complete intersection and would have only Koszul syzygies, so
in the case of general quadrics this map would have 12-dimensional image.
This is a map from a 12-dimensional vector space to a 20-dimensional one, and what we've seen is that if $V$ is the net of quadrics containing a twisted cubic, it has a 2-dimensional kernel; that is, it has rank 10. 

Thus if $\cE$ is the universal subbundle on $G = G(3, H^0(\cO_{\PP^3}(2))$, and  $H^0(\cO_{\PP^3}(d))\otimes \sO_G$ is the trivial bundle, then the multiplication map above gives a map of vector bundles
$$
\mu: \cE \otimes H^0(\cO_{\PP^3}(1)) \to H^0(\cO_{\PP^3}(3))
$$
We can represent this locally as a matrix of functions, and the minors of this matrix vanish on the points of
of the Hilbert scheme: in a neighborhood of a point in $G$ corresponding to a twisted cubic, the common zero locus of these minors is the locus of nets of quadrics containing a twisted cubic


In fact, the construction of the Hilbert scheme in general is no more structurally complicated than this special case. Given a polynomial $p(m)$, we find a value of $m_0$ that satisfies the statement of Lemma~\ref{matsusaka}; we let
$$
G = G\big(\binom{m_0+r}{r} - p(m_0), \binom{m_0+r}{r} \big)
$$
be the Grassmannian, and let $h$ be the map from the set of subschemes of $\PP^r$ with Hilbert polynomial $p$ to $G$ sending $X$ to $H^0(\cI_{X/\PP^r}(m_0))$. We then get a map of vector bundles  on $G$
$$
\sE \otimes H^0(\cO_{\PP^r}(1)) \to H^0(\cO_{\PP^r}(m_0+1)),
$$
and indeed in a neighborhood of any point of $G$ in the image of $h$, the common zero locus of the minors of size $\binom{r+m_0+1}{r} - p(m_0+1)$ of a matrix representative of this map is the image of $h$; and these functions define the Hilbert scheme.

\section{Exercises}


\begin{exercise}\label{deg of disjoint union}
Suppose that a scheme $X\subset \PP^n$ is the disjoint union of subschemes $Y,Z$. Show that the Hilbert polynomial of
$X$ is the sum of the Hilbert polynomials of $Y$ and $Z$. What statement can you make about the Hilbert functions?
\end{exercise}

\begin{exercise}
More generally, suppose that a scheme $X\subset \PP^n$ is the union of subschemes $Y,Z$. Show that the Hilbert polynomial of
$X$ is the sum of the Hilbert polynomials of $Y$ and $Z$ minus the Hilbert polynomial of $Y\cap Z$. 
\end{exercise}

\begin{exercise}
Let $H \subset \PP^3$ be a 2-plane; let $C \subset H$ be a plane cubic curve and $p \in H \setminus C$ and point in $H$ not on $C$; let $X = C \cup \{p\}$.
\begin{enumerate}
\item Show that the Hilbert polynomial of $X$ is $p_X(m) = 3m+1$.
\item Show that the smallest value of $m_0$ satisfying the statement of Lemma~\ref{matsusaka} is 4.
\end{enumerate}
\end{exercise}

\begin{exercise}\label{rational normal hilbert}
Use an  argument like that of Proposition~\ref{hilb of twisted cubics} to show that the restricted Hilbert scheme $\cH^\circ$ of rational normal curves $C \subset \PP^r$ is irreducible of dimension $r^2+2r-3$.
\end{exercise}

\begin{exercise}\label{hilb at a ci}
If $C = X\cap Y\subset \PP^3$ is a complete intersection of surfaces of degrees $d,e$, then
$Hilb$ is smooth at the point $[C]$, of dimension $2\binom{3+d}{3}-4$ if $d=e$
or $\binom{3+d}{3} +\binom{3+e}{3} -\binom{3+e-d}{3} -3$ if $d<e$.

Hint: The normal bundle is $\sN = \sO_C(d)+\sO_C(e)$. To prove smoothness, use
Exercise~\ref{ci is acm} to compute $H^0(\sN)$.
\end{exercise}

%\begin{section} possible exercises:
%\begin{enumerate}
%\item Iarrobino: large component
%\item hilb of quartics in P3
%\item hilb of all rational curves in P3
%\item hilb of pairs: define; prove "line on quadric" is irreducible.
%\item hilb for linear space is the Grassmannian
%\item describe an analogue of the construction of hilb for the case of nested pairs of schemes
%\item in a hilb \times hilb, show that the locus of pairs of schemes that intersect in closed. (Hint intersect universal families, push forward)
%\end{enumerate}
%\end{section}
\input{footer}

