\input{header}

\chapter{Moduli} 
\label{Moduli chapter}\label{ModuliChapter}

%%Here's a possible new structure for the chapter. Possible too ambitious. But some items below could be quite short. Can we prove *anything*? Severi varieties move back home to "Plane curves". Hurwitz and Hurwitz numbers should go into the Hyperelliptic chapter, where we have a section on coverings of $\PP^1$ already.
%%dfc
%%\begin{enumerate}
%% \item Name: let's call it ``parameter spaces and moduli''.
%% 
%% Introduction: what we want of moduli (replacing "what is a moduli problem"). Three routes
%% re%% \item The moduli space. Approach \#1 (Mumford's Thesis, GIT, then--for the compactification, projectiveness, Mumford-Kundsen and Knudsen) Explain Hilbert scheme of tricanonical curves, linearize the action of PGL, take quotient. Fibers are NOT the orbits (unlike case of finite groups). Stable, semistable, unstable. 
%% 
%% \item Interlude: Semistable reduction. ``every degeneration of curves is a degeneration to a nodal curve''
%%(mention open problems). The reason why the compactification is compact.
%%
%%\item The moduli space. Approach \#2 (Deligne-Mumford)
%%
%%\end{enumerate}
%%

\section{What is a moduli problem?}

Algebraic geometry is almost unique among geometric categories in that the objects---varieties,  schemes or maps between them---can be parametrized by other varieties or schemes. The set of submanifolds of a given manifold, or more generally of maps between two given manifolds, seems too large to be given the structure of a finite-dimensional manifold itself. By contrast, any algebraic variety is specified by a finite collection of polynomials, which in turn have a finite number of coefficients, so it's not too far-fetched that the collection of all varieties with specified numerical invariants, or morphisms between two given varieties, could be given the structure of a ``moduli space'' that is a variety (or scheme or\dots) in its own right.

For example, projective plane curves of degree $d$
are in natural one-to-one correspondence with the forms of degree $d$ modulo the group of nonzero scalars---that is, with the points of the dual of the projective space
$ \PP(H^0(\sO_{\PP^2}(d)))=\PP^{\binom{d+2}{2}-1} $.
Perhaps this is the origin of the impulse in algebraic geometry to make 
 \emph{moduli}, or \emph{parameter spaces}---spaces parametrizing algebro-geometric objects of a specified sort. In this chapter, we'll give a general framework for the notion of moduli space, introducing the main examples that we will treat in this book.

There are at least two ways in which this possibility has been useful in algebraic geometry. First, the existence of a moduli space that in some \emph{natural} parameterizes objects of a certain type allows us to speak of ``the general object'', meaning that we allow ourselves to avoid the ``special'' properties of objects parameterized by closed subvarieties of the moduli space. We have already used this
possibility in many places in this book. 

The second reason that having a moduli space is important in algebraic geometry is that it allows us to speak coherently about
families of objects. Ideally, the notion of ``natural'' should imply that every family of objects of a given sort
is obtained by pullback along a map to the moduli space of such objects. 

This idea was already exploited informally in the nineteenth century in the guise of ``preservation of number'', used to count configurations of points or curves with a given property by specializing the 
data, and we have also exploited this idea in
Chapter~\ref{JacobianChapter} to explain the count of odd and even theta characteristics on a a general curve by appealing to the existence of a specialization to a hyperelliptic curve.

In modern terms, a \emph{moduli problem} consists of a class of objects in algebraic geometry---schemes, subschemes of a given scheme, sheaves on schemes, maps of schemes, typically defined by some common attributes---and a notion of what it means to have a \emph{family} of these objects parametrized by a scheme $B$. The notion is formalized in the idea of a \emph{moduli functor}, 
which associates to each scheme $B$ the set of families of the given sort. Examples will make this vague notion more concrete.

\subsection{Examples of moduli problems}

\begin{enumerate}\label{list of moduli problems}

\item \emph{Effective divisors on a given curve}. The objects are effective divisors of given degree on a given smooth, projective curve $C$. A family of such divisors is a subscheme $\cD \subset B \times C$, flat of degree $d$ over $B$. 
Here we are using
the equivalence between divisors of degree $d$ on a smooth curve and degree $d$ subschemes of the curve. The result is the symmetric power $C_d$, discussed in Section~\ref{symmetric section}.

\item \emph{Line bundles on a given curve}. The objects are line bundles of given degree on a given smooth projective curve $C$. A family of line bundles over $B$ is an equivalence class of line bundles $\cL$ on $B \times C$ whose restriction to each fiber of $B \times C$ over $B$ has degree $d$, with the equivalence relation that two families $\cL$ and $\cL'$ on $B \times C$ are equivalent if $\cL$ and $\cL'$ differ by a line
bundle pulled back from $B$. 
The result is the Jacobian and Picard varieties, discussed in Section~\ref{Picard section}.

\item \emph{Hurwitz spaces}. The objects are curves of a given genus, together maps to $\PP^1$ of given degree, up to isomorphism of the curves that commute with the maps. Often the allowable ramification indices are specified.

\item \emph{Severi varieties}. The objects are plane curves
of given degree $d$ and geometric genus $g$. If $g \neq {d-1\choose 2}$
the curves will necessarily be singular but are often
constrained to have only mild singularities, usually only ordinary nodes.

\item \emph{Hilbert schemes}. The objects are curves of given degree $d$ and arithmetic genus $g$ in $\PP^r$.  A family of such curves over $B$ is a subscheme $\cC \subset B \times \PP^r$, flat over $B$,  whose fibers are smooth, projective curves of genus $g$. More generally, there are Hilbert schemes
for subschemes with any specified Hilbert polynomial or Hilbert function.

\item \emph{Moduli of smooth curves}. The objects are isomorphism classes of smooth, projective curves of genus $g$. A family over $B$ is an equivalence class of smooth, projective morphism $f : \cC \to B$ whose fibers are curves of genus $g$, wheres two such families $f, f'$
are equated if there is an isomorphism from the source of $f$ to the source
of $f'$ making the diagram
$$
\begin{diagram}
\cC && \rTo^\cong && \cC'\\
&\rdTo_f&&\ldTo_{f'}\\
&&B
\end{diagram}
$$
commutative.
\end{enumerate}


We have already encountered examples 1 and 2 in Chapter~\ref{JacobianChapter}. Severi varieties will be discussed in Chapter~\ref{PlaneCurvesChapter}; we will discuss Hurwitz spaces at the end of this chapter, in connection with basic facts about the moduli space $M_g$. In this chapter we will discuss Examples 5 and 6.



\section{What is a solution to a moduli problem?}

Given a moduli problem, we want to construct a scheme $M$ whose closed points are in natural  1-to-1 correspondence with the objects we're trying to parametrize. The word \emph{natural} is the key. Most of the time, the set of objects we are interested in has cardinality $2^{\aleph_0}$, as do all positive-dimensional varieties $M$ over $\CC$, so a mere a bijection between the points of $M$ and the objects to be parametrized is useless.

What we really want from a moduli space $M$ is to understand \emph{all} the possible families of the objects it classifies. Thus it is natural to ask that there be a \emph{universal} family $\phi: \cX\to M$ of these objects over $M$,
and that every family over another base, say $B$,  be pulled back from the one on $M$ via a morphism $B\to M$ . Since we would prefer not to count families more than once, we can ask that the 
morphism $B\to M$ be unique. Such a space $M$ with its universal family $\phi$, if if exists, is called a \emph{fine moduli space}. This can be expressed more abstractly but more succinctly by saying that there is an isomorphism of functors:
$$
\{ B \mapsto \text{families of } X \text{ over } B \} \cong \{ B\mapsto \rm{Mor}_{\rm Schemes}(B, M) \}.
$$
If $M$ is a fine moduli space then the identity map $M\to M$ corresponds to the ``universal family'' $\phi: \cX \to M$. 

If a moduli space and its universal family exist, then it is unique up to unique isomorphism: given two avatars $M,M'$ of the fine moduli space of a given moduli problem,
the universal family on $M$ corresponds to a map $M\to M'$, and we similarly produce a map $M'\to M$. The pullback of the universal family on $M$ by the composition of these two maps is again the universal family, so the composition is the identity map.

Hilbert schemes are fine moduli spaces for subschemes of a given scheme, but 
fine moduli spaces do not exist for all moduli problems. As we'll explain in Section~\ref{course moduli}, there does not exist a universal family of abstract curves of genus $g$: the moduli space of curves is
not a fine moduli space, but has a slightly weaker property.


%In the case of the Hurwitz spaces, we consider pairs $(C,f)$ where $C$ is a smooth curve of genus $g$ and
% $f : C \to \PP^1$ is a branched cover of degree $d$, possibly with some further restrictions.
%%Also, we can look at pairs $(C,f)$ where $f : C \to \PP^2$ is a birational embedding of $C$ as a plane curve of degree $d$, yielding the Severi varieties (Section~\ref{severi variety}). These spaces are more readily described and better-behaved than the moduli space $M_g$ of abstract curves, or the Hilbert schemes $\cH$ of curves in higher-dimensional space. They have been useful in proving theorems about $M_g$ and $\cH$.
%%
%To describe the simplest setting, we fix integers $d \geq 2$ and $g \geq 0$. By the \emph{small Hurwitz space} $\cH^\circ_{d,g}$ we will mean a space parametrizing simply branched covers $f : C \to \PP^1$ of degree $d$, with $C$ a smooth projective curve of genus $g$. Here ``simply branched" means that every fiber  either is reduced---that is, consists of $d$ reduced points---or consists of one double point and $d-2$ reduced points. If a map $f : C \to \PP^1$ is simply branched, then Hurwitz' Theorem~\ref{Hurwitz} implies that the branch divisor $B \subset \PP^1$ of the map consists of $b = 2d+2g-2$ distinct points in $\PP^1$
%
%\fix{What's the equivalence relation? Does this and the Severi and variety actually fit into the moduli mold? If not, maybe this whole chapter should be "Moduli and other Parameter spaces"? If so,
%let's set the terms for the moduli problem and answer the question: Is $\cH^\circ_{d,g}$ a fine moduli space?}
%
%It is easiest to understand $\cH^\circ_{d,g}$ if we work over $\CC$ and use the classical topology. Since an effective divisor on $\PP^1$ is given by a homogeneous polynomial $F \in H^0(\cO_{\PP^1}(b))$, the space of all effective divisors is $(\PP^1)_b \cong \PP^b$, and the locus of reduced divisors---divisors consisting of $b$ distinct points---is an open subset $U \subset \PP^b$.
%%\fix{The hurwitz spaces section is all about $\cH^\circ_{d,g}$. Maybe we should say something about $\cH_{d,g}$ .}
%Consider the incidence correspondence
%$$
% \cH^\circ_{d,g}:= \{(F,C, f)  \mid f: C \to \PP^1 \text{ is  simply branched   with branch divisor } F = 0 \},
%$$
%and the associated projections
%\begin{diagram}
%& & \cH^\circ_{d,g} & & \\
%& \ldTo^\alpha & & \rdTo^\beta & \\
%U \subset \PP^b & & & & M_g
%\end{diagram} 
%Here $\alpha$ is the map associating to a branched cover $f : C \to \PP^1$ its branch divisor, and $\beta$ the map sending $f : C \to \PP^1$ to the point $[C] \in M_g$; the open set $U \subset \PP^b$ is the open set of $b$-tuples of distinct points in the space $\PP^b$ of all effective divisors of degree $b$ on $\PP^1$.
%
%Over $\CC$, we can describe a branched cover concretely: if we make a collection of cuts in $\PP^1$ joining a base point $p$ to each of the branch points $p_1, p_2, \dots, p_b$ of the map, the preimage in $C$ of the complement of the cuts will consist of $d$ disjoint copies of the complement of the cuts in $\PP^1$ (the ``sheets" of the cover), which we can label with the integers $1, 2, \dots, d$. In these terms, we can associate to each branch point $p_i \in \PP^1$ the transposition $\tau_i \in S_d$ exchanging the two sheets that come together over $p_i$. We arrive at a sequence of transpositions $\tau_1, \tau_2, \dots, \tau_b \in S_d$, that satisfies two conditions:
%
%\begin{enumerate}
%\item the product $\tau_1\cdot \tau_2 \cdots \tau_b$ is the identity (because the complement of the cuts is contractible); and
%\item the $\tau_i$ together generate a transitive subgroup of $S_d$ (because $C$ is connected).
%\end{enumerate}
%
%Note that the sequence $\tau_1, \tau_2, \dots, \tau_b \in S_d$ is determined by the cover $f : C \to \PP^1$ up to simultaneous conjugation in $S_d$: we can revise our labelling of the sheets, which has the effect of conjugating all the $\tau_i$ by the relabelling permutation. Conversely, any such sequence of transpositions determines a connected $d$-sheeted covering of the complement
%of the branch points, and a complex structure is determined by the fact that the covering map is a local isomorphism. One can analytically add patches of the form $z \mapsto z^2$ at the branch points to complete
%the covering to be a branched covering of $\PP^1$ by a (compact, connected) Riemann surface. 

%Thus the map $\alpha : \cH^\circ_{d,g} \to U$ is a finite covering space, which gives us a picture of the local geometry of $\cH^\circ_{d,g}$. 
%The degree of the covering space $\alpha : \cH^\circ_{d,g} \to U$ is called a \emph{Hurwitz numbers}, These arise in many contexts, and many have been calculated \cite{Graber-Vakil}. Clebsch, Hurwitz and others analyzed the monodromy of the cover $\alpha : \cH^\circ_{d,g} \to U$, and showed that it is transitive, proving that $\cH^\circ_{d,g}$ is irreducible for all $d$ and $g$ and hence, since $\cH^\circ_{d,g}$ dominates $M_g$ for $d \gg g$, that $M_g$ is irreducible for all $g$. (Because of the reliance on the classical topology, this argument only works in characteristric 0). 
%%\fix{The statement that high degree Hurwitz dominates moduli needs some
%%unpacking: existence of good projections or $g+2$ theorem, the fact that $M_g$ is not a fine modul space... .}
%
%The Hurwitz spaces also give us a way to estimate the dimension of the moduli space $M_g$. Since $\cH_{d,g}$ is a finite-sheeted cover of an open subset $U \subset \PP^b$, it has dimension  $b = 2d+2g-2$. 
%To find the dimension of $M_g$, we can choose $d \gg g$ (so that $\cH_{d,g}$ dominates $M_g$), and estimate the dimension of the fibers of $\cH_{d,g}$ over $M_g$.
%
%To do this, fix a curve $C$. To specify a map $f : C \to \PP^1$ we have to specify first a line bundle $L$ of degree $d$ on $C$ ($g$ parameters, as described in Chapter~\ref{new Jacobians chapter}. We then have to specify a pair of sections of $L$ (up to multiplying the pair by a scalar). By the Riemann-Roch Theorem, $h^0(L) = d-g+1$, so to specify a pair of sections (mod scalars) is $2(d-g+1)-1$ parameters. Altogether, we have
%$$
%2d+2g-2 = \dim \cH^\circ_{d,g} = \dim M_g + g + 2(d-g+1)-1;
%$$
%and solving, we arrive at
%$$
%\dim M_g \; = \; 3g-3.
%$$
%
%\fix{DE rev to here 10/26}
%\section{Severi varieties}
%
%%\fix{this material is partly repeated in the plane curves chapter. Especially if this chapter comes early, we could leave it here, and 
%%prune the plane curve treatment -- probably the right choice.}
%
%Just as the small Hurwitz space $\cH^\circ_{d,g}$ parametrizes pairs $(C,f)$ consisting of a smooth curve $C$ of genus $g$ and a map $f : C \to \PP^1$ of degree $d$
%with simple branching, the \emph{small Severi variety} parametrizes pairs $(C,f)$ consisting of a smooth curve $C$ of genus $g$ and a map $f : C \to \PP^2$ of degree $d$ that is birational onto a plane curve $C_0$ having only nodes as singularities. In this case, the curve $C$ is the normalization of $C_0$, so we can define the \emph{small Severi variety} $V_{d,g}$ to be the locally closed subset of the projective space $\PP^N$ parametrizing plane curves of degree $d$ corresponding to irreducible nodal curves of degree $d$ and geometric genus $g$.
%
%With both the small Hurwitz and small Severi varieties, it is useful to have a modular compactification or partial compactification of these spaces. In the case of the Hurwitz space, there is such a compactification: the \emph{space of admissible covers}, which are  maps of degree $d$ from nodal curves $C$ of arithmetic genus $g$ to nodal curves of arithmetic genus 0 satisfying certain local conditions. In the case of Severi varieties, we could take the closure $\overline{V_{d,g}}$ of $V_{d,g}$ in the space $\PP^N = \PP^{\binom{d+2}{2}-1}$ of all plane curves of degree $d$, but this is unsatisfactory in a number of ways: the singularities of $\overline{V_{d,g}}$ are arbitrarily awful, as are those of the curves $C_0 \subset \PP^2$ corresponding to the added points. It is an open problem to give a better compactification.
%
%
%The dimension of the (small) Severi variety is relatively easy to compute. A curve $C_0 \subset \PP^2$ corresponding to a point on the small Severi variety $V_{d,g}$ will have $\delta = \binom{d-1}{2} - g$ nodes; to describe the locus of such points, we can introduce the incidence correspondence
%$$
%\Sigma = \{(C_0,p_1,\dots,p_\delta) \in V_{d,g} \times (\PP^2)^\delta \; \mid \; C_0 \text{ has a node at $p_i$} \}.
%$$
%The fibers of the projection $\Sigma \to (\PP^2)^\delta$ are Zariski open subsets of linear subspaces of $\PP^N$, and an argument to be given in Section~\ref{severi variety} shows that they have the expected dimension $N - 3\delta$. Thus:
%$$
%\dim V_{d,g} = \dim \Sigma = 2\delta + N - 3\delta = 3d+g-1.
%$$
%
%As in the case of Hurwitz spaces, this knowledge is enough for us to determine the dimension of $M_g$. For any given $g$ if we choose $d \gg g$ the map $V_{d,g} \to M_g$ sending the pair $(C, f)$ to the point $C \in M_g$ will be dominant. If $C$ is a curve of genus $g$, then  to specify a map $f : C \to \PP^2$ of degree $d$ we have to choose a line bundle $L$ of degree $d$ on $C$ ($g$ parameters), and then choose 3 global sections of $L$ up to simultaneous multiplication by a scalar. By the Riemann-Roch Theorem we have $h^0(L) = d-g+1$, so
%$$
%3d+g-1 = \dim V_{d,g}  = g + 3(d-g+1) - 1,
%$$
%and solving we see again that $\dim M_g = 3g-3$.
%
%Like the Hurwitz space, the Severi variety $V_{d,g}$ is irreducible for all $d$ and $g\leq \binom{d-1}{2}$, and this could be used to prove that $M_g$ is irreducible for all $g$. However it is not so easy to prove irreducibility of the Severi variety\footnote{The second author of the current volume owes his current employment to this fact.}; the fastest way to prove irreducibility of $M_g$ (in characteristic 0, at least) is still via the Hurwitz spaces.

\section{Hilbert schemes}\label{hilbert scheme section}

The Hilbert scheme is the solution to the moduli problem of subschemes of projective space with given Hilbert polynomial; it is a fine moduli space. For example, the set of curves $C \subset \PP^r$ of degree $d$ and genus $g$ corresponds to a subset of the Hilbert scheme parametrizing subschemes of $\PP^r$ with Hilbert polynomial $p(m) = dm - g + 1$. In this section, we'll describe how the Hilbert scheme is constructed. In Chapters~\ref{HilbertSchemesChapter} and~\ref{HilbertSchemesCounterexamplesChapter}, we'll describe in more detail the Hilbert schemes of curves of low degree and genus in $\PP^3$. 



%We mentioned at the beginning of this chapter that since a subscheme $X \subset \PP^r$ may be specified by a finite number of polynomials, which in turn have a finite number of coefficients, that it's not unreasonable to hope that the set of all subschemes with given numerical invariants (e.g., their degree) would be parametrized by the points of a scheme. To get an idea of how we might go about doing this, and what sort of facts we need to establish to carry this out, let's start with an example: twisted cubic curves in $\PP^3$.

\subsection{Parametrizing twisted cubics} We  start with an example. As we've seen, a twisted cubic curve $C \subset \PP^3$ can be described as the zero locus of three homogeneous quadratic polynomials $Q_1, Q_2$ and $Q_3$ in the homogeneous coordinates on $\PP^3$; to specify the twisted cubic we could just list the $3 \times 10 = 30$ coefficients of these. But of course we could replace the three quadrics $Q_i$ with any three independent linear combinations of them; what matters---and what is is naturally associated to $C$---is the vector space $V = \langle Q_1, Q_2, Q_3 \rangle \subset H^0(\cO_{\PP^3}(2))$ that they span. This suggests that we consider the map of sets
$$
h : \{ \text{twisted cubic curves } C \subset \PP^3 \} \to G = G(3, H^0(\cO_{\PP^3}(2)))
$$
obtained by associating to a twisted cubic $C$ the second graded piece of its homogeneous ideal. 

We should point out one respect in which this differs from the example of plane curves given at the beginning of this chapter: there, the objects to be parametrized were the zero locus of a single polynomial, and we could vary those coefficients arbitrarily and still have a plane curve; thus, the image of the analogous map was open in the projective space $\PP^N$. In the present situation, though, if we vary the coefficients of the three quadratic polynomials $Q_i$ generally, the resulting quadrics will no longer intersect in a twisted cubic curve, but rather in eight points in $\PP^3$. Thus the image of the map $h$ is more complicated.
In fact, we'll see in Section~\ref{} below that the image of this map is a locally closed subvariety $U$ of the Grassmannian (we'll give the equations cutting it out in $G$), and the image can lay claim to being the moduli space of twisted cubics in $\PP^3$.

\subsection{Construction of the Hilbert scheme in general}

In general, we face additional problems. Not all curves of a given degree and genus lie on the same number of hypersurfaces of degree $m$ for all $m$. Furthermore, when we posed the problem, we spoke of parametrizing all subschemes $X \subset \PP^r$ with a given Hilbert polynomial; even in the case of twisted cubics there are many subschemes of $\PP^3$ that have the same Hilbert polynomial $3m+1$ as a twisted cubic---for example, the union of a plane cubic and a point---but that are not the intersection of the quadrics containing them.

A fundamental result of Matsusaka provides a place to start:

\begin{lemma}\label{matsusaka}
Let $p(m) \in \QQ[m]$ be a polynomial. There exists an integer $m_0$ such that

\begin{enumerate}  

\item For any subscheme $X \subset \PP^r$ with Hilbert polynomial $p_X = p$ we have
$$
h^0(\cI_{X/\PP^r}(m)) = \binom{m+r}{r} - p(m) \quad \text{for all } m \geq m_0
$$
or in other words the Hilbert function of $X$ agrees with the Hilbert polynomial $p_X = p$ for all $m \geq m_0$; and

\item For any subscheme $X \subset \PP^r$ with Hilbert polynomial $p_X = p$ and for all $m \geq m_0$, $X$ is the intersection of the hypersurfaces of degree $m$ containing it.
\end{enumerate}
\end{lemma}

Note that  for any given $X$ the existence of an $m_0$ satisfying the statement of the lemma is immediate by Serre's vanishing theorem~\ref{Serre-Grothendieck vanishing}. The point of the lemma is that we can find one value of $m_0$ that works for all $X$ with Hilbert polynomial $p$.

The first item allows us to define a  map of sets
$$
h : \left\{ \text{subschemes $X \subset \PP^r$ with $p_X=p$} \right\}  \to G\big(\binom{m_0+r}{r} - p(m_0), p(m_0)\big)
$$
by sending $X$ to $H^0(\cI_{X/\PP^r}(m_0))$; the second implies that this map is injective.  In Section~\ref{eqns of Hilb} we give a set of equations on $G = G(\binom{m_0+r}{r} - p(m_0), p(m_0))$ with common zero locus the image $\im(h)$, showing that $\im(h)$ is closed and giving it the structure of a scheme; this is the Hilbert scheme we seek.

\begin{exercise}
Let $H \subset \PP^3$ be a 2-plane; let $C \subset H$ be a plane cubic curve and $p \in H \setminus C$ and point in $H$ not on $C$; let $X = C \cup \{p\}$.
\begin{enumerate}
\item Show that the Hilbert polynomial of $X$ is $p_X(m) = 3m+1$.
\item Show that the smallest value of $m_0$ satisfying the statement of Lemma~\ref{} is 4.
\end{enumerate}
\end{exercise}

We observed above that if $Q_1, Q_2$ and $Q_3$ were general quadrics, their intersection would be
8 points,  not a twisted cubic. What we want to know is how to tell these cases apart algebraically. One way to do this is to consider the multiplication map
$$
V \otimes H^0(\cO_{\PP^3}(1)) \to H^0(\cO_{\PP^3}(3)).
$$
We saw in Chapter~\ref{genus0And1Chapter} that the cokernel of this map is the 10-dimensional space $H^0(\sO_{\PP^1}(9))$, so the image of this map is 10-dimensional, whereas
3 general quadrics form a complete intersection and would have only Koszul syzygies, so
in the case of general quadrics this map would have 12-dimensional image.
This is a map from a 12-dimensional vector space to a 20-dimensional one, and what we've seen is that if $V$ is the net of quadrics containing a twisted cubic, it has a 2-dimensional kernel; that is, it has rank 10. 

Thus if $S$ is the universal subbundle on $G = G(3, H^0(\cO_{\PP^3}(2))$, and  $H^0(\cO_{\PP^3}(d))\otimes \sO_G$ is the trivial bundle, then the multiplication map above gives a map of vector bundles
$$
\mu: S \otimes H^0(\cO_{\PP^3}(1)) \to H^0(\cO_{\PP^3}(3))
$$
We can represent this locally as a matrix of functions, and the minors of this matrix vanish on the points of
of the Hilbert scheme: in a neighborhood of a point in $G$ corresponding to a twisted cubic, the common zero locus of these minors is the locus of nets of quadrics containing a twisted cubic

\subsection{Equations defining the Hilbert scheme}\label{eqns of Hilb}

In fact, the construction of the Hilbert scheme in general is no more structurally complicated than this special case. Given a polynomial $p(m)$, we find a value of $m_0$ that satisfies the statement of Lemma~\ref{matsusaka}; we let
$$
G = G\big(\binom{m_0+r}{r} - p(m_0), p(m_0)\big)
$$
be the Grassmannian, and let $h$ be the map from the set of subschemes of $\PP^r$ with Hilbert polynomial $p$ to $G$ sending $X$ to $H^0(\cI_{X/\PP^r}(m_0))$. We then get a map of vector bundles  on $G$
$$
S \otimes H^0(\cO_{\PP^r}(1)) \to H^0(\cO_{\PP^r}(m_0+1)),
$$
and indeed in a neighborhood of any point of $G$ in the image of $h$, the common zero locus of the minors of size $\binom{r+m_0+1}{r} - p(m_0+1)$ of a matrix representative of this map is the image of $h$; and these functions define the Hilbert scheme.


%The Hilbert scheme $\cH_{d,g,r}$ parametrizes curves of given degree and arithmetic genus in $\PP^r$. For $r>2$, the theory is much more complicated.  Even if we restrict our attention to  what we might call the ``small Hilbert scheme"---the open subset corresponding to smooth, irreducible and nondegenerate curves---Hilbert schemes are truly wild. Locally, they can have arbitrarily bad singularities \cite{MR2227692}, at least for $r>3$. Furthermore, they can have many irreducible components---no one knows how many in general---of ;;;;;;;5 gfvcdimensions. 
%
%While the proof of existence of Hilbert schemes is highly nontrivial, a decent summary can be found in~\cite{3264}. In the present volume, we will describe a number of examples,  some nice  and some not-so-nice, in Chapters~\ref{HilbertSchemesChapter} and \ref{HilbertSchemesCounterexamplesChapter}.
%
%\fix{add material from 3264; for the moment perhaps just refer to it.}
%\fix{Here's a "fix" from Ch 15: Add a section on basics of the Hilbert scheme explaining why Hilbert schemes; the universal property; and the tangent space **I think this should go in Chapter 6---we should have a ``cast of characters" section there, where we introduce all the moduli spaces we'll be dealing with**}
%
%\fix{citations we could add: Constructions: Grothendieck Fonde;ments; \cite[Section IV]{Grothendieck19571962}; Mumford \cite[Chapter 15]{Mumford1966}, curves on an alg surface; Homogeneous Hilbert Schemes
%\cite{MR2361849}; Iarrobino~\cite{Iarrobino1985} and/or other work on punctual Hilbert schemes. \cite{BayerThesis}, Ramkumar \cite{fiber-full} \cite{Intro moduli}
%}

%The space $M_g$ parametrizing isomorphism classes of smooth projective curves of genus $g$---Example 1 of ~\ref{list of moduli problems}---is at the heart of the mystery that is algebraic curves. 
%Algebraic geometers of the 19th century were certainly aware that, while every smooth projective curve of genus 0 was isomorphic to the Riemann sphere, in  genus 1 and higher there are continuously varying families of non-isomorphic curves. 
%
%The idea of
%making these into the points of a space was clearly present in the work of Riemann, who asked among other things what the dimension of that space should be. He thought of $M_g$ as a real manifold, and arrived at the (correct) answer $\dim_\RR M_g = 6g-6$ for $g \geq 2$ by using the auxilliary construction of the \emph{Hurwitz space}, which we describe in Section~\ref{hurwitz spaces}. The same auxilliary construction was used by Hurwitz, Clebsch and others to assert the irreducibility of $M_g$; this was a crucial development, in that it allows us to talk unambiguously about a ``general curve."
%
%In low genus it is possible to give explicit constructions of $M_g$. For example, we have seen that every curve of genus 2 is expressible as a double cover of $\PP^1$ branched at six points, and  that the curve is determined by those points. Now, given six distinct points in $\PP^1$ we can find an automorphism of $\PP^1$ carrying three of the points to 0, 1 and $\infty$. The remaining three points will be sent to three distinct points in $\PP^1 \setminus \{0, 1, \infty \} $. Of course, this depends on how we order the points in the first place; at the end of the day, we see that the symmetric group $S_6$ acts on the quasi-projective variety
%$$
%\Gamma = \left( \PP^1 \setminus \{0, 1, \infty \} \right)^3 \setminus \Delta
%$$
%(where $\Delta$ is the union of all diagonals in the triple product), and the moduli space $M_2$ is the quotient $\Gamma/S_6$. There is clearly much more to say, but this construction at least does two things:
%
%One, it may serve to convince us that $M_2$ is irreducible of dimension 3; and
%
%Two, it allows us to write down explicitly a ``general curve of genus 2:" this is just the curve
%$$
%y^2 = x(x-1)(x-a)(x-b)(x-c)
%$$
%with $a, b$ and $c$ general scalars.
%
%There are similarly ad-hoc ways of describing the moduli spaces $M_g$ for other small values of $g$. For example, in genus 3 we've seen that a non-hyperelliptic curve of genus 3 is embeddable as a smooth plane quartic curve $C \subset \PP^2$. Now, the space of all quartic curves is a projective space $\PP^{14}$, and the subset of smooth curves is an open subset $U \subset \PP^{14}$. Moreover, the group $PGL_3$ of automorphisms of $\PP^2$ acts on this open set $U$, and---because every isomorphism between these curves extends to the whole plane---the moduli of (nonhyperelliptic) curves of genus 3 is, at lease set-theoretically, the quotient $U/PGL_3$.
%
%These constructions exhibit a typical pattern: one first chooses some data that forms a scheme, subject to a group of automorphisms whose orbits correspond to the objects one wants to parametrize. In the cases where the group is finite, or the stabilizers of points are sufficiently nice, the quotient may be a fine moduli space, as in the case of effective divisors, above. But even in very simple cases, this may not work.
%
%A rather trivial example of how this fails is given by the action of the multiplicative group $\CC^*$ on $\CC^1$, the
%affine line. There are only two orbits: one consisting of the point zero, and the other containing all nonzero points. It would thus seem natural to think that the moduli space of such points would be the disjoint union of two points. But this doesn't reflect the existence of a family, represented by the 
%identity map $\CC^1 \to \CC^1$, in which the nonzero point ``degenerates" to the zero point. Thus the moduli ``space" should be an object with two points, one in the closure of the other. The relevant ring of invariants, $\CC = \CC[x]^{\CC^*}$ is no use: it suggests that the quotient should be a single point (and indeed this is the best approximation among schemes).
%%\fix{say: because maps are given by regular functions, the map to the moduli space would have
%%have to factor through the invariants}
%
%A much more interesting example is the classification of square matrices under the action of conjugation by an invertible matrix. As every undergraduate learns, the equivalence classes are characterized by Jordan normal forms; but the invariant polynomials on the ring of matrices are just the coefficients of the characteristic polynomial, and these distinguish only the eigenvalues. (This example is discussed further in an informative way by Mumford in \cite{Mumford-Suominen}.)
%
%In the case of curves, the data we can produce is typically a point in some quasiprojective variety together with a group of automorphisms of the projective space. Thus, for example, taking the embedding by the complete linear series $|dK|$, the $d$-th multiple of the canonical series, all smooth curves of genus $g\geq 2$ can be represented as the points of an open subscheme of the Hilbert scheme $H$ of subschemes of $\PP^{d(2g-2)-g}$ whose Hilbert polynomial is $p(t) = (d(2g-2))t+1-g$, with group action given by
%$G := PGL(d(2g-2)-g+1)$. If the group action had been finite, we would have chosen a finite cover of $H$ by invariant open affine sets, and glued together the schemes corresponding to their rings of invariants. In this case we don't have that option: the group doesn't even act naturally on the homogeneous coordinate ring
%of $H$. 
%
%In his famous monograph on ``Geometric Invariant Theory" \cite{GIT}, Mumford established a paradigm for dealing with this problem: one \emph{chooses} a lifting of the action of $PGL(d(2g-2)-g+1)$ on $\PP^{d(2g-2)-g}$, called a \emph{linearization}, and then looks at the ring of invariant homogeneous forms. Although rings of invariants of infinite groups may fail to be finitely generated, it turns out that this does not occur for the classical groups such as the general linear group, so the ring of invariants can, in this case, be
%thought of as corresponding to a projective scheme, and there is a map from $H$
%to this scheme. In general this map is one-to-one only on an open subset, called the set of 
%\emph{stable} points; and cannot be defined in a way that preserves the topology (or the maps from families) outside a slightly larger subset called the set of 
%semi-stable points, and with these the image of the objects parameterized fill the projective variety
%defined by the ring of invariants.
%
%
%Thus one must look for good embeddings and linearizations for which the objects one cares about---in our case perhaps the smooth curves---become stable points, and this is attained by choosing the multiple $d=3$ in the sketch above sufficiently large. 
%%\fix{to take into account...: D\&M use the tricanonical embedding.}. 
%It turns out that the 
%set of \emph{stable} curves (always of genus $\geq 2$) is then a little larger: it includes all curves with finite automorphism groups, which can be characterized as those reduced connected curves with only ordinary double points as singularities and such that any component isomorphic to $\PP^1$ meets at least three other components. In recent times people have looked at other embeddings and linearizations, leading to a different set of stable curves; see for example \cite{SchubertCompactification},\cite{Hassett1}
%and \cite{Hassett2}
%%\fix{or Smythe?}
%
%%This is bogus in several respects: apart from the fact that we're excluding hyperelliptic curves, a much more serious issue is that we're taking the quotient of a variety by the positive-dimensional group $PGL_3$; and while the quotient of a variety by a finite group is always a variety, quotients by positive-dimensional groups may not be (think of $\CC^*$ acting on $\CC$ by scalar multipli[;]pcation: as a topological space, the quotient has two points, one in the closure of the other. \fix{but the reader wants to know whether THIS quotient is a variety, or not!} Nonetheless, it does two things:
%
%\subsection{Coarse moduli spaces vs. fine moduli stacks}
%
%Apart from the technical difficulties of constructing a moduli space of curves, it is a fundamental fact that \emph{a fine moduli space for smooth projective curves of genus $g$ does not exist}: in other words, the moduli functor, associating to a scheme $B$ the set of families of smooth projective curves over $B$ is simply noit representable in the category of schemes. (A summary of the reasons for this may be found in~\cite{GeomSchemes}.)
%There are two essentially equivalent ways out of this problem that sometimes work:
%
%First, we can weaken the definition and only require a bijection between families $\cC$ over $B$ and the set of morphisms $\phi_\cC : B \to M$ after finite base change. A \emph{coarse moduli space} $M$ is a space such that for every family  $\cC$ over $B$ 
%of the appropriate type there is a morphism $\phi_\cC : B \to M$ such that:
%
%\begin{enumerate}
%\item if $\phi_\cC : B_0 \to M$ is any morphism, then there exists a finite cover $\pi : B \to B_0$ such that $\phi_\cC \circ \pi : B \to M$ is the morphism associated to some family; and
%\item if $\cC \to B_0$ and $\cC' \to B_0$ are two families such that the associated morphisms $\phi_\cC = \phi_{\cC'} : B_0 \to M$ are equal, then there exists a finite cover $\pi : B \to B_0$ such that the pullbacks of $\cC$ and $\cC'$ to $B$ are equal.
%\end{enumerate}
%
%A careful argument shows that a coarse moduli space, if it exists, is also uniquely defined, by the moduli problem it solves.
%
%An alternative approach to this problem is to enlarge the category of schemes to the category of  \emph{stacks}, where in fact a fine moduli space for curves of genus $g$ does exist. This is the approach taken by Deligne and Mumford in~\cite{Deligne-Mumford}. The type of stack they introduce---now called \emph{Deligne-Mumford stacks}---have associated coarse moduli spaces, so their approach actually produces both.
%
%%and look for
%%a stack $M$ and replace morphisms in the category of schemes with morphisms to a stack. For this approach see~\cite{Deligne-Mumford}. 
%%
%%The moduli problem for smooth curves does have a coarse moduli space called $M_g$, to which we now turn.
%%
%%
%%\fix{ we should explain something of 
%%the problem with invariants of infinite groups -- that there aren't enough of them -- and say something
%%about GIT. This was actually promised when we discussed finite group quotients in Chapter 4. It might be most natural to do this with the elliptic curve example below, if we know enough to do it correctly. Since the Moduli space construction depends on the Hilbert scheme construction, this is also a reason to do that first; and then treat the elliptic curves as the simplest nontrivial example (except of course that it isn't the pluricanonical embedding.}
%
%
%%\subsection{Two modern approaches}
%%
%%\subsubsection{Deligne-Mumford}Though Riemann already (correctly) calculated the dimension of the moduli space $M_g$ as a real variety by heuristic arguments (as we did in preceding chapters), carrying out the programme outlined above for smooth curves turned out to be quite difficult. 
%%Perhaps the first complete proof was in David Mumford's 1960 Thesis under Oscar Zariski at Harvard: it's title is:
%%``Existence of the moduli scheme for curves of any genus" \cite{}. However, the first published treatment came only in 1969, with the publication of the landmark paper \cite{Deligne-Mumford}. Two results in that paper fundamentally altered the landscape of curve theory:
%%
%%First, they gave a precise, rigorous construction of the moduli space $M_g$ for any $g \geq 2$ (showing in particular that it was a coarse moduli space, but that no fine moduli space can exist in the category of schemes. They also proved the existence of a fine moduli \emph{ stack} $\cM_g$.). Second, they gave a modular compactification of $M_g$ (described in Section~\ref{compactifying Mg}), denoted $\overline M_g$. 
%%
%%Surprisingly, the compactification proved crucial in understanding the (uncompactified) $M_g$ itself, because it opened up the study of the moduli space of curves to the powerful techniques of modern projective geometry. This made possible the resolution of many outstanding problems related to moduli of curves, to which we shall return. 
%%
%%\subsubsection{Work of Mumford and Knudsen} The Deligne-Mumford paper proved that the
%%moduli spaces of stable curves are \emph{proper} (so, over the complex numbers, compact). The advantage of the method of geometric invariant theory is that it can show that a moduli space is projective by describing the scheme defined by
%%the graded ring of invariants associated with a linearization of the appropriate group action. In
%%Mumford-Knudsen and in Knudsen and Knudsen \fix{get refs to the three papers} this approach 
%%was carried out successfully.
%%
%%\fix{refer somewhere to Harris-Morrison}.
%%
%%\subsection{$M_g$ is only a coarse moduli space}
%%
%%The fact that $M_g$ is a coarse moduli space, not a fine one, manifests itself in two concrete ways:
%%
%%\begin{enumerate}
%%\item There exists a scheme $B$ and a map $B \to M_g$ that does not arise from a family $\cC \to B$ of curves over $B$; and
%%\item There exists a scheme $B$ and two families $\cC \to B$ and $\cC' \to B$ such that the associated maps $\phi_\cC$ and $\phi_{\cC'} \to B$ are equal (meaning in particular that for each closed point $b \in B$ the fibers $C_b$ and $C'_b$ are isomorphic); but such that $\cC$ and $\cC'$ are not isomorphic.
%%\end{enumerate}
%%
%%Examples of both of these can be found in \cite[****]{GeomSchemes}.\fix{add precise reference. The moduli question occupies only the last 2.5 pages of that book.}
%
%\subsection{Compactifying $M_g$}\label{compactifying Mg}
%
%In general, if $X$ is any variety a \emph{compactification} of $X$ is simply the inclusion of $X$ as an open subset of a compact, or proper variety $Y$. In case $X$ is a moduli space for a certain class of objects, however, there is a special class of compactifications,  called \emph{modular} in which $Y$ itself is the moduli space of some larger class of objects. In practice, if $M$ is a moduli space parametrizing a certain class $\Sigma$ of geometric objects---for example, smooth projective curves of genus $g$---and $N$ is a moduli space of the class of objects $\overline \Sigma$, then we apply the valuative criterion to test whether $N$ is compact (or \emph{proper}, over a different base field): If every family of objects in $\Sigma$ parametrized by a punctured disc $\Delta^*$ can be extended to a family of objects in the larger class $\overline \Sigma$ over the full disc $\Delta$ in a unique way, then $Y$ is compact and separated (that is, Hausdorff). If every object in the class $\overline \Sigma$ appears as a limit of objects in $\Sigma$, then $N = \overline M$ and $N$ is called a \emph{modular compactification} of $M$.
%
%In the example of the moduli space $M_g$ parametrizing smooth, projective curves of genus $g$, Deligne and Mumford introduced the larger class of \emph{stable curves}. These are by definition connected curves $C$ of arithmetic genus $g$, with two properties:
%
%\begin{enumerate}
%\item $C$ has only nodes as singularities; and
%\item the automorphism group of $C$ is finite.
%\end{enumerate}
%
%This  solution to the problem is not the only one: For example, \cite{MR1106299} shows that we can also give a modular compactification by enlarging the class of smooth curves to the class of \emph{pseudo-stable} curves, in which we allow cusps as well as nodes, but disallow elliptic tails (smooth components of genus 1 meeting the rest of the curve in only one point). Many other compactifications have been studied by Hassett-Hyeon-\cite{MR2500894}, Smyth~\cite{MR2801404} and ~\cite{MR3044128}, Alper-Fedorchuk-Smyth~\cite{MR3020172} and others.
%
%\subsection{Can one write down a general curve of genus $g$?}
%
%%The first important result about the moduli space is that $M_g$ is irreducible; we will sketch the characteristic 0 proof in Section~\ref{hurwitz spaces}  (a proof of the irreducibility of $M_g$ valid in arbitrary characteristic was not found until much later. \fix{reference!})
%
%Given that a moduli space $M_g$ exists and is irreducible, we can make sense of the question: Can one write down a general curve of genus $g$?
%That is: can we find a family of curves depending freely on parameters---in other words, a family $\cC \to B$ over an open subset $B \subset \AA^n$---that includes a general curve of genus $g$, in the sense that the induced map $\phi_\cC : B \to M_g$ is dominant? This is of course just the first step in knowing the structure of $M_g$.
%
%We have done this in the case of genus 2 and 3. Essentially
%the same approach works in genera $4$ and $5$; in each case a general canonical curve is a complete intersection, so that if we take the coefficients of its defining polynomials to be general scalars we have a general curve.
%
%This method breaks down when we get to genus 6, where a canonical curve is not a complete intersection. But it's close enough: a general canonical curve of genus 6 is the intersection of a smooth del Pezzo surface $S \subset \PP^5$ with a quadric hypersurface $Q$; since all smooth del Pezzo surfaces in $\PP^5$ are isomorphic, we can just fix one such surface $S$ and let $Q$ be a general quadric.
%
%It gets harder as the genus increases. Let's do one more case, genus 7, which already calls for a different approach. Here we want to argue that, by Brill-Noether theory, a general curve of genus $7$ can be realized as (the normalization of) a plane septic curve with 8 nodes $p_1,\dots,p_8 \in \PP^2$. Equivalently, if we let $S = Bl_{p_1,\dots,p_8}(\PP^2)$ be the blow-up, and let $l$ and $e_1,\dots,e_8$ be the classes of the pullback of a line and of the eight exceptional divisors respectively, a divisor of class $7l - 2 \sum e_i$ is a curve of genus 7 on $S$. Thus the curves on $S$ form a linear series, parametrized by a projective space $\PP^{11}$.
%
%The problem is, there are many such surfaces $S$; we don't have a single linear system that includes the general curve of genus 7. The good news is, that's OK because the surfaces $S$ themselves form a rationally parametrized family. Explicitly, if we look at the set $\Phi$ of pairs $(S, C)$ with $S = Bl_{p_1,\dots,p_8}(\PP^2)$  the blow-up of $\PP^2$ at eight points and $C \subset S$ a curve of class $7l - 2 \sum e_i$ on $S$, then $\Phi$ is a $\PP^{11}$-bundle over $(\PP^2)^8$, and so is again a rational variety; choosing a rational parametrization of $\Phi$ we get a family of curves of genus $7$ parametrized by $\PP^{27}$ and dominating $M_7$. As before, then, a general point in $\PP^{27}$ yields a general curve of genus 7.
%
%Things continued in this vein up through genus 10, but then this approach fails as well: if we represent a general curve of genus 11 as a plane curve with nodes, the nodes are no longer general points of $\PP^2$, and the same argument doesn't work. Ad hoc (and much more difficult) arguments were given in genera 11, 12 13 and 14, but so far no-one can go further in producing general curves. 
%
%A spectacular application of the existence of $\overline M_g$ was the proof that this sequence cannot go much further! To say that there exists a family $\cC \to B$ over an open subset $B \subset \AA^n$ such that the induced map $\phi_\cC : B \to M_g$ is dominant implies that $M_g$ is \emph{unirational}, an assertion that we can disprove simply by exhibiting a pluricanonical divisor on a desingularization of $\overline M_g$. This was carried out in \fix{add references)} for all genera $g \geq 23$; in a neat twist, the divisor used consisted of curves possessing a special linear system with Brill-Noether number $-1$, meaning its existence was dependent on the proof of the Brill-Noether Theorem.
%
%The existence of an effective pluricanonical divisor on $\overline M_g$ tells us even more: for example it implies that \emph{$M_g$ is not uniruled}, meaning that through a general point $[C] \in M_g$ there are no rational curves. This is because the restriction (or pullback) of a nonzero differential to such a curve would be a nonzero diferential, contradicting the fact that the canonical bundle of $\PP^1$ has  negative degree. A consequence is that the sort of descriptions of embeddings with which much of this book is concerned, where we produce a surface on which a general curve of a certain sort lies, cannot be continued to high genus:
%
%\begin{corollary}
% A general curve $C$ of  genus $\geq 22$ does not lie in a nontrivial linear series on any surface
% except those birational to $C\times \PP^1$.
%\end{corollary}
%\begin{proof}
% A linear family of curves containing $C$ that are not all isomorphic would map to a rational curve in $M_g$; if the curves are all isomorphic, one can show that the family
% covers a surface birational to a product of $C$ and some other curve \fix{put in an argument,
% using the prop. that a general curve has no automorphisms.}
%\end{proof}


\section{$M_g$}


In the remainder of this chapter, we will discuss the moduli space central to the theory of algebraic curves: the moduli space of curves of genus $g$ up to isomorphism.

\subsection{Genus 2}                                                                                             

Again we start with an example: the moduli space of smooth projective curves of genus $2$. We have seen that the simplest way to represent a curve $C$ of genus 2 is via the canonical map $\phi_K : C \to \PP^1$, which expresses $C$ as a 2-sheeted cover of $\PP^1$ branched over 6 distinct points $p_1,\dots,p_6 \in \PP^1$. Since this expression is unique, we see that the moduli space $M_2$ of smooth curves of genus 2 is---at least set-theoretically---the set of unordered 6-tuples of distinct points in $\PP^1$, modulo the automorphism group ${\rm Aut}(\PP^1) = PGL_2$.

 If we choose an ordering of the points $p_i$, there is a unique automorphism of $\PP^1$ carrying $p_1, p_2$ and $p_3$ to $0$, $1$ and $\infty$ respectively.  The remaining three points will be sent to three distinct points in $\PP^1 \setminus \{0, 1, \infty \} $. Of course, this depends on how we order the points in the first place; at the end of the day, we see that the symmetric group $S_6$ acts on the quasi-projective variety
$$
\Gamma = \left( \PP^1 \setminus \{0, 1, \infty \} \right)^3 \setminus \Delta
$$
(where $\Delta$ is the union of all diagonals in the triple product), and the set $M_2$ of isomorphism classes of smooth curves of genus 2 is thus identified with the points of the quotient variety $\Gamma/S_6$.

There are many questions to address---for example, is the variety $\Gamma/S_6$ a fine moduli space in the sense that there is a universal family?---but this construction at least does two things:

One, it may serve to convince us that $M_2$ is irreducible of dimension 3; and

Two, it allows us to write down explicitly a ``general curve of genus 2:" this is just the curve
$$
y^2 = x(x-1)(x-a)(x-b)(x-c)
$$
with $a, b$ and $c$ general scalars. We will discuss the analogous question for curves of any genus $g$ in Section~\ref{Hurwitz section} below.

\subsection{Higher genus}

In the genus 2 example, we worked with the canonical map $\phi_K$, expressing a given curve $C$ of genus 2 as a 2-sheeted cover of $\PP^1$, so that the moduli space of curves of genus 2 could be realized as the space of such double covers modulo $\PGL_2$. What if we adopted the same approach in genus 3? If a curve $C$ of genus 3 is non-hyperelliptic, the canonical map embeds $C$ as a smooth quartic curve in $\PP^2$. Since this realization is unique up to automorphisms of $\PP^2$, we could realize the space $\tilde M_3$ of non-hyperelliptic curves as the quotient of the space of smooth plane quartic curves---an open subset of the $\PP^{14}$ of all quartic curves---by the action of ${\rm Aut}(\PP^2) = PGL_3$. 

We can include the hyperelliptic curves as well if we take the the bicanonical map $\phi_{2K} : C \to \PP^{3g-4}$ (or, if we want to include the case of genus 2, the tricanonical map  $\phi_{3K} : C \to \PP^{5g-6}$). This means we have to replace the relatively simple ``space of smooth plane quartic curves" (an open subset of $\PP^{14}$) with the more daunting ``locally closed subset of the Hilbert scheme of curves of genus $g$ and degree $6g-6$ in $\PP^{5g-6}$," whose construction was given in Section~\ref{Hilbert scheme section}.

In this case we want to take the quotient of a subset of the Hilbert scheme by the positive-dimensional group $PGL_{5g-5}$. Unlike of the orbit space of a finite group, the orbit space in this case cannot be realized as an algebraic variety!

This is the central problem of \emph{geometric invariant theory} as developed by David Mumford in~\cite{MumfordGIT}. We will treat the theory as a black box; to explain its inputs and outputs, we will describe a relatively well-understood example.

\subsection{An example: plane cubics}

The simplest way to describe the moduli space of smooth curves of genus 1 is to observe that every such curve can be expressed as a 2-sheeted cover of $\PP^1$ branched over 4 points, and to construct the moduli of unordered 4-tuples of distinct points in $\PP^1$, much as we did in the case of curves of genus 2 above.

But suppose we tried a different approach: suppose we observed that any curve of genus 1 can be realized as a plane cubic, and tried to construct the moduli space by taking the quotient of the space $\PP^9$ of plane cubics---the Hilbert space---by the group ${\rm Aut}(\PP^2) = PGL_3$. 

Any $PGL_3$ orbit in $\PP^9$ contains in its closure the locus of points in $\PP^9$ corresponding to triple lines: supposing, as we may, that $C$ is defined by the cubic form $F(x,y,z) = x^3+$ terms in the ideal $(y,z)$,
we consider $F(x,ty, tz)$ and let $t$ go to 0. Thus in the topological quotient $\PP^9/PGL_3$ the point corresponding to triple lines is in the closure of every other point; this could not be an algebraic variety.

The same problem occurs in a less obvious fashion for other orbits. For example, in suitable coordinates every smooth cubic $C$ has affine equation of the form $y^2-x^3 - ax - b$, and the family of cubics
$$
y^2 - x^3 - t^2ax - t^3b
$$
has the cuspidal curve $y^2-x^3$ as limit.
Thus, if a quotient existed, the point corresponding to the orbit of a cuspidal cubic would lie in the closure of every point corresponding to a smooth cubic. 

A related phenomenon involves curves without any singularities other than nodes: as the reader can verify, the orbit in $\PP^9$ corresponding to irreducible cubics with a node contains in its closure the locus of reducible cubics consisting of a line and a conic meeting transversely; and this orbit contains in its closure the orbit of triangles, cubics consisting of three non-concurrent lines. Thus even after restricting to an open set that contains nodal cubics, any continuous map 
to a separated space that sends orbits to points all three of these orbits must map to the same point.
These phenomena are typical of the problems that Geometric Invariant theory solves.

\subsection{Stable, semistable, unstable}

In general, given a projective variety $X \subset \PP^N$ and a reductive subgroup $G \subset PGL_{N+1}$ that carries $X$ into itself, we wish to construct a map from the set of orbits
to a projective space that preserves as much of the structure of the orbit space as possible. Thus
the output must correspond to a graded ring, and the obvious thing to try is the ring of invariants
of the homogeneous coordinate ring of the closure of $X$

However, unlike the affine case, the group may not act by transformations of the homogeneous coordinate ring $A$ of $X$, since the elements of $A$ are not functions on $X$. Thus, we need to lift the action of 
$G$ to the action of a (possibly larger) group on $A$.  This is called a \emph{linearization} of the action, and in the most general setting of group actions,
a choice of linearization matters.  But in our setting, since the kernel of the map $SL_{N+1} \to PGL_{N+1}$ consists of diagonal matrices of finite order, the kernel acts trivially on forms of degree a multiple
of $N+1$, that is, on the homogeneous coordinate ring of the $(N+1)$-st Veronese embedding. Thus the linearization is irrelevant, and we may assume from the outset that our action lifts to the homogeneous coordinate ring $A$.

By Hilbert's theorem\footnote{Hilbert's Theorem covers the action of $SL_{N+1}$ in characteristic 0, the general case of a reductive group in any characteristic is more complicated, and combines ideas of 
Hilbert, Mumford and Haboush} the subring $A^G \subset A$ of invariant elements is finitely generated over our ground field, and the projective variety best approximating the set of orbits of $G$ on $X$ 
is $\Proj(A^G)$, usually denoted $X//G$. In view of the example above, we must ask what might be
the relationship between the points of $X//G$ and the orbits of $G$? 

To answer this question, GIT performs a sort of triage on the set of orbits of the action of $G$ on $X$, dividing them into three classes:

\begin{enumerate}

\item  \emph{Stable} orbits. These comprise an open subset of $X$, and the points of an open subset of $X//G$ correspond one-to-one to the stable orbits. In the case of the action of $PGL_3$ on the $\PP^9$ of plane cubics, these are the orbits of smooth plane cubics, and the quotient is the affine $j$-line.

\item \emph{Strictly semistable} orbits. These, together with the stable orbits, comprise a larger open subset $V \subset X$, called the \emph{semistable} locus. There is an open subset of
$X//G$ whose points are images of orbits in $V$, but distinct strictly semistable orbits may map to the same point. In the example of the action of $PGL_3$ on  $\PP^9$, the semistable  locus contains  the orbits of smooth and nodal plane cubics; that is, smooth cubics together with the three orbits consisting of irreducible cubics with a node, unions of lines and conics meeting transversely, and triangles. In the quotient, these last three orbits correspond to just one additional point, and this quotient is just the compactification of the affine line to the projective line obtained by adding one point.

\item  \emph{Unstable} orbits. These do not correspond to any point of $X//G$; in fact, these are the ones that cannot be included in any topologically separated quotient of an open subset of $X$.

\end{enumerate}

Geometric invariant theory is more than an abstract classification theorem; it actually provides tools for determining which class a given orbit belongs to. These are crucial for the application of geometric invariant theory to specific situations; a  priori, given an action of a group $G$ on a variety $X$, we don't know that there are any stable orbits at all.

\subsection{Construction of the moduli space of curves}

Geometric invariant theory gives us a way of constructing a moduli space $M_g$ of smooth  curves of genus $g$. We start with the Hilbert scheme $\cH$ parametrizing curves of genus $g$ and degree $6g-6$ in $\PP^{5g-6}$, and pass to the open subset $W \subset \cH$ of smooth curves. Within this open subset, the locus $U \subset W$ of curves embedded by their tricanonical bundles is a closed subvariety, invariant under the automorphism group of the ambient space, and it is a theorem of Mumford~\cite{MumfordGIT} that all that orbits in $U$ are stable. The moduli space $M_g$ is the quotient $U/PGL_{5g-5}$.

\section{Compactifying moduli}

The power of the theory of the moduli space of curves was greatly increased when the compactification of the space was understood, first in \cite{DeligneMumford} and then, using GIT, but Knudsen and Mumford \cite{***}, leading to the proof that the compactification is a projective variety. There are two reasons why these results are so important:

First, the great majority of the techniques that algebraic geometers have developed for dealing with varieties apply a priori to projective varieties---often the most effective way of dealing with a quasi-projective variety has proved to be to realize it as the complement of a divisor in a projective variety. One example of how  a compactification of $M_g$ can play a role in analyzing the global geometry fo $M_g$ is given in Section~\ref{mgunirational} below, where we take up the question, ``can we write down a general curve of genus $g$?"

\fix{ DE got to here Jan 11}
The second applies to a special class of compactifications of the moduli space $M_g$, called \emph{modular compactifications}. To explain, suppose that $U$ is a moduli space for a certain class of objects. One possible way to arrive at a compactification of $U$ is to enlarge the class of objects parametrized and consider the moduli space of this enlarged class, thus adding points to the space; a compactification of this sort  is called a modular compactification.

(Put somewhere: one significant example of a compactification of $M_g$ that is \emph{not} modular is the \emph{Satake compactification} $M_g^S$. Two salient facts about the Satake compactification are that it is projective and for $g \geq 3$ the boundary $M_g^S \setminus M_g$ has codimension 2. As a consequence, we may deduce that \emph{through any point $[C] \in M_g$ there exists a complete curve $B \subset M_g$}; in other words,
 if $C$ is any smooth projective curve of genus $g \geq 3$, there exists a complete one-parameter family of smooth curves $\cC \to B$, of varying moduli, including $C$ as a fiber. Possible extensions of this theorem remain open problems; for example, it's not known whether  through any point $[C] \in M_g$ there exists a complete surface $B \subset M_g$.)
 
 The pre-eminent example of a modular compactification is the \emph{stable} compactification $\overline M_g$ of $M_g$, introduced by Deligne and Mumford in their groundbreaking 1969 paper. Briefly, a projective curve $C$ of arithmetic genus $g$ is said to be \emph{stable} if its singularities, if any, are all nodes, and the automorphism group is finite; in their 1969 paper Deligne and Mumford show that there exists a moduli space for stable curves, and that it is a complete variety.
 
 The moduli space of stable curves was the first modular compactification of $M_g$. But it's not the only one; others have been found by



The introduction of the moduli space $\overline M_g$ of stable curves has had enormous consequences for the study of the geometry of $M_g$ and hence for curve theory in general. But its significance goes beyond even that. As a consequence, for example, we can invoke the valuative criterion for properness to deduce the fundamental theorem.

\begin{theorem}[Stable reduction]
If $\cC \to \Delta$ is an arbitrary family of curves over a disc $\Delta$, smooth over the complement $\Delta^* := \Delta \setminus \{0\}$, then after pulling back via the base change map $\Delta \to \Delta$ sending $z$ to $z^m$ and birational modifications we can arrive at a family $\tilde \cC \to \Delta$, all of whose fibers are stable curves; and the fiber of this new family over $0$ is unique.
\end{theorem}

\subsection{An example}

It's worth going through an example of stable reduction in the simplest nontrivial case: a family $\{C_t\}$ of curves specializing to a curve $C$ with a cusp; we'll work out such an example here.

So: let $\Delta$ be a disc, and $\pi : \cC \to \Delta$ a family of curves such that:
\begin{enumerate}
\item Away from the origin, the map $\pi$ is smooth; in particular, all the fibers $C_t$ with $t \neq 0$ are smooth curves;
\item The fiber $C_0$ is reduced and irreducible, with one ordinary cusp $p$; and
\item The total space $\cC$ is smooth.
\end{enumerate}

In these circumstances, the stable reduction theorem says that for some $m$, if we let $\beta : \Delta \to \Delta$ be the map given by $z \mapsto z^m$ and form the fiber product
$$
\tilde \cC := \cC \times_\Delta \Delta \to \Delta
$$
there exists a surface $S$ birational to $\tilde \cC$ such that the induced map $S \to \Delta$ is regular and has stable fibers. We will now describe the process by which we can construct this new family, and what its special fiber looks like.

\fix{Clearly, for the following to make any sense whatsoever, we need pictures here}

To start, we want to get rid of the cusp in the special fiber; our first goal will be to blow up $\cC$ until the special fiber has set-theoretic normal crossings (i.e., the reduced fiber has only nodes). This can be achieved in three steps:

\begin{enumerate}

\item First, of course, we blow up the point $p \in \cC$; that is, we take $S_1 := Bl_p\cC \to \Delta$. The proper transform $\tilde C_0$ of our cuspidal curve $C_0$ is now smooth; the fiber of $S_1$ over the origin $0 \in \Delta$ is the union of $\tilde C_0$ and the exceptional divisor $E_1$ of the blow up, with $E_1$ simply tangent to $
\tilde C_0$ at a point $q$. Note that since $p$ is a point of multiplicity 2 in the original fiber $C_0$,  the scheme-theoretic fiber of $S_1$ over $0 \in \Delta$ consists of $\tilde C_0$ plus the exceptional divisor $E_1$ with multiplicity 2.

\item At this point, the reduced special fiber $\tilde C_0 \cup E_1$ has a tacnode, so we have to blow up again at the point $q$; we'll call the resulting surface $S_2$ and the exceptional divisor of this second blow up $E_2$. We'll let $\pi : S_2 \to \Delta$ be again the composite map, and by abuse of notation we'll denote the proper transform of $C_0$ in $S_2$ again by $\tilde C_0$, and the proper transform of $E_1$ again by $E_1$. Note that since $q$ was a triple point of the fiber, the new exceptional divisor $E_2$ will appear as a component of multiplicity 3 in the fiber $\pi^{-1}(0)$; we have
$$
\pi^{-1}(0) = \tilde C_0 + 2E_1 + 3E_2.
$$
The first exceptional divisor $E_1$ is now transverse to the proper transform $\tilde C_0$ of the original fiber, but we haven't achieved our goal of set-theoretic normal crossings: the new exceptional divisor $E_3$ passes through the point $r$ of intersection of $E_1$ with $\tilde C_0$, forming a triple point of the reduced fiber of $S_2$ over $0 \in \Delta$. From bad to worse!

\item Of course, we have to blow up again at the point $r \in S_2$ and---third time's the charm!---this achieves our goal of a nodal reduced fiber: the proper transforms $\tilde C_0$ of the original fiber and of the two previous exceptional divisors $E_1$ and $E_2$ are now disjoint, and the new exceptional divisor $E_3$ meets each transversely in one point. As a divisor, the fiber is now
$$
\pi^{-1}(0) = \tilde C_0 + 2E_1 + 3E_2 + 6E_3.
$$
\end{enumerate}

It remains to deal with the multiplicities in the special fiber. The basic tool for accomplishing this is a base change followed by normalization, which works as follows. Starting with a family $S \to \Delta$ of curves, we first make a base change of some order $k$; that is, we replace the family $S \to \Delta$ with the fiber product $S \times_\Delta \Delta'$, where $\Delta'$ is again a disc, mapping to $\Delta$ by the map $z \mapsto z^k$. We then normalize $S \times_\Delta \Delta'$ to arrive at a normal surface $S'$ fibered over $\Delta'$.

What is the effect of this process? To answer this, we'll describe it in the case $k=2$, and then extrapolate. Suppose to begin with we have a component $C$ of the special fiber $C_0$ with multiplicity $m$---in other words, at a smooth point $p \in C$, we can find local coordinates $(u,v)$ on $S$ with $C$ given as the locus $u=0$ and the map $S \to \Delta$ given by $(u,v) \mapsto u^m$. When we make a base change of order 2, we introduce a new variable $w$ with $w^2 = z$; so the local defining equation of the fiber product is $w^2 = u^m$.

What happens now when we normalize? If $m = 1$, nothing; the fiber product is already smooth. If $m=2$, by contrast, normalizing replaces the preimage of $C$ with an unramified two-sheeted cover of $C$, which appears with multiplicity 1 in the fiber of the new family. And in general, there are two cases:
\begin{enumerate}
\item If $m$ is odd, then the preimage of $C$ maps 1-1 to $C$, and appears in the fiber of the new family with the same multiplicity as $C$; while
\item If $m$ is even, the preimage of $C$ is a 2-sheeted cover of $C$, which appears in the fiber of the new family with multiplicity one half the multiplicity with which $C$ appeared in the fiber of the original family.
\end{enumerate}

A similar description applies when we perform a base change of prime order $p$ followed by normalization (and since any base change can be factored into a product of base changes of prime order, this is enough): if $C$ is a smooth component of the special fiber of multiplicity $m$ divisible by $p$, $C$ is replaced by a $p$-sheeted cover of $p$, with multiplicity $m/p$; while if $m$ is not divisible by $p$, the preimage of $C$ maps one-to-one to $C$ and has the same multiplicity as $C$. In other words, \emph{carrying out a base change of order $p$ followed by normalization replaces $S$ by the cyclic cover of $S$ branched over the union of the components of $C_0$ having multiplicity not divisible by $p$}. Note in particular that is this union is singular, so will be our new surface; thus we have to avoid this situation in we want to stay in the realm of smooth surfaces.

How does this play out in our example? Very nicely, as it turns out. We start by making a base change of order 2 followed by normalization; this replaces $S$ by the two-sheeted cover of $S$ branched over the union of the curves $\tilde C_0$ and $E_2$; since $\tilde C_0$ and $E_2$ are disjoint, this union is smooth and the resulting surface is again smooth. Meanwhile, $E_1$ and $E_3$ are replaced by double covers of themselves branched over their points of intersection with $\tilde C_0 \cup E_2$; this means $E_1$ is replaced by two curves $E_1'$ and $E_1''$ each mapping isomorphically to $E_1$, and appearing in the fiber with multiplicity 1; and $E_3$ is replaced by a 2-sheeted cover branched over the two points of intersection of $E_3$ with $\tilde C_0 \cup E_2$. This is again a rational curve, which we'll call $E_3$, and which appears with multiplicity 3 in the special fiber of the new family. Altogether, the new picture is:

\

To get rid of the remaining multiplicities, we need to make a second base-change-and-normalization, this time of order 3. Again, we are lucky, in that the union of the components of the special fiber with multiplicity prime to 3 (that is, $\tilde C_0 \cup E_1' \cup E_1''$) is smooth, so that carrying out this second base change yields a smooth surface, with fiber over $0 \in \Delta$ consisting of $\tilde C_0$, two smooth rational curves $E_1'$ and $E_1''$, three smooth rational curves $E_2', E_2''$ and $E_2'''$, and finally a component $E_3$ which is a cyclic triple cover of the original $E_3$ branched over three points---by Riemann-Hurwitz, a curve of genus 1.

\

At this point, we have achieved most of our goals: the (scheme-theoretic) special fiber is indeed nodal. The only thing that keeps the special fiber from being stable if the presence of smooth rational components in the special fiber meeting the rest of the fiber in only one point; and these can be blown down. We arrive finally at a family $S \to \Delta$ whose fiber over $0 \in \Delta$ is the union of the normalization $\tilde C_0$ of the original fiber, together with a curve of genus 1 meeting $\tilde C_0$ at one point.



%Here is an example of the application of this theorem. In the chapter on plane curves, we introduce the \emph{Severi variety} $V^d_g$: in the space $\PP^N$ parametrizing all plane curves of degree $d$, it is the locus of reduced and irreducible curves of geometric genus $g$. This is only a locally closed subset of $\PP^N$; we'd like to understand better what plane curves correspond to points in its boundary.
%
%One way to approach this problem is to first establish that  $V^d_g$ has dimension $3d+g-1$, so that if $p_1,\dots,p_{3d+g-1} \in \PP^2$ are general points in the plane, there will be a finite number of reduced and irreducible curves $C_\alpha$ of degree $d$ and genus $g$ passing through $p_1,\dots,p_{3d+g-1}$. We can now ask, if we vary the points $p_i$ until $d+1$ of them are collinear, what are the limits of the curves $C_\alpha$?
%
%The key to answering this question is stable reduction. A priori, the limits $C_0$ of the curves $C_\alpha$ can be arbitrarily singular. But applying stable reduction, we can realize them as images of curves with at most nodes as singularities, and these can be analyzed in straightforward fashion. This analysis, and its surprising conclusions, can be found in \cite{**},  \cite{**} and  \cite{**}. (Severi problem, HM and CH)


\subsection{Can one write down a general curve of genus $g$?}\label{mgunirational}

Let us first formulate the question that is the title of this section more precisely. What we mean is, does there exist  a family of curves depending freely on parameters---in other words, a family $\cC \to B$ over an open subset $B \subset \AA^n$---that includes a general curve of genus $g$, in the sense that the induced map $\phi_\cC : B \to M_g$ is dominant? 	

We have done this in the case of genus 2 and 3. Essentially
the same approach works in genera $4$ and $5$; in each case a general canonical curve is a complete intersection, so that if we take the coefficients of its defining polynomials to be general scalars we have a general curve.

This method breaks down when we get to genus 6, where a canonical curve is not a complete intersection. But it's close enough: a general canonical curve of genus 6 is the intersection of a smooth del Pezzo surface $S \subset \PP^5$ with a quadric hypersurface $Q$; since all smooth del Pezzo surfaces in $\PP^5$ are isomorphic, we can just fix one such surface $S$ and let $Q$ be a general quadric.

It gets harder as the genus increases. Let's do one more case, genus 7, which already calls for a different approach. Here we want to argue that, by Brill-Noether theory, a general curve of genus $7$ can be realized as (the normalization of) a plane septic curve with 8 nodes $p_1,\dots,p_8 \in \PP^2$. Equivalently, if we let $S = Bl_{p_1,\dots,p_8}(\PP^2)$ be the blow-up, and let $l$ and $e_1,\dots,e_8$ be the classes of the pullback of a line and of the eight exceptional divisors respectively, a divisor of class $7l - 2 \sum e_i$ is a curve of genus 7 on $S$. Thus the curves on $S$ form a linear series, parametrized by a projective space $\PP^{11}$.

The problem is, there are many such surfaces $S$; we don't have a single linear system that includes the general curve of genus 7. The good news is, that's OK because the surfaces $S$ themselves form a rationally parametrized family. Explicitly, if we look at the set $\Phi$ of pairs $(S, C)$ with $S = Bl_{p_1,\dots,p_8}(\PP^2)$  the blow-up of $\PP^2$ at eight points and $C \subset S$ a curve of class $7l - 2 \sum e_i$ on $S$, then $\Phi$ is a $\PP^{11}$-bundle over $(\PP^2)^8$, and so is again a rational variety; choosing a rational parametrization of $\Phi$ we get a family of curves of genus $7$ parametrized by $\PP^{27}$ and dominating $M_7$. As before a general point in $\PP^{27}$ yields a general curve of genus 7.

A similar approach works through genus 10, but fails in genus 11: the nodes are no longer general points of $\PP^2$, and the same argument doesn't work. \fix{the comment is obscure -- what degree are we talking about? the 10 nodes for degree 8? if the point of the $g=7$ example was
nodes in general position (for a general curve), we should have explained that.} Ad hoc (and much more difficult) arguments were given in genera 11, 12 13 and 14, but so far no-one can go further in producing general curves. 

One application of the construction of $\overline M_g$ was the proof that this sequence cannot go much further! To say that there exists a family $\cC \to B$ over an open subset $B \subset \AA^n$ such that the induced map $\phi_\cC : B \to M_g$ is dominant implies that $M_g$ is \emph{unirational}, an assertion that we can disprove simply by exhibiting a pluricanonical divisor on a desingularization of $\overline M_g$. This was carried out in
\cite{Harris-MumfordModuli}, \cite{HarrisModuli}, and \cite{Eisenbud-HarrisModuli}
 for all genera $g \geq 23$; in a neat twist, the divisor used consisted of curves possessing a special linear system with Brill-Noether number $-1$, meaning its existence was dependent on the proof of the Brill-Noether Theorem.

The existence of an effective pluricanonical divisor on $\overline M_g$ tells us even more: for example it implies that \emph{$M_g$ is not uniruled}, meaning that through a general point $[C] \in M_g$ there are no rational curves. This is because the restriction (or pullback) of a nonzero differential to such a curve would be a nonzero diferential, contradicting the fact that the canonical bundle of $\PP^1$ has  negative degree. A consequence is that the sort of descriptions of embeddings with which much of this book is concerned, where we produce a surface on which a general curve of a certain sort lies, cannot be continued to high genus:

\begin{corollary}
 A general curve $C$ of  genus $\geq 22$ does not lie in a nontrivial linear series on any surface
 except those birational to $C\times \PP^1$.
\end{corollary}
\begin{proof}
 A linear family of curves containing $C$ that are not all isomorphic would map to a rational curve in $M_g$; if the curves are all isomorphic, one can show that the family
 covers a surface birational to a product of $C$ and some other curve \fix{put in an argument,
 using the prop. that a general curve has no automorphisms.}
\end{proof}

\subsection{Coarse vs. Fine moduli spaces}\section{course moduli}

We have said that there does not exist a fine moduli space for curves of genus $g$; here we'll indicate why that's the case and define the notion of a \emph{coarse moduli space}, which is the next best thing.

To see why a fine moduli space for curves of genus $g$ does not exist, consider the following family of curves. First, let $B$ be a curve with a fixed-point free involution $\tau$; equivalently, let $B \to B_0$ be a map of smooth curves of degree 2, with no branching. Next, let $C$ be any smooth curve of genus $g$ with an involution $\sigma : C \to C$. We then consider the quotients $$
S := B \times C/\langle (\tau, \sigma) \rangle \to B_0 := B/\langle \tau \rangle,
$$
which is a family of smooth curves of genus $g$ over $B_0$; in effect,  for each $b \in B$ we are identifying the fiber of $B \times C$ over $b$ with the fiber over $\sigma(b)$ via the map $\tau$. Since $\sigma$ has no fixed points, neither does the involution $(\tau, \sigma)$ of $B \times C$; so that the map $S \to B_0$ is indeed a family of smooth curves of genus $g$.

Now suppose there were in fact a fine moduli space $M_g$ for smooth curves of genus $g$. Since all the fibers of $S \to B_0$ are isomorphic to $C$, the induced map $\phi : B_0 \to M_g$ would be just the constant map sending $B_0$ to the point $[C] \in M_g$. Thus we have two different families of smooth curves over $B_0$, namely $B_0 \times C \to B_0$ and $S \to B_0$, with the same induced map $B_0 \to M_g$, contradicting the hypothesis that $M_g$ was a fine moduli space.

Examples like this suggest introducing a weaker notion than that of a fine moduli space. We'll describe this here in the context of families of schemes; the analogous definition in other settings should be clear.

\begin{definition}
Let $\cM$ be a class of schemes. We say that a scheme $M$ is a \emph{coarse moduli space} for $\cM$ if we have a natural transformation of functors $\phi : (schemes) \to (sets)$
$$
\{ B \mapsto \text{families $X \to B$ of schemes of type $\cM$}\} \to \{ B\mapsto \rm{Mor}_{\rm Schemes}(B, M) \}
$$
satisfying two conditions:
\begin{enumerate}
\item If $X \to B$ and $X' \to B$ are families whose associated maps $B \to M$ are the same, there exists a finite cover $\pi : \tilde B \to B$ such that the pullback families $X \times_B \tilde B$ and $X' \times_B \tilde B$ are the same; and
\item For any morphism $B \to M$, there exists a finite cover $\pi : \tilde B \to B$ such that the composition $\pi \circ \phi : \tilde B \to M$ is the map associated to a family $X \to \tilde B$
\end{enumerate}
\end{definition}

In other words, while the definition of a fine moduli space requires that the natural transformation $\phi$ be an isomorphism, here we require only that it be a natural transformation with ``finite kernel and cokernel" In these terms, what we can say is that the moduli space $\overline M_g$ is a coarse moduli space for stable curves of genus $g$.

\section{Hurwitz spaces and the dimension of $M_g$}\label{Hurwitz section}

Recall that the third item in the list of examples of moduli problems in Section~\ref{} was \emph{Hurwitz spaces}, spaces that parametrize branched covers of $\PP^1$ of specified degree and genus. In fact, proving the existence of solutions to this moduli problem can be tricky, but in the simplest case, where we consider only simply branched covers, we can give at least a local description of these spaces. We can then use this to estimate the dimension of the moduli space $M_g$.

We start by recalling from Chapter~\ref{} the description of simply branched covers of $\PP^1$: given $b = 2d + 2g - 2$ distinct points $p_1,\dots,p_b \in \PP^1$, we have a natural bijection between the set of maps $C \to \PP^1$ of degree $d$ simply branched over the points $p_i$ and unramified elsewhere; and the set of $b$-tuples $\tau_1, \dots, \tau_b \in S_d$ of transpositions in the symmetric group $S_d$
satisfying the conditions that the product $\tau_1\cdot \dots \cdot tau_b = e$ is the identity, and $\tau_1, \dots, \tau_b$ generate a transitive subgroup of $S_d$, modulo simultaneous conjugation by elements of $S_d$. 

Now suppose we allow the points $p_i$ to vary, each one in a disc $\Delta_i \subset \PP^1$, with the discs $\Delta_i$ disjoint. The same correspondence between branched covers and $b$-tuples of transpositions can be carried out simultaneously and consistently for all $b$-tuples $(p_1,\dots, p_b) \in \Delta_1 \times \dots \times \Delta_b$. Thus, if we let $U = (\PP^1)^b \setminus \Delta$ be the complement of the big diagonal in $(\PP^1)^b$---that is, the space of ordered $b$-tuples of points in $\PP^1$, the set
$$
H := \{ (f, B) \mid f : C \to \PP^1 \text{ is simply branched over } B \}
$$
can be given the structure of a topological covering space of $U$ via projection on the second factor. $H$ thus has the structure of a complex manifold of dimension $b$.

There are many more things to say. In fact, $H$ has the structure of an algebraic variety; there are many variants of this construction, in which we allow the points to come together and thereby include non-simply branched covers; and the problem of compactifying the space $H$ is a formidable one. But we are only going to be concerned with a simple application, estimating the dimension of the moduli space $M_g$.

To set this up, consider the map $\rho : H \to M_g$, in which we forget everything except the domain $C$ of the map $f$. The first thing to say is that for $d >> g$, this map is surjective (this follows, for example from the $g+1$ theorem of Chapter~\ref{}). Next, we might ask for the dimension of the fibers: in other words, given a smooth projective curve of genus $g$, how many simply branched maps $f : C \to \PP^1$ are there?

This is not too hard to answer. After all, a map $f : C \to \PP^1$ is given by a rational function on $C$, whose polar divisor $D = f^{-1}(\infty)$ can be any divisor of degree $d$ on $C$ if $d$ is large. Moreover, once we specify $D$, we know by Riemann-Roch (again, for large $d$) that the space of rational functions with polar divisor $D$ is a subset of a vector space of dimension $d-g+1$. Thus the fibers of the map $\rho$ have dimension $2d-g+1$; and since the space $H$ has dimension $b = 2d+2g-2$, we conclude that






\section{Exercises}


%\begin{exercise}
%Find the degree of the covering space $\alpha : \cH_{3,g} \to U \subset \PP^{2g+4}$
%defined in Section{hurwitz spaces}.
%\end{exercise}

\begin{exercise}\label{symmetric power vs Hilbert scheme}
\begin{enumerate}
 \item If $X$ is a smooth curve, then the Hilbert scheme of finite subschemes of $X$ of degree $d$ is
 isomorphic to the symmetric product of $d$ copies of $X$.
 \item If $X$ is a singular curve or any variety of dimension $r \geq 2$, the symmetric power $X^{(d)}$ is \emph{not} the Hilbert scheme of subschemes of dimension 0 and degree $d$ on $X$. 
 
 \fix{maybe needs a hint, especially since we can't do even the first part!}
\end{enumerate}
 \end{exercise}

\begin{exercise}
It is not an accident that we can characterize a fine moduli space $M$ in terms of the maps into it. 
 Let $X$ be a category, and $F,G$ two functors from $X$ to the category of sets.
 A morphism $\eta: F\to G$ in the category of functors is what is called a \emph{natural transformation}:
 for every object $a\in X$ there is a morphism $\eta_a:F(a) \to G(a)$ such that for every
 morphism $f: a\to b$ in $X$ the compositions $G(f)\circ \eta_a$ and $\eta_b\circ F(f)$
 are equal. 
\begin{enumerate}
 \item (Prove Yoneda's Lemma: If $X$ is any category, and $F$ is a contravariant functor from $X$ to the category of sets, then 
 $$
 \Hom_{\hbox{\scriptsize Functors on $X$}}(\Hom_X( -, Z), F) = F(Z)
 $$
 \item Conclude that if the functors $\Hom_X( -, Z)$ and $Hom_X( -, Z')$ are isomorphic in the functor category, 
 then $Z \cong Z'$ in $X$; that is, the functor $\Hom_X( -, Z)$ determines the object $Z$.
 \end{enumerate}
\end{exercise}



\begin{exercise}
Find the degree of the covering space $\alpha : \cH_{3,g} \to U \subset \PP^{2g+4}$
defined in Section{hurwitz spaces}.
\end{exercise}

\begin{exercise}\label{symmetric power vs Hilbert scheme}
\begin{enumerate}
 \item If $X$ is a smooth curve, then the Hilbert scheme of finite subschemes of $X$ of degree $d$ is
 isomorphic to the symmetric product of $d$ copies of $X$.
 \item If $X$ is a singular curve or any variety of dimension $r \geq 2$, the symmetric power $X^{(d)}$ is \emph{not} the Hilbert scheme of subschemes of dimension 0 and degree $d$ on $X$. 
 
 \fix{maybe needs a hint, especially since we can't do even the first part!}
\end{enumerate}
 \end{exercise}


\begin{exercise}
It is not an accident that we can characterize a fine moduli space $M$ in terms of the maps into it. 
 Let $X$ be a category, and $F,G$ two functors from $X$ to the category of sets.
 A morphism $\eta: F\to G$ in the category of functors is what is called a \emph{natural transformation}:
 for every object $a\in X$ there is a morphism $\eta_a:F(a) \to G(a)$ such that for every
 morphism $f: a\to b$ in $X$ the compositions $G(f)\circ \eta_a$ and $\eta_b\circ F(f)$
 are equal. 
\begin{enumerate}
 \item (Prove Yoneda's Lemma: If $X$ is any category, and $F$ is a contravariant functor from $X$ to the category of sets, then 
 $$
 \Hom_{\hbox{\scriptsize Functors on $X$}}(\Hom_X( -, Z), F) = F(Z)
 $$
 \item Conclude that if the functors $\Hom_X( -, Z)$ and $Hom_X( -, Z')$ are isomorphic in the functor category, 
 then $Z \cong Z'$ in $X$; that is, the functor $\Hom_X( -, Z)$ determines the object $Z$.
 \end{enumerate}
\end{exercise}

\

\

Two things still to be done/added: non-existence of a fine moduli space for smooth curves, and an example of stable reduction.

%
%\section{Unirationality}
%
%The Brill-Noether theorem, in all its many forms, deals with a simple question: what linear series $g^r_d$ does a curve $C$ of genus $g$ possess? Of course, the answer depends on $C$, but we know from general principles that it's constant on an open subset of $M_g$; so it's natural to ask what the answer is on that open set. That is the subject of the Brill-Noether theorem: what linear series exist on a general curve $C$ of genus $g$? This raises, naturally, a question we'll take up next.
%
%\subsection{Can we write down a general curve of genus $g$?}
%
%Let's do this one genus at a time. For curves of genus 2, the family of curves given by
%$$
%y^2 = x^6 + a_5x^5 + \dots + a_1x + a_0
%$$
%includes every curve of genus $2$; in other words, the induced (rational) map $\AA^6 \to M_2$ is dominant, so that  a general choice of the coefficients $a_i$ will yield a general curve.



\input{footer}