\input{header}

\chapter{Moduli} 
\label{Moduli chapter}\label{ModuliChapter}

\section{What is a moduli problem?}

Plane curves, the original objects studied by algebraic geometry, come naturally in a family: the projective plane curves of degree $d$, with their embedding
are in natural one-to-one correspondence with the forms of degree $d$ modulo the group of nonzero scalars---that is, with the points of the dual of the projective space
$ \PP(H^0(\sO_{\PP^2}(d)))=\PP^{\binom{d+2}{2}-1} $.
Perhaps this is the origin of the impulse in algebraic geometry to make 
 \emph{moduli}, or \emph{parameter spaces}---spaces parametrizing algebro-geometric objects of a specified sort. In this chapter, we'll give a general framework for the notion of moduli space, introducing the main examples that we will treat in this book and their desirable and undesirable properties.

In modern terms, a \emph{moduli problem} is a class of objects in algebraic geometry---schemes, subschemes of a given scheme, sheaves on schemes, maps of schemes, typically defined by some common attributes---and a notion of what it means to have a \emph{family} of these objects parametrized by a scheme $B$. The notion is formalized in the idea of a \emph{moduli functor}, 
which associates to each scheme $B$ the set of families of the given sort. Examples will make this vague notion more concrete. In each case, we'll discuss some cases relevant to curves.

\subsection{Examples}

\begin{enumerate}\label{list of moduli problems}

\item \emph{Effective divisors on a given curve}. The objects are divisors of degree $d$ on a given smooth, projective curve $C$. A family of such divisors is a subscheme $\cD \subset B \times C$, flat of degree $d$ over $B$. Here we are using
the equivalence between divisors of degree $d$ on a smooth curve and degree $d$ subschemes of the curve. The result is the symmetric power $C_d$, discussed in Section~\ref{symmetric section}.

\item \emph{Line bundles on a given curve}. The objects are line bundles of degree $d$ on a given smooth projective curve $C$. A family of line bundles over $B$ is a line bundle $\cL$ on $B \times C$, whose restriction to each fiber of $B \times C$ over $B$ has degree $d$. Here we identify two families $\cL$ and $\cL'$ on $B \times C$ if $\cL$ and $\cL'$ differ by a line
bundle pulled back from $B$. The result is the Jacobian and Picard varieties, discussed in Section~\ref{Picard section}.

\item \emph{Hurwitz spaces}. The objects are curves of a given genus, together maps to $\PP^1$ of given degree, often with specified ramification indices. 
%\fix{what's the equivalence relation? Does this really
%fit into moduli problems? If so let's say it. Same question for Severi varieties.}

\item \emph{Severi varieties}. The objects are plane curves
of given degree and geometric genus. Thus for most degrees and genera,
the curves will all be singular, but are often
constrained to have only mild singularities, usually only ordinary nodes.

\item \emph{Hilbert schemes}. The objects are curves of given degree $d$ and arithmetic genus $g$ in $\PP^r$.  A family of such curves over $B$ is a subscheme $\cC \subset B \times \PP^r$, flat over $B$,  whose fibers are smooth, projective curves of genus $g$. The result is the Hilbert scheme.

\item \emph{Moduli of smooth curves of genus $g$}. The objects are (isomorphism classes of) smooth, projective curves of genus $g$. A \emph{family of curves of genus $g$} over $B$ is an isomorphism class of smooth, projective morphism $f : \cC \to B$ whose fibers are  smooth curves of genus $g$. Here two such morphisms $f, f'$
are \emph{isomorphic} if there is an isomorphism from the source of $f$ to the source
of $f'$ making the diagram
$$
\begin{diagram}
\cC && \rTo^\cong && \cC'\\
&\rdTo_f&&\ldTo_{f'}\\
&&B
\end{diagram}
$$
commutative.
\end{enumerate}
Examples 3--6 will be discussed in the remaining sections of this Chapter; we will give further examples of Hilbert Schemes in the last two chapters of this book.

\section{What is a solution to a moduli problem?}

Given a moduli problem, we want to construct a scheme $M$ whose closed points are in natural  1-to-1 correspondence with the objects we're trying to parametrize. The word \emph{natural} appearing in that last sentence is the key. Most of the time, the set of objects we are interested in has cardinality $2^{\aleph_0}$, as do all positive-dimensional varieties $M$ over $\CC$, so a mere a bijection between the points of $M$ and the objects to be parametrized is useless.

What we really want from a moduli space $M$ is to understand \emph{all} the possible families of the objects it classifies; thus it is natural to ask their to be a \emph{universal} family $\phi: \cX\to M$ of these objects over $M$,
and that every family over another base, say $B$,  be pulled back from the one on $M$ via a morphism $B\to M$ . Since we would prefer not to count families more than once, we can ask that the 
morphism $B\to M$ be unique. Such a space $M$ with its universal family $\phi$, if if exists, is called a \emph{fine moduli space}. This can be expressed more abstractly but more succinctly by saying that there is an isomorphism of functors:
$$
\{ B \mapsto \text{families of } X \text{ over } B \} \cong \{ B\mapsto \rm{Mor}_{\rm Schemes}(B, M) \}.
$$
If $M$ is a fine moduli space then the identity map $M\to M$ corresponds to the ``universal family'' $\phi: \cX \to M$. 

If a moduli space and its universal family exist, then it is unique up to unique isomorphism: given two avatars $M,M'$ of the fine moduli space of a given moduli problem,
the universal family on $M$ corresponds to a map $M\to M'$, and we similarly produce a map $M'\to M$. The pullback of the universal family on $M$ by the composition of these two maps is again the universal family, so the composition is the identity map.

As we have discussed in Chapter~\ref{Jacobians chapter}, fine moduli spaces exist in the case
of the first two examples above. But they don't always exist, and in the important example
of the moduli space of curves of genus $g>0$, there is no fine moduli space.  This example
will be discussed at length at the end of this chapter.


\section{Hurwitz Spaces}

It is hard to specify an abstract curve. It is much easier if the curve $C$ comes to us with some additional structure, such as a map to projective space

In the case of the Hurwitz spaces, we consider pairs $(C,f)$ where $C$ is a smooth curve of genus $g$ and
 $f : C \to \PP^1$ is a branched cover of degree $d$, possibly with some further restrictions.
%Also, we can look at pairs $(C,f)$ where $f : C \to \PP^2$ is a birational embedding of $C$ as a plane curve of degree $d$, yielding the Severi varieties (Section~\ref{severi variety}). These spaces are more readily described and better-behaved than the moduli space $M_g$ of abstract curves, or the Hilbert schemes $\cH$ of curves in higher-dimensional space. They have been useful in proving theorems about $M_g$ and $\cH$.
%
To describe the simplest setting, we fix integers $d \geq 2$ and $g \geq 0$. By the \emph{small Hurwitz space} $\cH^\circ_{d,g}$ we will mean a space parametrizing simply branched covers $f : C \to \PP^1$ of degree $d$, with $C$ a smooth projective curve of genus $g$. Here ``simply branched" means that every fiber  either is reduced---that is, consists of $d$ reduced points---or consists of one double point and $d-2$ reduced points. If a map $f : C \to \PP^1$ is simply branched, then Hurwitz' Theorem~\ref{Hurwitz} implies that the branch divisor $B \subset \PP^1$ of the map consists of $b = 2d+2g-2$ distinct points in $\PP^1$

\fix{What's the equivalence relation? Does this and the Severi and variety actually fit into the moduli mold? If not, maybe this whole chapter should be "Moduli and other Parameter spaces"? If so,
let's set the terms for the moduli problem and answer the question: Is $\cH^\circ_{d,g}$ a fine moduli space?}

It is easiest to understand $\cH^\circ_{d,g}$ if we work over $\CC$ and use the classical topology. Since an effective divisor on $\PP^1$ is given by a homogeneous polynomial $F \in H^0(\cO_{\PP^1}(b))$, the space of all effective divisors is $(\PP^1)_b \cong \PP^b$, and the locus of reduced divisors---divisors consisting of $b$ distinct points---is an open subset $U \subset \PP^b$.
%\fix{The hurwitz spaces section is all about $\cH^\circ_{d,g}$. Maybe we should say something about $\cH_{d,g}$ .}
Consider the incidence correspondence
$$
 \cH^\circ_{d,g}:= \{(F,C, f)  \mid f: C \to \PP^1 \text{ is  simply branched   with branch divisor } F = 0 \},
$$
and the associated projections
\begin{diagram}
& & \cH^\circ_{d,g} & & \\
& \ldTo^\alpha & & \rdTo^\beta & \\
U \subset \PP^b & & & & M_g
\end{diagram} 
Here $\alpha$ is the map associating to a branched cover $f : C \to \PP^1$ its branch divisor, and $\beta$ the map sending $f : C \to \PP^1$ to the point $[C] \in M_g$; the open set $U \subset \PP^b$ is the open set of $b$-tuples of distinct points in the space $\PP^b$ of all effective divisors of degree $b$ on $\PP^1$.

Over $\CC$, we can describe a branched cover concretely: if we make a collection of cuts in $\PP^1$ joining a base point $p$ to each of the branch points $p_1, p_2, \dots, p_b$ of the map, the preimage in $C$ of the complement of the cuts will consist of $d$ disjoint copies of the complement of the cuts in $\PP^1$ (the ``sheets" of the cover), which we can label with the integers $1, 2, \dots, d$. In these terms, we can associate to each branch point $p_i \in \PP^1$ the transposition $\tau_i \in S_d$ exchanging the two sheets that come together over $p_i$. We arrive at a sequence of transpositions $\tau_1, \tau_2, \dots, \tau_b \in S_d$, that satisfies two conditions:

\begin{enumerate}
\item the product $\tau_1\cdot \tau_2 \cdots \tau_b$ is the identity (because the complement of the cuts is contractible); and
\item the $\tau_i$ together generate a transitive subgroup of $S_d$ (because $C$ is connected).
\end{enumerate}

Note that the sequence $\tau_1, \tau_2, \dots, \tau_b \in S_d$ is determined by the cover $f : C \to \PP^1$ up to simultaneous conjugation in $S_d$: we can revise our labelling of the sheets, which has the effect of conjugating all the $\tau_i$ by the relabelling permutation. Conversely, any such sequence of transpositions determines a connected $d$-sheeted covering of the complement
of the branch points, and a complex structure is determined by the fact that the covering map is a local isomorphism. One can analytically add patches of the form $z \mapsto z^2$ at the branch points to complete
the covering to be a branched covering of $\PP^1$ by a (compact, connected) Riemann surface. 

Thus the map $\alpha : \cH^\circ_{d,g} \to U$ is a finite covering space, which gives us a picture of the local geometry of $\cH^\circ_{d,g}$. 
The degree of the covering space $\alpha : \cH^\circ_{d,g} \to U$ is called a \emph{Hurwitz numbers}, These arise in many contexts, and many have been calculated \cite{Graber-Vakil}. Clebsch, Hurwitz and others analyzed the monodromy of the cover $\alpha : \cH^\circ_{d,g} \to U$, and showed that it is transitive, proving that $\cH^\circ_{d,g}$ is irreducible for all $d$ and $g$ and hence, since $\cH^\circ_{d,g}$ dominates $M_g$ for $d \gg g$, that $M_g$ is irreducible for all $g$. (Because of the reliance on the classical topology, this argument only works in characteristric 0). 
%\fix{The statement that high degree Hurwitz dominates moduli needs some
%unpacking: existence of good projections or $g+2$ theorem, the fact that $M_g$ is not a fine modul space... .}

The Hurwitz spaces also give us a way to estimate the dimension of the moduli space $M_g$. Since $\cH_{d,g}$ is a finite-sheeted cover of an open subset $U \subset \PP^b$, it has dimension  $b = 2d+2g-2$. 
To find the dimension of $M_g$, we can choose $d \gg g$ (so that $\cH_{d,g}$ dominates $M_g$), and estimate the dimension of the fibers of $\cH_{d,g}$ over $M_g$.

To do this, fix a curve $C$. To specify a map $f : C \to \PP^1$ we have to specify first a line bundle $L$ of degree $d$ on $C$ ($g$ parameters, as described in Chapter~\ref{new Jacobians chapter}. We then have to specify a pair of sections of $L$ (up to multiplying the pair by a scalar). By the Riemann-Roch Theorem, $h^0(L) = d-g+1$, so to specify a pair of sections (mod scalars) is $2(d-g+1)-1$ parameters. Altogether, we have
$$
2d+2g-2 = \dim \cH^\circ_{d,g} = \dim M_g + g + 2(d-g+1)-1;
$$
and solving, we arrive at
$$
\dim M_g \; = \; 3g-3.
$$

\fix{DE rev to here 10/26}
\section{Severi varieties}

%\fix{this material is partly repeated in the plane curves chapter. Especially if this chapter comes early, we could leave it here, and 
%prune the plane curve treatment -- probably the right choice.}

Just as the small Hurwitz space $\cH^\circ_{d,g}$ parametrizes pairs $(C,f)$ consisting of a smooth curve $C$ of genus $g$ and a map $f : C \to \PP^1$ of degree $d$
with simple branching, the \emph{small Severi variety} parametrizes pairs $(C,f)$ consisting of a smooth curve $C$ of genus $g$ and a map $f : C \to \PP^2$ of degree $d$ that is birational onto a plane curve $C_0$ having only nodes as singularities. In this case, the curve $C$ is the normalization of $C_0$, so we can define the \emph{small Severi variety} $V_{d,g}$ to be the locally closed subset of the projective space $\PP^N$ parametrizing plane curves of degree $d$ corresponding to irreducible nodal curves of degree $d$ and geometric genus $g$.

With both the small Hurwitz and small Severi varieties, it is useful to have a modular compactification or partial compactification of these spaces. In the case of the Hurwitz space, there is such a compactification: the \emph{space of admissible covers}, which are  maps of degree $d$ from nodal curves $C$ of arithmetic genus $g$ to nodal curves of arithmetic genus 0 satisfying certain local conditions. In the case of Severi varieties, we could take the closure $\overline{V_{d,g}}$ of $V_{d,g}$ in the space $\PP^N = \PP^{\binom{d+2}{2}-1}$ of all plane curves of degree $d$, but this is unsatisfactory in a number of ways: the singularities of $\overline{V_{d,g}}$ are arbitrarily awful, as are those of the curves $C_0 \subset \PP^2$ corresponding to the added points. It is an open problem to give a better compactification.


The dimension of the (small) Severi variety is relatively easy to compute. A curve $C_0 \subset \PP^2$ corresponding to a point on the small Severi variety $V_{d,g}$ will have $\delta = \binom{d-1}{2} - g$ nodes; to describe the locus of such points, we can introduce the incidence correspondence
$$
\Sigma = \{(C_0,p_1,\dots,p_\delta) \in V_{d,g} \times (\PP^2)^\delta \; \mid \; C_0 \text{ has a node at $p_i$} \}.
$$
The fibers of the projection $\Sigma \to (\PP^2)^\delta$ are Zariski open subsets of linear subspaces of $\PP^N$, and an argument to be given in Section~\ref{severi variety} shows that they have the expected dimension $N - 3\delta$. Thus:
$$
\dim V_{d,g} = \dim \Sigma = 2\delta + N - 3\delta = 3d+g-1.
$$

As in the case of Hurwitz spaces, this knowledge is enough for us to determine the dimension of $M_g$. For any given $g$ if we choose $d \gg g$ the map $V_{d,g} \to M_g$ sending the pair $(C, f)$ to the point $C \in M_g$ will be dominant. If $C$ is a curve of genus $g$, then  to specify a map $f : C \to \PP^2$ of degree $d$ we have to choose a line bundle $L$ of degree $d$ on $C$ ($g$ parameters), and then choose 3 global sections of $L$ up to simultaneous multiplication by a scalar. By the Riemann-Roch Theorem we have $h^0(L) = d-g+1$, so
$$
3d+g-1 = \dim V_{d,g}  = g + 3(d-g+1) - 1,
$$
and solving we see again that $\dim M_g = 3g-3$.

Like the Hurwitz space, the Severi variety $V_{d,g}$ is irreducible for all $d$ and $g\leq \binom{d-1}{2}$, and this could be used to prove that $M_g$ is irreducible for all $g$. However it is not so easy to prove irreducibility of the Severi variety\footnote{The second author of the current volume owes his current employment to this fact.}; the fastest way to prove irreducibility of $M_g$ (in characteristic 0, at least) is still via the Hurwitz spaces.

\section{Hilbert schemes}\label{hilbert scheme section}
The Hilbert scheme $\cH_{d,g,r}$ parametrizes curves of given degree and arithmetic genus in $\PP^r$. For $r>2$, the theory is much more complicated.  Even if we restrict our attention to  what we might call the ``small Hilbert scheme"---the open subset corresponding to smooth, irreducible and nondegenerate curves---Hilbert schemes are truly wild. Locally, they can have arbitrarily bad singularities \cite{MR2227692}, at least for $r>3$. Furthermore, they can have many irreducible components---no one knows how many in general---of many different dimensions. 

While the proof of existence of Hilbert schemes is highly nontrivial, a decent summary can be found in~\cite{3264}. In the present volume, we will describe a number of examples,  some nice  and some not-so-nice, in Chapters~\ref{HilbertSchemesChapter} and \ref{HilbertSchemesCounterexamplesChapter}.

%\fix{add material from 3264; for the moment perhaps just refer to it.}
%\fix{Here's a "fix" from Ch 15: Add a section on basics of the Hilbert scheme explaining why Hilbert schemes; the universal property; and the tangent space **I think this should go in Chapter 6---we should have a ``cast of characters" section there, where we introduce all the moduli spaces we'll be dealing with**}
%
%\fix{citations we could add: Constructions: Grothendieck Fonde;ments; \cite[Section IV]{Grothendieck19571962}; Mumford \cite[Chapter 15]{Mumford1966}, curves on an alg surface; Homogeneous Hilbert Schemes
%\cite{MR2361849}; Iarrobino~\cite{Iarrobino1985} and/or other work on punctual Hilbert schemes. \cite{BayerThesis}, Ramkumar \cite{fiber-full} \cite{Intro moduli}
%}


\section{$M_g$}

The space $M_g$ parametrizing isomorphism classes of smooth projective curves of genus $g$---Example 1 of ~\ref{list of moduli problems}---is at the heart of the mystery that is algebraic curves. 
Algebraic geometers of the 19th century were certainly aware that, while every smooth projective curve of genus 0 was isomorphic to the Riemann sphere, in  genus 1 and higher there are continuously varying families of non-isomorphic curves. 

The idea of
making these into the points of a space was clearly present in the work of Riemann, who asked among other things what the dimension of that space should be. He thought of $M_g$ as a real manifold, and arrived at the (correct) answer $\dim_\RR M_g = 6g-6$ for $g \geq 2$ by using the auxilliary construction of the \emph{Hurwitz space}, which we describe in Section~\ref{hurwitz spaces}. The same auxilliary construction was used by Hurwitz, Clebsch and others to assert the irreducibility of $M_g$; this was a crucial development, in that it allows us to talk unambiguously about a ``general curve."

In low genus it is possible to give explicit constructions of $M_g$. For example, we have seen that every curve of genus 2 is expressible as a double cover of $\PP^1$ branched at six points, and  that the curve is determined by those points. Now, given six distinct points in $\PP^1$ we can find an automorphism of $\PP^1$ carrying three of the points to 0, 1 and $\infty$. The remaining three points will be sent to three distinct points in $\PP^1 \setminus \{0, 1, \infty \} $. Of course, this depends on how we order the points in the first place; at the end of the day, we see that the symmetric group $S_6$ acts on the quasi-projective variety
$$
\Gamma = \left( \PP^1 \setminus \{0, 1, \infty \} \right)^3 \setminus \Delta
$$
(where $\Delta$ is the union of all diagonals in the triple product), and the moduli space $M_2$ is the quotient $\Gamma/S_6$. There is clearly much more to say, but this construction at least does two things:

One, it may serve to convince us that $M_2$ is irreducible of dimension 3; and

Two, it allows us to write down explicitly a ``general curve of genus 2:" this is just the curve
$$
y^2 = x(x-1)(x-a)(x-b)(x-c)
$$
with $a, b$ and $c$ general scalars.

There are similarly ad-hoc ways of describing the moduli spaces $M_g$ for other small values of $g$. For example, in genus 3 we've seen that a non-hyperelliptic curve of genus 3 is embeddable as a smooth plane quartic curve $C \subset \PP^2$. Now, the space of all quartic curves is a projective space $\PP^{14}$, and the subset of smooth curves is an open subset $U \subset \PP^{14}$. Moreover, the group $PGL_3$ of automorphisms of $\PP^2$ acts on this open set $U$, and---because every isomorphism between these curves extends to the whole plane---the moduli of (nonhyperelliptic) curves of genus 3 is, at lease set-theoretically, the quotient $U/PGL_3$.

These constructions exhibit a typical pattern: one first chooses some data that forms a scheme, subject to a group of automorphisms whose orbits correspond to the objects one wants to parametrize. In the cases where the group is finite, or the stabilizers of points are sufficiently nice, the quotient may be a fine moduli space, as in the case of effective divisors, above. But even in very simple cases, this may not work.

A rather trivial example of how this fails is given by the action of the multiplicative group $\CC^*$ on $\CC^1$, the
affine line. There are only two orbits: one consisting of the point zero, and the other containing all nonzero points. It would thus seem natural to think that the moduli space of such points would be the disjoint union of two points. But this doesn't reflect the existence of a family, represented by the 
identity map $\CC^1 \to \CC^1$, in which the nonzero point ``degenerates" to the zero point. Thus the moduli ``space" should be an object with two points, one in the closure of the other. The relevant ring of invariants, $\CC = \CC[x]^{\CC^*}$ is no use: it suggests that the quotient should be a single point (and indeed this is the best approximation among schemes).
%\fix{say: because maps are given by regular functions, the map to the moduli space would have
%have to factor through the invariants}

A much more interesting example is the classification of square matrices under the action of conjugation by an invertible matrix. As every undergraduate learns, the equivalence classes are characterized by Jordan normal forms; but the invariant polynomials on the ring of matrices are just the coefficients of the characteristic polynomial, and these distinguish only the eigenvalues. (This example is discussed further in an informative way by Mumford in \cite{Mumford-Suominen}.)

In the case of curves, the data we can produce is typically a point in some quasiprojective variety together with a group of automorphisms of the projective space. Thus, for example, taking the embedding by the complete linear series $|dK|$, the $d$-th multiple of the canonical series, all smooth curves of genus $g\geq 2$ can be represented as the points of an open subscheme of the Hilbert scheme $H$ of subschemes of $\PP^{d(2g-2)-g}$ whose Hilbert polynomial is $p(t) = (d(2g-2))t+1-g$, with group action given by
$G := PGL(d(2g-2)-g+1)$. If the group action had been finite, we would have chosen a finite cover of $H$ by invariant open affine sets, and glued together the schemes corresponding to their rings of invariants. In this case we don't have that option: the group doesn't even act naturally on the homogeneous coordinate ring
of $H$. 

In his famous monograph on ``Geometric Invariant Theory" \cite{GIT}, Mumford established a paradigm for dealing with this problem: one \emph{chooses} a lifting of the action of $PGL(d(2g-2)-g+1)$ on $\PP^{d(2g-2)-g}$, called a \emph{linearization}, and then looks at the ring of invariant homogeneous forms. Although rings of invariants of infinite groups may fail to be finitely generated, it turns out that this does not occur for the classical groups such as the general linear group, so the ring of invariants can, in this case, be
thought of as corresponding to a projective scheme, and there is a map from $H$
to this scheme. In general this map is one-to-one only on an open subset, called the set of 
\emph{stable} points; and cannot be defined in a way that preserves the topology (or the maps from families) outside a slightly larger subset called the set of 
semi-stable points, and with these the image of the objects parameterized fill the projective variety
defined by the ring of invariants.


Thus one must look for good embeddings and linearizations for which the objects one cares about---in our case perhaps the smooth curves---become stable points, and this is attained by choosing the multiple $d=3$ in the sketch above sufficiently large. 
%\fix{to take into account...: D\&M use the tricanonical embedding.}. 
It turns out that the 
set of \emph{stable} curves (always of genus $\geq 2$) is then a little larger: it includes all curves with finite automorphism groups, which can be characterized as those reduced connected curves with only ordinary double points as singularities and such that any component isomorphic to $\PP^1$ meets at least three other components. In recent times people have looked at other embeddings and linearizations, leading to a different set of stable curves; see for example \cite{SchubertCompactification},\cite{Hassett1}
and \cite{Hassett2}
%\fix{or Smythe?}

%This is bogus in several respects: apart from the fact that we're excluding hyperelliptic curves, a much more serious issue is that we're taking the quotient of a variety by the positive-dimensional group $PGL_3$; and while the quotient of a variety by a finite group is always a variety, quotients by positive-dimensional groups may not be (think of $\CC^*$ acting on $\CC$ by scalar multiplication: as a topological space, the quotient has two points, one in the closure of the other. \fix{but the reader wants to know whether THIS quotient is a variety, or not!} Nonetheless, it does two things:

\subsection{Coarse moduli spaces vs. fine moduli stacks}

Apart from the technical difficulties of constructing a moduli space of curves, it is a fundamental fact that \emph{a fine moduli space for smooth projective curves of genus $g$ does not exist}: in other words, the moduli functor, associating to a scheme $B$ the set of families of smooth projective curves over $B$ is simply noit representable in the category of schemes. (A summary of the reasons for this may be found in~\cite{GeomSchemes}.)
There are two essentially equivalent ways out of this problem that sometimes work:

First, we can weaken the definition and only require a bijection between families $\cC$ over $B$ and the set of morphisms $\phi_\cC : B \to M$ after finite base change. A \emph{coarse moduli space} $M$ is a space such that for every family  $\cC$ over $B$ 
of the appropriate type there is a morphism $\phi_\cC : B \to M$ such that:

\begin{enumerate}
\item if $\phi_\cC : B_0 \to M$ is any morphism, then there exists a finite cover $\pi : B \to B_0$ such that $\phi_\cC \circ \pi : B \to M$ is the morphism associated to some family; and
\item if $\cC \to B_0$ and $\cC' \to B_0$ are two families such that the associated morphisms $\phi_\cC = \phi_{\cC'} : B_0 \to M$ are equal, then there exists a finite cover $\pi : B \to B_0$ such that the pullbacks of $\cC$ and $\cC'$ to $B$ are equal.
\end{enumerate}

A careful argument shows that a coarse moduli space, if it exists, is also uniquely defined, by the moduli problem it solves.

An alternative approach to this problem is to enlarge the category of schemes to the category of  \emph{stacks}, where in fact a fine moduli space for curves of genus $g$ does exist. This is the approach taken by Deligne and Mumford in~\cite{Deligne-Mumford}. The type of stack they introduce---now called \emph{Deligne-Mumford stacks}---have associated coarse moduli spaces, so their approach actually produces both.

%and look for
%a stack $M$ and replace morphisms in the category of schemes with morphisms to a stack. For this approach see~\cite{Deligne-Mumford}. 
%
%The moduli problem for smooth curves does have a coarse moduli space called $M_g$, to which we now turn.
%
%
%\fix{ we should explain something of 
%the problem with invariants of infinite groups -- that there aren't enough of them -- and say something
%about GIT. This was actually promised when we discussed finite group quotients in Chapter 4. It might be most natural to do this with the elliptic curve example below, if we know enough to do it correctly. Since the Moduli space construction depends on the Hilbert scheme construction, this is also a reason to do that first; and then treat the elliptic curves as the simplest nontrivial example (except of course that it isn't the pluricanonical embedding.}


%\subsection{Two modern approaches}
%
%\subsubsection{Deligne-Mumford}Though Riemann already (correctly) calculated the dimension of the moduli space $M_g$ as a real variety by heuristic arguments (as we did in preceding chapters), carrying out the programme outlined above for smooth curves turned out to be quite difficult. 
%Perhaps the first complete proof was in David Mumford's 1960 Thesis under Oscar Zariski at Harvard: it's title is:
%``Existence of the moduli scheme for curves of any genus" \cite{}. However, the first published treatment came only in 1969, with the publication of the landmark paper \cite{Deligne-Mumford}. Two results in that paper fundamentally altered the landscape of curve theory:
%
%First, they gave a precise, rigorous construction of the moduli space $M_g$ for any $g \geq 2$ (showing in particular that it was a coarse moduli space, but that no fine moduli space can exist in the category of schemes. They also proved the existence of a fine moduli \emph{ stack} $\cM_g$.). Second, they gave a modular compactification of $M_g$ (described in Section~\ref{compactifying Mg}), denoted $\overline M_g$. 
%
%Surprisingly, the compactification proved crucial in understanding the (uncompactified) $M_g$ itself, because it opened up the study of the moduli space of curves to the powerful techniques of modern projective geometry. This made possible the resolution of many outstanding problems related to moduli of curves, to which we shall return. 
%
%\subsubsection{Work of Mumford and Knudsen} The Deligne-Mumford paper proved that the
%moduli spaces of stable curves are \emph{proper} (so, over the complex numbers, compact). The advantage of the method of geometric invariant theory is that it can show that a moduli space is projective by describing the scheme defined by
%the graded ring of invariants associated with a linearization of the appropriate group action. In
%Mumford-Knudsen and in Knudsen and Knudsen \fix{get refs to the three papers} this approach 
%was carried out successfully.
%
%\fix{refer somewhere to Harris-Morrison}.
%
%\subsection{$M_g$ is only a coarse moduli space}
%
%The fact that $M_g$ is a coarse moduli space, not a fine one, manifests itself in two concrete ways:
%
%\begin{enumerate}
%\item There exists a scheme $B$ and a map $B \to M_g$ that does not arise from a family $\cC \to B$ of curves over $B$; and
%\item There exists a scheme $B$ and two families $\cC \to B$ and $\cC' \to B$ such that the associated maps $\phi_\cC$ and $\phi_{\cC'} \to B$ are equal (meaning in particular that for each closed point $b \in B$ the fibers $C_b$ and $C'_b$ are isomorphic); but such that $\cC$ and $\cC'$ are not isomorphic.
%\end{enumerate}
%
%Examples of both of these can be found in \cite[****]{GeomSchemes}.\fix{add precise reference. The moduli question occupies only the last 2.5 pages of that book.}

\subsection{Compactifying $M_g$}\label{compactifying Mg}

In general, if $X$ is any variety a \emph{compactification} of $X$ is simply the inclusion of $X$ as an open subset of a compact, or proper variety $Y$. In case $X$ is a moduli space for a certain class of objects, however, there is a special class of compactifications,  called \emph{modular} in which $Y$ itself is the moduli space of some larger class of objects. In practice, if $M$ is a moduli space parametrizing a certain class $\Sigma$ of geometric objects---for example, smooth projective curves of genus $g$---and $N$ is a moduli space of the class of objects $\overline \Sigma$, then we apply the valuative criterion to test whether $N$ is compact (or \emph{proper}, over a different base field): If every family of objects in $\Sigma$ parametrized by a punctured disc $\Delta^*$ can be extended to a family of objects in the larger class $\overline \Sigma$ over the full disc $\Delta$ in a unique way, then $Y$ is compact and separated (that is, Hausdorff). If every object in the class $\overline \Sigma$ appears as a limit of objects in $\Sigma$, then $N = \overline M$ and $N$ is called a \emph{modular compactification} of $M$.

In the example of the moduli space $M_g$ parametrizing smooth, projective curves of genus $g$, Deligne and Mumford introduced the larger class of \emph{stable curves}. These are by definition connected curves $C$ of arithmetic genus $g$, with two properties:

\begin{enumerate}
\item $C$ has only nodes as singularities; and
\item the automorphism group of $C$ is finite.
\end{enumerate}

This  solution to the problem is not the only one: For example, \cite{MR1106299} shows that we can also give a modular compactification by enlarging the class of smooth curves to the class of \emph{pseudo-stable} curves, in which we allow cusps as well as nodes, but disallow elliptic tails (smooth components of genus 1 meeting the rest of the curve in only one point). Many other compactifications have been studied by Hassett-Hyeon-\cite{MR2500894}, Smyth~\cite{MR2801404} and ~\cite{MR3044128}, Alper-Fedorchuk-Smyth~\cite{MR3020172} and others.

\subsection{Can one write down a general curve of genus $g$?}

%The first important result about the moduli space is that $M_g$ is irreducible; we will sketch the characteristic 0 proof in Section~\ref{hurwitz spaces}  (a proof of the irreducibility of $M_g$ valid in arbitrary characteristic was not found until much later. \fix{reference!})

Given that a moduli space $M_g$ exists and is irreducible, we can make sense of the question: Can one write down a general curve of genus $g$?
That is: can we find a family of curves depending freely on parameters---in other words, a family $\cC \to B$ over an open subset $B \subset \AA^n$---that includes a general curve of genus $g$, in the sense that the induced map $\phi_\cC : B \to M_g$ is dominant? This is of course just the first step in knowing the structure of $M_g$.

We have done this in the case of genus 2 and 3. Essentially
the same approach works in genera $4$ and $5$; in each case a general canonical curve is a complete intersection, so that if we take the coefficients of its defining polynomials to be general scalars we have a general curve.

This method breaks down when we get to genus 6, where a canonical curve is not a complete intersection. But it's close enough: a general canonical curve of genus 6 is the intersection of a smooth del Pezzo surface $S \subset \PP^5$ with a quadric hypersurface $Q$; since all smooth del Pezzo surfaces in $\PP^5$ are isomorphic, we can just fix one such surface $S$ and let $Q$ be a general quadric.

It gets harder as the genus increases. Let's do one more case, genus 7, which already calls for a different approach. Here we want to argue that, by Brill-Noether theory, a general curve of genus $7$ can be realized as (the normalization of) a plane septic curve with 8 nodes $p_1,\dots,p_8 \in \PP^2$. Equivalently, if we let $S = Bl_{p_1,\dots,p_8}(\PP^2)$ be the blow-up, and let $l$ and $e_1,\dots,e_8$ be the classes of the pullback of a line and of the eight exceptional divisors respectively, a divisor of class $7l - 2 \sum e_i$ is a curve of genus 7 on $S$. Thus the curves on $S$ form a linear series, parametrized by a projective space $\PP^{11}$.

The problem is, there are many such surfaces $S$; we don't have a single linear system that includes the general curve of genus 7. The good news is, that's OK because the surfaces $S$ themselves form a rationally parametrized family. Explicitly, if we look at the set $\Phi$ of pairs $(S, C)$ with $S = Bl_{p_1,\dots,p_8}(\PP^2)$  the blow-up of $\PP^2$ at eight points and $C \subset S$ a curve of class $7l - 2 \sum e_i$ on $S$, then $\Phi$ is a $\PP^{11}$-bundle over $(\PP^2)^8$, and so is again a rational variety; choosing a rational parametrization of $\Phi$ we get a family of curves of genus $7$ parametrized by $\PP^{27}$ and dominating $M_7$. As before, then, a general point in $\PP^{27}$ yields a general curve of genus 7.

Things continued in this vein up through genus 10, but then this approach fails as well: if we represent a general curve of genus 11 as a plane curve with nodes, the nodes are no longer general points of $\PP^2$, and the same argument doesn't work. Ad hoc (and much more difficult) arguments were given in genera 11, 12 13 and 14, but so far no-one can go further in producing general curves. 

A spectacular application of the existence of $\overline M_g$ was the proof that this sequence cannot go much further! To say that there exists a family $\cC \to B$ over an open subset $B \subset \AA^n$ such that the induced map $\phi_\cC : B \to M_g$ is dominant implies that $M_g$ is \emph{unirational}, an assertion that we can disprove simply by exhibiting a pluricanonical divisor on a desingularization of $\overline M_g$. This was carried out in \fix{add references)} for all genera $g \geq 23$; in a neat twist, the divisor used consisted of curves possessing a special linear system with Brill-Noether number $-1$, meaning its existence was dependent on the proof of the Brill-Noether Theorem.

The existence of an effective pluricanonical divisor on $\overline M_g$ tells us even more: for example it implies that \emph{$M_g$ is not uniruled}, meaning that through a general point $[C] \in M_g$ there are no rational curves. This is because the restriction (or pullback) of a nonzero differential to such a curve would be a nonzero diferential, contradicting the fact that the canonical bundle of $\PP^1$ has  negative degree. A consequence is that the sort of descriptions of embeddings with which much of this book is concerned, where we produce a surface on which a general curve of a certain sort lies, cannot be continued to high genus:

\begin{corollary}
 A general curve $C$ of  genus $\geq 22$ does not lie in a nontrivial linear series on any surface
 except those birational to $C\times \PP^1$.
\end{corollary}
\begin{proof}
 A linear family of curves containing $C$ that are not all isomorphic would map to a rational curve in $M_g$; if the curves are all isomorphic, one can show that the family
 covers a surface birational to a product of $C$ and some other curve \fix{put in an argument,
 using the prop. that a general curve has no automorphisms.}
\end{proof}



\begin{exercise}
Find the degree of the covering space $\alpha : \cH_{3,g} \to U \subset \PP^{2g+4}$
defined in Section{hurwitz spaces}.
\end{exercise}

\begin{exercise}\label{symmetric power vs Hilbert scheme}
\begin{enumerate}
 \item If $X$ is a smooth curve, then the Hilbert scheme of finite subschemes of $X$ of degree $d$ is
 isomorphic to the symmetric product of $d$ copies of $X$.
 \item If $X$ is a singular curve or any variety of dimension $r \geq 2$, the symmetric power $X^{(d)}$ is \emph{not} the Hilbert scheme of subschemes of dimension 0 and degree $d$ on $X$. 
 
 \fix{maybe needs a hint, especially since we can't do even the first part!}
\end{enumerate}
 \end{exercise}

\section{Exercises}
\begin{exercise}
It is not an accident that we can characterize a fine moduli space $M$ in terms of the maps into it. 
 Let $X$ be a category, and $F,G$ two functors from $X$ to the category of sets.
 A morphism $\eta: F\to G$ in the category of functors is what is called a \emph{natural transformation}:
 for every object $a\in X$ there is a morphism $\eta_a:F(a) \to G(a)$ such that for every
 morphism $f: a\to b$ in $X$ the compositions $G(f)\circ \eta_a$ and $\eta_b\circ F(f)$
 are equal. 
\begin{enumerate}
 \item (Prove Yoneda's Lemma: If $X$ is any category, and $F$ is a contravariant functor from $X$ to the category of sets, then 
 $$
 \Hom_{\hbox{\scriptsize Functors on $X$}}(\Hom_X( -, Z), F) = F(Z)
 $$
 \item Conclude that if the functors $\Hom_X( -, Z)$ and $Hom_X( -, Z')$ are isomorphic in the functor category, 
 then $Z \cong Z'$ in $X$; that is, the functor $\Hom_X( -, Z)$ determines the object $Z$.
 \end{enumerate}
\end{exercise}

%
%\section{Unirationality}
%
%The Brill-Noether theorem, in all its many forms, deals with a simple question: what linear series $g^r_d$ does a curve $C$ of genus $g$ possess? Of course, the answer depends on $C$, but we know from general principles that it's constant on an open subset of $M_g$; so it's natural to ask what the answer is on that open set. That is the subject of the Brill-Noether theorem: what linear series exist on a general curve $C$ of genus $g$? This raises, naturally, a question we'll take up next.
%
%\subsection{Can we write down a general curve of genus $g$?}
%
%Let's do this one genus at a time. For curves of genus 2, the family of curves given by
%$$
%y^2 = x^6 + a_5x^5 + \dots + a_1x + a_0
%$$
%includes every curve of genus $2$; in other words, the induced (rational) map $\AA^6 \to M_2$ is dominant, so that  a general choice of the coefficients $a_i$ will yield a general curve.



\input{footer}