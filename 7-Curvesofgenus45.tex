\input{header.tex}

\chapter{Curves of genus 4 and 5}\label{genus 4, 5 Chapter}

In this Chapter we focus on the linear systems that exist on curves of genus 4 and 5, and what this says about maps to $\PP^r$, focusing on the nonhyperelliptic case, which is quite different. Modulo a general position result that we will put off until Chapter~\ref{uniform position} we'll also prove the
important Theorem~\ref{canonical curves are ACM}, which allows us to identify the Hilbert functions of canonical curves of any genus.

We will say more about hyperelliptic curves in Chapter~\ref{ScrollsChapter}. 
In particular we will discuss the canonical embeddings of these curves. 
\section{Curves of genus 4}

In genus 4 we have a question that the elementary theory based on the Riemann-Roch formula cannot answer: are nonhyperelliptic curves of genus 4 \emph{trigonal}, that is, expressible as three-sheeted covers of $\PP^1$? The answer will emerge from our analysis in Proposition~\ref{genus 4 trigonal} below.

\subsection{The canonical model}

Let $C$ be a non-hyperelliptic curve of genus 4. We start by considering the canonical map $\phi_K : C \hookrightarrow \PP^3$, which embeds $C$ as a curve of degree 6 in $\PP^3$. We identify $C$ with its image, and investigate the homogeneous ideal $I = I_C$ of equations it satisfies. As in previous cases we may try to describe $I$ by considering the restriction maps
$$
\rho_m : \HH^0(\cO_{\PP^3}(m)) \; \to \; \HH^0(\cO_{C}(m)) = \HH^0(mK_C).
$$

For $m=1$, this is by construction an isomorphism; that is, the image of $C$ is non-degenerate (not contained in any plane).

For $m=2$ we know that $\h^0(\cO_{\PP^3}(2)) = \binom{5}{3} = 10$, while by the Riemann-Roch
theorem we have
$$
h^0(\cO_C(2)) = 12 - 4 + 1 = 9.
$$
This shows that the curve $C \subset \PP^3$ must lie on at least one quadric surface $Q$. The quadric $Q$ must be irreducible, since any any reducible and/or non-reduced quadric must be a union of planes, and thus cannot contain an irreducible non-degenerate curve.
If $Q'\neq Q$ is any other quadric then, by B\'ezout's theorem, $Q\cap Q'$ is a curve of degree 4 and thus could not contain $C$. From this we see that $Q$ is unique, and it follows that $\rho_2$ is surjective.

What about cubics? Again we consider the restriction map
$$
\rho_3 : H^0(\cO_{\PP^3}(3)) \; \to \; H^0(\cO_{C}(3)) = \HH^0(3K_C).
$$
The space $H^0(\cO_{\PP^3}(3))$ has dimension $\binom{6}{3} = 20$, while  the Riemann-Roch formula shows that
$$
h^0(\cO_C(3)) = 18 - 4 + 1 = 15.
$$
It follows that the ideal of $C$ contains at least a 5-dimensional vector space of cubic polynomials. We can get a 4-dimensional subspace as products of the unique quadratic polynomial $F$ vanishing on $C$ with linear forms---these define the cubic surfaces containing $Q$. Since $5 > 4$ we  conclude that the curve $C$ lies on at least one cubic surface $S$  not containing $Q$. 
B\'ezout's theorem shows that the curve $Q \cap S$ has degree 6; thus it must be equal to $C$. 

Let $G=0$ be the cubic form defining the surface $S$. By Lasker's theorem the ideal $(F,G)$ is unmixed, and thus is equal to the homogeneous ideal of $C$. Putting this together, we have proven the first statement of the following result:

\begin{theorem}
The canonical model of any nonhyperelliptic curve of genus 4 is a complete intersection of a quadric $Q = V(F)$ and a cubic surface $S = V(G)$ meeting transversely along nonsingular points of each. Conversely, any smooth curve that is the complete intersection of a quadric and a cubic surface in $\PP^3$ is the canonical model of a nonhyperelliptic curve of genus 4.
\end{theorem}
 
\begin{proof}
Let $C = Q\cap S$ with $Q$ a quadric and $S$ a cubic. Because $C$ is nonsingular and a complete intersection, both $S$ and $Q$ must be nonsingular at every point of their intersection Applying the adjunction formula to $Q\subset \PP^3$ we get
$$
\omega_Q = (\omega_{\PP^3} \otimes \cO_{\PP^3}(2))|_Q = \cO_Q(-4+2) = \cO_Q(-2).
$$
Applying it again to $C$ on $Q$, and noting that $\cO_Q(C) = \cO_Q(3)$, we get
$$
\omega_C = ((\omega_{Q} \otimes \cO_{3}(3))|_C = \cO_C(-2+3) = \cO_C(1)
$$
as required. 
\end{proof}

Since the quadric surface $Q$ containing the canonical curve $C$  is unique, its rank is an invariant of $C$.
Since $C$ is irreducible and non-degenerate, the quadric cannot be a double plane or the union of two planes, but it can be singular (rank 3) or smooth (rank 4). On the other hand, the singularities of a cubic $F$ such that $F\cap Q = C$ play no role. Of course $F$ must be nonsingular along $C$, since else 
$C$ would be singular. We can vary $F$ by adding a multiple of the equation of $Q$ to the equation of $F$, and since this linear system of cubics has base locus only along $C$, Bertini's Theorem shows that the general such cubic is nonsingular everywhere.

\subsection{Maps to $\PP^1$ and $\PP^2$}

We can now answer the question we asked at the outset, whether a nonhyperelliptic curve of genus 4 can be expressed as a three-sheeted cover of $\PP^1$. This amounts to asking if there are any divisors $D$ on $C$ of degree 3 with $r(D) \geq 1$; since we can take $D$ to be a general fiber of a map $\pi : C \to \PP^1$, we can for simplicity assume $D = p+q+r$ is the sum of three distinct points.

By the geometric Riemann-Roch theorem, a divisor $D = p+q+r$ on a canonical curve $C \subset \PP^{g-1}$ has $r(D) \geq 1$ if and only if the three points $p,q,r \in C$ are colinear. If three points $p,q,r \in C$ lie on a line $L \subset \PP^3$ then the quadric $Q$ would meet $L$ in at least three points, and hence would contain $L$. Conversely,  if $L$ is a line contained in $Q$, then the divisor $D = C \cap L = S \cap L$ on $C$ has degree  3. Thus we can answer our question in terms of the family of lines contained in $Q$.

Any smooth quadric is isomorphic to $\PP^1\times \PP^1$, and contains two families of lines, or \emph{rulings}. On the other hand, any singular quadric is a cone over a plane conic, and thus has just one ruling. By the argument above, the pencils of divisors on $C$ cut out by the lines of these rulings are the $g^1_3$s on $C$. This proves:

\begin{proposition}\label{genus 4 trigonal}
A nonhyperelliptic curve of genus 4 may be expressed as a 3-sheeted cover of $\PP^1$ in either one or two ways, depending on whether the unique quadric containing the canonical model of the curve is singular or smooth.
\end{proposition}

A curve expressible as a 3-sheeted cover of $\PP^1$ is called \emph{trigonal}; by the analyses of the preceding sections, we have shown that \emph{every curve of genus $g \leq 4$ is either hyperelliptic or trigonal}. 

We can also describe the lowest degree plane models of nonhyperelliptic curves $C$ of genus 4. 
We can always get a plane model of degree 5 by projecting $C$ from a point $p$ of the canonical model of $C$. Moreover, the Riemann-Roch theorem shows that if $D$ is a divisor of degree 5 with $r(D)=2$ then,  $\h^0(K-D) = 1$. Thus $D$ is of the form $K-p$ for some point $p \in C$, and the map to $\PP^2$ corresponding to $D$ is $\pi_p$. These  maps $\pi_p: C\to \PP^2$ have the lowest possible degree (except for those whose image is  contained in a line) because, by Clifford's theorem a nonhyperelliptic curve of genus 4 cannot have a $g^2_4$.

We now consider the singularities of the plane quintic $\pi_p(C)$. Suppose as above that $C = Q\cap S$, with $Q$ a quadric. If a line $L$ through $p$ meets $C$ in $p$ plus a divisor of degree $\geq 2$ then, as we have seen, $L$ must lie in $Q$.  All other lines through $p$ meet $C$ in at most a single reduced point,  whose image is thus a nonsingular point of $\pi(C)$. Moreover, a line that met $C$ in $>3$ points would have to lie in both the quadric and the cubic containing $C$, and therefore would be contained in $C$. Since $C$ is irreducible there can be no such line; thus the image $\pi_p(C)$ has at most double points.

We will distinguish two cases, depending on whether the quadric $Q$ is smooth or singular. We will make use of the Gauss map of the quadric, described by the next Lemma.

\begin{lemma}
Let $L \subset S \subset \PP^3$ be a line on a surface $S \subset \PP^3$ of degree $d$. The Gauss map $\cG : S \to {\PP^3}^*$ sending each point $p \in S$ to the tangent plane $\TT_p(S)$ maps $L$ into the dual line in $\PP^3$ (that is, the locus of planes containing $L$); if $S$ is smooth along $L$ then $\cG$  has degree $d-1$, and if $S$ is singular anywhere along $L$ it has strictly lower degree.
\end{lemma}

\begin{proof}
Suppose that in terms of homogeneous coordinates $[X,Y,Z,W]$ on $\PP^3$ the line $L$ is given by $X = Y = 0$. Then the defining equation $F$ of $S$ can be written
$$
F(X,Y,Z,W) = X\cdot G(Z,W) + Y\cdot H(Z,W) + J(X,Y,Z,W)
$$
where $J$ vanishes to order 2 along $L$; that is, $J \in (X,Y)^2$. The Gauss map $\cG|_L$ restricted to $L$ is then given by
$$
[0,0,Z,W] \mapsto [G(Z,W), H(Z,W), 0, 0].
$$
The polynomials $G$ and $H$ have degree $d-1$, and have a common zero if and only if $S$ is singular somewhere along $L$; the lemma follows.
\end{proof}

\begin{example} (Gauss map of a quadric)\label{Gauss of Quadric}
 Let $Q\subset \PP^3$ be a smooth quadric, and let $L\subset Q$ be the line $X=Y =0$. Since we may write the equation of $Q$ as $XZ+YW = 0$, the Gauss map of $Q$, restricted to $L$, maps $L$ one-to-one onto the dual line. Indeed, the Gauss map takes $Q$ isomorphically onto its dual, which is also a smooth quadric.
 
 We can also see this geometrically: if $H \subset \PP^3$ is any plane containing the line $L \subset Q$, then $H$ intersects $Q$ in the union of $L$ and a line $M$; the hyperplane section $Q \cap H = L \cup M$ is then singular at a unique point $p \in L$. Thus the Gauss map gives a bijection between points on $L$ and planes containing $L$. 
\end{example}

Given this, we can analyze the geometry of projections $\pi_p(C)$ of our canonical curve $C = Q \cap S$ as follows:

\begin{enumerate}
\item $Q$ is nonsingular:
In this case there are two lines $L_1, L_2$ on $Q$ that pass through $p$; they meet $C$ in $p$ plus divisors $E_1$ and $E_2$ of degree 2. If each $E_i$ consists of distinct points, then, since the tangent planes to the quadric along $L_i$ are all distinct by Example~\ref{Gauss of Quadric} the plane curve $\pi(C)$ has two ordinary nodes, one at the image of each $E_i$.

On the other hand, if $E_i$ consists of a double point $2q$ (that is, $L_i$ is tangent to $C$ at $q\neq p$, or meets $C$ three times at $q = p$), then $\pi(C)$ has a cusp at the corresponding image point. 
In either case, $\pi(C)$ has two distinct singular points, each either a node or a cusp. The two $g^1_3$s on $C$ correspond to the projections from these singular points.

\item $Q$ is a cone:
In this case, since the curve cannot pass through the singular point of $Q$ there is a unique line $L\subset Q$ that passes through $p$. Let $p+E$ be the divisor on $C$ in which this line meets $C$. The tangent planes to $Q$ along $L$ are all the same. Thus if $E = q_1+q_2$ consists of two distinct points, the image $\pi_p(C)$ has two smooth branches sharing a common tangent line at
$\pi_p(q_1) = \pi_p(q_2)$. Such a point is called a \emph{tacnode} of $\pi_p(C)$. On the other hand, if $E= 2q$, that is, if $L$ meets $C$ tangentially at one point $q\neq p$ (or meets $C$ 3 times at $p$) then the image curve has a higher order cusp, called a \emph{ramphoid cusp}. In either case, the one $g^1_3$ on $C$ is the projection from the unique singular point of $\pi(C)$.
\end{enumerate}

%\fix{add pictures illustrating some of the possibilities above.}


\section{Curves of genus 5}

We next consider a nonhyperelliptic curve $C$ of genus 5. There are now two questions that cannot be answered by simple application of the Riemann-Roch theorem:

\begin{enumerate}
\item Is $C$ expressible as a 3-sheeted cover of $\PP^1$? In other words, does $C$ have a $g^1_3$?
\item Is $C$ expressible as a 4-sheeted cover of $\PP^1$? In other words, does $C$ have a base-point-free $g^1_4$?
\end{enumerate}

As in the preceding case, the answers can be found through an investigation of the geometry of the canonical model $C \subset \PP^4$ of $C$. This is an octic curve in $\PP^4$, and as before the first question to ask is what sort of polynomial equations define $C$. We start with quadrics, by considering the restriction map
$$
r_2 : \HH^0(\cO_{\PP^4}(2)) \; \to \; \HH^0(\cO_{C}(2)).
$$
On the left, we have the space of homogeneous quadratic polynomials on $\PP^4$, which has dimension $\binom{6}{4} = 15$, while by the Riemann-Roch theorem the target is a vector space of dimension
$$
2\cdot8 - 5 + 1 = 12.
$$
We deduce that $C$ lies on at least 3 independent quadrics. (We will see in the course of the following analysis that it is exactly 3; that is, $r_2$ is surjective.) Since $C$ is irreducible and, by construction, does not lie on a hyperplane, each of the quadrics containing $C$ is irreducible, and thus the intersection of any two is a surface of degree 4. There are now two possibilities:  The intersection of (some) three quadrics $Q_1 \cap Q_2 \cap Q_3$ containing the curve is 1-dimensional; or every such intersection is two dimensional. 

\subsection{First case: the canonical curve is a complete intersection}

We first consider the case where $Q_1 \cap Q_2 \cap Q_3$ is 1-dimensional. By Lasker's theorem the intersection is unmixed. By B\'ezout's theorem the intersection is a curve of degree 8, and since $C$ also has degree 8 we must have $C=Q_1 \cap Q_2 \cap Q_3$. Lasker's theorem then shows that the three quadrics $Q_i$ generate the whole homogeneous ideal of $C$; in particular, there are no additional quadrics containing $C$.

We can now answer the first of our two questions for curves of this type. As in the genus 4 case the geometric Riemann-Roch theorem implies that $C$ has a $g^1_3$ if and only if the canonical model of $C$ contains 3 colinear points or, more generally, meets a line $L$ in a divisor of 3 points. When $C$ is the intersection of quadrics, this cannot happen, since the line $L$ would have to be contained in all the quadrics that contain $C$. Thus, in this case, 
$C$ has no $g^1_3$.

What about $g^1_4$s? Again invoking the geometric Riemann-Roch theorem, a divisor of degree 4 moving in a pencil lies in a 2-plane; so the question is, does $C \subset \PP^4$ contain a divisor of degree 4, say $D = p_1+\dots +p_4 \subset C$, that lies in a plane $\Lambda$? Supposing this is so, we consider the restriction map
$$
\HH^0(\cI_{C/\PP^4}(2)) \; \to \; \HH^0(\cI_{D/\Lambda}(2)).
$$
By what we have said, the left hand space is 3-dimensional. We will show that the right-hand space
is 2-dimensional, so that one of the quadrics vanishes identically on $\Lambda$.

\begin{lemma}\label{4-tuples}
Let $\Gamma \subset \PP^2$ be any scheme of dimension 0 and degree 4. Either $\Gamma$ is contained in a line $L \subset \PP^2$, or $\Gamma$ imposes independent conditions on quadrics, that is, $h^0(\cI_{D/\PP^2}(2)) = 2$.
\end{lemma}

\begin{proof}
We will do this in case $\Gamma$ is reduced, that is, consists of four distinct points; the reader is asked to supply the analogous argument in the general case in Exercise~\ref{non-red 4-tuples}. Suppose to begin with that $\Gamma$ fails to impose independent conditions on quadrics, and let $q \in \PP^2$ be a general point. Since we are assuming that $h^0(\cI_{D/\PP^2}(2)) \geq 3$, we see that there are at least two conics $C', C'' \subset \PP^2$ containing $\Gamma \cup \{q\}$. By Bezout, these two conics have a component in common, which can only be a line $L$; thus we can write $C' = L \cup L'$ and $C'' = L \cup L''$ for some pair of distinct lines $L', L'' \subset \PP^2$. The intersection $C' \cap C''$ thus consists of the line $L$ and the single point $L' \cap L"$. Since this must contain $\Gamma \cup \{q\}$, and $q$ does not lie on the line joining any two points of $\Gamma$, we conclude that $L' \cap L'' = \{q\}$ and hence $\Gamma \subset L$.
\end{proof}

\begin{fact}
The Lemma is the first case of a more general statement: If $n\leq 2d+1$ points in the plane fail to impose independent conditions on forms of degree $d$, then $d+2$ of the point lie on a line. See \cite[p.***]{MR1376653} for a proof.
\end{fact}


 It follows that the 2-plane $\Lambda$ spanned by $D$ must be contained in one of the quadrics $Q \subset \PP^4$ containing $C$. This is implies that the quadric is singular: If $V = \CC^3\subset \CC^5$
is a  3-dimensional subspace of a 5-dimensional inner-product space, then $V$ meets its orthogonal space
in a line, which is a singular point of the corresponding quadric.
 
Thus $Q$ is a cone over a quadric in $\PP^3$, and it is ruled by the (one or two) families of 2-planes it contains, which are the cones over the (one or two) rulings of the quadric in $\PP^3$. The argument above shows that the existence of a $g_4^1$s on $C$ in this case implies the existence of a singular quadric containing $C$.

Conversely, suppose that $Q \subset \PP^4$ is a singular quadric containing $C = Q_1 \cap Q_2 \cap Q_3$. Now say $\Lambda \subset Q$ is  a 2-plane. If $Q'$ and $Q''$ are ``the other two quadrics" containing $C$, we can write
$$
\Lambda \cap C = \Lambda \cap Q' \cap Q'', 
$$ 
from which we see that $D = \Lambda \cap C$ is a divisor of degree 4 on $C$, and so has $r(D) = 1$ by the geometric Riemann-Roch theorem. Thus, the rulings of  singular quadrics containing $C$ cut out on $C$ pencils of degree 4; and every pencil of degree 4 on $C$ arises in this way.

Does $C$ lie on singular quadrics? There is a $\PP^2$ of quadrics containing $C$---a 2-plane in the space $\PP^{14}$ of quadrics in $\PP^4$---and the family of singular quadrics  consists of a  hypersurface of degree 5 in $\PP^{14}$--called the \emph{discriminant} hypersurface. By Bertini's theorem, not every quadric containing $C$ is singular. Thus the set of singular quadrics containing $C$ is a plane curve $B$ cut out by a quintic equation. So $C$ does indeed have a $g^1_4$, and is expressible as a 4-sheeted cover of $\PP^1$. Moreover, each singular quadric contributes either 1 or 2 $g^1_4$s, depending on whether it has rank 3 or 4. In sum, we have proven:

\begin{proposition}
Let $C \subset \PP^4$ be a canonical curve, and assume $C$ is the complete intersection of three quadrics in $\PP^4$. Then $C$ may be expressed as a 4-sheeted cover of $\PP^1$ in a one-dimensional family of ways, and there is a map from the set $W^1_4(C)$ of $g^1_4$s on $C$ to a plane quintic curve $B$, whose fibers have cardinality 1 or 2.
\end{proposition}

One can go further and ask about the geometry of the plane curve $B$ and how it relates to the geometry of $C$. The list of possibilities is given in \cite[p. 274]{ACGH}. %\fix{possibly include a photo here?}

\subsection{Second case: the canonical curve is not a complete intersection}

At the outset of our analysis of curves of genus 5, we saw that a canonical curve $C \subset \PP^4$ of genus 5 is contained in at least a three-dimensional vector space of quadrics. Assuming that the intersection of these quadrics was 1-dimensional---and hence $C$ was a complete intersection---led us to the analysis above. We'll now consider the alternative: what if the intersection of the quadrics containing our canonical curve is a surface?

The first thing to do in this case is to observe that the intersection must contain an irreducible, nondegenerate surface. This  follows from Fulton's Elementary B\'ezout  theorem:
%\fix{maybe move this---with its new name---to whereever we recall B\'ezout's Thm}

\begin{theorem}\cite[]{Fulton}
Let $Z_1,\dots, Z_k \subset \PP^n$ be hypersurfaces of degrees $d_1,\dots,d_k$. If $\Gamma_1,\dots,\Gamma_m$ are the irreducible components of the intersection $\bigcap_1^kZ_j$, then
$$
\sum_{\alpha = 1}^m \deg(\Gamma_\alpha) \; \leq \; \prod_{i=1}^k d_i.
$$
\end{theorem}

\begin{proof}
We do induction on $k$, the result being trivial for $k=1$. Assuming that the the result
is true for $k-1$, we consider the irreducible components $V_i$ of $\bigcap_1^{k-1}Z_j$. If $Z_k$ contains
$V_i$, then $V_i$ is again a component of $\bigcap_1^kZ_j$. Otherwise,
$V_i\cap Z_k$ is a union of components whose degrees sum to $d_k\deg V_i$. Thus
the sum of the degrees of the components of $\bigcap_1^kZ_j$ is at most $d_i$ times the
sum of the degrees of components of $\bigcap_1^{k-1}Z_j$, as required.
\end{proof}

Returning to the canonical curve $C \subset \PP^4$, suppose that the intersection $X = Q_1 \cap Q_2 \cap Q_3$ of the three quadrics containing $C$ has dimension 2. If $C$ were a component of $X$, then the sum of the degrees of the irreducible components of $X$ would be strictly greater than 8, which Fulton's theorem doesn't allow. Thus $C$ must be contained in a 2-dimensional irreducible component  $S$ of $X$, and this surface $S$ is necessarily nondegenerate.

We will identify this surface, and the divisor classes on it, in Exercise~\ref{trigonal genus 5} in Chapter~\ref{scrollsChapter}, once we develop the theory of rational normal scrolls.
Here is the result:

\begin{theorem}
Let $C \subset \PP^4$ be a canonical curve of genus 5. Then $C$ lies on exactly three quadrics, and either
\begin{enumerate}
\item $C$ is the intersection of these quadrics; in which case $C$ is not trigonal, and the variety $W^1_4(C)$ of expressions of $C$ as a 4-sheeted cover of $\PP^1$ is a two-sheeted cover of a plane quintic curve; or
\item The quadrics containing $C$ intersect in a nonsingular cubic surface; in this case, $C$ has a unique $g^1_3$, and the variety $W^1_4(C)$ consists of the union of two copies of $C$ meeting at two points.
\end{enumerate}
\end{theorem}

\begin{fact}
In the second case of the Theorem, the ideal of the curve is generated by the $4\times 4$ Pfaffians
of a skew-symmetric $5\times 5$ matrix of the form
$$
\begin{pmatrix}
0&0&\ell_0 &\ell_1 &\ell_2\\
0&0&\ell_1&\ell_2&\ell_3\\
-\ell_0&-\ell_1& 0&Q_1&Q_2\\
-\ell_1&-\ell_2&-Q_1&0&Q_3\\
-\ell_2&-\ell_3&-Q_2&-Q_3&0
\end{pmatrix}
$$
where $\ell_0,\dots,\ell_3$ are independent linear forms and $Q_1, Q_2, Q_3$ are quadrics. The columna of this matrix generate the syzygies of the ideal. Moreover, the
$4\times 4$ Pfaffians of any sufficiently general matrix of this form define a trigonal canonical curve.
\end{fact}
\section{Canonical curves are projectively normal}\label{Noether theorem section}

When we analyze the embedding of a curve $C\subset \PP^n$ we generally ask first whether $C$ is contained in any low-degree
hypersurfaces, and if so how many, in the sense of the dimension $\dim((I_C)_e)$ of the degree $e$ part of the homogeneous ideal of $C$.
From the long exact sequence in cohomology
$$
0\to H^0(\sI_{C/\PP^n}(e)) \to H^0(\sO_{\PP^n}(e)) \to H^0(\sO_C(e)) \to H^1(\sI_{C/\PP^n}(e)) \to H^1(\sO_{\PP^n}(e)) \to\cdots
$$
together with the identification of $H^0(\sO_{\PP^n}(e))$ with the vector space of degree $e$ forms on $\PP^n$, and  the fact that
 $H^1(\sO_{\PP^n}(e)) = 0$ for all $n>1$ and all $e\geq 0$, we see that
 $$
 \dim (I_C)_e = h^0(\sI_{C/\PP^n}(e)) = h^0(\sO_{\PP^n}(e)) - h^0(\sO_C(e)) + h^1(\sI_{C/\PP^n}(e)).
$$
If $\sO_C(e)$ is nonspecial---for example if $e$ times the degree of $C$ is $>2g-2$---then the the Riemann-Roch Theorem tells us the value of
 $h^0(\sO_C(e))$, and thus a lower bound for $ \dim (I_C)_e$. If, in addition, the map
 $H^0(\sO_{\PP^n}(e) \to H^0(\sO_C(e))$ is surjective (or equivalently $h^1(\sI_{C/\PP^n}(e))=0$),
 then we get $ \dim (I_C)_e$ exactly.
 
 
\begin{definition} An embedding of a smooth curve
$C\subset \PP^n$ is said to be \emph{projectively normal} or \emph{arithmetically Cohen-Macaulay} if all the maps $H^0(\sO_{\PP^n}(e)) \to H^0(\sO_C(e))$ are surjective,
or equivalently $h^1(\sI_{C/\PP^n}(e))=0$ for all $e\geq 0$ (equivalently, for all $e\in \ZZ$. \end{definition}
 
 
\begin{remark}
 Smooth varieties are of course normal and Cohen-Macaulay in the sense that their local rings have these properties. The condition of ``projective normality'' is equivalent, by Serre's Criterion (see for example~\cite[Section 11.2]{Eisenbud1995}), to the normality of the homogeneous coordinate ring of $C$. In the case of smooth curves, this is equivalent to the condition that the homogeneous coordinate
ring is Cohen-Macaulay, whence the term \emph{arithmetically Cohen-Macaulay} (sometimes also, confusingly, called
\emph{projectively Cohen-Macaulay}.


Serre's criterion for normality has two parts, which are interesting separately: A local or graded ring is normal if it is nonsingular in
codimension 1; and
locally of depth $\geq 2$ in codimension $\geq 2$ (\cite[Theorem 11.5]{Eisenbud1995}) In the case of the homogeneous coordinate ring of a curve, 
the first condition means that the curve is nonsingular and the second means that $h^1(\sI_{C/\PP^n}(e))=0$ for all $e$.
It follows that for any very ample invertible sheaf $\sL$ on a smooth curve $C$, the ring 
$$
R(C, \sL) := \bigoplus_{e=0}^\infty H^0(\sL^e)
$$
is the normalization of the homogeneous coordinate ring in the embedding of $C$ by $|\sL|$.

More generally, a scheme
$X\subset \PP^n$ is called \emph{arithmetically Cohen-Macaulay} if 
$h^1(\sI_{C/\PP^n}(e))=0$ and $h^i(\sI_{C/\PP^n}(e))=0$ for all $e\in \ZZ$ and all $0<i<\dim X$.
This is equivalent to the condition that the homogeneous coordinate ring of $X$ is a Cohen-Macaulay
ring.

\end{remark}

\begin{example}\label{rnc is projectively normal}
For $d\geq 1$ the rational normal curve $C\subset \PP^d$ of degree $d$ is projectively normal. 
We have $H^0(\sO_{\PP^1}(ed))  = \CC[s,t]_{ed}$. Th natural natural map
$$
\CC[x_0,\dots,x_d] \to\bigoplus_{e = 0}^\infty H^0(\sO_{\PP^1}(ed)));\quad x_0,\dots, x_d \mapsto s^d,s^{d-1}t,\dots, t^d
$$ 
is surjective since every monomial of degree $ed$ can be written as a monomial in  
the elements $s^d,s^{d-1}t,\dots, t^d$, and the ring is normal (Exercise~\ref{normality of RNC}).
\end{example}

We will now show that the canonical image of every smooth curve of genus $\geq 2$ is projectively normal. When the curve is hyperelliptic,
the canonical image is the rational normal curve, treated above, so we may assume that the curve $C$ is embedded
by $|K_C|$ as a smooth curve in $\PP^{g-1}$.

To do this we will make use of a general position aregument, whose conclusion is that the canonical curve has a \emph{simple $(g-4)$-secant $(g-3)$-plane.}

\begin{lemma}\label{simple secant}
 If $C\subset \PP^n$ is a smooth nondegenerate curve, $n\geq 3$, and $m\leq n-1$, then the linear span $L := \overline{p_1,\dots, p_m}$
 of $m$ general points of $C$ is a simple $m$-secant; that is, a plane of dimension $m-1$ such that
 $C\cap L = \{p_1,\dots,p_m\}$ scheme-theoretically.
 \end{lemma}
 
\begin{proof}
By Lemma~\ref{general position lemma} the points of a general hyperplane section are in linearly general position.
\end{proof}

The following was proven, for smooth curves, by Max Noether, Emmy's father.

\begin{theorem}\label{canonical curves are ACM}
If $C\subset \PP^{g-1}$ is the canonical image of a smooth curve of genus $\geq 2$ then the natural maps
$\HH^0(\sO_{\PP^{g-1}}(m)) \to \HH^0(\sO_C(m))$
are surjective for all $m\in \ZZ$; equivalently,
$\HH^{1}(\sI_{C/\PP^{g-1}}(m)) = 0$ for all $m\in \ZZ$.
\end{theorem}
 
We will follow Schreyer's presentation of the proof from~\cite{Schreyer}, which has the advantage that it applies to a wide range of singular
curves as well. 
 
   
\begin{proof} 
One sees the equivalence of the two statements from the long exact sequence in cohomology coming from the sequences
$$
0\to \sI_{C/\PP^{g-1}} \to\sO_{\PP^{g-1}} \to \sO_C \to 0 
$$
after tensoring with $\sO_{\PP^{g-1}}(m)$.


The invertible sheaf $\sO_C(-m)$ has negative degree, and thus no nonzero global sections for $m<0$.
For $m=0,1$ the surjectivity of  $\HH^0(\sO_{\PP^{g-1}}(m)) \to \HH^0(\sO_C(m))$ is immediate from the hypothesis that $C$ is
the image of a map corresponding to a complete linear series.

If
$g=2$ then $C$ is a line, and the result is trivial, so we may assume $g\geq 3$.

%Also, if $g=3$ then $C$ is a plane quartic,
%and $\sI_{C/\PP^{g-1}} = \sO_{\PP^2}(-4)$. Since $H^1(\sO_{\PP^n}(d)) = 0$ for all $n>1$ and all $d$, the Theorem is true
%in this case. Thus we may assume $g\geq 4$.

By Lemma simple secant, $C$ in has a  simple $g-3$-dimensional $g-2$ secant plane $\Lambda$. Write
$\Lambda\cap C = \{p_1,\dots, p_{g-2}\}$. Choose linear forms $x_1,\dots, x_{g-2}$ on $\PP^{g-1}$ such that
$x_i$ vanishes on $p_j$ if and only if $i=j$. 

To simplify the notation, let $D$ be the divisor $p_1+\cdots+p_{g-2}$.
The sheaf $\sO_C(K_C)$, restricted to any finte set is trivial,
so the quotient 
$$
mK_C\mid_D = \frac{\sO_C(mK_C)}{\sO_C(mK_C-D)}
$$
is generated by $x_1^m,\dots, x_{g-2}^m$ for every $m\geq 1$.
Thus it suffices to show that the maps
$$
\HH^0(K_C-D) \otimes \HH^0(\sO_C((m-1)K_C)) \to \HH^0(\sO_C(mK_C -D)
$$
are surjective for every $m\geq 2$.

By the geometric Riemann-Roch theorem, the linear series $|K_C-D|$ is a base-point free $g^1_2$, a ``base-point free pencil". 
The following argument is sometimes called the \emph{base-point-free pencil trick}: Choose sections $\sigma_1, \sigma_2$ that
generate the 2-dimensional vector space $V$, and consider the complex of sheaves
$$
0\to \wedge^{2} V\otimes \sL^{-1} \rTo^{
\begin{pmatrix}
 \sigma_2\\-\sigma_1
\end{pmatrix}}
 V\otimes \sO \rTo^{
\begin{pmatrix}
 \sigma_2&\sigma_2
\end{pmatrix}}
 \sL \to 0. \quad (*)
$$
Locally at a point $p$ we may identify $\sigma_1,\sigma_2$ with functions in the local ring $R := \sO_{C,,p}$
and rewrite the complex as
$$
0 \to R \rTo^{
\begin{pmatrix}
 \sigma_2\\-\sigma_1
\end{pmatrix}}
R^2 \rTo^{
\begin{pmatrix}
 \sigma_2&\sigma_2
\end{pmatrix}}
R \to 0. \quad (**)
$$
Since $p$ is not a basepoint of the pencil, with this identification
 $(\sigma_1, \sigma_2)\subset R$ is the unit ideal, so the  sequence $(**)$ is exact, and
 thus the sequence $(*)$ of sheaves is exact too. 
 
 We now tensor the sequence $(*)$ with $\sO_C((m-1)K)$ obtaining an exact sequence
 $$
0\to \wedge^{2} V\otimes \sO_C((m-2)K+D) \rTo V\otimes \sO_C((m-1)K) \rTo \sO_C(mK-D) \to 0.
$$
By the argument at the beginning of the proof, it suffices to show that this induces an exact sequence
on global sections for all $m\geq 2$.

For $m = 2$, we see, again by the geometric Riemann-Roch theorem, that $h^0(\sO_C(D)) = 1$,
while $\dim_\CC(V\otimes \HH^0(\sO_C(K) )= 2g$. Since $\deg(2K-D) = 3g-2>2g-2$, the Riemann-Roch
theorem gives $h^0(\sO_C(2K-D)) = 2g-1$. Since the sequence on cohomology is automatically left-exact,
this dimension computation shows that it is exact.

Finally, for $m>2$ the degree of $(m-2)K+D$ is $>2g-2$, so $\HH^1(\sO_C((m-2)K+D))= 0$ so again we see
that the required sequence is exact, completing the proof.
\end{proof}

\begin{corollary}\label{canonical hilbert function}
If $C\subset \PP^{g-1}$ is a canonical curve with a simple $g-3$-secant, then the Hilbert function of the homogeneous coordinate ring $S_{C}$ of  $C$ depends only on $g$, and is given by:
$$
\dim({S_{C}})_{d} = h^{0}(\cO_{C}(d)) = 
\begin{cases}
 0 &\mbox {if } d<0\\
 1 & \mbox {if }  d=0\\
 g & \mbox {if }  d=1\\
 (2n-1)g+1 & \mbox {if }  d>1\\
\end{cases}
$$
\end{corollary}
\begin{proof}
Theorem~\ref{canonical curves are ACM} implies, in particular, that the homogeneous coordinate ring of $C$ can be identified with 
$\oplus_{n\in \ZZ}\HH^0\sO_C(n)$.  
\end{proof}

\section{Exercises}
\begin{exercise}\label{non-red 4-tuples}
Complete the proof of Lemma~\ref{4-tuples}
\end{exercise}

\begin{exercise}
Verify that if $C$ is a nonhyperelliptic curve of genus 5 then the variety $W^1_4(C)$ is a curve of arithmetic genus 11.
\end{exercise}

\input footer.tex


