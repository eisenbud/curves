\input{header}

\chapter{Inflection points}\label{inflections chapter}
\label{InflectionsChapter}


%Generalizing the ramification points of the two-to-one map of a hyperelliptic curve to $\PP^1$, there are finitely
%many ``special'' points determined by any linear series on any curve, the \emph{inflection points}.


In this chapter, we'll undertake the study of the \emph{inflection points} of a curve in projective space, or more generally of a linear series on a smooth curve. We love this topic for its echos of classical algebraic geometry, but beyond that it will provide a powerful tool for the study of curves; most significantly, it will be an essential ingredient in our proof of the Brill-Noether theorem in the following chapter. 



\section{Inflection points,  Pl\"ucker formulas and Weierstrass points}

\subsection{Definitions}

Everyone knows what a flex point of an arc in $\RR^2$ looks like: naively, it's a point where the arc stops bending to the right and starts bending to the left, or vice versa. 
%\includegraphics[scale=1]{"pic12.1.pdf"}
\begin{center}
\begin{figure}\label{flex}
\centerline{ \includegraphics[scale=1]{"pic12.1.pdf"}}
\end{figure}
 \end{center}


Our first goal will be give a formal characterization of such points on an algebraic curve $C \subset \PP^r$ in projective space of any dimension (or more generally a map $C \to \PP^r$ of a  smooth curve to projective space; that is, a linear series). To start, we will use the following result:

\begin{proposition}\label{vanishing sequence} Let $V$ be a vector space of global sections of an invertible sheaf $\sL$ on a smooth curve $C$, and let $p \in C$ be a point. There exists a basis $\sigma_0, \dots, \sigma_r$ of $V$ consisting of sections vanishing to different orders at $p$. Thus the set
$$
\{ \ord_p(\sigma) \mid \sigma \neq 0 \in V \}
$$
 has cardinality $\dim V$.
\end{proposition}

\begin{proof} Let $\tau_0, \dots, \tau_r$ be a basis of $V$.  If  $\tau_i$ and $\tau_j$ vanish to the same order at $p$, then 
some nonzero linear combination $\tau_i' := a\tau_i+b\tau_j$  will vanish to strictly higher order. Since the coefficients $a$ and $b$ are both necessarily nonzero we may modify our basis, replacing $\tau_i$ with $\tau_i'$, strictly increasing the sum of the orders. 
The order of vanishing of each $\sigma_i$ is bounded above by $\deg \sL$, so the sum of the orders is bounded by $(r+1)\deg \sL$. Thus the process must terminate, and when it does,
 the orders must be distinct. \end{proof}

According to  Proposition~\ref{vanishing sequence}, we may write
$$
\{ \ord_p(\sigma) \mid \sigma \neq 0 \in V \} = \{a_0,\dots,a_r\} \; \text{ with } \; 0\leq a_0 < a_1 < \dots < a_r.
$$
The sequence $a_i = a_i(\cD,p)$ is called the \emph{vanishing sequence} of $\cD$ at $p$.  Since $a_i \geq i$, the numbers $\alpha_i = \alpha_i(\cD,p) := a_i - i$ are often more interesting, and the sequence $0 \leq \alpha_0 \leq \alpha_1 \leq \dots \leq \alpha_r$ is called the \emph{ramification sequence} of $\cD$ at $p$. 

We say that $p$ is an \emph{inflection point} of the linear series $\cD$ if $(\alpha_0,\dots,\alpha_r) \neq (0,\dots,0)$---equivalently, if $\alpha_r > 0$---and we define the \emph{weight} of $p$ to be
$$
w(\cD, p) = \sum_{i=0}^r \alpha_i(\cD, p).
$$

If $\cD$ is very ample, so that it may be viewed at the linear series cut on $C$ by hyperplanes for some embedding $C \subset \PP^r$, then this coincides with the notion above: $p$ is an inflection point if $a_r > r$; that is, if there is a hyperplane $H \subset \PP^r$ having contact of order $r+1$ or more with $C$ at $p$.

The first two terms in the ramification sequence are particularly important: $\alpha_0(\cD, p)$ is nonzero if and only if $p$ is a base point of $\cD$; and if $\alpha_0(\cD, p)=0$, then $\alpha_1(\cD, p) = 0$ if and only if, in addition, the map $\phi_\cD$ is an immersion (that is, has nonzero derivative) at $p$.


\subsection{The Pl\"ucker formula}


In characteristic 0, a linear series on a smooth projective curve can have only finitely many inflection points (we will prove this in Lemma~\ref{finite inflections} below), and in fact the sum of the weights of all the inflection points depends only on the genus of the curve and the degree and dimension of the the linear series. The result is called the Pl\"ucker formula:

\begin{theorem}\label{Plucker}
If $C$ be a smooth curve of genus $g$ and $\cD$ is a
linear series of degree $d$ and dimension $r$, then
 \begin{equation}\label{Plucker formula}
\sum_{p \in C} w(\cD, p) \; = \; (r+1)d + r(r+1)(g-1).
\end{equation}
\end{theorem}
For a proof, see for example~\cite[Theorem 7.13]{allthat}.

Theorem~\ref{Plucker} also holds in positive characteristic under the hypothesis that the number of inflection points is finite (equivalently, not every point is an inflection point). This may seem like an unnecessary hypothesis---it's hard even to imagine a plane curve in which every point is a flex!---but in positive characteristic there are such curves; see Exercise~\ref{inseparable Gauss} .
As an immediate consequence of the Pl\"ucker formula, we have

\begin{corollary}\label{uninflected curves}
 If $C\subset \PP^r$ is a smooth nondegenerate curve with no inflection points, then $C$ is the rational normal curve of degree $r$. 
\end{corollary}

\begin{proof}
Suppose $C \subset \PP^r$ is a curve of degree $d$ and genus $g$. If $C$ has no inflection points then, by the Pl\"ucker formula, we must have
$$
(r+1)d + r(r+1)(g-1) = 0.
$$
This immediately implies that $g=0$, so that we must have $(r+1)(d-r) = 0$ and hence $d=r$; thus $C$ is a rational normal curve.
\end{proof}

In Proposition~\ref{independence on rnc} we showed that if $C \subset \PP^r$ is a rational normal curve, and $\Gamma \subset C$ any proper subscheme of $C$ of degree $r+1$, then $\Gamma$ spans $\PP^r$. The Corollary above implies that the
rational normal curves are the only ones with this property:
 if $C \subset \PP^r$ is any smooth, irreducible, nondegenerate curve other than the rational normal curve,
 and $p \in C$ is an inflection point, then $(r+1)p$ is  a subscheme that lies in a hyperplane. 

Recall that $C\subset \PP^r$ is \emph{projectively homogeneous} if the automorphisms of $\PP^r$ fixing
$C$ act transitively on $C$.  Proposition~\ref{Veronese is projectively homogeneous} shows that the rational normal curve has this property, and now we can see that it's the only irreducible, nondegenerate curve that does: if $C \subset \PP^r$ is any curve and $\phi : \PP^r \to \PP^r$ any automorphism carrying $C$ to itself, $\phi$ will carry inflection points of $C$ to inflection points of $C$, so that a curve with a finite nonzero number of inflection points cannot be projectively homogeneous.

The Pl\"ucker formula leaves many questions about the possible configurations of flex points unanswered. 
For example, how many cusps can there be on a plane curve of geometric genus $g$ and degree $d$? 
The answer is known only up to degree 8: \cite{Zariski1931} proves that a plane curve of degree 8 can have 15 but not 16 cusps.
See \cite{Calabri} and \cite{Kulikov} for recent contributions and \cite{Kharlamov-Sottile} for a study of what is possible
over the real numbers.
%\includegraphics[scale=.5]{"3_Cusps.eps"}
\begin{center}
\begin{figure}\label{3-cusp quartic}
 \caption{A quartic plane curve with 3 cusps(Image credit F. Sottile)}
\centerline{ \includegraphics[scale=.5]{"3_Cusps.eps"}}
\end{figure}
 \end{center}
One thing we do know is the behavior of the inflection points for a general linear series; we will state this here and prove it as a corollary to the proof of the Brill-Noether theorem in Chapter~\ref{BrillNoetherProof}:

\begin{theorem}\label{Brill Noether Plucker}
If $C$ is a general curve of genus $g$, $L \in W^r_d(C) \subset \pic_d(C)$ a general line bundle of degree $d$ with $h^0(L) = r+1$ and $V = H^0(L)$, then every inflection point of the linear series $\cD = (L, V)$ has weight 1 and hence ramification sequence $(0, \dots, 0, 1)$.
\end{theorem}

\subsection{Flexes of plane curves}\label{plane curve pluecker}

Specializing Theorem~\ref{Plucker} to a smooth curve of degree $d$ in the plane, and using the formula
$g= {d-1\choose 2}$, we see that the total number of flexes is $3(d-2)d$. 

It turns out that the ``flex divisor''
$\sum_{p\in C} w(C, p)p$
is the intersection of $C$ with a curve of degree $3(d-2)$, called the \emph{Hessian}: If $C$ is defined by a form $F(x_0, x_1, x_2)$ of degree $d$, then
the Hessian of $C$ is the curve defined by the determinant of the \emph{Hessian matrix} of partial derivatives
$$
Hess(C) :=
\begin{pmatrix}
 \partial^2 F/\partial x_0 \partial x_0 & \partial^2 F/\partial x_0 \partial x_1 & \partial^2 F/\partial x_0 \partial x_2 \\
\partial^2 F/\partial x_1 \partial x_0 & \partial^2 F/\partial x_1 \partial x_1 & \partial^2 F/\partial x_1 \partial x_2 \\
\partial^2 F/\partial x_2 \partial x_0 & \partial^2 F/\partial x_2 \partial x_1 & \partial^2 F/\partial x_2 \partial x_2 
\end{pmatrix}
$$
\begin{theorem}\label{Hessian} If $C$ is a smooth plane curve then the flex divisor of $C$ is the intersection 
of $C$ with the Hessian curve defined by $\det Hess(C)$.
\end{theorem}
The proof is an exercise in Euler's formula and matrix manipulation; see Exercise~\ref{Hessian exercise}.

\subsection{Weierstrass points}\label{Weierstrass points}

As with any extrinsic invariant of a curve in projective space, we can derive an intrinsic invariant of an abstract curve by applying the invariant to the canonical linear series. We define a \emph{Weierstrass point} of a curve $C$ to be an inflection point of the canonical linear series $|K_C|$. 

Thus $p$ is a Weierstrass point of $C$ if there exists a  differential form on $C$ vanishing to order $g$ or more at $p$. The \emph{weight} $w_p$ of a Weierstrass point $p \in C$  is defined to be the weight $w(|K_C|,p)$ of $p$ as an inflection point of the canonical series. 

The Pl\"ucker formula tells us  the total weight of the Weierstrass points on a given curve $C$:

\begin{corollary}\label{plucker formula}
The sum of the weights of the Weierstrass points on a curve $C$ of genus $g$ is
$$
\sum_{p \in C} w_p = g^3-g.
$$\qed
\end{corollary}

Note that Theorem~\ref{Brill Noether Plucker} implies that on a general curve $C$ of genus $g$, every Weierstrass point has weight 1; thus there are $g^3-g$ distinct Weierstrass points on $C$.

%Since there are only finitely many ramification points of the canonical series, a general point $p$ on any curve $C$ has gap sequence $(1,2,\dots,g)$, and correspondingly its Weierstrass semigroup
%is $W_p = (0, g+1, g+2, \dots)$. A Weierstrass point is called \emph{normal} if it has weight 1; this is tantamount to saying that the gap sequence is $(1,2,\dots,g-1,g+1)$, or that the semigroup is $(0, g, g+2, g+3, \dots)$. (The full Brill-Noether theorem tells us that a general curve $C$ has only normal Weierstrass points; this will be a consequence of Theorem~\ref{BN with inflection and dimension} below.)

For example, suppose $C$ is a curve of genus 2. The canonical series on $C$ gives a map $\phi_K : C \to \PP^1$ of degree 2; the Weierstrass points of $C$ are the 6 ramification points of this map. 

In genus 3, if $C$ is hyperelliptic then the Weierstrass points are exactly the 8 ramification points of the 2-sheeted cover $C \to \PP^1$, and each has weight 3. If $C$ is non-hyperelliptic, then it is a plane quartic curve. A general such curve will have 24 ordinary flexes, which will be Weierstrass points of weight 1; special quartics may have some number $\alpha$ of \emph{hyperflexes}---points where the tangent line has contact of order 4 with the curve---which will be Weierstrass points of weight 2; in this case $C$ will have $\alpha$ Weierstrass points of weight 2 and $24-2\alpha$ Weierstrass points of weight 1. (It has been shown that $\alpha$ cannot be 11, but  all  other values  between 0 and 12 occur (\cite{Vermeulen}).


\subsubsection{The Weierstrass semigroup} 

The Riemann-Roch formula tells us that
$$
h^0(\cO_C(gp)) = g - g + 1 + h^0(K_C(-gp))
$$
so the condition $h^0(K_C(-gp)) \neq 0$ that $p$ be a Weierstrass point is equivalent to the condition $h^0(\cO_C(gp)) > 1$; in other words, there exists a nonconstant rational function on $C$, regular on $C \setminus \{p\}$ and having a pole of order at most $g$ at $p$.

This suggests that we look at the set of all possible orders of pole at $p$ of rational functions regular on $C \setminus \{p\}$; that is,
$$
W(C,p) := \left\{ -\ord_p(f) \mid f \in K(C) \text{ with $f$ regular on } C \setminus \{p\} \right\}.
$$
This is clearly a sub-semigroup of the natural numbers $\NN$; it is called the \emph{Weierstrass semigroup} of the point $p$.  

Another way to characterize the condition that there exists a rational function on $C$, regular on $C \setminus \{p\}$, with a pole of order exactly $k$ at $p$ is to say that
$$
h^0(\cO_C(kp)) = h^0(\cO_C((k-1)p)) + 1.
$$
Applying Riemann-Roch to both sides of this equation, we see that it is equivalent to the condition
$$
h^0(K_C(-kp)) = h^0(K_C((-k+1)p)).
$$

In English: there exists a rational function on $C$, regular on $C \setminus \{p\}$, with a pole of order exactly $k$ at $p$, if and only if there does \emph{not} exist a regular differential on $C$ with a zero of order exactly $k-1$ at $p$.
 In other words, the complement $\NN \setminus W(C,p)$ is exactly the vanishing sequence of the canonical series at $p$, shifted by 1; in particular, it has cardinality  exactly $g$. This is called the \emph{Weierstrass gap sequence} of the point $p$.

We still don't know what semigroups of finite index in $\NN$ occur as Weierstrass semigroups.
there are existence results for certain classes, such as the statement ([EH]) that every semigroup of weight $w \leq g/2$ occurs, and its refinement and strengthening in~\cite{MR3892968}). But an example by Buchweitz given in Exercise~\ref{Buchweitz} shows that not all semigroups occur.


\section{Finiteness of the automorphism group}\label{finiteness section}


\begin{theorem}\label{finite autos}
If $C$ is a smooth curve of genus $\geq 2$ then the automorphism group $\Aut(C)$ is finite.
\end{theorem}

  The idea behind the argument is simple: because the Weierstrass points of a curve are intrinsically defined, any automorphism must carry Weierstrass points to Weierstrass points. We will show that the subgroup of $Aut(C)$ of automorphisms that fix each  of the finitely many Weierstrass point is either
 trivial or, in the case of hyperelliptic curves, just the $\ZZ/2$ generated by the hyperelliptic involution.
    
We will study the fixed points of automorphisms by studying the intersection of the graph of
an automorphism with the diagonal divisor in $C\times C$. For this we use
\emph{Neron-Severi group} $N(S)$ of a surface $S$. This consists of divisors modulo \emph{numerical equivalence}---that is, in $N(S)$ we identify divisors $H, H'$ if for all divisors $D$ on $S$ we have $H\cdot D = H'\cdot D$. The group
$N(S)$ is a  finitely generated free abelian group for any surface---in characteristic 0 it is a subgroup of the quotient of the second integral homology group by its torsion elements. The rank of $N(S)$ is called the \emph{Picard number} of $S$. 

\begin{theorem}[Hodge Index theorem]\label{hodge index}
If $H\subset S$ is an ample divisor on a smooth projective surface, and $D \neq 0 \in N(S)$ is a divisor class with $D\cdot H = 0$, then 
$D^2<0$; that is, the intersection pairing is negative definite on the orthogonal complement of an
ample divisor.
\end{theorem}
\begin{proof}
The result follows easily from the Riemann-Roch theorem for surfaces; see \cite[Theorem V.1.9]{Hartshorne1977}.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{finite autos}]
 
The following two lemmas prove Theorem~\ref{finite autos} in a strong form:

\begin{lemma}Let $C$ be a smooth projective curve of genus $g \geq 2$, and $f: C \to C$ an automorphism of $C$.
\begin{enumerate}
\item If $f$ has $2g+3$ or more distinct fixed points, then $f$ is the identity; and
\item If $f$ has $2g+2$ distinct fixed points, then either $f$ is the identity or $C$ is hyperelliptic and $f$ is the hyperelliptic involution.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $S = C\times C$, and let $\Delta$ and $\Gamma \subset S$ be the diagonal and the graph of $f$ respectively, and let $\Phi_1$ and $\Phi_2 \subset S$ be fibers of the two projection maps. Let $\delta, \gamma, \varphi_1$ and $\varphi_2$ be the classes of these curves in  $N(S)$. The number of fixed points of $f$ (counted with multiplicities) is the intersection number  $b = \delta \cdot \gamma$.

We know all the other pairwise intersection numbers of these classes: the ones involving $\varphi_1$ or $\varphi_2$ are obvious. The normal bundle of the diagonal is the tangent bundle of $C$, so
$$
\delta^2 = 2 - 2g
$$
by Corollary~\ref{self-intersection number}.

Since the automorphism $id_C \times f : C\times C \to C \times C$ carries $\Delta$ to $\Gamma$, we see that $\gamma^2 = 2-2g$ as well.

We can now apply the index theorem for surfaces to deduce our inequality. To keep things relatively simple, let's introduce two new classes: set
$$
\delta' = \delta - \varphi_1 - \varphi_2 \quad \text{and} \quad \gamma' = \gamma - \varphi_1 - \varphi_2,
$$
so that $\delta'$ and $\gamma'$ are orthogonal to the class $\varphi_1 + \varphi_2$. Since $\varphi_1 + \varphi_2$ has positive self-intersection, the index theorem  tells us that the intersection pairing must be negative definite on the span $\langle \delta',\gamma' \rangle \subset N(S)$. In particular, the determinant of the intersection matrix
\begin{center}
\begin{tabular}{c|c|c}
& $\delta'$ &  $\gamma'$  \\
\hline
$\delta'$ & $-2g$ & $b-2$ \\
\hline
$\gamma'$ & $b-2$ & $-2g$ 
\end{tabular}
\end{center}
(where again $b = \gamma \cdot \delta$) is nonnegative, or equivalently, $b\leq 2g+2$.
\end{proof}

Having established an upper  bound on the number of fixed points an automorphism $f$ of $C$ (other than the identity) may have, it remains to find a lower bound on the number of distinct Weierstrass points; this is the content of the next lemma.


\begin{lemma}
If $C$ is a smooth projective curve of genus $g \geq 2$, then $C$ has at least $2g+2$ distinct Weierstrass points; and if it has exactly $2g+2$ Weierstrass points it is hyperelliptic.
\end{lemma}

\begin{proof}
Let $p \in C$ be any point, and $w_1=w_1(p),\dots,w_g = w_g(p)$ the ramification sequence of the canonical series $|K_C|$ at $p$. By definition, 
$$
h^0(K_C(-(w_i+i)p)) = g - i.
$$
Applying Clifford's theorem we have
$$
g-i \leq \frac{2g - 2 - w_i - i}{2} + 1;
$$
solving, we see that
$$
w_i \leq i
$$
and hence
$$
w_p \leq \binom{g}{2}
$$
where $w_p$ is the total weight of $p$ as a Weierstrass point. Since the total weight of the Weierstrass points on $C$ is $g^3-g$ by the Pl\"ucker formula, Theorem~\ref{Plucker}, we see that the number of distinct Weierstrass points must be at least
$$
\frac{g^3-g}{\binom{g}{2}} = 2g+2.
$$
Finally, by the strong form of Clifford's Theorem \ref{equality in Clifford from Martens}, equality implies that the curve is hyperelliptic.\end{proof}


\end{proof}

\section{Inflections of linear series on $\PP^1$}

Having a description in therms of ramification sequence for the inflectionary behavior of a linear series on a curve $C$ at a point, we can ask the global question: what combinations of inflectionary behaviors are actually possible? We don't know how to answer this
question for an arbitrary curve---as remarked above, we don't even know what Weierstrass semigroups are possible.
But we can give a complete answer for linear series on $\PP^1$. This is an essential ingredient in the proof of the Brill-Noether theorem given in the next chapter; and part of that theorem will answer the question completely
for general curves of any genus.

If we embed $\PP^1$ in $\PP^d$ as a rational normal curve $C$, any $g^r_d$ on $\PP^1$ will be the linear system cut out on $C$ by hyperplanes containing a fixed $(d-r-1)$-plane $\Lambda \subset \PP^d$, and the inflectionary behavior of the $g^r_d$ is determined by how $\Lambda$ intersects the flag of \emph{osculating spaces}  to $C$ at a point, which we will define below. 

\subsection{Schubert cycles}\label{Schubert1}

In this section and the next we will review the definition and a few facts about the subvarieties of the Grassmanian called Schubert cycles.
See for example~\cite[Chapters 3 and 4]{3264} for a full exposition.

The set of planes $\Lambda \subset \PP^d$ meeting  the subspaces of a given flag in (at least) certain dimensions
is a subvariety of the Grassmannian called a Schubert cycle, and these will be central to our discussion.

Let $G = \GG(k, d)$ be the Grassmannian of $k$-planes $\PP^k \subset \PP^d$, or equivalently the Grassmannian $G(k+1,d+1)$ of $(k+1)$-dimensional subspaces of a $(d+1)$-dimensional vector space $V$.
To simplify the notation, we will write $\ell := k+1, e:= d+1$.
Our application, will use the projective setting, but for now it will be clearer to work in the context  of vector spaces.

\begin{definition}
A \emph{complete flag} $\cal V$  in an $e$-dimensional vector space $V$ is a nested sequence of vector spaces
$$
0 \subset V_1 \subset V_2 \subset \dots  \subset V_{e} = V.
$$
with $\dim V_i = i$.
\end{definition}

Given a complete flag in $V$ and any  $\ell$-plane $\Lambda \subset V$, we can derive the nested sequence of $e$ subspaces of $\Lambda$:
$$
0 \; \subset \; \Lambda \cap V_1 \; \subset \;  \Lambda \cap V_2 \; \subset \;  \dots \; \subset \;  \Lambda \cap V_d \; \subset \;  \Lambda \cap V_{e} = \Lambda
$$
Each term in this sequence is either equal to the preceding one, or of dimension 1 greater; the former will occur $e-\ell$ times, and the latter $\ell$ times. For a general $\ell $-plane $\Lambda$, the jumps occur at the end; that is, we have $\Lambda \cap V_{e-\ell} = 0$, and thereafter the dimension of the intersection goes up by 1 each time. This makes it natural
to describe the special position of a given $\ell $-plane by how early the $i$-th jump occurs: 

\begin{definition}
A \emph{Schubert index} for $G(\ell, e)$ is a sequence ${\bf a} = (a_1,\dots,a_{\ell})$ of integers with $e-\ell \geq a_1 \geq a_2 \geq \dots \geq a_{\ell} \geq 0$.
The \emph{Schubert cycle $\Sigma_{\bf a}({\cal V}) \subset G$} associated to a complete flag $\sV$ in $\CC^e$ and
Schubert index $\bf a$  is 
$$
\Sigma_{\bf a}({\cal V}) \; := \; \left\{ \Lambda \in G \mid \dim(\Lambda \cap V_{e-\ell+i-a_i}) \geq i \; \forall i \right\}
$$
When $\cal V$ is clear from context (or immaterial) we sometimes drop it and write simply $\Sigma_{\bf a}$.
\end{definition}
Thus the variety  $\Sigma_{\bf a}({\cal V})$ is the set of $\ell $-planes $\Lambda$ for which the $i$-th jump in the sequence of intersections $\Lambda \cap V_{e-\ell} = 0$ occurs
$a_i$ steps earlier than for the general $\ell $-plane. 

%Alternately, since a generic $\ell $-plane meets $V_s$ in dimension $\max\{0, \ell  - (d+1-s) = k-d+s\}$,  
%$\Sigma_{\bf a}({\cal V})$ is the set of $\ell $-planes that meet $V_s$ in dimension $\geq k-d+s + a_

 
For example, the Schubert cycle $\Sigma_{0\dots,0}$ is the whole Grassmannian, 
and $\Sigma_{1,0\dots,0}(\cal V)$ is the set of $\ell$-planes that meet $V_{e-\ell}$ nontrivially, which is
a hyperplane section of the Grassmannian in its Pl\"ucker embedding. 
More generally, the
\emph{special Schubert cycle} 
$\Sigma_a(\sV) := \Sigma_{a,0,\dots, 0}(\sV)$ 
is the set of $\ell$-planes
meeting  $V_{e-\ell - a+1}$ nontrivially.
Since this condition really involves only the single space $W = V_{e-\ell-a+1}$, we sometimes 
 write it
as $\Sigma_a(W)$. 

 The codimension $\sum a_i$ of $\Sigma_{\bf a}({\cal V})$ in $G$ is $\sum a_i$, denoted $|{\bf a}|$ (Exercise~\ref{codim Schubert}).

The natural isomorphism $\phi$ between the Grassmannian $G(\ell, V)$ of $\ell$-planes in an $e$-dimensional vector space $V$, and the Grassmannian  $G(e-\ell, V^*)$ of $(e-\ell)$-planes in  the dual vector space $V^*$, sends a subspace $\Lambda \subset V$ to its annihilator in $V^*$. This isomorphism carries Schubert cycles in $G(\ell, V)$ defined relative to a flag $\cal V$ to Schubert cycles in $G(e-\ell, V^*)$ defined relative to the dual flag ${\cal V}^*$, but with different indices.

To describe the correspondence between Schubert indices,
suppose that ${\bf a} = (a_1,\dots, a_{\ell})$ is a Schubert index in $G(\ell, V)$, so that $n-k \geq a_1 \geq a_2 \geq \dots \geq a_{k+1} \geq 0$. The \emph{transpose} Schubert index to be the sequence ${\bf a}^*:  (b_1,\dots, b_{n-k})$ given by 
$$
 b_j \; := \; \#\{ i \mid a_i \geq j \}
$$
For example, the transpose of the special Schubert cycle
$\Sigma_{a,0,\dots,0}(\sV)$ is 
$\Sigma_{1,1,\dots,1,0,\dots,0}(\sV)$ with $a$ 1s.
For the properties of this operation, see Exercise~\ref{Schubert duality}.

\pict{a flag in $\PP^3$, with illustrations of $\Sigma_1, \Sigma_2, \Sigma_{1,1}, \Sigma_{2,1}$}

\subsection{Special Schubert cycles and Pieri's formula}

\begin{fact}
The variety of complete flags in $\CC^e$ is rational, and it follows that the class of $\Sigma_{\bf a}({\cal V})\subset G$
in the cohomology ring $H^*(G, \ZZ)$ of the Grassmanian $G = G(\ell, e)$ (or the Chow ring, which is the same in this case) is independent
of the flag $\sV$, and is typically denoted $\sigma_{\bf a}$. Moreover, the classes $\sigma_{\bf a}$ form a basis for the Chow ring of $G$. Thus the product $\sigma_{\bf a} \cdot \sigma_{\bf b}$ is a linear combination of Schubert classes,
given combinatorially by the \emph{Littlewood-Richardson rule}, the center of the \emph{Schubert calculus}. See for example~\cite{MR2247964}.
\end{fact}

\emph{Pieri's formula} is the special
case of the Littlewood-Richardson rule that expresses the product in the cohomology ring $H^*(G(\ell, e))$ of an arbitrary Schubert class with a special Schubert class.
In Chapter~\ref{BrillNoetherproofChapter} we will use it to describe the possible osculating behavior of rational curves with cusps.

\begin{fact}
\begin{proposition}\label{Pieri}[Pieri's Formula]
If $\sigma_a$ is a special Schubert class and $\sigma_{\bf b}$ is an arbitrary Schubert class, then
$$
\sigma_a \cdot \sigma_{\bf b} \; = \; \sum \sigma_{\bf c}
$$
where the sum ranges over all indices ${\bf c} = (c_1, \dots c_{k+1})$ with
$$
\sum c_i = a + \sum b_i \quad \text{and} \quad b_i \leq c_i \leq b_{i-1} \text{ for all } i
$$
\end{proposition}

\pict{illustration showing the degeneration of $\Sigma_1\cdot \Sigma_1$ to $\Sigma_2 \cup \Sigma_{1,1}$.}

For a proof, see for example \cite[Section 4.2.4]{3264}.
\end{fact}
To understand what this is saying, imagine we represent the Schubert class $\sigma_{\bf b}$ by stacks of coins, with $b_1$ coins in the first stack, $b_2$ coins in the second stack, and so on. We now want to add a total of $a$ coins to the stacks; we can add any number of them to any stack (including a stack that was previously empty), with the one condition that the new height of each stack can't be larger than the previous height of the stack to its left. This interpretation makes the following corollary clear:

\begin{corollary}\label{intersection with sigma nonzero}
If $\sigma_a$ is any special Schubert class, $\sigma_{\bf b}$ is any Schubert class,
and $m\geq 0$ is an integer with $m a + \sum b_i \leq \dim G(\ell, e) = \ell(e-\ell)$, then   
$$
(\sigma_a)^l \cdot \sigma_{\bf b} \neq 0 \in H^*(G(\ell, e), \ZZ).
$$
\end{corollary}

\subsection{Osculating flags of a rational normal curve}

To relate the discussion above to inflection points of linear series on $\PP^1$ we introduce the notion of the \emph{osculating flag} to a curve at a point.

If $C\subset \PP^d$ is a rational normal curve of degree $d$ and $p \in C$ is a point on $C$ then by Corollary~\ref{independence of points on a RNC} the span $\overline{mp}$ is an $(m-1)$-plane in $\PP^d$.
Thus we have a complete flag of linear subspaces:
$$
\{p\} \subset \overline{2p} \subset \overline{3p} \subset \dots \subset \overline{dp} \subset \overline{(d+1)p} = \PP^d
$$
which we call the \emph{osculating flag} to $C$ at $p$. Note that the second term $\overline{2p}$ is the tangent line to $C$ at $p$; in general, the $k$-plane $\overline{(k+1)p}$ is called the \emph{osculating $k$-plane to $C$ at $p$}.

For any $(d-r-1)$-plane $\Lambda \subset \PP^d$, let $(\sO_C(d), V_\Lambda)$ be the linear series cut on $C$ by hyperplanes in $\PP^d$ containing $\Lambda$. (Note that if $\Lambda \cap C \neq \emptyset$, the linear series $V_\Lambda$ will have base points; we do not throw those away, since we want $V_\Lambda$ to always be a $g^r_d$.) All $g^r_d$s on $\PP^1$ are given in this way.

\begin{proposition}\label{ramification}
Let $(V_\Lambda, \sO_C(d))$ be the $g^r_d$ on $\PP^1$ obtained as the projection from a rational normal curve $C\subset \PP^d$
from a plane $\Lambda \subset \PP^d$ of dimension $d-r-1$, and write $\sV = 0\subset V_1\subset \cdots \subset V_d = \PP^d$ for the osculating flag of $C$ at $p$. The ramification sequence $\alpha(V_\Lambda, p)$
is determined by the formula
%
%Let ${\bf a}$ be a Schubert index in the Grassmannian $G(d-r, d+1)$; that is ${\bf a} = (a_1, \dots a_{d-r})$ with $r+1 \geq a_1 \geq \dots \geq a_{d-r} \geq 0$, and let ${\bf a}^*$ be the transpose Schubert index. If $\cal V$ is the osculating flag to the rational normal curve $C \subset \PP^d$ at a point $p$,
%then for any $(d-r-1)$-plane $\Lambda \subset \PP^d$, 
$$
\Lambda \in \Sigma_{\bf a}({\cal V}) \; \iff \; \alpha_i(V_\Lambda, p) \geq {\bf a}^*_{r+1-i} = \#\{j\mid a_j\geq r+1-i\}.
$$
\end{proposition} 
\def\tL{{\widetilde \Lambda}}
\def\tsV{{\widetilde \sV}}
\def\tV{{\widetilde V}}
In other words, the ramification sequence $\alpha(V_\Lambda, p)$ of the linear series $V_\Lambda$ at $p$ is exactly the reverse of the transpose of the Schubert index of the smallest Schubert cycle containing $\tL$, the vector
space associated to $\Lambda$, in  $G(d-r, d+1)$.

%\$$van = (\nu_0< \dots< \nu_r);$$
%$$\alpha = (\alpha_0\leq \dots\leq \alpha_r);$$
%$$ {\bf a} = (r+1 \geq a_1\geq \cdots \geq a_{d-r});$$
%$$  {\bf a}^* = (d-r\geq b_1\geq\cdots \geq b_{r+1})$$
%


\begin{proof}
To keep the notation of Section~\ref{Schubert1}, we work with the affine versions
$\tL, \tsV = (\tV_1, \dots, \tV_{d+1})$ of the projection center and the osculating flag at $p$, respectively,
so that, for example $\dim \tL = d-r$. Note that the space $\tV_\Lambda$ of the linear series 
denoted $(V_\Lambda, \sO_{\PP^1}(d))$ 
is already a vector space, but for consistency of notation we will write $\tV_\tL$ anyway.

The condition $\tL \in \Sigma_{\bf a}({\tsV})$
 means that 
$$
\dim \tL \cap \tV_{r+1+i-a_i} \geq i
$$
for each $i$. It follows that, 
in the space of hyperplanes containing $\tL$, it is $\leq r-a_i+1$ further conditions to contain $\tV_{r+i-a_i}$. Equivalently,
since the projective space correspondin to $\tV_{r+i-a_i}$ is the linear span of the divisor $(r+i-a_i+1)p\subset C$
a codimension $\leq r-a_i+1$ space of sections of $\tV_\tL$ will vanish to order $\geq r -a_i+1+i$ at $p$. 

If we write the distinct orders of vanishing of the sections in $\tV_\tL$ as
$b_0 < b_1<  \cdots < b_r$, we see that $\tL \in \Sigma_{\bf a}$  if and only if
$a_i$ of the $b_j$ are $\geq r+i+a_i+1$, that is,
$b_{r-a_i+1}\geq r-a_i+1+i$ or equivalently $\alpha_{r-a_i+1}\geq i$ for each $i$.
Since $\alpha_i\leq \alpha_{i+1} \leq \alpha_r$,
this is equivalent to saying that the number of $\{j \mid \alpha_j \geq i\}$ is at least $a_i$, or, for the
reverse sequence $\alpha' = \alpha_r \geq \alpha_{r-1} \geq \cdots \geq 0$, that the $a_i$-th term is $\geq i$.
On the other hand ${\bf a'}_{a_i} = \#\{j\mid a_j \geq a_i\} = i$ since the sequence ${\bf a}$ is weakly
decreasing, so $\alpha'$ is termwise $\geq {\bf a'}$.
\end{proof}

\subsection{Conclusions}

Using these ideas we can completely characterize the sets of ramification indices that can occur at specified points for a given
linear series on $\PP^1$. 

\begin{theorem}\label{osculating intersection}
Let $p_1,\dots,p_\delta \in C$ be distinct points on a rational normal curve $C \subset \PP^d$, and ${\cal V}^1, \dots, {\cal V}^\delta$ the corresponding osculating flags. If ${\bf a}^1, \dots, {\bf a}^\delta$ are $\delta$ Schubert indices for $G(d-r, d+1)$, the Schubert cycles $\Sigma_{{\bf a}^1}({\cal V}^1), \dots, \Sigma_{{\bf a}^\delta}({\cal V}^\delta) \subset G(d-r, d+1)$ intersect properly; that is, the intersection is either empty or has codimension exactly
$$
\sum_{j=1}^\delta\left(\sum_{i = 1}^{r+1}a^j_i\right),
$$
 the sum of the codimensions of the cycles $\Sigma_{{\bf a}^j}$. Moreover, the intersection is nonempty if and only if
 the intersection product of the classes $[\Sigma_{{\bf a}^j}]$ is nonzero in $H^*(G(d-r, d+1), \ZZ)$.
\end{theorem}

Note that this does not depend on the choice of points $p_i$!

\begin{proof} 
If the intersection is empty then the cohomology class is 0, so it suffices to show that the intersection is proper,
and we may assume that it is non-empty. Because the Grassmannian is smooth, the codimension of the intersection of any subvarieties
 is $\leq$ than the sum of their codimensions, so it is enough to show that the codimension of the
 intersection cannot be too large.

The Schubert cycle $\Sigma_1$ is a hyperplane section of the Grassmannian $G(d-r, r+1)$, so that if $\Phi \subset G$ is any subvariety of dimension $m$, its intersection with $m$ Schubert cycles $\Sigma_1$ is nonempty. Thus, if the intersection
$$
X := \bigcap_{i=1}^\delta \Sigma_{{\bf a}^i}({\cal V}^i)
$$
had dimension strictly bigger than the expected
$$
\rho \; := \; (r+1)(d-r) - \sum_{i=1}^\delta |{\bf a}^i|,
$$
we could choose $\rho + 1$ additional points $q_1,\dots,q_{\rho + 1}$ on $C$, with osculating flags ${\cal W}^1, \dots, {\cal W}^{\rho + 1}$ and the intersection of $X$ with the Schubert cycles $\Sigma_1({\cal W}^i)$ would still be nonempty.

It thus suffices to show that the intersection is empty if
$$
\sum_{i=1}^\delta |{\bf a}^i| \; > \; (r+1)(d-r) = \dim G(d-r, d+1).
$$
If on the contrary 
$$
\Lambda \; \in \; \bigcap_{i=1}^\delta \Sigma_{{\bf a}^i}({\cal V}^i),
$$
then, by Proposition~\ref{ramification}, the linear series $V_\Lambda$ cut by hyperplanes containing $\Lambda$ would have
ramification of weight $|{bf a_i}|$ at $p_i$, and the sum of the weights would be strictly greater than $(r+1)(d-r)$. 
This contradicts the Pl\"ucker formula, Theorem~\ref{Plucker}.
\end{proof}

Using Proposition~\ref{ramification} this result becomes a characterization of the sets of possible ramification
sequences for linear series at specified points on $\PP^1.$
 Explicitly, suppose we are given a collection of distinct points $p_1,\dots,p_\delta \in \PP^1$, and for each point $p_i$ a ramification sequence
$$
\alpha^i = (\alpha^i_0, \alpha^i_1, \dots, \alpha^i_r) \quad \text{with} \quad 0 \leq \alpha^i_0 \leq \alpha^i_1 \leq \dots \leq \alpha^i_r \leq d-r.
$$
Let ${\bf a}^i$ be this sequence in reverse (and relabelled); that is
$$
{\bf a}^i \; = \; (\alpha^i_r, \alpha^i_{r-1}, \dots, \alpha^i_1, \alpha^i_0)
$$
and finally let ${\bf b}^i$ be the transpose of the Schubert index ${\bf a}^i$. 

\begin{corollary}
There exists a $g^r_d$ on $\PP^1$ with ramification sequence at $p_i$ equal to $(\alpha^i_0, \alpha^i_1, \dots, \alpha^i_r)$ if and only if 
$$
\prod_{i=0}^\delta  \sigma_{{\bf b}^i} \; \neq \; 0 \quad \text{in} \quad A^*(G(d-r, r+1)).
$$
\end{corollary}

\begin{proof}
If the product is nonzero, Proposition~\ref{ramification} and Theorem\ref{osculating intersection} immediately show the existence of a $g^r_d$ on $\PP^1$ with ramification sequence greater than or equal to $\alpha^i$ at $p_i$. But by Theorem~\ref{osculating intersection}, the ones with ramification strictly greater than the $\alpha^i$ form a family of strictly smaller dimension. Thus a general $g^r_d$ with ramification sequence greater than or equal to $\alpha^i$ at $p_i$ will have  ramification sequence exactly equal to $\alpha^i$ at $p_i$
\end{proof}

We can deduce a result about general secant loci strengthening one that was originally proven in \cite{Griffiths-Harris-BN}:
Given a curve $C \subset \PP^d$, we say that a \emph{secant flag} in $\PP^d$ is a flag
$$
0 \subset V_1 \subset V_2 \subset \dots \subset V_{d-1} \subset V_d = \PP^d
$$
where each $V_i$ is spanned by its (scheme-theoretic) intersection with $C$. In other words, there is a sequence of points $p_1, p_2, \dots, p_{d+1} \in C$ such that
$$
V_i \; = \; \overline{p_1+p_2+ \dots + p_{i+1}}
$$
(An osculating flag is just the special case where all $p_i$ are equal.) Since any secant flag can specialize to an osculating flag, we can deduce the

\begin{corollary}\label{secant schubert proper}
Schubert cycles defined relative to \emph{general} secant flags to a rational normal curve intersect properly.
\end{corollary} 

Unlike the case for osculating flags, the hypothesis of generality is necessary here; see Exercise~\ref{only general secants}



\section{Exercises}
\begin{exercise}\label{inseparable Gauss}
Let $k$ be a field of characteristic $p$. Show that every point of the affine curve $y = x^{p+1}+1$ over $k$ is a flex point.
 
\end{exercise}

\begin{exercise}\label{Hessian exercise} 
Let $p\in C$ be a smooth point of a  plane curve with equation $F(x_0,x_1,x_2) = 0$ of degree $d>1$. Show that the tangent line to $C$ at $p$ meets
$C$ is a scheme of order $m+2$ if and only if the determinant of the Hessian matrix vanishes
along $C$ to order $m$ as is done in \cite[pp. 84--85]{Kunz}:

\begin{enumerate}
\item Assume that $p = (0,0)\in \AA^2\subset \PP^2$, where $\AA^2$ is the locus $x_0\neq 0$, 
and suppose that $f(x,y) =0$ is the affine equation of $C$, with $x= x_1/x_0, y = x_2/x_0$.
Reduce to the affine case by showing that
$$
\begin{aligned}
&\det Hess(C) = \\
&x_0^2 \det 
\begin{pmatrix}
 d(d-1)F & (d-1) \partial F/\partial x_1 & (d-1) \partial F/\partial x_2 \\
 (d-1) \partial F/\partial x_1&\partial^2 F/\partial x_1 \partial x_1 & \partial^2 F/\partial x_1 \partial x_2\\
 (d-1) \partial F/\partial x_2 &\partial^2 F/\partial x_2 \partial x_1 & \partial^2 F/\partial x_2 \partial x_2 
\end{pmatrix} .
\end{aligned}
$$ 
Writing the partial derivatives as subscripts, this becomes
$$
\det \begin{pmatrix}
 d(d-1)f & (d-1) f_x & (d-1) f_y \\
 (d-1) f_x&f_{xx} & f_{xy}\\
 (d-1) f_y &f_{xy} & f_{yy}
\end{pmatrix}
$$ 
when restricted to $\AA^2$.

\item Assume that the tangent line to $C$ at $p$ is $y=0$. Show that $f$ can be written as
$$
f = x^{m+2}\phi(x) +y\psi(x,y)
$$
where $\phi(0) \neq 0$ and $\psi(0,0) \neq 0$, and thus, modulo $f$, the Hessian determinant,
up to a constant factor, 
has the form
$$
f_x^2f_{yy}+f_y^2f_{xx}-2f_xf_yf_{xy}.
$$
Note that $x$ is a local parameter at $p$. Using the form of $f$ above, show that there is a unique term vanishing to order $m$ at $p$,
and no term vanishing to lower order there.
\end{enumerate}
\end{exercise}

\begin{exercise}\label{codim Schubert}
Show that the codimension of $\Sigma_{\bf a}({\cal V})$ in $G$ is equal to $\sum a_i$.
\end{exercise}
\begin{exercise}\label{Schubert duality}
 If ${\bf a}^*$ is the transpose Schubert index to $\bf a$,
\begin{enumerate}
\item  Show that $|{\bf a}^*| = |{\bf a}|$
\item Show that $({\bf a}^*)^* = {\bf a}$
\item Show that the isomorphism $\phi : G(k+1, V) \rTo^\cong G(n-k, V^*)$ carries the Schubert cycle $\Sigma_{\bf a}({\cal V})$ to the Schubert cycle $\Sigma_{{\bf a}^*}({\cal V}^*)$.
\end{enumerate}
(Of course, the first two parts follow from the third; think of the first two as warmups.)
\end{exercise}

\begin{exercise}
Though we will only use the osculating flag for rational normal curves, we can define the osculating flag to any nondegenerate curve $C \subset \PP^d$ at any smooth point $p$. If $p$ is an inflection point then $\overline{mp}$ may not be an $(m-1)$-plane, but we can look at the nested sequence of subspaces
$$
\{p\} \subset \overline{2p} \subset \overline{3p} \subset \dots 
$$
and pick out exactly the terms whose dimension is strictly greater than the preceding term; this gives a complete flag
$$
\{p\} \subset \overline{b_2p} \subset \overline{b_3p} \subset \dots \subset \overline{b_{d+1}p} = \PP^d
$$
Show that the sum $\sum b_i - i$ is equal to the weight of the point $p$ as an inflection point of the hyperplane series.
\end{exercise}

\begin{exercise}\label{only general secants}
Show by example that Schubert cycles defined relative to arbitrary secant flags to a rational normal curve may fail to intersect properly. (Hint: it's enough to look at the case $d=2$ and $r=1$.)
\end{exercise}

\begin{exercise}
The Pl\"ucker formula shows that an elliptic normal curve $E\subset P^{n-1}$ has $n^2$ inflection points. Show that they are
all simple, and that if you choose one as the origin for the group law on $E$, then 
then they are the $n$-torsion points of  $E \cong Jac(E)$.
\end{exercise}

\begin{exercise}
Show that in case $r=1$, Theorem~\ref{Plucker} is equivalent to the Riemann-Hurwitz formula for branched covers of $\PP^1$.
\end{exercise}

\begin{exercise}(Buchweitz, unpublished)\label{Buchweitz}
It was long believed that every vanishing sequence of length $g$, bounded by $2g-2$, could occur at a Weierstrass
point on a curve of genus $g$, but this is not the case. The following counterexample for a curve of genus 16 was found by Buchweitz (unpublished): Show that there is no curve $C$ (necessarily of genus 16) with a point whose Weierstrass semigroup
is generated by
$W =\{0,1,2,3,4,5,6,7,8,9,10,11, 18,20,23,24\}$
by showing that the cardinality of $W+W$ is larger than $h^0(2K_C)$.
\end{exercise}

%\section{possible exercises}
%\begin{enumerate}
% \item geometry of the Grassmannian G of lines in P^3: embedding as a quadric. 
% \item condition for a line joining two points to lie in G; 
% \item tangent hyperplane to G at a point [L] meets G in the space of lines meeting L
% \item enumerate the Schubert cycles in G, and their lattice of containments
% \item the tangent space to G is Hom(sub, quot)
% \item difference between rank 1 and rank 2 tangent vectors
% \item line joining two flexes on a cubic contains a 3rd.
%\end{enumerate}
\input{footer}